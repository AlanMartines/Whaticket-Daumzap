const a244_0x35260d=a244_0x465b;function a244_0x465b(_0x263a72,_0x216d99){const _0x471394=a244_0x49e8();return a244_0x465b=function(_0x219831,_0x53dc80){_0x219831=_0x219831-0x14c;let _0x49e817=_0x471394[_0x219831];return _0x49e817;},a244_0x465b(_0x263a72,_0x216d99);}(function(_0x422dc4,_0x241a32){const _0x465f9b=a244_0x465b,_0x3939a6=_0x422dc4();while(!![]){try{const _0x2786d7=-parseInt(_0x465f9b(0x14e))/0x1*(-parseInt(_0x465f9b(0x14d))/0x2)+-parseInt(_0x465f9b(0x17a))/0x3+-parseInt(_0x465f9b(0x15c))/0x4+-parseInt(_0x465f9b(0x164))/0x5*(-parseInt(_0x465f9b(0x171))/0x6)+-parseInt(_0x465f9b(0x150))/0x7*(-parseInt(_0x465f9b(0x16c))/0x8)+parseInt(_0x465f9b(0x158))/0x9*(parseInt(_0x465f9b(0x15e))/0xa)+parseInt(_0x465f9b(0x175))/0xb;if(_0x2786d7===_0x241a32)break;else _0x3939a6['push'](_0x3939a6['shift']());}catch(_0x144b4e){_0x3939a6['push'](_0x3939a6['shift']());}}}(a244_0x49e8,0xb15a0));const a244_0x53dc80=(function(){let _0x50111d=!![];return function(_0x21aec1,_0x405468){const _0x35cf17=_0x50111d?function(){if(_0x405468){const _0x31ea34=_0x405468['apply'](_0x21aec1,arguments);return _0x405468=null,_0x31ea34;}}:function(){};return _0x50111d=![],_0x35cf17;};}()),a244_0x219831=a244_0x53dc80(this,function(){const _0x16ffe7=a244_0x465b;return a244_0x219831[_0x16ffe7(0x177)]()['search']('(((.+)+)+)+$')[_0x16ffe7(0x177)]()[_0x16ffe7(0x166)](a244_0x219831)[_0x16ffe7(0x168)]('(((.+)+)+)+$');});a244_0x219831();'use strict';var __importDefault=this&&this[a244_0x35260d(0x15b)]||function(_0x1a6083){const _0x2bb98e=a244_0x35260d;return _0x1a6083&&_0x1a6083[_0x2bb98e(0x16a)]?_0x1a6083:{'default':_0x1a6083};};Object['defineProperty'](exports,a244_0x35260d(0x16a),{'value':!![]}),exports['SendMessage']=void 0x0;const GetWhatsappWbot_1=__importDefault(require(a244_0x35260d(0x153))),SendWhatsAppMedia_1=require(a244_0x35260d(0x17e)),CreateOrUpdateContactService_1=__importDefault(require(a244_0x35260d(0x17c))),FindOrCreateTicketService_1=__importDefault(require(a244_0x35260d(0x17f))),CheckNumber_1=__importDefault(require(a244_0x35260d(0x157))),SetTicketMessagesAsRead_1=__importDefault(require('../helpers/SetTicketMessagesAsRead')),Mustache_1=__importDefault(require(a244_0x35260d(0x162))),wbotMessageListener_1=require('../services/WbotServices/wbotMessageListener'),mime_1=__importDefault(require(a244_0x35260d(0x16e))),CreateMessageService_1=__importDefault(require(a244_0x35260d(0x170))),SendPresenceStatus_1=require(a244_0x35260d(0x159)),SendMessage=async(_0x15c702,_0x491025)=>{const _0x2741b0=a244_0x35260d;try{const _0x4c830=await(0x0,GetWhatsappWbot_1['default'])(_0x15c702),_0x46a79e=_0x491025[_0x2741b0(0x163)],_0x45f794=_0x491025[_0x2741b0(0x15d)],_0x2dd96f=_0x15c702[_0x2741b0(0x169)],_0x5b23a0=await(0x0,CheckNumber_1[_0x2741b0(0x176)])(_0x46a79e[_0x2741b0(0x154)](),_0x2dd96f),_0x4aaac5=_0x5b23a0['jid'][_0x2741b0(0x17d)](/\D/g,''),_0x4364ae={'name':''+_0x4aaac5,'number':_0x4aaac5,'isGroup':![],'companyId':_0x2dd96f},_0x3f48f4=await(0x0,CreateOrUpdateContactService_1[_0x2741b0(0x176)])(_0x4364ae,_0x4c830,_0x5b23a0[_0x2741b0(0x17b)]),_0x4c4c4c=await(0x0,FindOrCreateTicketService_1[_0x2741b0(0x176)])(_0x3f48f4,_0x15c702['id'],0x0,_0x2dd96f),_0x35eb41=_0x4c4c4c['contact'][_0x2741b0(0x163)]+'@'+(_0x4c4c4c['isGroup']?_0x2741b0(0x160):_0x2741b0(0x165));let _0x4c40ad;if(_0x491025[_0x2741b0(0x178)]){const _0x334ede=await(0x0,SendWhatsAppMedia_1[_0x2741b0(0x16d)])(_0x491025[_0x2741b0(0x15a)],_0x491025['mediaPath'],_0x491025[_0x2741b0(0x15d)],_0x2dd96f);if(_0x334ede){await(0x0,SendPresenceStatus_1[_0x2741b0(0x172)])(_0x4c830,_0x35eb41,0x0,0x2710);let _0x14507e=_0x4c40ad=await _0x4c830[_0x2741b0(0x16b)](_0x35eb41,{..._0x334ede});const _0x5c0555=mime_1[_0x2741b0(0x176)][_0x2741b0(0x15f)](_0x491025[_0x2741b0(0x178)]),_0x5adb0d=await(0x0,wbotMessageListener_1['verifyQuotedMessage'])(_0x14507e),_0x385515={'id':_0x14507e['key']['id'],'ticketId':_0x4c4c4c['id'],'contactId':_0x14507e[_0x2741b0(0x180)][_0x2741b0(0x14f)]?undefined:_0x3f48f4['id'],'body':_0x45f794?(0x0,Mustache_1[_0x2741b0(0x176)])(_0x45f794,_0x4c4c4c):_0x491025['fileName'],'fromMe':_0x14507e[_0x2741b0(0x180)][_0x2741b0(0x14f)],'read':_0x14507e['key'][_0x2741b0(0x14f)],'mediaUrl':_0x491025[_0x2741b0(0x156)],'mediaType':typeof _0x5c0555===_0x2741b0(0x167)?_0x5c0555[_0x2741b0(0x16f)]('/')[0x0]:_0x2741b0(0x173),'quotedMsgId':_0x5adb0d?.['id'],'ack':0x0,'remoteJid':_0x14507e[_0x2741b0(0x180)][_0x2741b0(0x155)],'participant':_0x14507e['key'][_0x2741b0(0x152)],'dataJson':JSON[_0x2741b0(0x179)](_0x14507e)};typeof _0x385515['body']!='string'&&console[_0x2741b0(0x14c)](_0x2741b0(0x161),_0x385515['body']),await _0x4c4c4c[_0x2741b0(0x151)]({'lastMessage':_0x385515[_0x2741b0(0x15d)]}),await(0x0,CreateMessageService_1['default'])({'messageData':_0x385515,'ticket':_0x4c4c4c,'companyId':_0x4c4c4c[_0x2741b0(0x169)]});}}else{const _0x498e56='â€Ž\x20'+_0x491025[_0x2741b0(0x15d)];await(0x0,SendPresenceStatus_1[_0x2741b0(0x172)])(_0x4c830,_0x35eb41);const _0x2659ee=await _0x4c830[_0x2741b0(0x16b)](_0x35eb41,{'text':(0x0,Mustache_1[_0x2741b0(0x176)])(_0x498e56,_0x4c4c4c)});await(0x0,wbotMessageListener_1[_0x2741b0(0x174)])(_0x2659ee,_0x4c4c4c,_0x4c4c4c['contact']);}return typeof _0x45f794!='string'&&console[_0x2741b0(0x14c)](_0x2741b0(0x161),_0x45f794),await _0x4c4c4c[_0x2741b0(0x151)]({'lastMessage':_0x45f794}),(0x0,SetTicketMessagesAsRead_1[_0x2741b0(0x176)])(_0x4c4c4c),_0x4c40ad;}catch(_0x154926){throw new Error(_0x154926);}};exports[a244_0x35260d(0x181)]=SendMessage;function a244_0x49e8(){const _0x42f480=['update','participant','./GetWhatsappWbot','toLocaleString','remoteJid','finalName','../services/WbotServices/CheckNumber','309645XuwsyX','./SendPresenceStatus','fileName','__importDefault','3513916tnGPha','body','120bXODYc','lookup','g.us','body\x20is\x20not\x20a\x20string','../helpers/Mustache','number','2365yWcaHl','s.whatsapp.net','constructor','string','search','companyId','__esModule','sendMessage','2615864NohYju','getMessageOptions','mime','split','../services/MessageServices/CreateMessageService','7998ntgoNe','SendPresenceStatus','unknown','verifyMessage','3401981AAmeRy','default','toString','mediaPath','stringify','3393492APSFqh','jid','../services/ContactServices/CreateOrUpdateContactService','replace','../services/WbotServices/SendWhatsAppMedia','../services/TicketServices/FindOrCreateTicketService','key','SendMessage','trace','2uPPuFR','1056452UGTzHs','fromMe','7MpbBCs'];a244_0x49e8=function(){return _0x42f480;};return a244_0x49e8();}