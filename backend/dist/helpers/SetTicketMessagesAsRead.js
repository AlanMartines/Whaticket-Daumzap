const a249_0x365056=a249_0x7c52;(function(_0x341766,_0x5a1ed3){const _0x2c11c0=a249_0x7c52,_0x16636d=_0x341766();while(!![]){try{const _0x236778=parseInt(_0x2c11c0(0x208))/0x1+parseInt(_0x2c11c0(0x209))/0x2*(-parseInt(_0x2c11c0(0x1eb))/0x3)+parseInt(_0x2c11c0(0x214))/0x4+-parseInt(_0x2c11c0(0x215))/0x5*(-parseInt(_0x2c11c0(0x1ec))/0x6)+-parseInt(_0x2c11c0(0x202))/0x7+-parseInt(_0x2c11c0(0x1f9))/0x8+parseInt(_0x2c11c0(0x1ff))/0x9*(parseInt(_0x2c11c0(0x201))/0xa);if(_0x236778===_0x5a1ed3)break;else _0x16636d['push'](_0x16636d['shift']());}catch(_0x13b261){_0x16636d['push'](_0x16636d['shift']());}}}(a249_0x2450,0x8723f));function a249_0x2450(){const _0x45c684=['2726872ztHbjM','companyId','../models/Message','-notification','dataJson','set','445392MpFOMO','apply','10BTPtWm','2284380yPDmcc','Could\x20not\x20mark\x20messages\x20as\x20read.\x20Maybe\x20whatsapp\x20session\x20disconnected?\x20Err:\x20','readMessages','sendReceipt','constructor','updateUnread','215925UkgiFN','300214nfJMiP','contactId','update','default','(((.+)+)+)+$','toString','../utils/logger','contacts:','DESC','@s.whatsapp.net','warn','1517024PIPdhe','907715MIlvrI','parse','findAll','./GetTicketWbot','__importDefault','defineProperty','isGroup','createdAt','emit','search','read','status','-ticket','key','3SqRsMa','24JyiGYa','company-','__esModule','getIO','../libs/socket','cacheLayer','number','length','@g.us','substring','../libs/cache','contact','fromMe'];a249_0x2450=function(){return _0x45c684;};return a249_0x2450();}const a249_0x192df3=(function(){let _0x378903=!![];return function(_0x3a1175,_0x5857ce){const _0x1ab5ef=_0x378903?function(){const _0x202bc=a249_0x7c52;if(_0x5857ce){const _0x32263c=_0x5857ce[_0x202bc(0x200)](_0x3a1175,arguments);return _0x5857ce=null,_0x32263c;}}:function(){};return _0x378903=![],_0x1ab5ef;};}()),a249_0x741c31=a249_0x192df3(this,function(){const _0x49d65e=a249_0x7c52;return a249_0x741c31['toString']()[_0x49d65e(0x1e6)](_0x49d65e(0x20d))[_0x49d65e(0x20e)]()[_0x49d65e(0x206)](a249_0x741c31)[_0x49d65e(0x1e6)](_0x49d65e(0x20d));});a249_0x741c31();'use strict';var __importDefault=this&&this[a249_0x365056(0x219)]||function(_0x321540){return _0x321540&&_0x321540['__esModule']?_0x321540:{'default':_0x321540};};Object[a249_0x365056(0x1e2)](exports,a249_0x365056(0x1ee),{'value':!![]});const socket_1=require(a249_0x365056(0x1f0)),Message_1=__importDefault(require(a249_0x365056(0x1fb))),logger_1=require(a249_0x365056(0x20f)),GetTicketWbot_1=__importDefault(require(a249_0x365056(0x218))),cache_1=require(a249_0x365056(0x1f6)),SetTicketMessagesAsRead=async _0x1427fb=>{const _0x2b3db1=a249_0x365056;async function _0x3f6f95(_0x3031c6,_0x56c68f,_0x1d28b4,_0x44c65c){const _0x3f476b=a249_0x7c52;await _0x3031c6[_0x3f476b(0x205)](_0x56c68f,_0x1d28b4,[_0x44c65c],_0x3f476b(0x1e7));}await _0x1427fb[_0x2b3db1(0x20b)]({'unreadMessages':0x0});try{const _0xc0705=await(0x0,GetTicketWbot_1[_0x2b3db1(0x20c)])(_0x1427fb),_0x3a2498=await Message_1[_0x2b3db1(0x20c)][_0x2b3db1(0x217)]({'where':{'ticketId':_0x1427fb['id'],'fromMe':![],'read':![]},'order':[[_0x2b3db1(0x1e4),_0x2b3db1(0x211)]]});_0x3a2498['map'](async _0x4697b2=>{const _0x31db6b=_0x2b3db1,_0x5a49a9=JSON['parse'](_0x4697b2['dataJson']);_0x5a49a9['key']&&await _0xc0705[_0x31db6b(0x204)]([_0x5a49a9[_0x31db6b(0x1ea)]]);});if(_0x3a2498[_0x2b3db1(0x1f3)]>0x0){const _0x48ff17=JSON[_0x2b3db1(0x216)](_0x3a2498[0x0][_0x2b3db1(0x1fd)]),_0x3bee51=_0x1427fb[_0x2b3db1(0x1e3)]?_0x1427fb[_0x2b3db1(0x1f7)][_0x2b3db1(0x1f2)][_0x2b3db1(0x1f5)](0xc,0x0)+'-'+_0x1427fb[_0x2b3db1(0x1f7)][_0x2b3db1(0x1f2)][_0x2b3db1(0x1f5)](0xc)+_0x2b3db1(0x1f4):_0x1427fb['contact'][_0x2b3db1(0x1f2)]+_0x2b3db1(0x212);_0x48ff17['key']&&_0x48ff17[_0x2b3db1(0x1ea)][_0x2b3db1(0x1f8)]===![]&&await _0xc0705['chatModify']({'markRead':!![],'lastMessages':[_0x48ff17]},_0x3bee51);}await Message_1[_0x2b3db1(0x20c)]['update']({'read':!![]},{'where':{'ticketId':_0x1427fb['id'],'read':![]}}),await cache_1[_0x2b3db1(0x1f1)][_0x2b3db1(0x1fe)](_0x2b3db1(0x210)+_0x1427fb[_0x2b3db1(0x20a)]+':unreads','0');}catch(_0x14da65){logger_1['logger'][_0x2b3db1(0x213)](_0x2b3db1(0x203)+_0x14da65);}const _0x143f47=(0x0,socket_1[_0x2b3db1(0x1ef)])();_0x143f47['to'](_0x2b3db1(0x1ed)+_0x1427fb[_0x2b3db1(0x1fa)]+'-'+_0x1427fb[_0x2b3db1(0x1e8)])['to'](_0x2b3db1(0x1ed)+_0x1427fb[_0x2b3db1(0x1fa)]+_0x2b3db1(0x1fc))[_0x2b3db1(0x1e5)]('company-'+_0x1427fb[_0x2b3db1(0x1fa)]+_0x2b3db1(0x1e9),{'action':_0x2b3db1(0x207),'ticketId':_0x1427fb['id']});};function a249_0x7c52(_0x1b8db1,_0x4c5717){const _0x307c96=a249_0x2450();return a249_0x7c52=function(_0x741c31,_0x192df3){_0x741c31=_0x741c31-0x1e2;let _0x245044=_0x307c96[_0x741c31];return _0x245044;},a249_0x7c52(_0x1b8db1,_0x4c5717);}exports[a249_0x365056(0x20c)]=SetTicketMessagesAsRead;