const a29_0x3027bf=a29_0x3179;(function(_0x55958e,_0x5ae946){const _0x21033f=a29_0x3179,_0x16e68f=_0x55958e();while(!![]){try{const _0x3fdf38=-parseInt(_0x21033f(0x1da))/0x1+parseInt(_0x21033f(0x1d5))/0x2*(parseInt(_0x21033f(0x1c7))/0x3)+parseInt(_0x21033f(0x1d2))/0x4*(parseInt(_0x21033f(0x1d6))/0x5)+parseInt(_0x21033f(0x1d7))/0x6+-parseInt(_0x21033f(0x1ac))/0x7+parseInt(_0x21033f(0x1c2))/0x8*(parseInt(_0x21033f(0x1b9))/0x9)+-parseInt(_0x21033f(0x1cf))/0xa;if(_0x3fdf38===_0x5ae946)break;else _0x16e68f['push'](_0x16e68f['shift']());}catch(_0x538e9b){_0x16e68f['push'](_0x16e68f['shift']());}}}(a29_0x3238,0xed7a7));const a29_0x2116a1=(function(){let _0x43d75e=!![];return function(_0x4c9b83,_0x157e86){const _0x55ea2b=_0x43d75e?function(){const _0x5b5d4f=a29_0x3179;if(_0x157e86){const _0x5113b2=_0x157e86[_0x5b5d4f(0x1dc)](_0x4c9b83,arguments);return _0x157e86=null,_0x5113b2;}}:function(){};return _0x43d75e=![],_0x55ea2b;};}()),a29_0x45fe12=a29_0x2116a1(this,function(){const _0x7eea15=a29_0x3179;return a29_0x45fe12['toString']()[_0x7eea15(0x1e2)](_0x7eea15(0x1ad))['toString']()[_0x7eea15(0x1b3)](a29_0x45fe12)[_0x7eea15(0x1e2)]('(((.+)+)+)+$');});a29_0x45fe12();function a29_0x3179(_0x598726,_0x5ea5c9){const _0x321240=a29_0x3238();return a29_0x3179=function(_0x45fe12,_0x2116a1){_0x45fe12=_0x45fe12-0x1ab;let _0x32385d=_0x321240[_0x45fe12];return _0x32385d;},a29_0x3179(_0x598726,_0x5ea5c9);}'use strict';var __importDefault=this&&this[a29_0x3027bf(0x1ae)]||function(_0x4c56f2){const _0x50af16=a29_0x3027bf;return _0x4c56f2&&_0x4c56f2[_0x50af16(0x1be)]?_0x4c56f2:{'default':_0x4c56f2};};Object['defineProperty'](exports,a29_0x3027bf(0x1be),{'value':!![]}),exports['deleteMedia']=exports[a29_0x3027bf(0x1c3)]=exports['remove']=exports['update']=exports['show']=exports[a29_0x3027bf(0x1ab)]=exports[a29_0x3027bf(0x1e3)]=void 0x0;const socket_1=require('../libs/socket'),CreateQueueService_1=__importDefault(require(a29_0x3027bf(0x1bb))),DeleteQueueService_1=__importDefault(require(a29_0x3027bf(0x1b8))),ListQueuesService_1=__importDefault(require(a29_0x3027bf(0x1c6))),ShowQueueService_1=__importDefault(require(a29_0x3027bf(0x1bd))),UpdateQueueService_1=__importDefault(require('../services/QueueService/UpdateQueueService')),lodash_1=require(a29_0x3027bf(0x1d8)),Queue_1=__importDefault(require(a29_0x3027bf(0x1c1))),lodash_2=require(a29_0x3027bf(0x1d8)),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a29_0x3027bf(0x1d3))),AppError_1=__importDefault(require(a29_0x3027bf(0x1cc))),index=async(_0x1efa64,_0x318046)=>{const _0x1331d8=a29_0x3027bf,{companyId:_0x8ec704}=_0x1efa64[_0x1331d8(0x1b6)],{companyId:_0x4833b0}=_0x1efa64[_0x1331d8(0x1ca)];let _0x4484e1=_0x8ec704;!(0x0,lodash_1[_0x1331d8(0x1e1)])(_0x4833b0)&&(_0x4484e1=+_0x4833b0);const _0x183ffa=await(0x0,ListQueuesService_1[_0x1331d8(0x1e5)])({'companyId':_0x4484e1});return _0x318046[_0x1331d8(0x1d9)](0xc8)['json'](_0x183ffa);};exports[a29_0x3027bf(0x1e3)]=index;const store=async(_0x12d906,_0x2a1108)=>{const _0x153607=a29_0x3027bf,{name:_0x2b261b,color:_0x36421a,greetingMessage:_0x2729f6,outOfHoursMessage:_0x2597c2,keywords:_0x5bc6fa,schedules:_0x155d28,orderQueue:_0x379b45,integrationId:_0x5b205d,promptId:_0x20aad3}=_0x12d906[_0x153607(0x1df)],{companyId:_0x587b0c}=_0x12d906[_0x153607(0x1b6)],_0xd75b33=await(0x0,CreateQueueService_1['default'])({'name':_0x2b261b,'color':_0x36421a,'greetingMessage':_0x2729f6,'companyId':_0x587b0c,'outOfHoursMessage':_0x2597c2,'keywords':_0x5bc6fa,'schedules':_0x155d28,'orderQueue':_0x379b45===''?null:_0x379b45,'integrationId':_0x5b205d===''?null:_0x5b205d,'promptId':_0x20aad3===''?null:_0x20aad3}),_0x5799b3=(0x0,socket_1[_0x153607(0x1b7)])();return _0x5799b3['to']('company-'+_0x587b0c+'-mainchannel')[_0x153607(0x1cd)]('company-'+_0x587b0c+_0x153607(0x1bc),{'action':_0x153607(0x1c5),'queue':_0xd75b33}),_0x2a1108[_0x153607(0x1d9)](0xc8)['json'](_0xd75b33);};exports['store']=store;const show=async(_0x13d71f,_0x1d76cd)=>{const _0x3f4052=a29_0x3027bf,{queueId:_0xedf676}=_0x13d71f[_0x3f4052(0x1d0)],{companyId:_0x24cde1}=_0x13d71f[_0x3f4052(0x1b6)],_0x550ec6=await(0x0,ShowQueueService_1[_0x3f4052(0x1e5)])(_0xedf676,_0x24cde1);return _0x1d76cd[_0x3f4052(0x1d9)](0xc8)['json'](_0x550ec6);};exports[a29_0x3027bf(0x1c0)]=show;const update=async(_0x5c345a,_0x4d49bb)=>{const _0x33be57=a29_0x3027bf,{queueId:_0x5f47c0}=_0x5c345a[_0x33be57(0x1d0)],{companyId:_0x15c76b}=_0x5c345a[_0x33be57(0x1b6)],{name:_0xc93b6a,color:_0x31f5ab,greetingMessage:_0x58a663,outOfHoursMessage:_0x38108e,keywords:_0x4805a7,newTicketOnTransfer:_0x1c433c,schedules:_0x1e17a3,orderQueue:_0x43d5fe,integrationId:_0x3438c4,promptId:_0x466f66}=_0x5c345a[_0x33be57(0x1df)],_0x596756=await(0x0,UpdateQueueService_1['default'])(_0x5f47c0,{'name':_0xc93b6a,'color':_0x31f5ab,'greetingMessage':_0x58a663,'outOfHoursMessage':_0x38108e,'keywords':_0x4805a7,'newTicketOnTransfer':_0x1c433c,'schedules':_0x1e17a3,'orderQueue':_0x43d5fe===''?null:_0x43d5fe,'integrationId':_0x3438c4===''?null:_0x3438c4,'promptId':_0x466f66===''?null:_0x466f66},_0x15c76b),_0x5d7ed6=(0x0,socket_1['getIO'])();return _0x5d7ed6['to'](_0x33be57(0x1d1)+_0x15c76b+_0x33be57(0x1de))[_0x33be57(0x1cd)](_0x33be57(0x1d1)+_0x15c76b+_0x33be57(0x1bc),{'action':'update','queue':_0x596756}),_0x4d49bb[_0x33be57(0x1d9)](0xc9)[_0x33be57(0x1cb)](_0x596756);};exports[a29_0x3027bf(0x1c5)]=update;const remove=async(_0x21840b,_0x30f977)=>{const _0x26abc9=a29_0x3027bf,{queueId:_0x32f2ab}=_0x21840b[_0x26abc9(0x1d0)],{companyId:_0x208b40}=_0x21840b[_0x26abc9(0x1b6)];await(0x0,DeleteQueueService_1[_0x26abc9(0x1e5)])(_0x32f2ab,_0x208b40);const _0x4ce889=(0x0,socket_1[_0x26abc9(0x1b7)])();return _0x4ce889['to']('company-'+_0x208b40+_0x26abc9(0x1de))[_0x26abc9(0x1cd)](_0x26abc9(0x1d1)+_0x208b40+'-queue',{'action':'delete','queueId':+_0x32f2ab}),_0x30f977[_0x26abc9(0x1d9)](0xc8)[_0x26abc9(0x1ba)]();};exports[a29_0x3027bf(0x1e0)]=remove;const mediaUpload=async(_0x2f9a1a,_0x5d6e9c)=>{const _0x223630=a29_0x3027bf,{queueId:_0x385584}=_0x2f9a1a[_0x223630(0x1d0)],_0x239f69=_0x2f9a1a[_0x223630(0x1dd)],_0x312b1b=(0x0,lodash_2[_0x223630(0x1b2)])(_0x239f69);try{const _0x3f41c4=await Queue_1[_0x223630(0x1e5)][_0x223630(0x1b5)](_0x385584);return _0x3f41c4['update']({'mediaPath':_0x312b1b[_0x223630(0x1c8)],'mediaName':_0x312b1b[_0x223630(0x1bf)]}),_0x5d6e9c[_0x223630(0x1ba)]({'mensagem':_0x223630(0x1d4)});}catch(_0x231c38){throw new AppError_1[(_0x223630(0x1e5))](_0x231c38[_0x223630(0x1e4)]);}};function a29_0x3238(){const _0x3bf398=['../services/QueueService/ShowQueueService','__esModule','originalname','show','../models/Queue','40ytWSCG','mediaUpload','unlinkSync','update','../services/QueueService/ListQueuesService','203619MXKKtz','filename','public','query','json','../errors/AppError','emit','mediaName','8241930TMWEmP','params','company-','676OZkcZl','path','Arquivo\x20Salvo','18VUZnWm','45455cyFoqT','2453952hkrfLw','lodash','status','261986xhsaoO','Arquivo\x20excluÃ­do','apply','files','-mainchannel','body','remove','isNil','search','index','message','default','deleteMedia','store','7698971maKAia','(((.+)+)+)+$','__importDefault','mediaPath','save','company','head','constructor','existsSync','findByPk','user','getIO','../services/QueueService/DeleteQueueService','1084527zHjxEe','send','../services/QueueService/CreateQueueService','-queue'];a29_0x3238=function(){return _0x3bf398;};return a29_0x3238();}exports[a29_0x3027bf(0x1c3)]=mediaUpload;const deleteMedia=async(_0x523a79,_0x74861e)=>{const _0x3e2dd2=a29_0x3027bf,{queueId:_0x3816ae}=_0x523a79[_0x3e2dd2(0x1d0)];try{const _0x4126c7=await Queue_1['default'][_0x3e2dd2(0x1b5)](_0x3816ae),_0x2cae2a=path_1[_0x3e2dd2(0x1e5)]['resolve'](_0x3e2dd2(0x1c9),_0x3e2dd2(0x1b1)+_0x4126c7['companyId'],_0x4126c7[_0x3e2dd2(0x1af)]),_0x804238=fs_1[_0x3e2dd2(0x1e5)][_0x3e2dd2(0x1b4)](_0x2cae2a);return _0x804238&&fs_1[_0x3e2dd2(0x1e5)][_0x3e2dd2(0x1c4)](_0x2cae2a),_0x4126c7['mediaPath']=null,_0x4126c7[_0x3e2dd2(0x1ce)]=null,await _0x4126c7[_0x3e2dd2(0x1b0)](),_0x74861e[_0x3e2dd2(0x1ba)]({'mensagem':_0x3e2dd2(0x1db)});}catch(_0x17a5b6){throw new AppError_1[(_0x3e2dd2(0x1e5))](_0x17a5b6[_0x3e2dd2(0x1e4)]);}};exports[a29_0x3027bf(0x1e6)]=deleteMedia;