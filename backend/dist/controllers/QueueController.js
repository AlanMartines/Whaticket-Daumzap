const a29_0x16e2c8=a29_0x3003;(function(_0x50b8c7,_0x2814e7){const _0x4926e4=a29_0x3003,_0x1ff3d1=_0x50b8c7();while(!![]){try{const _0x5e0018=parseInt(_0x4926e4(0x84))/0x1+-parseInt(_0x4926e4(0x9d))/0x2*(parseInt(_0x4926e4(0x93))/0x3)+-parseInt(_0x4926e4(0xab))/0x4*(-parseInt(_0x4926e4(0x8f))/0x5)+-parseInt(_0x4926e4(0xb3))/0x6+-parseInt(_0x4926e4(0xa3))/0x7*(-parseInt(_0x4926e4(0xac))/0x8)+parseInt(_0x4926e4(0x9a))/0x9*(-parseInt(_0x4926e4(0xa2))/0xa)+-parseInt(_0x4926e4(0x8a))/0xb;if(_0x5e0018===_0x2814e7)break;else _0x1ff3d1['push'](_0x1ff3d1['shift']());}catch(_0x413775){_0x1ff3d1['push'](_0x1ff3d1['shift']());}}}(a29_0x410f,0x8c778));const a29_0x2a92b4=(function(){let _0x54e6d0=!![];return function(_0x4ae2e9,_0xff1923){const _0x58fb2f=_0x54e6d0?function(){const _0x479c3e=a29_0x3003;if(_0xff1923){const _0x1222bc=_0xff1923[_0x479c3e(0xae)](_0x4ae2e9,arguments);return _0xff1923=null,_0x1222bc;}}:function(){};return _0x54e6d0=![],_0x58fb2f;};}()),a29_0x35e22f=a29_0x2a92b4(this,function(){const _0x47510c=a29_0x3003;return a29_0x35e22f[_0x47510c(0xbc)]()[_0x47510c(0xa6)](_0x47510c(0x87))[_0x47510c(0xbc)]()['constructor'](a29_0x35e22f)[_0x47510c(0xa6)]('(((.+)+)+)+$');});function a29_0x3003(_0x51f9cd,_0x369388){const _0x1ed0f4=a29_0x410f();return a29_0x3003=function(_0x35e22f,_0x2a92b4){_0x35e22f=_0x35e22f-0x7f;let _0x410fd3=_0x1ed0f4[_0x35e22f];return _0x410fd3;},a29_0x3003(_0x51f9cd,_0x369388);}a29_0x35e22f();'use strict';var __importDefault=this&&this[a29_0x16e2c8(0x8d)]||function(_0x2f8eec){const _0x9c63b0=a29_0x16e2c8;return _0x2f8eec&&_0x2f8eec[_0x9c63b0(0xb0)]?_0x2f8eec:{'default':_0x2f8eec};};Object[a29_0x16e2c8(0xb5)](exports,a29_0x16e2c8(0xb0),{'value':!![]}),exports['deleteMedia']=exports[a29_0x16e2c8(0x98)]=exports['remove']=exports[a29_0x16e2c8(0x90)]=exports[a29_0x16e2c8(0xbb)]=exports['store']=exports['index']=void 0x0;const socket_1=require(a29_0x16e2c8(0x9e)),CreateQueueService_1=__importDefault(require(a29_0x16e2c8(0x91))),DeleteQueueService_1=__importDefault(require(a29_0x16e2c8(0xa4))),ListQueuesService_1=__importDefault(require(a29_0x16e2c8(0xa0))),ShowQueueService_1=__importDefault(require(a29_0x16e2c8(0x8b))),UpdateQueueService_1=__importDefault(require(a29_0x16e2c8(0x9b))),lodash_1=require(a29_0x16e2c8(0x89)),Queue_1=__importDefault(require(a29_0x16e2c8(0xa5))),lodash_2=require(a29_0x16e2c8(0x89)),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a29_0x16e2c8(0x99))),AppError_1=__importDefault(require(a29_0x16e2c8(0x9c))),index=async(_0x28a546,_0x420a5f)=>{const _0x4992c0=a29_0x16e2c8,{companyId:_0x125f5d}=_0x28a546['user'],{companyId:_0x50fa0b}=_0x28a546[_0x4992c0(0xb7)];let _0x25fa80=_0x125f5d;!(0x0,lodash_1[_0x4992c0(0x82)])(_0x50fa0b)&&(_0x25fa80=+_0x50fa0b);const _0x80a7c0=await(0x0,ListQueuesService_1[_0x4992c0(0x8e)])({'companyId':_0x25fa80});return _0x420a5f[_0x4992c0(0x95)](0xc8)[_0x4992c0(0xb1)](_0x80a7c0);};exports[a29_0x16e2c8(0xb8)]=index;const store=async(_0x16cd28,_0x12f79c)=>{const _0x273e30=a29_0x16e2c8,{name:_0x4159a6,color:_0x47992e,greetingMessage:_0x3fd8c9,outOfHoursMessage:_0x2337ca,keywords:_0x6e06f3,schedules:_0xc67b56,orderQueue:_0x39b35b,integrationId:_0x2cfaaa,promptId:_0x13c3b8}=_0x16cd28[_0x273e30(0xa7)],{companyId:_0x283dcc}=_0x16cd28[_0x273e30(0x97)],_0xac1f17=await(0x0,CreateQueueService_1['default'])({'name':_0x4159a6,'color':_0x47992e,'greetingMessage':_0x3fd8c9,'companyId':_0x283dcc,'outOfHoursMessage':_0x2337ca,'keywords':_0x6e06f3,'schedules':_0xc67b56,'orderQueue':_0x39b35b===''?null:_0x39b35b,'integrationId':_0x2cfaaa===''?null:_0x2cfaaa,'promptId':_0x13c3b8===''?null:_0x13c3b8}),_0x4a2dae=(0x0,socket_1[_0x273e30(0x86)])();return _0x4a2dae['to'](_0x273e30(0xba)+_0x283dcc+_0x273e30(0xa8))[_0x273e30(0x7f)]('company-'+_0x283dcc+_0x273e30(0xbd),{'action':_0x273e30(0x90),'queue':_0xac1f17}),_0x12f79c['status'](0xc8)[_0x273e30(0xb1)](_0xac1f17);};exports[a29_0x16e2c8(0xaf)]=store;const show=async(_0x1494a1,_0x37ae72)=>{const _0x2414a0=a29_0x16e2c8,{queueId:_0x32ad3f}=_0x1494a1['params'],{companyId:_0x2a9b29}=_0x1494a1[_0x2414a0(0x97)],_0x4843d4=await(0x0,ShowQueueService_1[_0x2414a0(0x8e)])(_0x32ad3f,_0x2a9b29);return _0x37ae72[_0x2414a0(0x95)](0xc8)['json'](_0x4843d4);};exports[a29_0x16e2c8(0xbb)]=show;const update=async(_0x1bb9c7,_0x3d226e)=>{const _0x480fd1=a29_0x16e2c8,{queueId:_0x510804}=_0x1bb9c7[_0x480fd1(0xb4)],{companyId:_0x1bbafb}=_0x1bb9c7[_0x480fd1(0x97)],{name:_0x5f1311,color:_0x21ff86,greetingMessage:_0x2f8277,outOfHoursMessage:_0x51e64a,keywords:_0x3c2b64,newTicketOnTransfer:_0x1e27d4,schedules:_0x135436,orderQueue:_0x4a9b1b,integrationId:_0x95f98f,promptId:_0x58da72}=_0x1bb9c7['body'],_0x418cac=await(0x0,UpdateQueueService_1[_0x480fd1(0x8e)])(_0x510804,{'name':_0x5f1311,'color':_0x21ff86,'greetingMessage':_0x2f8277,'outOfHoursMessage':_0x51e64a,'keywords':_0x3c2b64,'newTicketOnTransfer':_0x1e27d4,'schedules':_0x135436,'orderQueue':_0x4a9b1b===''?null:_0x4a9b1b,'integrationId':_0x95f98f===''?null:_0x95f98f,'promptId':_0x58da72===''?null:_0x58da72},_0x1bbafb),_0x450046=(0x0,socket_1[_0x480fd1(0x86)])();return _0x450046['to'](_0x480fd1(0xba)+_0x1bbafb+'-mainchannel')['emit'](_0x480fd1(0xba)+_0x1bbafb+_0x480fd1(0xbd),{'action':_0x480fd1(0x90),'queue':_0x418cac}),_0x3d226e[_0x480fd1(0x95)](0xc9)[_0x480fd1(0xb1)](_0x418cac);};exports[a29_0x16e2c8(0x90)]=update;const remove=async(_0x58bb26,_0x124800)=>{const _0x5824f4=a29_0x16e2c8,{queueId:_0x298922}=_0x58bb26[_0x5824f4(0xb4)],{companyId:_0x15da1e}=_0x58bb26['user'];await(0x0,DeleteQueueService_1[_0x5824f4(0x8e)])(_0x298922,_0x15da1e);const _0x29ec68=(0x0,socket_1[_0x5824f4(0x86)])();return _0x29ec68['to'](_0x5824f4(0xba)+_0x15da1e+'-mainchannel')[_0x5824f4(0x7f)]('company-'+_0x15da1e+'-queue',{'action':_0x5824f4(0x8c),'queueId':+_0x298922}),_0x124800[_0x5824f4(0x95)](0xc8)[_0x5824f4(0x80)]();};exports[a29_0x16e2c8(0xad)]=remove;const mediaUpload=async(_0x3a94a6,_0x10d9ef)=>{const _0x1502d0=a29_0x16e2c8,{queueId:_0x24d491}=_0x3a94a6['params'],_0x14d5dd=_0x3a94a6[_0x1502d0(0x9f)],_0x27c91d=(0x0,lodash_2[_0x1502d0(0x81)])(_0x14d5dd);try{const _0xc1cb70=await Queue_1[_0x1502d0(0x8e)][_0x1502d0(0xb9)](_0x24d491);return _0xc1cb70[_0x1502d0(0x90)]({'mediaPath':_0x27c91d[_0x1502d0(0x83)],'mediaName':_0x27c91d['originalname']}),_0x10d9ef[_0x1502d0(0x80)]({'mensagem':_0x1502d0(0x92)});}catch(_0x37fc77){throw new AppError_1[(_0x1502d0(0x8e))](_0x37fc77[_0x1502d0(0x88)]);}};function a29_0x410f(){const _0xac1633=['update','../services/QueueService/CreateQueueService','Arquivo\x20Salvo','3kJrgDJ','company','status','existsSync','user','mediaUpload','path','9uJnUPn','../services/QueueService/UpdateQueueService','../errors/AppError','1692604ugFoAW','../libs/socket','files','../services/QueueService/ListQueuesService','mediaName','1873250sCVSgq','56119UUroDj','../services/QueueService/DeleteQueueService','../models/Queue','search','body','-mainchannel','save','deleteMedia','20LmnrlH','944DBPNpj','remove','apply','store','__esModule','json','Arquivo\x20excluÃ­do','2093208zrATBH','params','defineProperty','resolve','query','index','findByPk','company-','show','toString','-queue','emit','send','head','isNil','filename','1032153YAESic','mediaPath','getIO','(((.+)+)+)+$','message','lodash','592922sBZEud','../services/QueueService/ShowQueueService','delete','__importDefault','default','33590WjwxWc'];a29_0x410f=function(){return _0xac1633;};return a29_0x410f();}exports[a29_0x16e2c8(0x98)]=mediaUpload;const deleteMedia=async(_0x21aecd,_0x54692a)=>{const _0x4a0805=a29_0x16e2c8,{queueId:_0x2828ec}=_0x21aecd['params'];try{const _0xb23724=await Queue_1[_0x4a0805(0x8e)][_0x4a0805(0xb9)](_0x2828ec),_0x230ecc=path_1['default'][_0x4a0805(0xb6)]('public',_0x4a0805(0x94)+_0xb23724['companyId'],_0xb23724['mediaPath']),_0x4d3e55=fs_1[_0x4a0805(0x8e)][_0x4a0805(0x96)](_0x230ecc);return _0x4d3e55&&fs_1['default']['unlinkSync'](_0x230ecc),_0xb23724[_0x4a0805(0x85)]=null,_0xb23724[_0x4a0805(0xa1)]=null,await _0xb23724[_0x4a0805(0xa9)](),_0x54692a[_0x4a0805(0x80)]({'mensagem':_0x4a0805(0xb2)});}catch(_0x191d7e){throw new AppError_1[(_0x4a0805(0x8e))](_0x191d7e[_0x4a0805(0x88)]);}};exports[a29_0x16e2c8(0xaa)]=deleteMedia;