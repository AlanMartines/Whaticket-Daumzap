function a12_0x5b67(_0x3dd6dd,_0x20d952){const _0xd668c1=a12_0x4077();return a12_0x5b67=function(_0x56ed99,_0x36692c){_0x56ed99=_0x56ed99-0xda;let _0x40776c=_0xd668c1[_0x56ed99];return _0x40776c;},a12_0x5b67(_0x3dd6dd,_0x20d952);}const a12_0x152b56=a12_0x5b67;(function(_0x5009de,_0x42a04a){const _0x5d5a1f=a12_0x5b67,_0x2bdc16=_0x5009de();while(!![]){try{const _0x5d788c=parseInt(_0x5d5a1f(0xe5))/0x1*(-parseInt(_0x5d5a1f(0x107))/0x2)+-parseInt(_0x5d5a1f(0x103))/0x3+parseInt(_0x5d5a1f(0xef))/0x4*(-parseInt(_0x5d5a1f(0xe1))/0x5)+-parseInt(_0x5d5a1f(0xf4))/0x6+parseInt(_0x5d5a1f(0xdb))/0x7+-parseInt(_0x5d5a1f(0xfe))/0x8*(-parseInt(_0x5d5a1f(0xe2))/0x9)+-parseInt(_0x5d5a1f(0xea))/0xa*(-parseInt(_0x5d5a1f(0xfa))/0xb);if(_0x5d788c===_0x42a04a)break;else _0x2bdc16['push'](_0x2bdc16['shift']());}catch(_0x8c8d1a){_0x2bdc16['push'](_0x2bdc16['shift']());}}}(a12_0x4077,0x8840b));const a12_0x36692c=(function(){let _0x5271e5=!![];return function(_0x321f8a,_0x5c3a64){const _0x5ae43e=_0x5271e5?function(){if(_0x5c3a64){const _0x283ae2=_0x5c3a64['apply'](_0x321f8a,arguments);return _0x5c3a64=null,_0x283ae2;}}:function(){};return _0x5271e5=![],_0x5ae43e;};}()),a12_0x56ed99=a12_0x36692c(this,function(){const _0x336dc0=a12_0x5b67;return a12_0x56ed99[_0x336dc0(0xe8)]()[_0x336dc0(0x100)](_0x336dc0(0xdd))['toString']()[_0x336dc0(0xfb)](a12_0x56ed99)[_0x336dc0(0x100)](_0x336dc0(0xdd));});a12_0x56ed99();'use strict';var __importDefault=this&&this['__importDefault']||function(_0xc38a09){const _0x16e91e=a12_0x5b67;return _0xc38a09&&_0xc38a09[_0x16e91e(0xf2)]?_0xc38a09:{'default':_0xc38a09};};function a12_0x4077(){const _0x1c54cf=['-mainchannel','findOne','__esModule','params','3775248NuiwvP','update','default','../services/ChatService/CreateMessageService','query','saveMessage','603647nvxGkx','constructor','../services/ChatService/DeleteService','../services/ChatService/ListService','1035752amUtFv','getIO','search','userId','user','3336384jZHvCL','show','new-message','forEach','14926WgLedG','../models/User','../services/ChatService/FindMessages','findByPk','json','owner','7227766PQtvXD','store','(((.+)+)+)+$','remove','-chat-user-','messages','544865rdycbC','36VoXQGv','body','-chat','3sJDgqY','Chat\x20deleted','status','toString','../services/ChatService/UpdateService','220aMDmdH','users','emit','index','company-','16MTWbHv'];a12_0x4077=function(){return _0x1c54cf;};return a12_0x4077();}Object['defineProperty'](exports,a12_0x152b56(0xf2),{'value':!![]}),exports[a12_0x152b56(0xe0)]=exports['checkAsRead']=exports['saveMessage']=exports[a12_0x152b56(0xde)]=exports[a12_0x152b56(0x104)]=exports['update']=exports['store']=exports[a12_0x152b56(0xed)]=void 0x0;const socket_1=require('../libs/socket'),CreateService_1=__importDefault(require('../services/ChatService/CreateService')),ListService_1=__importDefault(require(a12_0x152b56(0xfd))),ShowFromUuidService_1=__importDefault(require('../services/ChatService/ShowFromUuidService')),DeleteService_1=__importDefault(require(a12_0x152b56(0xfc))),FindMessages_1=__importDefault(require(a12_0x152b56(0x109))),UpdateService_1=__importDefault(require(a12_0x152b56(0xe9))),Chat_1=__importDefault(require('../models/Chat')),CreateMessageService_1=__importDefault(require(a12_0x152b56(0xf7))),User_1=__importDefault(require(a12_0x152b56(0x108))),ChatUser_1=__importDefault(require('../models/ChatUser')),index=async(_0x555a8d,_0x5c4338)=>{const _0x1f2f5c=a12_0x152b56,{pageNumber:_0x6debb3}=_0x555a8d[_0x1f2f5c(0xf8)],_0x6636c7=+_0x555a8d[_0x1f2f5c(0x102)]['id'],{records:_0x579176,count:_0x11a374,hasMore:_0x1732ca}=await(0x0,ListService_1[_0x1f2f5c(0xf6)])({'ownerId':_0x6636c7,'pageNumber':_0x6debb3});return _0x5c4338[_0x1f2f5c(0x10b)]({'records':_0x579176,'count':_0x11a374,'hasMore':_0x1732ca});};exports[a12_0x152b56(0xed)]=index;const store=async(_0x30c985,_0x572162)=>{const _0x2586ea=a12_0x152b56,{companyId:_0x44a412}=_0x30c985['user'],_0x802a4a=+_0x30c985['user']['id'],_0x1df7d5=_0x30c985[_0x2586ea(0xe3)],_0x4e3199=await(0x0,CreateService_1[_0x2586ea(0xf6)])({..._0x1df7d5,'ownerId':_0x802a4a,'companyId':_0x44a412}),_0x325aba=(0x0,socket_1[_0x2586ea(0xff)])();return _0x4e3199[_0x2586ea(0xeb)][_0x2586ea(0x106)](_0x50125d=>{const _0x592ca7=_0x2586ea;_0x325aba['to'](_0x592ca7(0xee)+_0x44a412+'-mainchannel')[_0x592ca7(0xec)](_0x592ca7(0xee)+_0x44a412+_0x592ca7(0xdf)+_0x50125d[_0x592ca7(0x101)],{'action':'create','record':_0x4e3199});}),_0x572162[_0x2586ea(0xe7)](0xc8)['json'](_0x4e3199);};exports[a12_0x152b56(0xdc)]=store;const update=async(_0x290a6f,_0xf039e4)=>{const _0x480372=a12_0x152b56,{companyId:_0xa76722}=_0x290a6f['user'],_0x5f0b64=_0x290a6f[_0x480372(0xe3)],{id:_0x54d87c}=_0x290a6f[_0x480372(0xf3)],_0x25d8ad=await(0x0,UpdateService_1[_0x480372(0xf6)])({..._0x5f0b64,'id':+_0x54d87c}),_0x7bdff3=(0x0,socket_1[_0x480372(0xff)])();return _0x25d8ad[_0x480372(0xeb)][_0x480372(0x106)](_0x5de140=>{const _0x2d34ad=_0x480372;_0x7bdff3['to']('company-'+_0xa76722+_0x2d34ad(0xf0))[_0x2d34ad(0xec)](_0x2d34ad(0xee)+_0xa76722+_0x2d34ad(0xdf)+_0x5de140[_0x2d34ad(0x101)],{'action':_0x2d34ad(0xf5),'record':_0x25d8ad});}),_0xf039e4[_0x480372(0xe7)](0xc8)[_0x480372(0x10b)](_0x25d8ad);};exports['update']=update;const show=async(_0x1c7162,_0x2a30a9)=>{const _0x47528d=a12_0x152b56,{id:_0x2f85f8}=_0x1c7162[_0x47528d(0xf3)],_0x5e1c30=await(0x0,ShowFromUuidService_1[_0x47528d(0xf6)])(_0x2f85f8);return _0x2a30a9[_0x47528d(0xe7)](0xc8)[_0x47528d(0x10b)](_0x5e1c30);};exports[a12_0x152b56(0x104)]=show;const remove=async(_0x31be9e,_0x23121b)=>{const _0x50232e=a12_0x152b56,{id:_0x42b25b}=_0x31be9e[_0x50232e(0xf3)],{companyId:_0x3dd5d1}=_0x31be9e['user'];await(0x0,DeleteService_1[_0x50232e(0xf6)])(_0x42b25b);const _0x24a81d=(0x0,socket_1[_0x50232e(0xff)])();return _0x24a81d['to']('company-'+_0x3dd5d1+_0x50232e(0xf0))['emit'](_0x50232e(0xee)+_0x3dd5d1+_0x50232e(0xe4),{'action':'delete','id':_0x42b25b}),_0x23121b['status'](0xc8)['json']({'message':_0x50232e(0xe6)});};exports[a12_0x152b56(0xde)]=remove;const saveMessage=async(_0x3d51de,_0x345bcd)=>{const _0x1deeb0=a12_0x152b56,{companyId:_0x1f8598}=_0x3d51de[_0x1deeb0(0x102)],{message:_0x3bf65b}=_0x3d51de['body'],{id:_0x60761a}=_0x3d51de[_0x1deeb0(0xf3)],_0x51f6a6=+_0x3d51de[_0x1deeb0(0x102)]['id'],_0x555c0c=+_0x60761a,_0xeefb30=await(0x0,CreateMessageService_1[_0x1deeb0(0xf6)])({'chatId':_0x555c0c,'senderId':_0x51f6a6,'message':_0x3bf65b}),_0x2ec53c=await Chat_1['default'][_0x1deeb0(0x10a)](_0x555c0c,{'include':[{'model':User_1[_0x1deeb0(0xf6)],'as':_0x1deeb0(0xda)},{'model':ChatUser_1[_0x1deeb0(0xf6)],'as':_0x1deeb0(0xeb)}]}),_0x31dd0f=(0x0,socket_1['getIO'])();return _0x31dd0f['to'](_0x1deeb0(0xee)+_0x1f8598+_0x1deeb0(0xf0))[_0x1deeb0(0xec)](_0x1deeb0(0xee)+_0x1f8598+'-chat-'+_0x555c0c,{'action':_0x1deeb0(0x105),'newMessage':_0xeefb30,'chat':_0x2ec53c}),_0x31dd0f['to']('company-'+_0x1f8598+'-mainchannel')[_0x1deeb0(0xec)](_0x1deeb0(0xee)+_0x1f8598+'-chat',{'action':'new-message','newMessage':_0xeefb30,'chat':_0x2ec53c}),_0x345bcd[_0x1deeb0(0x10b)](_0xeefb30);};exports[a12_0x152b56(0xf9)]=saveMessage;const checkAsRead=async(_0x3e4c16,_0x478bac)=>{const _0x20242b=a12_0x152b56,{companyId:_0xec84d3}=_0x3e4c16[_0x20242b(0x102)],{userId:_0x4bb648}=_0x3e4c16[_0x20242b(0xe3)],{id:_0x21cbe1}=_0x3e4c16[_0x20242b(0xf3)],_0x49e21c=await ChatUser_1['default'][_0x20242b(0xf1)]({'where':{'chatId':_0x21cbe1,'userId':_0x4bb648}});await _0x49e21c[_0x20242b(0xf5)]({'unreads':0x0});const _0x2fefaa=await Chat_1[_0x20242b(0xf6)][_0x20242b(0x10a)](_0x21cbe1,{'include':[{'model':User_1[_0x20242b(0xf6)],'as':_0x20242b(0xda)},{'model':ChatUser_1[_0x20242b(0xf6)],'as':_0x20242b(0xeb)}]}),_0x321ad0=(0x0,socket_1[_0x20242b(0xff)])();return _0x321ad0['to'](_0x20242b(0xee)+_0xec84d3+_0x20242b(0xf0))[_0x20242b(0xec)](_0x20242b(0xee)+_0xec84d3+'-chat-'+_0x21cbe1,{'action':'update','chat':_0x2fefaa}),_0x321ad0['to'](_0x20242b(0xee)+_0xec84d3+'-mainchannel')[_0x20242b(0xec)]('company-'+_0xec84d3+_0x20242b(0xe4),{'action':_0x20242b(0xf5),'chat':_0x2fefaa}),_0x478bac[_0x20242b(0x10b)](_0x2fefaa);};exports['checkAsRead']=checkAsRead;const messages=async(_0x59ba91,_0x2b3d32)=>{const _0x245c43=a12_0x152b56,{pageNumber:_0xcc4e8}=_0x59ba91[_0x245c43(0xf8)],{id:_0x596cf6}=_0x59ba91[_0x245c43(0xf3)],_0x3b98de=+_0x59ba91[_0x245c43(0x102)]['id'],{records:_0x427482,count:_0x12504d,hasMore:_0x462473}=await(0x0,FindMessages_1[_0x245c43(0xf6)])({'chatId':_0x596cf6,'ownerId':_0x3b98de,'pageNumber':_0xcc4e8});return _0x2b3d32[_0x245c43(0x10b)]({'records':_0x427482,'count':_0x12504d,'hasMore':_0x462473});};exports[a12_0x152b56(0xe0)]=messages;