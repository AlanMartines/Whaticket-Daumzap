const a26_0x51c5c2=a26_0x47d8;(function(_0x11ff84,_0x4e82bc){const _0x3aee50=a26_0x47d8,_0x292f07=_0x11ff84();while(!![]){try{const _0x54d7f2=parseInt(_0x3aee50(0x1ae))/0x1*(parseInt(_0x3aee50(0x199))/0x2)+parseInt(_0x3aee50(0x1ac))/0x3+parseInt(_0x3aee50(0x205))/0x4*(-parseInt(_0x3aee50(0x1b7))/0x5)+parseInt(_0x3aee50(0x21e))/0x6*(parseInt(_0x3aee50(0x1e0))/0x7)+-parseInt(_0x3aee50(0x1ba))/0x8+parseInt(_0x3aee50(0x19b))/0x9*(-parseInt(_0x3aee50(0x1ee))/0xa)+parseInt(_0x3aee50(0x1e6))/0xb;if(_0x54d7f2===_0x4e82bc)break;else _0x292f07['push'](_0x292f07['shift']());}catch(_0x11ef6d){_0x292f07['push'](_0x292f07['shift']());}}}(a26_0x431b,0xc318d));const a26_0x4c8166=(function(){let _0x588ab7=!![];return function(_0x47f3cd,_0x402867){const _0xa22486=_0x588ab7?function(){const _0x425a5e=a26_0x47d8;if(_0x402867){const _0x576fb1=_0x402867[_0x425a5e(0x1e3)](_0x47f3cd,arguments);return _0x402867=null,_0x576fb1;}}:function(){};return _0x588ab7=![],_0xa22486;};}()),a26_0x548026=a26_0x4c8166(this,function(){const _0x4cabe7=a26_0x47d8;return a26_0x548026[_0x4cabe7(0x1b5)]()['search']('(((.+)+)+)+$')[_0x4cabe7(0x1b5)]()[_0x4cabe7(0x20f)](a26_0x548026)[_0x4cabe7(0x1d2)](_0x4cabe7(0x1c1));});a26_0x548026();'use strict';var __createBinding=this&&this[a26_0x51c5c2(0x1c4)]||(Object[a26_0x51c5c2(0x1cf)]?function(_0x2844f8,_0x53c931,_0x2f76a9,_0x117346){const _0x4afb37=a26_0x51c5c2;if(_0x117346===undefined)_0x117346=_0x2f76a9;var _0x231780=Object[_0x4afb37(0x215)](_0x53c931,_0x2f76a9);(!_0x231780||(_0x4afb37(0x1e4)in _0x231780?!_0x53c931[_0x4afb37(0x192)]:_0x231780[_0x4afb37(0x202)]||_0x231780[_0x4afb37(0x1b8)]))&&(_0x231780={'enumerable':!![],'get':function(){return _0x53c931[_0x2f76a9];}}),Object[_0x4afb37(0x21c)](_0x2844f8,_0x117346,_0x231780);}:function(_0x4d363f,_0x5be1f7,_0x35cada,_0x4d5d83){if(_0x4d5d83===undefined)_0x4d5d83=_0x35cada;_0x4d363f[_0x4d5d83]=_0x5be1f7[_0x35cada];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a26_0x51c5c2(0x1cf)]?function(_0x12bc2a,_0x44e45f){const _0x32b5d1=a26_0x51c5c2;Object[_0x32b5d1(0x21c)](_0x12bc2a,_0x32b5d1(0x1ea),{'enumerable':!![],'value':_0x44e45f});}:function(_0x39a42a,_0x3fce9d){const _0x17fd46=a26_0x51c5c2;_0x39a42a[_0x17fd46(0x1ea)]=_0x3fce9d;}),__importStar=this&&this['__importStar']||function(_0x393279){const _0x5b38ee=a26_0x51c5c2;if(_0x393279&&_0x393279[_0x5b38ee(0x192)])return _0x393279;var _0x27d523={};if(_0x393279!=null){for(var _0x7ee2b8 in _0x393279)if(_0x7ee2b8!==_0x5b38ee(0x1ea)&&Object[_0x5b38ee(0x211)][_0x5b38ee(0x194)][_0x5b38ee(0x1e2)](_0x393279,_0x7ee2b8))__createBinding(_0x27d523,_0x393279,_0x7ee2b8);}return __setModuleDefault(_0x27d523,_0x393279),_0x27d523;},__importDefault=this&&this[a26_0x51c5c2(0x1b4)]||function(_0x5f2cb5){const _0x15dd99=a26_0x51c5c2;return _0x5f2cb5&&_0x5f2cb5[_0x15dd99(0x192)]?_0x5f2cb5:{'default':_0x5f2cb5};};Object[a26_0x51c5c2(0x21c)](exports,a26_0x51c5c2(0x192),{'value':!![]}),exports[a26_0x51c5c2(0x1fb)]=exports[a26_0x51c5c2(0x1f9)]=exports[a26_0x51c5c2(0x1ff)]=exports['send']=exports[a26_0x51c5c2(0x1a0)]=exports['remove']=exports['edit']=exports[a26_0x51c5c2(0x220)]=exports[a26_0x51c5c2(0x213)]=exports[a26_0x51c5c2(0x1bb)]=void 0x0;const AppError_1=__importDefault(require(a26_0x51c5c2(0x1c2))),SetTicketMessagesAsRead_1=__importDefault(require(a26_0x51c5c2(0x1b3))),socket_1=require(a26_0x51c5c2(0x214)),Message_1=__importDefault(require(a26_0x51c5c2(0x1e7))),Ticket_1=__importDefault(require(a26_0x51c5c2(0x19c))),Queue_1=__importDefault(require(a26_0x51c5c2(0x1fd))),User_1=__importDefault(require(a26_0x51c5c2(0x1da))),Whatsapp_1=__importDefault(require('../models/Whatsapp')),Mustache_1=__importDefault(require('../helpers/Mustache')),ListMessagesService_1=__importDefault(require(a26_0x51c5c2(0x1f3))),ShowTicketService_1=__importDefault(require(a26_0x51c5c2(0x1a3))),FindOrCreateTicketService_1=__importDefault(require(a26_0x51c5c2(0x21d))),UpdateTicketService_1=__importDefault(require('../services/TicketServices/UpdateTicketService')),DeleteWhatsAppMessage_1=__importDefault(require('../services/WbotServices/DeleteWhatsAppMessage')),SendWhatsAppMedia_1=__importStar(require(a26_0x51c5c2(0x1ab))),SendWhatsAppMessage_1=__importDefault(require(a26_0x51c5c2(0x1fa))),SendWhatsAppReaction_1=__importDefault(require(a26_0x51c5c2(0x1dd))),CheckNumber_1=__importDefault(require(a26_0x51c5c2(0x1f6))),EditWhatsAppMessage_1=__importDefault(require(a26_0x51c5c2(0x206))),TranslateAudioService_1=__importDefault(require('../services/MessageServices/TranslateAudioService')),CreateOrUpdateContactService_1=__importDefault(require(a26_0x51c5c2(0x1db))),ShowMessageService_1=__importStar(require(a26_0x51c5c2(0x1e9))),ShowContactService_1=require(a26_0x51c5c2(0x1a9)),ShowUserService_1=__importDefault(require('../services/UserServices/ShowUserService')),user_1=require(a26_0x51c5c2(0x19a)),UpdateTicketService_2=require(a26_0x51c5c2(0x1de)),ListAllMessagesService_1=__importDefault(require('../services/MessageServices/ListAllMessagesService')),validator_1=require(a26_0x51c5c2(0x198)),ffmpeg_static_1=__importDefault(require(a26_0x51c5c2(0x1d1))),fluent_ffmpeg_1=__importDefault(require(a26_0x51c5c2(0x219))),crypto_1=__importDefault(require('crypto')),GetWhatsappWbot_1=__importDefault(require(a26_0x51c5c2(0x216))),wbot_1=require(a26_0x51c5c2(0x1cd)),SendPresenceStatus_1=require('../helpers/SendPresenceStatus');fluent_ffmpeg_1[a26_0x51c5c2(0x1ea)][a26_0x51c5c2(0x1bd)](ffmpeg_static_1[a26_0x51c5c2(0x1ea)]);function a26_0x431b(){const _0x4674ab=['../services/WbotServices/SendWhatsAppMedia','884529JuFBti','MessageId\x20or\x20ContactId\x20not\x20found','197rVEaEj','conversation','body','end','SendTypingStatus','../helpers/SetTicketMessagesAsRead','__importDefault','toString','closed','5GEFKqk','configurable','contact','7397040bHVySr','index','length','setFfmpegPath','send','GetWhatsAppFromMessage','map','(((.+)+)+)+$','../errors/AppError','randomBytes','__createBinding','save','Whatsapp\x20from\x20message\x20not\x20found','emit','toBoolean','replace','open','Message\x20not\x20found','userId','../libs/wbot','Reação\x20adicionada\x20com\x20sucesso!','create','Erro\x20ao\x20adicionar\x20reação:','ffmpeg-static','search','user','@s.whatsapp.net','>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<','jid','getWbot','dateStart','log','../models/User','../services/ContactServices/CreateOrUpdateContactService','error','../services/WbotServices/SendWhatsAppReaction','../services/TicketServices/UpdateTicketService','reactions','42hxLMOb','mediaType','call','apply','get','SendWhatsAppMediaFileAddress','35996642DJeSZS','../models/Message','g.us','../services/MessageServices/ShowMessageService','default','isGroup','ticketId','s.whatsapp.net','60chbipA','mediaUrl','files','-appMessage','ShowContactService1','../services/MessageServices/ListMessagesService','update','companyId','../services/WbotServices/CheckNumber','Transcrição\x20não\x20disponível','\x20enviado\x20com\x20sucesso','storeAudio','../services/WbotServices/SendWhatsAppMessage','forwardMessage','getIO','../models/Queue','forEach','addReaction','admin','Contact\x20not\x20found','writable','TicketId\x20is\x20required','all','5224488xGblwo','../services/WbotServices/EditWhatsAppMessage','toFormat','extendedTextMessage','status','.mp3','findByPk','dateEnd','true','Não\x20foi\x20possível\x20realizar\x20a\x20operação','constructor','whatsappId','prototype','Ticket\x20not\x20found','store','../libs/socket','getOwnPropertyDescriptor','../helpers/GetWhatsappWbot','push','filename','fluent-ffmpeg','query','Status\x20','defineProperty','../services/TicketServices/FindOrCreateTicketService','348444MSHGWB','SendPausedStatus','getAll','path','./public/company','isArray','hex','mp3','app','__esModule','SendMessage','hasOwnProperty','message','@g.us','queues','validator','4452avhXzn','../utils/user','1986543JkwPSu','../models/Ticket','params','messageId','saveToFile','typing','company-','Mensagem\x20não\x20encontrada','../services/TicketServices/ShowTicketService','Mensagem\x20enviada','Erro\x20ao\x20adicionar\x20reação','number','keys','originalname','../services/ContactServices/ShowContactService','edit'];a26_0x431b=function(){return _0x4674ab;};return a26_0x431b();}const index=async(_0x534344,_0x9bdfa6)=>{const _0xe5b512=a26_0x51c5c2,{ticketId:_0x593310}=_0x534344[_0xe5b512(0x19d)],{pageNumber:_0x904001}=_0x534344[_0xe5b512(0x21a)],{companyId:_0x4c9e2d,profile:_0x54c1fd}=_0x534344[_0xe5b512(0x1d3)],_0x461184=[];if(_0x54c1fd!==_0xe5b512(0x200)){const _0x4cf94a=await User_1['default'][_0xe5b512(0x20b)](_0x534344[_0xe5b512(0x1d3)]['id'],{'include':[{'model':Queue_1[_0xe5b512(0x1ea)],'as':'queues'}]});_0x4cf94a[_0xe5b512(0x197)][_0xe5b512(0x1fe)](_0x3d21d4=>{const _0x34f1bb=_0xe5b512;_0x461184[_0x34f1bb(0x217)](_0x3d21d4['id']);});}const {count:_0x10bfc3,messages:_0x13c012,ticket:_0x1966fa,hasMore:_0x25f530}=await(0x0,ListMessagesService_1['default'])({'pageNumber':_0x904001,'ticketId':_0x593310,'companyId':_0x4c9e2d,'queues':_0x461184});return(0x0,SetTicketMessagesAsRead_1['default'])(_0x1966fa),_0x9bdfa6['json']({'count':_0x10bfc3,'messages':_0x13c012,'ticket':_0x1966fa,'hasMore':_0x25f530});};exports[a26_0x51c5c2(0x1bb)]=index;const store=async(_0x47053e,_0x5dd4bb)=>{const _0x97e76=a26_0x51c5c2,{ticketId:_0x4ab333}=_0x47053e[_0x97e76(0x19d)],{body:_0x3ec202,quotedMsg:_0x55b25f,vCard:_0x3f497e}=_0x47053e[_0x97e76(0x1b0)],_0x2a72d6=_0x47053e[_0x97e76(0x1f0)],{companyId:_0x317bb3,id:_0x88dd9e}=_0x47053e[_0x97e76(0x1d3)],_0xa570b2=await(0x0,ShowTicketService_1[_0x97e76(0x1ea)])(_0x4ab333,_0x317bb3);_0xa570b2['status']!==_0x97e76(0x1ca)&&await(0x0,UpdateTicketService_1[_0x97e76(0x1ea)])({'ticketId':_0xa570b2['id'],'ticketData':{'status':_0x97e76(0x1ca),'userId':parseInt(_0x88dd9e)},'companyId':_0x317bb3});if(_0xa570b2['unreadMessages']>0x0)(0x0,SetTicketMessagesAsRead_1['default'])(_0xa570b2);if(_0x2a72d6)await Promise[_0x97e76(0x204)](_0x2a72d6[_0x97e76(0x1c0)](async(_0x8a294e,_0x572abc)=>{const _0x284b38=_0x97e76;return(0x0,SendWhatsAppMedia_1[_0x284b38(0x1ea)])({'media':_0x8a294e,'ticket':_0xa570b2,'body':Array[_0x284b38(0x18e)](_0x3ec202)?_0x3ec202[_0x572abc]:_0x3ec202});}));else{const _0x2e98fa=await(0x0,SendWhatsAppMessage_1[_0x97e76(0x1ea)])({'body':_0x3ec202,'ticket':_0xa570b2,'quotedMsg':_0x55b25f,'vCard':_0x3f497e});}return _0x5dd4bb[_0x97e76(0x1be)]();};exports[a26_0x51c5c2(0x213)]=store;const getAll=async(_0x402d86,_0x4d53a7)=>{const _0x51b338=a26_0x51c5c2,_0x1d2ff2=_0x402d86[_0x51b338(0x21a)][_0x51b338(0x1d8)],_0x4a6aad=_0x402d86[_0x51b338(0x21a)][_0x51b338(0x20c)],_0x311901=(0x0,validator_1[_0x51b338(0x1c8)])(_0x402d86['query']['fromMe']),{companyId:_0x1ccfbe}=_0x402d86['user'],{count:_0x1eacd5}=await(0x0,ListAllMessagesService_1['default'])({'companyId':_0x1ccfbe,'fromMe':_0x311901,'dateStart':_0x1d2ff2,'dateEnd':_0x4a6aad});return _0x4d53a7['json']({'count':_0x1eacd5});};exports[a26_0x51c5c2(0x220)]=getAll;const edit=async(_0x376774,_0x1a2b2c)=>{const _0x4bc52a=a26_0x51c5c2,{messageId:_0x57cbc6}=_0x376774[_0x4bc52a(0x19d)],{companyId:_0x45536e}=_0x376774[_0x4bc52a(0x1d3)],{body:_0x5bbf33}=_0x376774[_0x4bc52a(0x1b0)],{ticketId:_0x5f2b56,message:_0x4d93f3}=await(0x0,EditWhatsAppMessage_1[_0x4bc52a(0x1ea)])({'messageId':_0x57cbc6,'companyId':_0x45536e,'body':_0x5bbf33}),_0x150ee7=(0x0,socket_1[_0x4bc52a(0x1fc)])();return _0x150ee7['to'](_0x5f2b56[_0x4bc52a(0x1b5)]())[_0x4bc52a(0x1c7)](_0x4bc52a(0x1a1)+_0x45536e+_0x4bc52a(0x1f1),{'action':_0x4bc52a(0x1f4),'message':_0x4d93f3}),_0x1a2b2c[_0x4bc52a(0x1be)]();};exports[a26_0x51c5c2(0x1aa)]=edit;const remove=async(_0x33b0e7,_0x338ef5)=>{const _0x501169=a26_0x51c5c2,{messageId:_0x2df8ff}=_0x33b0e7['params'],{companyId:_0x559bb5}=_0x33b0e7[_0x501169(0x1d3)],_0x74bcd4=await(0x0,DeleteWhatsAppMessage_1['default'])(_0x2df8ff),_0x1724dd=(0x0,socket_1[_0x501169(0x1fc)])();return _0x1724dd['to'](_0x74bcd4[_0x501169(0x1ec)]['toString']())['emit'](_0x501169(0x1a1)+_0x559bb5+_0x501169(0x1f1),{'action':'update','message':_0x74bcd4}),_0x338ef5['send']();};exports['remove']=remove;function a26_0x47d8(_0x443ad5,_0x4fd77f){const _0x3ba23d=a26_0x431b();return a26_0x47d8=function(_0x548026,_0x4c8166){_0x548026=_0x548026-0x18e;let _0x431b1a=_0x3ba23d[_0x548026];return _0x431b1a;},a26_0x47d8(_0x443ad5,_0x4fd77f);}const typing=async(_0x5db203,_0x28243d)=>{const _0xa5a366=a26_0x51c5c2,{ticketId:_0x4d3bc0}=_0x5db203[_0xa5a366(0x19d)],{companyId:_0xf3ae55}=_0x5db203[_0xa5a366(0x1d3)],{status:_0x1d3ab8}=_0x5db203['query'];if(!_0x4d3bc0)return _0x28243d[_0xa5a366(0x209)](0x190)[_0xa5a366(0x1be)](_0xa5a366(0x203));const _0x4120f7=await(0x0,ShowTicketService_1['default'])(_0x4d3bc0,_0xf3ae55);if(!_0x4120f7)return _0x28243d[_0xa5a366(0x209)](0x194)[_0xa5a366(0x1be)](_0xa5a366(0x212));let _0x51dffe=(0x0,wbot_1[_0xa5a366(0x1d7)])(_0x4120f7[_0xa5a366(0x210)]);return _0x1d3ab8==_0xa5a366(0x20d)?await(0x0,SendPresenceStatus_1[_0xa5a366(0x1b2)])(_0x51dffe,_0x4120f7[_0xa5a366(0x1b9)][_0xa5a366(0x1a6)]+'@'+(_0x4120f7[_0xa5a366(0x1eb)]?_0xa5a366(0x1e8):_0xa5a366(0x1ed))):await(0x0,SendPresenceStatus_1[_0xa5a366(0x21f)])(_0x51dffe,_0x4120f7[_0xa5a366(0x1b9)][_0xa5a366(0x1a6)]+'@'+(_0x4120f7[_0xa5a366(0x1eb)]?_0xa5a366(0x1e8):'s.whatsapp.net')),_0x28243d['status'](0xc8)[_0xa5a366(0x1be)](_0xa5a366(0x21b)+_0x1d3ab8+_0xa5a366(0x1f8));};exports[a26_0x51c5c2(0x1a0)]=typing;const send=async(_0x226d1d,_0x20bd15)=>{const _0x2d88db=a26_0x51c5c2,{whatsappId:_0x5340dc}=_0x226d1d['params'],_0x40b500=_0x226d1d[_0x2d88db(0x1b0)],_0x2ec984=_0x226d1d[_0x2d88db(0x1f0)];try{const _0x315cf3=await Whatsapp_1['default'][_0x2d88db(0x20b)](_0x5340dc);if(!_0x315cf3)throw new Error(_0x2d88db(0x20e));if(_0x40b500[_0x2d88db(0x1a6)]===undefined)throw new Error('O\x20número\x20é\x20obrigatório');const _0x3fb40b=_0x40b500[_0x2d88db(0x1a6)],_0x22cb5f=_0x40b500[_0x2d88db(0x1b0)],_0xd3c8c6=_0x315cf3[_0x2d88db(0x1f5)],_0x3026b4=await(0x0,CheckNumber_1[_0x2d88db(0x1ea)])(_0x3fb40b,_0xd3c8c6);var _0x4ada2c=_0x3026b4['jid']['includes'](_0x2d88db(0x196));console[_0x2d88db(0x1d9)](_0x4ada2c);const _0x12acef=_0x3026b4[_0x2d88db(0x1d6)][_0x2d88db(0x1c9)](_0x2d88db(0x1d4),'')[_0x2d88db(0x1c9)](_0x2d88db(0x196),''),_0x3c8bca={'name':''+_0x12acef,'number':_0x12acef,'isGroup':_0x4ada2c,'companyId':_0xd3c8c6},_0x45be95=await(0x0,GetWhatsappWbot_1[_0x2d88db(0x1ea)])(_0x315cf3),_0x3953c5=await(0x0,CreateOrUpdateContactService_1[_0x2d88db(0x1ea)])(_0x3c8bca,_0x45be95,_0x3026b4[_0x2d88db(0x1d6)]),_0x4e333f=await(0x0,FindOrCreateTicketService_1['default'])(_0x3953c5,_0x315cf3['id'],0x0,_0xd3c8c6);return _0x2ec984?await Promise[_0x2d88db(0x204)](_0x2ec984[_0x2d88db(0x1c0)](async _0x29b4b4=>{const _0x14055b=_0x2d88db;await _0x226d1d[_0x14055b(0x191)][_0x14055b(0x1e4)](_0x14055b(0x197))['messageQueue']['add'](_0x14055b(0x193),{'whatsappId':_0x5340dc,'data':{'number':_0x12acef,'body':_0x22cb5f?(0x0,Mustache_1[_0x14055b(0x1ea)])(_0x22cb5f,_0x4e333f):_0x29b4b4['originalname'],'mediaPath':_0x29b4b4[_0x14055b(0x221)],'finalName':_0x29b4b4[_0x14055b(0x218)],'fileName':_0x29b4b4[_0x14055b(0x1a8)]}},{'removeOnComplete':!![],'attempts':0x3});})):await(0x0,SendWhatsAppMessage_1[_0x2d88db(0x1ea)])({'body':(0x0,Mustache_1[_0x2d88db(0x1ea)])(_0x22cb5f,_0x4e333f),'ticket':_0x4e333f}),_0x40b500['closeTicket']&&setTimeout(async()=>{const _0x1ad666=_0x2d88db;await(0x0,UpdateTicketService_1[_0x1ad666(0x1ea)])({'ticketId':_0x4e333f['id'],'ticketData':{'status':_0x1ad666(0x1b6)},'companyId':_0xd3c8c6});},0x3e8),await(0x0,SetTicketMessagesAsRead_1[_0x2d88db(0x1ea)])(_0x4e333f),_0x20bd15[_0x2d88db(0x1be)]({'mensagem':_0x2d88db(0x1a4)});}catch(_0x54a080){console[_0x2d88db(0x1d9)](_0x54a080);if(Object[_0x2d88db(0x1a7)](_0x54a080)[_0x2d88db(0x1bc)]===0x0)throw new AppError_1[(_0x2d88db(0x1ea))]('Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes');else throw new AppError_1[(_0x2d88db(0x1ea))](_0x54a080[_0x2d88db(0x195)]);}};exports[a26_0x51c5c2(0x1be)]=send;const addReaction=async(_0x5631fd,_0x32f7cb)=>{const _0x2f7ff4=a26_0x51c5c2;try{const {messageId:_0x51f8c8}=_0x5631fd[_0x2f7ff4(0x19d)],{type:_0x4a71e5}=_0x5631fd[_0x2f7ff4(0x1b0)],{companyId:_0x5c1870,id:_0x328859}=_0x5631fd[_0x2f7ff4(0x1d3)],_0x569b2a=await Message_1['default'][_0x2f7ff4(0x20b)](_0x51f8c8),_0x2b0dbc=await Ticket_1['default'][_0x2f7ff4(0x20b)](_0x569b2a[_0x2f7ff4(0x1ec)],{'include':[_0x2f7ff4(0x1b9)]});if(!_0x569b2a)return _0x32f7cb['status'](0x194)[_0x2f7ff4(0x1be)]({'message':_0x2f7ff4(0x1a2)});const _0x2778ac=await(0x0,SendWhatsAppReaction_1['default'])({'messageId':_0x51f8c8,'ticket':_0x2b0dbc,'reactionType':_0x4a71e5}),_0x5dee04=await _0x569b2a['update']({'reactions':[..._0x569b2a[_0x2f7ff4(0x1df)],{'type':_0x4a71e5,'userId':_0x328859}]}),_0x18ee9e=(0x0,socket_1[_0x2f7ff4(0x1fc)])();return _0x18ee9e['to'](_0x569b2a[_0x2f7ff4(0x1ec)][_0x2f7ff4(0x1b5)]())[_0x2f7ff4(0x1c7)]('company-'+_0x5c1870+_0x2f7ff4(0x1f1),{'action':_0x2f7ff4(0x1f4),'message':_0x569b2a}),_0x32f7cb[_0x2f7ff4(0x209)](0xc8)[_0x2f7ff4(0x1be)]({'message':_0x2f7ff4(0x1ce),'reactionResult':_0x2778ac,'reactions':_0x5dee04[_0x2f7ff4(0x1df)]});}catch(_0x8ef2a5){console[_0x2f7ff4(0x1dc)](_0x2f7ff4(0x1d0),_0x8ef2a5);if(_0x8ef2a5 instanceof AppError_1[_0x2f7ff4(0x1ea)])return _0x32f7cb[_0x2f7ff4(0x209)](0x190)['send']({'message':_0x8ef2a5[_0x2f7ff4(0x195)]});return _0x32f7cb[_0x2f7ff4(0x209)](0x1f4)[_0x2f7ff4(0x1be)]({'message':_0x2f7ff4(0x1a5),'error':_0x8ef2a5[_0x2f7ff4(0x195)]});}};exports['addReaction']=addReaction;const storeAudio=async(_0xdd1e0a,_0x54a921)=>{const _0x2e6a59=a26_0x51c5c2,_0x269b73=_0xdd1e0a[_0x2e6a59(0x1d3)][_0x2e6a59(0x1f5)],_0x5b6903=_0xdd1e0a['file'];let _0x5ea646='';const _0x4a0843=generateRandomFilename(),_0xfa8f45=_0x2e6a59(0x222)+_0x269b73+'/'+_0x4a0843;return await convertToMp3(_0x5b6903[_0x2e6a59(0x221)],_0xfa8f45),_0x5b6903&&(_0x5ea646=await(0x0,TranslateAudioService_1[_0x2e6a59(0x1ea)])(_0xfa8f45)),_0x54a921[_0x2e6a59(0x1be)](_0x5ea646||_0x2e6a59(0x1f7));};exports[a26_0x51c5c2(0x1f9)]=storeAudio;function convertToMp3(_0x19a49a,_0x48fb92){return new Promise((_0x5ccec4,_0x21bfab)=>{const _0x5c2d9e=a26_0x47d8;(0x0,fluent_ffmpeg_1[_0x5c2d9e(0x1ea)])(_0x19a49a)[_0x5c2d9e(0x207)](_0x5c2d9e(0x190))['on'](_0x5c2d9e(0x1b1),()=>{_0x5ccec4(_0x48fb92);})['on']('error',_0x265e40=>{const _0x186b7a=_0x5c2d9e;console[_0x186b7a(0x1dc)]('Erro\x20na\x20conversão\x20do\x20áudio:',_0x265e40),_0x21bfab(_0x265e40);})[_0x5c2d9e(0x19f)](_0x48fb92);});}function generateRandomFilename(){const _0x451774=a26_0x51c5c2,_0x9a1876=crypto_1[_0x451774(0x1ea)][_0x451774(0x1c3)](0x10)[_0x451774(0x1b5)](_0x451774(0x18f));return _0x9a1876+_0x451774(0x20a);}const forwardMessage=async(_0x159d83,_0x5623c8)=>{const _0x11840d=a26_0x51c5c2;console[_0x11840d(0x1d9)](_0x11840d(0x1d5));const {body:_0x18882f,quotedMsg:_0x4c2abc}=_0x159d83['body'],_0x4f7add=_0x159d83['body'][_0x11840d(0x19e)],_0x11485a=_0x159d83[_0x11840d(0x1b0)]['contactId'];if(!_0x4f7add||!_0x11485a)return _0x5623c8[_0x11840d(0x209)](0xc8)[_0x11840d(0x1be)](_0x11840d(0x1ad));const _0x4f54f7=await(0x0,ShowMessageService_1[_0x11840d(0x1ea)])(_0x4f7add),_0x454563=await(0x0,ShowContactService_1[_0x11840d(0x1f2)])(_0x11485a);if(!_0x4f54f7)return _0x5623c8[_0x11840d(0x209)](0x194)[_0x11840d(0x1be)](_0x11840d(0x1cb));if(!_0x454563)return _0x5623c8[_0x11840d(0x209)](0x194)[_0x11840d(0x1be)](_0x11840d(0x201));const _0x5c5860=await(0x0,ShowMessageService_1[_0x11840d(0x1bf)])(_0x4f54f7);if(!_0x5c5860)return _0x5623c8[_0x11840d(0x209)](0x194)['send'](_0x11840d(0x1c6));const _0x6828c9=_0x159d83['user'][_0x11840d(0x1f5)],_0x264caf=await(0x0,FindOrCreateTicketService_1[_0x11840d(0x1ea)])(_0x454563,_0x5c5860,0x0,_0x6828c9);await(0x0,SetTicketMessagesAsRead_1[_0x11840d(0x1ea)])(_0x264caf);_0x4f54f7[_0x11840d(0x1e1)]===_0x11840d(0x1af)||_0x4f54f7[_0x11840d(0x1e1)]===_0x11840d(0x208)?await(0x0,SendWhatsAppMessage_1[_0x11840d(0x1ea)])({'body':_0x4f54f7[_0x11840d(0x1b0)],'ticket':_0x264caf,'quotedMsg':_0x4c2abc}):await(0x0,SendWhatsAppMedia_1[_0x11840d(0x1e5)])(_0x4f54f7[_0x11840d(0x1ef)]||'',_0x264caf,_0x4f54f7['body']);const _0x124e08=await(0x0,ShowUserService_1['default'])(_0x159d83[_0x11840d(0x1d3)]['id']),_0x4892da=await(0x0,user_1['firstQueueThisUser'])(_0x124e08);_0x264caf[_0x11840d(0x209)]=_0x11840d(0x1ca),_0x264caf['queueId']=_0x4892da?.['id']||null,_0x264caf[_0x11840d(0x1cc)]=_0x124e08['id'],_0x264caf[_0x11840d(0x1c5)]();const _0x289620=(0x0,socket_1[_0x11840d(0x1fc)])();return(0x0,UpdateTicketService_2['notifyUpdate'])(_0x289620,_0x264caf,_0x264caf['id'],_0x6828c9),_0x5623c8[_0x11840d(0x1be)]();};exports[a26_0x51c5c2(0x1fb)]=forwardMessage;