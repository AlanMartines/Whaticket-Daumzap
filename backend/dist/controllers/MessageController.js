const a26_0x33a65d=a26_0x25b7;(function(_0x52b2c2,_0xe501fd){const _0x244c2e=a26_0x25b7,_0x47ddcc=_0x52b2c2();while(!![]){try{const _0xe2e04c=-parseInt(_0x244c2e(0x1ee))/0x1*(parseInt(_0x244c2e(0x1b9))/0x2)+parseInt(_0x244c2e(0x200))/0x3+-parseInt(_0x244c2e(0x222))/0x4*(-parseInt(_0x244c2e(0x229))/0x5)+parseInt(_0x244c2e(0x1cd))/0x6*(-parseInt(_0x244c2e(0x1dc))/0x7)+parseInt(_0x244c2e(0x206))/0x8+-parseInt(_0x244c2e(0x227))/0x9*(parseInt(_0x244c2e(0x1bd))/0xa)+-parseInt(_0x244c2e(0x242))/0xb*(-parseInt(_0x244c2e(0x20f))/0xc);if(_0xe2e04c===_0xe501fd)break;else _0x47ddcc['push'](_0x47ddcc['shift']());}catch(_0x22bd64){_0x47ddcc['push'](_0x47ddcc['shift']());}}}(a26_0xe78c,0x73232));const a26_0x3028f4=(function(){let _0x2ac1af=!![];return function(_0xd4b404,_0x50c11a){const _0x3195fa=_0x2ac1af?function(){const _0x50c612=a26_0x25b7;if(_0x50c11a){const _0x140440=_0x50c11a[_0x50c612(0x1ec)](_0xd4b404,arguments);return _0x50c11a=null,_0x140440;}}:function(){};return _0x2ac1af=![],_0x3195fa;};}()),a26_0x4d1f84=a26_0x3028f4(this,function(){const _0x3b8c68=a26_0x25b7;return a26_0x4d1f84[_0x3b8c68(0x1bc)]()['search']('(((.+)+)+)+$')[_0x3b8c68(0x1bc)]()['constructor'](a26_0x4d1f84)[_0x3b8c68(0x218)]('(((.+)+)+)+$');});a26_0x4d1f84();'use strict';function a26_0x25b7(_0xf472cc,_0x247e43){const _0x3719ac=a26_0xe78c();return a26_0x25b7=function(_0x4d1f84,_0x3028f4){_0x4d1f84=_0x4d1f84-0x1b5;let _0xe78c48=_0x3719ac[_0x4d1f84];return _0xe78c48;},a26_0x25b7(_0xf472cc,_0x247e43);}var __createBinding=this&&this[a26_0x33a65d(0x22a)]||(Object[a26_0x33a65d(0x20c)]?function(_0x743c6f,_0x4f670d,_0x220a7b,_0x23e47e){const _0x1c4998=a26_0x33a65d;if(_0x23e47e===undefined)_0x23e47e=_0x220a7b;var _0x49cb82=Object[_0x1c4998(0x1ed)](_0x4f670d,_0x220a7b);(!_0x49cb82||(_0x1c4998(0x20d)in _0x49cb82?!_0x4f670d[_0x1c4998(0x1f3)]:_0x49cb82[_0x1c4998(0x202)]||_0x49cb82[_0x1c4998(0x1fc)]))&&(_0x49cb82={'enumerable':!![],'get':function(){return _0x4f670d[_0x220a7b];}}),Object[_0x1c4998(0x1e2)](_0x743c6f,_0x23e47e,_0x49cb82);}:function(_0x5ed538,_0x1af6d2,_0x2bc75f,_0xc64c31){if(_0xc64c31===undefined)_0xc64c31=_0x2bc75f;_0x5ed538[_0xc64c31]=_0x1af6d2[_0x2bc75f];}),__setModuleDefault=this&&this[a26_0x33a65d(0x1f0)]||(Object[a26_0x33a65d(0x20c)]?function(_0x3e139e,_0x55a014){const _0x5e15a2=a26_0x33a65d;Object[_0x5e15a2(0x1e2)](_0x3e139e,_0x5e15a2(0x1f4),{'enumerable':!![],'value':_0x55a014});}:function(_0x132b1d,_0x1c4cb2){_0x132b1d['default']=_0x1c4cb2;}),__importStar=this&&this[a26_0x33a65d(0x1fd)]||function(_0x1aff86){const _0x3b3015=a26_0x33a65d;if(_0x1aff86&&_0x1aff86[_0x3b3015(0x1f3)])return _0x1aff86;var _0x35a58a={};if(_0x1aff86!=null){for(var _0x4078d7 in _0x1aff86)if(_0x4078d7!==_0x3b3015(0x1f4)&&Object['prototype'][_0x3b3015(0x221)][_0x3b3015(0x223)](_0x1aff86,_0x4078d7))__createBinding(_0x35a58a,_0x1aff86,_0x4078d7);}return __setModuleDefault(_0x35a58a,_0x1aff86),_0x35a58a;},__importDefault=this&&this[a26_0x33a65d(0x23c)]||function(_0x211bb2){const _0x337d97=a26_0x33a65d;return _0x211bb2&&_0x211bb2[_0x337d97(0x1f3)]?_0x211bb2:{'default':_0x211bb2};};Object[a26_0x33a65d(0x1e2)](exports,a26_0x33a65d(0x1f3),{'value':!![]}),exports[a26_0x33a65d(0x21e)]=exports[a26_0x33a65d(0x232)]=exports[a26_0x33a65d(0x1b7)]=exports[a26_0x33a65d(0x1e3)]=exports[a26_0x33a65d(0x209)]=exports[a26_0x33a65d(0x1cb)]=exports[a26_0x33a65d(0x233)]=exports[a26_0x33a65d(0x1bf)]=exports[a26_0x33a65d(0x235)]=exports['index']=void 0x0;const AppError_1=__importDefault(require(a26_0x33a65d(0x1d2))),SetTicketMessagesAsRead_1=__importDefault(require(a26_0x33a65d(0x23d))),socket_1=require(a26_0x33a65d(0x1c0)),Message_1=__importDefault(require(a26_0x33a65d(0x217))),Ticket_1=__importDefault(require('../models/Ticket')),Queue_1=__importDefault(require('../models/Queue')),User_1=__importDefault(require('../models/User')),Whatsapp_1=__importDefault(require(a26_0x33a65d(0x214))),Mustache_1=__importDefault(require(a26_0x33a65d(0x237))),ListMessagesService_1=__importDefault(require('../services/MessageServices/ListMessagesService')),ShowTicketService_1=__importDefault(require(a26_0x33a65d(0x1b5))),FindOrCreateTicketService_1=__importDefault(require('../services/TicketServices/FindOrCreateTicketService')),UpdateTicketService_1=__importDefault(require('../services/TicketServices/UpdateTicketService')),DeleteWhatsAppMessage_1=__importDefault(require('../services/WbotServices/DeleteWhatsAppMessage')),SendWhatsAppMedia_1=__importStar(require(a26_0x33a65d(0x1c9))),SendWhatsAppMessage_1=__importDefault(require(a26_0x33a65d(0x1c2))),SendWhatsAppReaction_1=__importDefault(require('../services/WbotServices/SendWhatsAppReaction')),CheckNumber_1=__importDefault(require(a26_0x33a65d(0x1ca))),EditWhatsAppMessage_1=__importDefault(require(a26_0x33a65d(0x226))),TranslateAudioService_1=__importDefault(require(a26_0x33a65d(0x1e5))),CreateOrUpdateContactService_1=__importDefault(require('../services/ContactServices/CreateOrUpdateContactService')),ShowMessageService_1=__importStar(require(a26_0x33a65d(0x1d4))),ShowContactService_1=require(a26_0x33a65d(0x224)),ShowUserService_1=__importDefault(require('../services/UserServices/ShowUserService')),user_1=require(a26_0x33a65d(0x23b)),UpdateTicketService_2=require(a26_0x33a65d(0x1da)),ListAllMessagesService_1=__importDefault(require(a26_0x33a65d(0x1d7))),validator_1=require('validator'),ffmpeg_static_1=__importDefault(require('ffmpeg-static')),fluent_ffmpeg_1=__importDefault(require('fluent-ffmpeg')),crypto_1=__importDefault(require('crypto')),GetWhatsappWbot_1=__importDefault(require(a26_0x33a65d(0x1d6))),wbot_1=require(a26_0x33a65d(0x1c8)),SendPresenceStatus_1=require(a26_0x33a65d(0x236));fluent_ffmpeg_1[a26_0x33a65d(0x1f4)][a26_0x33a65d(0x1c4)](ffmpeg_static_1['default']);const index=async(_0xb068b0,_0x3577d5)=>{const _0x2b8bee=a26_0x33a65d,{ticketId:_0x176366}=_0xb068b0[_0x2b8bee(0x204)],{pageNumber:_0x453887}=_0xb068b0[_0x2b8bee(0x1c3)],{companyId:_0x3c3002,profile:_0x5a12a1}=_0xb068b0[_0x2b8bee(0x22b)],_0x52e95e=[];if(_0x5a12a1!==_0x2b8bee(0x1bb)){const _0x26c6a0=await User_1[_0x2b8bee(0x1f4)][_0x2b8bee(0x21b)](_0xb068b0[_0x2b8bee(0x22b)]['id'],{'include':[{'model':Queue_1[_0x2b8bee(0x1f4)],'as':'queues'}]});_0x26c6a0[_0x2b8bee(0x1f7)][_0x2b8bee(0x1d3)](_0xdbe44c=>{const _0x78c6e8=_0x2b8bee;_0x52e95e[_0x78c6e8(0x240)](_0xdbe44c['id']);});}const {count:_0x2d5e0f,messages:_0x5b5cbe,ticket:_0x3d3733,hasMore:_0x4714a0}=await(0x0,ListMessagesService_1[_0x2b8bee(0x1f4)])({'pageNumber':_0x453887,'ticketId':_0x176366,'companyId':_0x3c3002,'queues':_0x52e95e});return(0x0,SetTicketMessagesAsRead_1[_0x2b8bee(0x1f4)])(_0x3d3733),_0x3577d5[_0x2b8bee(0x231)]({'count':_0x2d5e0f,'messages':_0x5b5cbe,'ticket':_0x3d3733,'hasMore':_0x4714a0});};exports['index']=index;const store=async(_0x2c11df,_0x1147e0)=>{const _0x3dec4b=a26_0x33a65d,{ticketId:_0x5c9be0}=_0x2c11df[_0x3dec4b(0x204)],{body:_0x9255be,quotedMsg:_0x38a718,vCard:_0x5226e2}=_0x2c11df[_0x3dec4b(0x1ce)],_0x5dabe2=_0x2c11df[_0x3dec4b(0x20a)],{companyId:_0x3a0e91,id:_0x16f2f6}=_0x2c11df[_0x3dec4b(0x22b)],_0x5a79ae=await(0x0,ShowTicketService_1['default'])(_0x5c9be0,_0x3a0e91);_0x5a79ae[_0x3dec4b(0x208)]!==_0x3dec4b(0x1e0)&&await(0x0,UpdateTicketService_1[_0x3dec4b(0x1f4)])({'ticketId':_0x5a79ae['id'],'ticketData':{'status':_0x3dec4b(0x1e0),'userId':parseInt(_0x16f2f6)},'companyId':_0x3a0e91});if(_0x5a79ae['unreadMessages']>0x0)(0x0,SetTicketMessagesAsRead_1[_0x3dec4b(0x1f4)])(_0x5a79ae);if(_0x5dabe2)await Promise['all'](_0x5dabe2[_0x3dec4b(0x1c6)](async(_0x1ff7ed,_0x35af7c)=>{const _0x3d185d=_0x3dec4b;return(0x0,SendWhatsAppMedia_1[_0x3d185d(0x1f4)])({'media':_0x1ff7ed,'ticket':_0x5a79ae,'body':Array[_0x3d185d(0x201)](_0x9255be)?_0x9255be[_0x35af7c]:_0x9255be});}));else{const _0x2b3e1e=await(0x0,SendWhatsAppMessage_1[_0x3dec4b(0x1f4)])({'body':_0x9255be,'ticket':_0x5a79ae,'quotedMsg':_0x38a718,'vCard':_0x5226e2});}return _0x1147e0[_0x3dec4b(0x1e3)]();};function a26_0xe78c(){const _0x187775=['SendMessage','.mp3','all','Whatsapp\x20from\x20message\x20not\x20found','json','storeAudio','edit','-appMessage','store','../helpers/SendPresenceStatus','../helpers/Mustache','messageQueue','SendPausedStatus','hex','../utils/user','__importDefault','../helpers/SetTicketMessagesAsRead','Contact\x20not\x20found','true','push','Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes','230362MoRXtO','randomBytes','>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<','toFormat','../services/TicketServices/ShowTicketService','log','addReaction','mediaUrl','1145302WUpLhJ','Message\x20not\x20found','admin','toString','10YSZSPj','app','getAll','../libs/socket','add','../services/WbotServices/SendWhatsAppMessage','query','setFfmpegPath','Erro\x20ao\x20adicionar\x20reação','map','replace','../libs/wbot','../services/WbotServices/SendWhatsAppMedia','../services/WbotServices/CheckNumber','remove','Mensagem\x20enviada','42umDqzU','body','SendTypingStatus','queueId','SendWhatsAppMediaFileAddress','../errors/AppError','forEach','../services/MessageServices/ShowMessageService','./public/company','../helpers/GetWhatsappWbot','../services/MessageServices/ListAllMessagesService','jid','whatsappId','../services/TicketServices/UpdateTicketService','Mensagem\x20não\x20encontrada','765527psIdFK','firstQueueThisUser','saveToFile','Erro\x20na\x20conversão\x20do\x20áudio:','open','messageId','defineProperty','send','mediaType','../services/MessageServices/TranslateAudioService','userId','ticketId','\x20enviado\x20com\x20sucesso','fromMe','emit','keys','apply','getOwnPropertyDescriptor','1iWxUrx','file','__setModuleDefault','Status\x20','companyId','__esModule','default','message','getWbot','queues','update','notifyUpdate','GetWhatsAppFromMessage','extendedTextMessage','configurable','__importStar','isGroup','getIO','1468923GrudEX','isArray','writable','TicketId\x20is\x20required','params','error','621528JXrPvn','@g.us','status','typing','files','s.whatsapp.net','create','get','company-','1092yGCeJQ','reactions','path','toBoolean','O\x20número\x20é\x20obrigatório','../models/Whatsapp','originalname','g.us','../models/Message','search','Erro\x20ao\x20adicionar\x20reação:','MessageId\x20or\x20ContactId\x20not\x20found','findByPk','contact','filename','forwardMessage','Reação\x20adicionada\x20com\x20sucesso!','closed','hasOwnProperty','76FvokfH','call','../services/ContactServices/ShowContactService','dateEnd','../services/WbotServices/EditWhatsAppMessage','6346863HGHnjj','number','11035yKGOJa','__createBinding','user','ShowContactService1'];a26_0xe78c=function(){return _0x187775;};return a26_0xe78c();}exports['store']=store;const getAll=async(_0x5126f8,_0x392363)=>{const _0x3bcf4b=a26_0x33a65d,_0x2e43bd=_0x5126f8[_0x3bcf4b(0x1c3)]['dateStart'],_0x3014f2=_0x5126f8[_0x3bcf4b(0x1c3)][_0x3bcf4b(0x225)],_0xef1af4=(0x0,validator_1[_0x3bcf4b(0x212)])(_0x5126f8[_0x3bcf4b(0x1c3)][_0x3bcf4b(0x1e9)]),{companyId:_0x2a25f7}=_0x5126f8[_0x3bcf4b(0x22b)],{count:_0x219521}=await(0x0,ListAllMessagesService_1[_0x3bcf4b(0x1f4)])({'companyId':_0x2a25f7,'fromMe':_0xef1af4,'dateStart':_0x2e43bd,'dateEnd':_0x3014f2});return _0x392363[_0x3bcf4b(0x231)]({'count':_0x219521});};exports[a26_0x33a65d(0x1bf)]=getAll;const edit=async(_0x583c22,_0x5d5b13)=>{const _0x4d1b5b=a26_0x33a65d,{messageId:_0x47e03c}=_0x583c22[_0x4d1b5b(0x204)],{companyId:_0x42ab5e}=_0x583c22['user'],{body:_0x3cb4b4}=_0x583c22[_0x4d1b5b(0x1ce)],{ticketId:_0x5486c9,message:_0x390bc1}=await(0x0,EditWhatsAppMessage_1[_0x4d1b5b(0x1f4)])({'messageId':_0x47e03c,'companyId':_0x42ab5e,'body':_0x3cb4b4}),_0x26c1a5=(0x0,socket_1[_0x4d1b5b(0x1ff)])();return _0x26c1a5['to'](_0x5486c9[_0x4d1b5b(0x1bc)]())['emit'](_0x4d1b5b(0x20e)+_0x42ab5e+'-appMessage',{'action':_0x4d1b5b(0x1f8),'message':_0x390bc1}),_0x5d5b13['send']();};exports['edit']=edit;const remove=async(_0x50a728,_0x2cc575)=>{const _0x29ecc1=a26_0x33a65d,{messageId:_0x1b623b}=_0x50a728[_0x29ecc1(0x204)],{companyId:_0x363455}=_0x50a728['user'],_0x168a77=await(0x0,DeleteWhatsAppMessage_1[_0x29ecc1(0x1f4)])(_0x1b623b),_0x42bd83=(0x0,socket_1[_0x29ecc1(0x1ff)])();return _0x42bd83['to'](_0x168a77[_0x29ecc1(0x1e7)][_0x29ecc1(0x1bc)]())['emit'](_0x29ecc1(0x20e)+_0x363455+_0x29ecc1(0x234),{'action':'update','message':_0x168a77}),_0x2cc575[_0x29ecc1(0x1e3)]();};exports[a26_0x33a65d(0x1cb)]=remove;const typing=async(_0x4955de,_0x855815)=>{const _0x149be6=a26_0x33a65d,{ticketId:_0x19d839}=_0x4955de[_0x149be6(0x204)],{companyId:_0x5ca081}=_0x4955de['user'],{status:_0x24686e}=_0x4955de[_0x149be6(0x1c3)];if(!_0x19d839)return _0x855815['status'](0x190)[_0x149be6(0x1e3)](_0x149be6(0x203));const _0x43aec7=await(0x0,ShowTicketService_1[_0x149be6(0x1f4)])(_0x19d839,_0x5ca081);if(!_0x43aec7)return _0x855815[_0x149be6(0x208)](0x194)[_0x149be6(0x1e3)]('Ticket\x20not\x20found');let _0xeca21a=(0x0,wbot_1[_0x149be6(0x1f6)])(_0x43aec7[_0x149be6(0x1d9)]);return _0x24686e==_0x149be6(0x23f)?await(0x0,SendPresenceStatus_1[_0x149be6(0x1cf)])(_0xeca21a,_0x43aec7[_0x149be6(0x21c)][_0x149be6(0x228)]+'@'+(_0x43aec7[_0x149be6(0x1fe)]?_0x149be6(0x216):_0x149be6(0x20b))):await(0x0,SendPresenceStatus_1[_0x149be6(0x239)])(_0xeca21a,_0x43aec7[_0x149be6(0x21c)][_0x149be6(0x228)]+'@'+(_0x43aec7['isGroup']?_0x149be6(0x216):_0x149be6(0x20b))),_0x855815[_0x149be6(0x208)](0xc8)[_0x149be6(0x1e3)](_0x149be6(0x1f1)+_0x24686e+_0x149be6(0x1e8));};exports[a26_0x33a65d(0x209)]=typing;const send=async(_0x469532,_0x136117)=>{const _0xaa9f74=a26_0x33a65d,{whatsappId:_0x3ebc0d}=_0x469532['params'],_0x42aa4f=_0x469532[_0xaa9f74(0x1ce)],_0x445ec3=_0x469532['files'];try{const _0x4478bd=await Whatsapp_1[_0xaa9f74(0x1f4)][_0xaa9f74(0x21b)](_0x3ebc0d);if(!_0x4478bd)throw new Error('Não\x20foi\x20possível\x20realizar\x20a\x20operação');if(_0x42aa4f['number']===undefined)throw new Error(_0xaa9f74(0x213));const _0x967af1=_0x42aa4f[_0xaa9f74(0x228)],_0x277f75=_0x42aa4f['body'],_0x30b454=_0x4478bd[_0xaa9f74(0x1f2)],_0x1a7e71=await(0x0,CheckNumber_1['default'])(_0x967af1,_0x30b454);var _0x54e9ea=_0x1a7e71[_0xaa9f74(0x1d8)]['includes'](_0xaa9f74(0x207));console['log'](_0x54e9ea);const _0x10fc0c=_0x1a7e71[_0xaa9f74(0x1d8)][_0xaa9f74(0x1c7)]('@s.whatsapp.net','')['replace'](_0xaa9f74(0x207),''),_0x4a0e83={'name':''+_0x10fc0c,'number':_0x10fc0c,'isGroup':_0x54e9ea,'companyId':_0x30b454},_0x23f51e=await(0x0,GetWhatsappWbot_1[_0xaa9f74(0x1f4)])(_0x4478bd),_0x1b9b8b=await(0x0,CreateOrUpdateContactService_1['default'])(_0x4a0e83,_0x23f51e,_0x1a7e71[_0xaa9f74(0x1d8)]),_0x1b3110=await(0x0,FindOrCreateTicketService_1[_0xaa9f74(0x1f4)])(_0x1b9b8b,_0x4478bd['id'],0x0,_0x30b454);return _0x445ec3?await Promise[_0xaa9f74(0x22f)](_0x445ec3['map'](async _0x5bfbc1=>{const _0x3d1135=_0xaa9f74;await _0x469532[_0x3d1135(0x1be)][_0x3d1135(0x20d)]('queues')[_0x3d1135(0x238)][_0x3d1135(0x1c1)](_0x3d1135(0x22d),{'whatsappId':_0x3ebc0d,'data':{'number':_0x10fc0c,'body':_0x277f75?(0x0,Mustache_1[_0x3d1135(0x1f4)])(_0x277f75,_0x1b3110):_0x5bfbc1['originalname'],'mediaPath':_0x5bfbc1[_0x3d1135(0x211)],'finalName':_0x5bfbc1[_0x3d1135(0x21d)],'fileName':_0x5bfbc1[_0x3d1135(0x215)]}},{'removeOnComplete':!![],'attempts':0x3});})):await(0x0,SendWhatsAppMessage_1[_0xaa9f74(0x1f4)])({'body':(0x0,Mustache_1['default'])(_0x277f75,_0x1b3110),'ticket':_0x1b3110}),_0x42aa4f['closeTicket']&&setTimeout(async()=>{const _0x1ff082=_0xaa9f74;await(0x0,UpdateTicketService_1[_0x1ff082(0x1f4)])({'ticketId':_0x1b3110['id'],'ticketData':{'status':_0x1ff082(0x220)},'companyId':_0x30b454});},0x3e8),await(0x0,SetTicketMessagesAsRead_1['default'])(_0x1b3110),_0x136117[_0xaa9f74(0x1e3)]({'mensagem':_0xaa9f74(0x1cc)});}catch(_0x5b5a4d){console[_0xaa9f74(0x1b6)](_0x5b5a4d);if(Object[_0xaa9f74(0x1eb)](_0x5b5a4d)['length']===0x0)throw new AppError_1[(_0xaa9f74(0x1f4))](_0xaa9f74(0x241));else throw new AppError_1[(_0xaa9f74(0x1f4))](_0x5b5a4d['message']);}};exports[a26_0x33a65d(0x1e3)]=send;const addReaction=async(_0x3d182d,_0x46b689)=>{const _0x9eed3d=a26_0x33a65d;try{const {messageId:_0x450555}=_0x3d182d['params'],{type:_0x1773c8}=_0x3d182d[_0x9eed3d(0x1ce)],{companyId:_0x5162d0,id:_0x15d343}=_0x3d182d[_0x9eed3d(0x22b)],_0x1d3926=await Message_1[_0x9eed3d(0x1f4)]['findByPk'](_0x450555),_0x4c4afe=await Ticket_1[_0x9eed3d(0x1f4)][_0x9eed3d(0x21b)](_0x1d3926[_0x9eed3d(0x1e7)],{'include':[_0x9eed3d(0x21c)]});if(!_0x1d3926)return _0x46b689['status'](0x194)[_0x9eed3d(0x1e3)]({'message':_0x9eed3d(0x1db)});const _0x588662=await(0x0,SendWhatsAppReaction_1['default'])({'messageId':_0x450555,'ticket':_0x4c4afe,'reactionType':_0x1773c8}),_0x34238d=await _0x1d3926[_0x9eed3d(0x1f8)]({'reactions':[..._0x1d3926[_0x9eed3d(0x210)],{'type':_0x1773c8,'userId':_0x15d343}]}),_0x1a30b7=(0x0,socket_1[_0x9eed3d(0x1ff)])();return _0x1a30b7['to'](_0x1d3926[_0x9eed3d(0x1e7)]['toString']())[_0x9eed3d(0x1ea)](_0x9eed3d(0x20e)+_0x5162d0+_0x9eed3d(0x234),{'action':_0x9eed3d(0x1f8),'message':_0x1d3926}),_0x46b689[_0x9eed3d(0x208)](0xc8)['send']({'message':_0x9eed3d(0x21f),'reactionResult':_0x588662,'reactions':_0x34238d[_0x9eed3d(0x210)]});}catch(_0x7f19e0){console[_0x9eed3d(0x205)](_0x9eed3d(0x219),_0x7f19e0);if(_0x7f19e0 instanceof AppError_1['default'])return _0x46b689[_0x9eed3d(0x208)](0x190)[_0x9eed3d(0x1e3)]({'message':_0x7f19e0[_0x9eed3d(0x1f5)]});return _0x46b689[_0x9eed3d(0x208)](0x1f4)[_0x9eed3d(0x1e3)]({'message':_0x9eed3d(0x1c5),'error':_0x7f19e0['message']});}};exports[a26_0x33a65d(0x1b7)]=addReaction;const storeAudio=async(_0x56b8e6,_0x4d2e1f)=>{const _0x9066f4=a26_0x33a65d,_0x2a1072=_0x56b8e6['user'][_0x9066f4(0x1f2)],_0x533986=_0x56b8e6[_0x9066f4(0x1ef)];let _0xb80e2f='';const _0x2380cd=generateRandomFilename(),_0x24056a=_0x9066f4(0x1d5)+_0x2a1072+'/'+_0x2380cd;return await convertToMp3(_0x533986[_0x9066f4(0x211)],_0x24056a),_0x533986&&(_0xb80e2f=await(0x0,TranslateAudioService_1[_0x9066f4(0x1f4)])(_0x24056a)),_0x4d2e1f[_0x9066f4(0x1e3)](_0xb80e2f||'Transcrição\x20não\x20disponível');};exports['storeAudio']=storeAudio;function convertToMp3(_0x14d6b4,_0x18be8e){return new Promise((_0xe9277c,_0x2cec9e)=>{const _0x10f52d=a26_0x25b7;(0x0,fluent_ffmpeg_1[_0x10f52d(0x1f4)])(_0x14d6b4)[_0x10f52d(0x245)]('mp3')['on']('end',()=>{_0xe9277c(_0x18be8e);})['on'](_0x10f52d(0x205),_0x580383=>{const _0xc41cc=_0x10f52d;console[_0xc41cc(0x205)](_0xc41cc(0x1df),_0x580383),_0x2cec9e(_0x580383);})[_0x10f52d(0x1de)](_0x18be8e);});}function generateRandomFilename(){const _0x1ad897=a26_0x33a65d,_0x25d629=crypto_1[_0x1ad897(0x1f4)][_0x1ad897(0x243)](0x10)[_0x1ad897(0x1bc)](_0x1ad897(0x23a));return _0x25d629+_0x1ad897(0x22e);}const forwardMessage=async(_0x266cb9,_0x1b4413)=>{const _0x5c4c0e=a26_0x33a65d;console[_0x5c4c0e(0x1b6)](_0x5c4c0e(0x244));const {body:_0x107166,quotedMsg:_0x157858}=_0x266cb9['body'],_0x1e9691=_0x266cb9[_0x5c4c0e(0x1ce)][_0x5c4c0e(0x1e1)],_0x388d04=_0x266cb9[_0x5c4c0e(0x1ce)]['contactId'];if(!_0x1e9691||!_0x388d04)return _0x1b4413[_0x5c4c0e(0x208)](0xc8)['send'](_0x5c4c0e(0x21a));const _0x2b5aeb=await(0x0,ShowMessageService_1[_0x5c4c0e(0x1f4)])(_0x1e9691),_0x149108=await(0x0,ShowContactService_1[_0x5c4c0e(0x22c)])(_0x388d04);if(!_0x2b5aeb)return _0x1b4413[_0x5c4c0e(0x208)](0x194)[_0x5c4c0e(0x1e3)](_0x5c4c0e(0x1ba));if(!_0x149108)return _0x1b4413[_0x5c4c0e(0x208)](0x194)[_0x5c4c0e(0x1e3)](_0x5c4c0e(0x23e));const _0x10a2ba=await(0x0,ShowMessageService_1[_0x5c4c0e(0x1fa)])(_0x2b5aeb);if(!_0x10a2ba)return _0x1b4413['status'](0x194)[_0x5c4c0e(0x1e3)](_0x5c4c0e(0x230));const _0x1bc0b2=_0x266cb9[_0x5c4c0e(0x22b)][_0x5c4c0e(0x1f2)],_0x1fb507=await(0x0,FindOrCreateTicketService_1[_0x5c4c0e(0x1f4)])(_0x149108,_0x10a2ba,0x0,_0x1bc0b2);await(0x0,SetTicketMessagesAsRead_1[_0x5c4c0e(0x1f4)])(_0x1fb507);_0x2b5aeb[_0x5c4c0e(0x1e4)]==='conversation'||_0x2b5aeb[_0x5c4c0e(0x1e4)]===_0x5c4c0e(0x1fb)?await(0x0,SendWhatsAppMessage_1['default'])({'body':_0x2b5aeb['body'],'ticket':_0x1fb507,'quotedMsg':_0x157858}):await(0x0,SendWhatsAppMedia_1[_0x5c4c0e(0x1d1)])(_0x2b5aeb[_0x5c4c0e(0x1b8)]||'',_0x1fb507,_0x2b5aeb[_0x5c4c0e(0x1ce)]);const _0x1da0cd=await(0x0,ShowUserService_1[_0x5c4c0e(0x1f4)])(_0x266cb9[_0x5c4c0e(0x22b)]['id']),_0x20853f=await(0x0,user_1[_0x5c4c0e(0x1dd)])(_0x1da0cd);_0x1fb507['status']=_0x5c4c0e(0x1e0),_0x1fb507[_0x5c4c0e(0x1d0)]=_0x20853f?.['id']||null,_0x1fb507[_0x5c4c0e(0x1e6)]=_0x1da0cd['id'],_0x1fb507['save']();const _0x40146f=(0x0,socket_1[_0x5c4c0e(0x1ff)])();return(0x0,UpdateTicketService_2[_0x5c4c0e(0x1f9)])(_0x40146f,_0x1fb507,_0x1fb507['id'],_0x1bc0b2),_0x1b4413[_0x5c4c0e(0x1e3)]();};exports['forwardMessage']=forwardMessage;