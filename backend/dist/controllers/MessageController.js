const a26_0x2692f9=a26_0x1963;(function(_0x598c7b,_0xf7107b){const _0x4abfa9=a26_0x1963,_0xbabd00=_0x598c7b();while(!![]){try{const _0x4efae8=parseInt(_0x4abfa9(0x159))/0x1+parseInt(_0x4abfa9(0x10e))/0x2+-parseInt(_0x4abfa9(0x108))/0x3+parseInt(_0x4abfa9(0x114))/0x4*(parseInt(_0x4abfa9(0xdf))/0x5)+parseInt(_0x4abfa9(0x157))/0x6+parseInt(_0x4abfa9(0x10c))/0x7+-parseInt(_0x4abfa9(0x11c))/0x8;if(_0x4efae8===_0xf7107b)break;else _0xbabd00['push'](_0xbabd00['shift']());}catch(_0x11855a){_0xbabd00['push'](_0xbabd00['shift']());}}}(a26_0x53f6,0x52b04));const a26_0x15c07b=(function(){let _0x3e23c0=!![];return function(_0x341571,_0x4b682c){const _0xbcedbf=_0x3e23c0?function(){const _0x3dc8f6=a26_0x1963;if(_0x4b682c){const _0x14c6c7=_0x4b682c[_0x3dc8f6(0x137)](_0x341571,arguments);return _0x4b682c=null,_0x14c6c7;}}:function(){};return _0x3e23c0=![],_0xbcedbf;};}()),a26_0x38fbb5=a26_0x15c07b(this,function(){const _0x52f24d=a26_0x1963;return a26_0x38fbb5[_0x52f24d(0x11a)]()[_0x52f24d(0x14b)]('(((.+)+)+)+$')[_0x52f24d(0x11a)]()[_0x52f24d(0xd6)](a26_0x38fbb5)[_0x52f24d(0x14b)](_0x52f24d(0x154));});a26_0x38fbb5();function a26_0x53f6(){const _0xe67e3e=['../services/ContactServices/CreateOrUpdateContactService','jid','push','__createBinding','../services/TicketServices/UpdateTicketService','../libs/wbot','__importStar','.mp3','../libs/socket','message','path','forEach','1113888YZaicP','error','get','Não\x20foi\x20possível\x20realizar\x20a\x20operação','4130833tjPIKv','randomBytes','1082766pDaNzf','store','getWbot','Erro\x20na\x20conversão\x20do\x20áudio:','Whatsapp\x20from\x20message\x20not\x20found','query','16TEyxhk','extendedTextMessage','\x20enviado\x20com\x20sucesso','../helpers/SetTicketMessagesAsRead','keys','GetWhatsAppFromMessage','toString','../services/WbotServices/EditWhatsAppMessage','11798992RvjzEl','messageQueue','../services/ContactServices/ShowContactService','edit','../services/MessageServices/ShowMessageService','remove','../models/User','../helpers/GetWhatsappWbot','setFfmpegPath','SendMessage','userId','prototype','../services/MessageServices/TranslateAudioService','user','isGroup','Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes','companyId','fluent-ffmpeg','../utils/user','getIO','emit','isArray','replace','ffmpeg-static','admin','addReaction','saveToFile','apply','reactions','default','Erro\x20ao\x20adicionar\x20reação','Transcrição\x20não\x20disponível','open','filename','add','../models/Ticket','g.us','findByPk','../services/MessageServices/ListAllMessagesService','../models/Message','contactId','all','body','SendTypingStatus','true','ticketId','contact','search','@s.whatsapp.net','save','Message\x20not\x20found','validator','fromMe','toBoolean','originalname','hasOwnProperty','(((.+)+)+)+$','includes','Reação\x20adicionada\x20com\x20sucesso!','2924400SFqDVk','s.whatsapp.net','184884bwZYED','conversation','number','typing','map','send','Mensagem\x20enviada','mediaType','company-','app','../models/Queue','create','queues','crypto','status','queueId','closed','constructor','configurable','params','defineProperty','messageId','__esModule','files','../services/UserServices/ShowUserService','../services/MessageServices/ListMessagesService','476345LrXSZb','Status\x20','whatsappId','mp3','../helpers/SendPresenceStatus','@g.us','-appMessage','log','end','Contact\x20not\x20found','getAll','SendPausedStatus','Mensagem\x20não\x20encontrada','hex','../services/WbotServices/SendWhatsAppReaction','>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<','storeAudio','update','json','length','ShowContactService1','../services/WbotServices/SendWhatsAppMessage','__setModuleDefault','unreadMessages','file','../models/Whatsapp','forwardMessage','index','../errors/AppError'];a26_0x53f6=function(){return _0xe67e3e;};return a26_0x53f6();}'use strict';var __createBinding=this&&this[a26_0x2692f9(0xff)]||(Object[a26_0x2692f9(0xd0)]?function(_0x2e1159,_0x4bc714,_0x4b28c7,_0x24ec50){const _0x2942d0=a26_0x2692f9;if(_0x24ec50===undefined)_0x24ec50=_0x4b28c7;var _0xe6a066=Object['getOwnPropertyDescriptor'](_0x4bc714,_0x4b28c7);(!_0xe6a066||(_0x2942d0(0x10a)in _0xe6a066?!_0x4bc714[_0x2942d0(0xdb)]:_0xe6a066['writable']||_0xe6a066[_0x2942d0(0xd7)]))&&(_0xe6a066={'enumerable':!![],'get':function(){return _0x4bc714[_0x4b28c7];}}),Object['defineProperty'](_0x2e1159,_0x24ec50,_0xe6a066);}:function(_0x42da7b,_0xd1a77a,_0x4e8b9c,_0xc9b432){if(_0xc9b432===undefined)_0xc9b432=_0x4e8b9c;_0x42da7b[_0xc9b432]=_0xd1a77a[_0x4e8b9c];}),__setModuleDefault=this&&this[a26_0x2692f9(0xf5)]||(Object[a26_0x2692f9(0xd0)]?function(_0xa9bfd7,_0xdf8c74){const _0x24351d=a26_0x2692f9;Object['defineProperty'](_0xa9bfd7,_0x24351d(0x139),{'enumerable':!![],'value':_0xdf8c74});}:function(_0x46b867,_0x4a7d77){const _0x987baf=a26_0x2692f9;_0x46b867[_0x987baf(0x139)]=_0x4a7d77;}),__importStar=this&&this[a26_0x2692f9(0x102)]||function(_0x3e008f){const _0x28b28d=a26_0x2692f9;if(_0x3e008f&&_0x3e008f[_0x28b28d(0xdb)])return _0x3e008f;var _0x41c500={};if(_0x3e008f!=null){for(var _0x31841d in _0x3e008f)if(_0x31841d!==_0x28b28d(0x139)&&Object[_0x28b28d(0x127)][_0x28b28d(0x153)]['call'](_0x3e008f,_0x31841d))__createBinding(_0x41c500,_0x3e008f,_0x31841d);}return __setModuleDefault(_0x41c500,_0x3e008f),_0x41c500;},__importDefault=this&&this['__importDefault']||function(_0x206323){const _0x576f58=a26_0x2692f9;return _0x206323&&_0x206323[_0x576f58(0xdb)]?_0x206323:{'default':_0x206323};};Object[a26_0x2692f9(0xd9)](exports,a26_0x2692f9(0xdb),{'value':!![]}),exports[a26_0x2692f9(0xf9)]=exports[a26_0x2692f9(0xef)]=exports[a26_0x2692f9(0x135)]=exports[a26_0x2692f9(0x15e)]=exports[a26_0x2692f9(0x15c)]=exports[a26_0x2692f9(0x121)]=exports[a26_0x2692f9(0x11f)]=exports['getAll']=exports[a26_0x2692f9(0x10f)]=exports[a26_0x2692f9(0xfa)]=void 0x0;const AppError_1=__importDefault(require(a26_0x2692f9(0xfb))),SetTicketMessagesAsRead_1=__importDefault(require(a26_0x2692f9(0x117))),socket_1=require(a26_0x2692f9(0x104)),Message_1=__importDefault(require(a26_0x2692f9(0x143))),Ticket_1=__importDefault(require(a26_0x2692f9(0x13f))),Queue_1=__importDefault(require(a26_0x2692f9(0xcf))),User_1=__importDefault(require(a26_0x2692f9(0x122))),Whatsapp_1=__importDefault(require(a26_0x2692f9(0xf8))),Mustache_1=__importDefault(require('../helpers/Mustache')),ListMessagesService_1=__importDefault(require(a26_0x2692f9(0xde))),ShowTicketService_1=__importDefault(require('../services/TicketServices/ShowTicketService')),FindOrCreateTicketService_1=__importDefault(require('../services/TicketServices/FindOrCreateTicketService')),UpdateTicketService_1=__importDefault(require(a26_0x2692f9(0x100))),DeleteWhatsAppMessage_1=__importDefault(require('../services/WbotServices/DeleteWhatsAppMessage')),SendWhatsAppMedia_1=__importStar(require('../services/WbotServices/SendWhatsAppMedia')),SendWhatsAppMessage_1=__importDefault(require(a26_0x2692f9(0xf4))),SendWhatsAppReaction_1=__importDefault(require(a26_0x2692f9(0xed))),CheckNumber_1=__importDefault(require('../services/WbotServices/CheckNumber')),EditWhatsAppMessage_1=__importDefault(require(a26_0x2692f9(0x11b))),TranslateAudioService_1=__importDefault(require(a26_0x2692f9(0x128))),CreateOrUpdateContactService_1=__importDefault(require(a26_0x2692f9(0xfc))),ShowMessageService_1=__importStar(require(a26_0x2692f9(0x120))),ShowContactService_1=require(a26_0x2692f9(0x11e)),ShowUserService_1=__importDefault(require(a26_0x2692f9(0xdd))),user_1=require(a26_0x2692f9(0x12e)),UpdateTicketService_2=require(a26_0x2692f9(0x100)),ListAllMessagesService_1=__importDefault(require(a26_0x2692f9(0x142))),validator_1=require(a26_0x2692f9(0x14f)),ffmpeg_static_1=__importDefault(require(a26_0x2692f9(0x133))),fluent_ffmpeg_1=__importDefault(require(a26_0x2692f9(0x12d))),crypto_1=__importDefault(require(a26_0x2692f9(0xd2))),GetWhatsappWbot_1=__importDefault(require(a26_0x2692f9(0x123))),wbot_1=require(a26_0x2692f9(0x101)),SendPresenceStatus_1=require(a26_0x2692f9(0xe3));fluent_ffmpeg_1['default'][a26_0x2692f9(0x124)](ffmpeg_static_1['default']);const index=async(_0x374be5,_0x438346)=>{const _0x588d51=a26_0x2692f9,{ticketId:_0x4248b8}=_0x374be5[_0x588d51(0xd8)],{pageNumber:_0xe1d01a}=_0x374be5[_0x588d51(0x113)],{companyId:_0x41288d,profile:_0x55079e}=_0x374be5[_0x588d51(0x129)],_0x2d80a9=[];if(_0x55079e!==_0x588d51(0x134)){const _0x4916dd=await User_1['default']['findByPk'](_0x374be5[_0x588d51(0x129)]['id'],{'include':[{'model':Queue_1['default'],'as':_0x588d51(0xd1)}]});_0x4916dd[_0x588d51(0xd1)][_0x588d51(0x107)](_0x3a4ded=>{const _0x45f0a2=_0x588d51;_0x2d80a9[_0x45f0a2(0xfe)](_0x3a4ded['id']);});}const {count:_0x57143c,messages:_0x47e39b,ticket:_0x1cb00b,hasMore:_0x1b1947}=await(0x0,ListMessagesService_1[_0x588d51(0x139)])({'pageNumber':_0xe1d01a,'ticketId':_0x4248b8,'companyId':_0x41288d,'queues':_0x2d80a9});return(0x0,SetTicketMessagesAsRead_1[_0x588d51(0x139)])(_0x1cb00b),_0x438346[_0x588d51(0xf1)]({'count':_0x57143c,'messages':_0x47e39b,'ticket':_0x1cb00b,'hasMore':_0x1b1947});};exports[a26_0x2692f9(0xfa)]=index;const store=async(_0x899ffa,_0x512f8b)=>{const _0x203a84=a26_0x2692f9,{ticketId:_0x43d958}=_0x899ffa[_0x203a84(0xd8)],{body:_0x13f53c,quotedMsg:_0xe9a273,vCard:_0x5a3882}=_0x899ffa['body'],_0x3e2046=_0x899ffa['files'],{companyId:_0x501cf6,id:_0x4d8c7a}=_0x899ffa[_0x203a84(0x129)],_0xe0a10a=await(0x0,ShowTicketService_1[_0x203a84(0x139)])(_0x43d958,_0x501cf6);_0xe0a10a[_0x203a84(0xd3)]!=='open'&&await(0x0,UpdateTicketService_1[_0x203a84(0x139)])({'ticketId':_0xe0a10a['id'],'ticketData':{'status':'open','userId':parseInt(_0x4d8c7a)},'companyId':_0x501cf6});if(_0xe0a10a[_0x203a84(0xf6)]>0x0)(0x0,SetTicketMessagesAsRead_1[_0x203a84(0x139)])(_0xe0a10a);if(_0x3e2046)await Promise['all'](_0x3e2046[_0x203a84(0x15d)](async(_0x173d3b,_0x9e7773)=>{const _0x4dc523=_0x203a84;return(0x0,SendWhatsAppMedia_1[_0x4dc523(0x139)])({'media':_0x173d3b,'ticket':_0xe0a10a,'body':Array[_0x4dc523(0x131)](_0x13f53c)?_0x13f53c[_0x9e7773]:_0x13f53c});}));else{const _0x33dc0c=await(0x0,SendWhatsAppMessage_1[_0x203a84(0x139)])({'body':_0x13f53c,'ticket':_0xe0a10a,'quotedMsg':_0xe9a273,'vCard':_0x5a3882});}return _0x512f8b[_0x203a84(0x15e)]();};exports[a26_0x2692f9(0x10f)]=store;const getAll=async(_0x191062,_0x5267d0)=>{const _0x5ed4db=a26_0x2692f9,_0x115bbe=_0x191062['query']['dateStart'],_0x464b49=_0x191062[_0x5ed4db(0x113)]['dateEnd'],_0x298669=(0x0,validator_1[_0x5ed4db(0x151)])(_0x191062[_0x5ed4db(0x113)][_0x5ed4db(0x150)]),{companyId:_0x2ef6b3}=_0x191062[_0x5ed4db(0x129)],{count:_0x8e0ee5}=await(0x0,ListAllMessagesService_1[_0x5ed4db(0x139)])({'companyId':_0x2ef6b3,'fromMe':_0x298669,'dateStart':_0x115bbe,'dateEnd':_0x464b49});return _0x5267d0['json']({'count':_0x8e0ee5});};exports[a26_0x2692f9(0xe9)]=getAll;const edit=async(_0x5d5b1c,_0xa7727d)=>{const _0x24533e=a26_0x2692f9,{messageId:_0x56ca07}=_0x5d5b1c[_0x24533e(0xd8)],{companyId:_0x38ec4a}=_0x5d5b1c[_0x24533e(0x129)],{body:_0x25d069}=_0x5d5b1c[_0x24533e(0x146)],{ticketId:_0x44315c,message:_0x13e310}=await(0x0,EditWhatsAppMessage_1[_0x24533e(0x139)])({'messageId':_0x56ca07,'companyId':_0x38ec4a,'body':_0x25d069}),_0x3e7610=(0x0,socket_1['getIO'])();return _0x3e7610['to'](_0x44315c[_0x24533e(0x11a)]())[_0x24533e(0x130)](_0x24533e(0xcd)+_0x38ec4a+_0x24533e(0xe5),{'action':'update','message':_0x13e310}),_0xa7727d[_0x24533e(0x15e)]();};exports[a26_0x2692f9(0x11f)]=edit;const remove=async(_0x1feee6,_0x45179d)=>{const _0x1db55a=a26_0x2692f9,{messageId:_0x1ff72e}=_0x1feee6[_0x1db55a(0xd8)],{companyId:_0xab2d0b}=_0x1feee6['user'],_0x5a8434=await(0x0,DeleteWhatsAppMessage_1[_0x1db55a(0x139)])(_0x1ff72e),_0x2cb3f3=(0x0,socket_1['getIO'])();return _0x2cb3f3['to'](_0x5a8434['ticketId']['toString']())[_0x1db55a(0x130)](_0x1db55a(0xcd)+_0xab2d0b+_0x1db55a(0xe5),{'action':'update','message':_0x5a8434}),_0x45179d[_0x1db55a(0x15e)]();};exports[a26_0x2692f9(0x121)]=remove;const typing=async(_0x1bd362,_0x35f004)=>{const _0xa6ff3d=a26_0x2692f9,{ticketId:_0x442a98}=_0x1bd362[_0xa6ff3d(0xd8)],{companyId:_0xf635b4}=_0x1bd362['user'],{status:_0x2c30f7}=_0x1bd362['query'];if(!_0x442a98)return _0x35f004[_0xa6ff3d(0xd3)](0x190)[_0xa6ff3d(0x15e)]('TicketId\x20is\x20required');const _0x20b8ab=await(0x0,ShowTicketService_1[_0xa6ff3d(0x139)])(_0x442a98,_0xf635b4);if(!_0x20b8ab)return _0x35f004[_0xa6ff3d(0xd3)](0x194)['send']('Ticket\x20not\x20found');let _0x59d40c=(0x0,wbot_1[_0xa6ff3d(0x110)])(_0x20b8ab[_0xa6ff3d(0xe1)]);return _0x2c30f7==_0xa6ff3d(0x148)?await(0x0,SendPresenceStatus_1[_0xa6ff3d(0x147)])(_0x59d40c,_0x20b8ab[_0xa6ff3d(0x14a)][_0xa6ff3d(0x15b)]+'@'+(_0x20b8ab[_0xa6ff3d(0x12a)]?_0xa6ff3d(0x140):_0xa6ff3d(0x158))):await(0x0,SendPresenceStatus_1[_0xa6ff3d(0xea)])(_0x59d40c,_0x20b8ab[_0xa6ff3d(0x14a)][_0xa6ff3d(0x15b)]+'@'+(_0x20b8ab[_0xa6ff3d(0x12a)]?_0xa6ff3d(0x140):_0xa6ff3d(0x158))),_0x35f004[_0xa6ff3d(0xd3)](0xc8)['send'](_0xa6ff3d(0xe0)+_0x2c30f7+_0xa6ff3d(0x116));};exports[a26_0x2692f9(0x15c)]=typing;const send=async(_0x6c72c7,_0x3a52f8)=>{const _0x3ee97f=a26_0x2692f9,{whatsappId:_0x2ab3f8}=_0x6c72c7['params'],_0xbc31c0=_0x6c72c7[_0x3ee97f(0x146)],_0x4b712f=_0x6c72c7[_0x3ee97f(0xdc)];try{const _0x2bb4c9=await Whatsapp_1[_0x3ee97f(0x139)][_0x3ee97f(0x141)](_0x2ab3f8);if(!_0x2bb4c9)throw new Error(_0x3ee97f(0x10b));if(_0xbc31c0[_0x3ee97f(0x15b)]===undefined)throw new Error('O\x20número\x20é\x20obrigatório');const _0x21620b=_0xbc31c0['number'],_0x35e3af=_0xbc31c0['body'],_0x3cc3a3=_0x2bb4c9[_0x3ee97f(0x12c)],_0x403543=await(0x0,CheckNumber_1[_0x3ee97f(0x139)])(_0x21620b,_0x3cc3a3);var _0x3415c1=_0x403543[_0x3ee97f(0xfd)][_0x3ee97f(0x155)](_0x3ee97f(0xe4));console['log'](_0x3415c1);const _0x4427e1=_0x403543[_0x3ee97f(0xfd)][_0x3ee97f(0x132)](_0x3ee97f(0x14c),'')[_0x3ee97f(0x132)](_0x3ee97f(0xe4),''),_0x46dbdb={'name':''+_0x4427e1,'number':_0x4427e1,'isGroup':_0x3415c1,'companyId':_0x3cc3a3},_0x464c77=await(0x0,GetWhatsappWbot_1[_0x3ee97f(0x139)])(_0x2bb4c9),_0x473971=await(0x0,CreateOrUpdateContactService_1[_0x3ee97f(0x139)])(_0x46dbdb,_0x464c77,_0x403543[_0x3ee97f(0xfd)]),_0x3bb26f=await(0x0,FindOrCreateTicketService_1[_0x3ee97f(0x139)])(_0x473971,_0x2bb4c9['id'],0x0,_0x3cc3a3);return _0x4b712f?await Promise[_0x3ee97f(0x145)](_0x4b712f[_0x3ee97f(0x15d)](async _0x2fe9f3=>{const _0x1767cb=_0x3ee97f;await _0x6c72c7[_0x1767cb(0xce)][_0x1767cb(0x10a)](_0x1767cb(0xd1))[_0x1767cb(0x11d)][_0x1767cb(0x13e)](_0x1767cb(0x125),{'whatsappId':_0x2ab3f8,'data':{'number':_0x4427e1,'body':_0x35e3af?(0x0,Mustache_1[_0x1767cb(0x139)])(_0x35e3af,_0x3bb26f):_0x2fe9f3[_0x1767cb(0x152)],'mediaPath':_0x2fe9f3['path'],'finalName':_0x2fe9f3[_0x1767cb(0x13d)],'fileName':_0x2fe9f3[_0x1767cb(0x152)]}},{'removeOnComplete':!![],'attempts':0x3});})):await(0x0,SendWhatsAppMessage_1['default'])({'body':(0x0,Mustache_1['default'])(_0x35e3af,_0x3bb26f),'ticket':_0x3bb26f}),_0xbc31c0['closeTicket']&&setTimeout(async()=>{const _0x1f7cdd=_0x3ee97f;await(0x0,UpdateTicketService_1[_0x1f7cdd(0x139)])({'ticketId':_0x3bb26f['id'],'ticketData':{'status':_0x1f7cdd(0xd5)},'companyId':_0x3cc3a3});},0x3e8),await(0x0,SetTicketMessagesAsRead_1[_0x3ee97f(0x139)])(_0x3bb26f),_0x3a52f8[_0x3ee97f(0x15e)]({'mensagem':_0x3ee97f(0x15f)});}catch(_0x1c1448){console[_0x3ee97f(0xe6)](_0x1c1448);if(Object[_0x3ee97f(0x118)](_0x1c1448)[_0x3ee97f(0xf2)]===0x0)throw new AppError_1['default'](_0x3ee97f(0x12b));else throw new AppError_1['default'](_0x1c1448[_0x3ee97f(0x105)]);}};exports['send']=send;const addReaction=async(_0x45b543,_0x22b875)=>{const _0x57d1e5=a26_0x2692f9;try{const {messageId:_0x2d8564}=_0x45b543[_0x57d1e5(0xd8)],{type:_0x42a850}=_0x45b543[_0x57d1e5(0x146)],{companyId:_0x50f5e4,id:_0x1fde2e}=_0x45b543[_0x57d1e5(0x129)],_0x550387=await Message_1['default'][_0x57d1e5(0x141)](_0x2d8564),_0x268a83=await Ticket_1['default'][_0x57d1e5(0x141)](_0x550387[_0x57d1e5(0x149)],{'include':[_0x57d1e5(0x14a)]});if(!_0x550387)return _0x22b875[_0x57d1e5(0xd3)](0x194)[_0x57d1e5(0x15e)]({'message':_0x57d1e5(0xeb)});const _0x27c0c7=await(0x0,SendWhatsAppReaction_1[_0x57d1e5(0x139)])({'messageId':_0x2d8564,'ticket':_0x268a83,'reactionType':_0x42a850}),_0x4f1e67=await _0x550387[_0x57d1e5(0xf0)]({'reactions':[..._0x550387['reactions'],{'type':_0x42a850,'userId':_0x1fde2e}]}),_0x57992e=(0x0,socket_1[_0x57d1e5(0x12f)])();return _0x57992e['to'](_0x550387['ticketId'][_0x57d1e5(0x11a)]())['emit'](_0x57d1e5(0xcd)+_0x50f5e4+_0x57d1e5(0xe5),{'action':_0x57d1e5(0xf0),'message':_0x550387}),_0x22b875['status'](0xc8)[_0x57d1e5(0x15e)]({'message':_0x57d1e5(0x156),'reactionResult':_0x27c0c7,'reactions':_0x4f1e67[_0x57d1e5(0x138)]});}catch(_0x465c49){console['error']('Erro\x20ao\x20adicionar\x20reação:',_0x465c49);if(_0x465c49 instanceof AppError_1[_0x57d1e5(0x139)])return _0x22b875[_0x57d1e5(0xd3)](0x190)[_0x57d1e5(0x15e)]({'message':_0x465c49['message']});return _0x22b875[_0x57d1e5(0xd3)](0x1f4)[_0x57d1e5(0x15e)]({'message':_0x57d1e5(0x13a),'error':_0x465c49[_0x57d1e5(0x105)]});}};function a26_0x1963(_0x2c5a60,_0x18c69e){const _0x10ae5b=a26_0x53f6();return a26_0x1963=function(_0x38fbb5,_0x15c07b){_0x38fbb5=_0x38fbb5-0xcc;let _0x53f6d6=_0x10ae5b[_0x38fbb5];return _0x53f6d6;},a26_0x1963(_0x2c5a60,_0x18c69e);}exports[a26_0x2692f9(0x135)]=addReaction;const storeAudio=async(_0x34d4eb,_0x4d1605)=>{const _0x16e89f=a26_0x2692f9,_0x4bba65=_0x34d4eb[_0x16e89f(0x129)][_0x16e89f(0x12c)],_0x5f2a60=_0x34d4eb[_0x16e89f(0xf7)];let _0xc4d0f9='';const _0x445f39=generateRandomFilename(),_0x18df7a='./public/company'+_0x4bba65+'/'+_0x445f39;return await convertToMp3(_0x5f2a60[_0x16e89f(0x106)],_0x18df7a),_0x5f2a60&&(_0xc4d0f9=await(0x0,TranslateAudioService_1['default'])(_0x18df7a)),_0x4d1605['send'](_0xc4d0f9||_0x16e89f(0x13b));};exports[a26_0x2692f9(0xef)]=storeAudio;function convertToMp3(_0x46805d,_0x5b45a4){return new Promise((_0x368e2d,_0x5c93a7)=>{const _0x30c19c=a26_0x1963;(0x0,fluent_ffmpeg_1[_0x30c19c(0x139)])(_0x46805d)['toFormat'](_0x30c19c(0xe2))['on'](_0x30c19c(0xe7),()=>{_0x368e2d(_0x5b45a4);})['on']('error',_0x3be59b=>{const _0x4dd2c7=_0x30c19c;console[_0x4dd2c7(0x109)](_0x4dd2c7(0x111),_0x3be59b),_0x5c93a7(_0x3be59b);})[_0x30c19c(0x136)](_0x5b45a4);});}function generateRandomFilename(){const _0x4ee9d1=a26_0x2692f9,_0x4da47f=crypto_1['default'][_0x4ee9d1(0x10d)](0x10)['toString'](_0x4ee9d1(0xec));return _0x4da47f+_0x4ee9d1(0x103);}const forwardMessage=async(_0x4e6111,_0x2b8143)=>{const _0x4c27a6=a26_0x2692f9;console[_0x4c27a6(0xe6)](_0x4c27a6(0xee));const {body:_0x30f37,quotedMsg:_0x320abc}=_0x4e6111['body'],_0x3948f9=_0x4e6111[_0x4c27a6(0x146)][_0x4c27a6(0xda)],_0x3e4712=_0x4e6111['body'][_0x4c27a6(0x144)];if(!_0x3948f9||!_0x3e4712)return _0x2b8143[_0x4c27a6(0xd3)](0xc8)[_0x4c27a6(0x15e)]('MessageId\x20or\x20ContactId\x20not\x20found');const _0x42d017=await(0x0,ShowMessageService_1['default'])(_0x3948f9),_0x46f5cd=await(0x0,ShowContactService_1[_0x4c27a6(0xf3)])(_0x3e4712);if(!_0x42d017)return _0x2b8143[_0x4c27a6(0xd3)](0x194)[_0x4c27a6(0x15e)](_0x4c27a6(0x14e));if(!_0x46f5cd)return _0x2b8143[_0x4c27a6(0xd3)](0x194)[_0x4c27a6(0x15e)](_0x4c27a6(0xe8));const _0x4bb89a=await(0x0,ShowMessageService_1[_0x4c27a6(0x119)])(_0x42d017);if(!_0x4bb89a)return _0x2b8143[_0x4c27a6(0xd3)](0x194)[_0x4c27a6(0x15e)](_0x4c27a6(0x112));const _0x581a74=_0x4e6111['user'][_0x4c27a6(0x12c)],_0x5906d0=await(0x0,FindOrCreateTicketService_1[_0x4c27a6(0x139)])(_0x46f5cd,_0x4bb89a,0x0,_0x581a74);await(0x0,SetTicketMessagesAsRead_1[_0x4c27a6(0x139)])(_0x5906d0);_0x42d017[_0x4c27a6(0xcc)]===_0x4c27a6(0x15a)||_0x42d017['mediaType']===_0x4c27a6(0x115)?await(0x0,SendWhatsAppMessage_1[_0x4c27a6(0x139)])({'body':_0x42d017[_0x4c27a6(0x146)],'ticket':_0x5906d0,'quotedMsg':_0x320abc}):await(0x0,SendWhatsAppMedia_1['SendWhatsAppMediaFileAddress'])(_0x42d017['mediaUrl']||'',_0x5906d0,_0x42d017[_0x4c27a6(0x146)]);const _0x32b05e=await(0x0,ShowUserService_1['default'])(_0x4e6111[_0x4c27a6(0x129)]['id']),_0x17b4ce=await(0x0,user_1['firstQueueThisUser'])(_0x32b05e);_0x5906d0[_0x4c27a6(0xd3)]=_0x4c27a6(0x13c),_0x5906d0[_0x4c27a6(0xd4)]=_0x17b4ce?.['id']||null,_0x5906d0[_0x4c27a6(0x126)]=_0x32b05e['id'],_0x5906d0[_0x4c27a6(0x14d)]();const _0x4fd626=(0x0,socket_1['getIO'])();return(0x0,UpdateTicketService_2['notifyUpdate'])(_0x4fd626,_0x5906d0,_0x5906d0['id'],_0x581a74),_0x2b8143[_0x4c27a6(0x15e)]();};exports[a26_0x2692f9(0xf9)]=forwardMessage;