const a26_0x3f6d6e=a26_0x4522;(function(_0x4d3e40,_0x3e916a){const _0x4ffa11=a26_0x4522,_0x1ea31f=_0x4d3e40();while(!![]){try{const _0x2b2c7d=parseInt(_0x4ffa11(0x17e))/0x1*(parseInt(_0x4ffa11(0x199))/0x2)+parseInt(_0x4ffa11(0x181))/0x3*(parseInt(_0x4ffa11(0x15a))/0x4)+parseInt(_0x4ffa11(0x17f))/0x5*(-parseInt(_0x4ffa11(0x171))/0x6)+-parseInt(_0x4ffa11(0x182))/0x7+-parseInt(_0x4ffa11(0x191))/0x8*(-parseInt(_0x4ffa11(0x192))/0x9)+-parseInt(_0x4ffa11(0x183))/0xa+parseInt(_0x4ffa11(0x188))/0xb;if(_0x2b2c7d===_0x3e916a)break;else _0x1ea31f['push'](_0x1ea31f['shift']());}catch(_0x520d92){_0x1ea31f['push'](_0x1ea31f['shift']());}}}(a26_0x557c,0xe16ee));const a26_0x20e336=(function(){let _0x3213ba=!![];return function(_0x1d3067,_0x457aad){const _0x26a966=_0x3213ba?function(){const _0x5ea85e=a26_0x4522;if(_0x457aad){const _0x45743e=_0x457aad[_0x5ea85e(0x13c)](_0x1d3067,arguments);return _0x457aad=null,_0x45743e;}}:function(){};return _0x3213ba=![],_0x26a966;};}()),a26_0x2c0209=a26_0x20e336(this,function(){const _0xe6f122=a26_0x4522;return a26_0x2c0209[_0xe6f122(0x16b)]()[_0xe6f122(0x134)](_0xe6f122(0x147))[_0xe6f122(0x16b)]()[_0xe6f122(0x1a5)](a26_0x2c0209)[_0xe6f122(0x134)](_0xe6f122(0x147));});a26_0x2c0209();'use strict';var __createBinding=this&&this[a26_0x3f6d6e(0x1ba)]||(Object[a26_0x3f6d6e(0x158)]?function(_0x40d60d,_0xada685,_0x503010,_0x4c4c71){const _0x536c7d=a26_0x3f6d6e;if(_0x4c4c71===undefined)_0x4c4c71=_0x503010;var _0x4a9149=Object['getOwnPropertyDescriptor'](_0xada685,_0x503010);(!_0x4a9149||('get'in _0x4a9149?!_0xada685[_0x536c7d(0x1a1)]:_0x4a9149['writable']||_0x4a9149['configurable']))&&(_0x4a9149={'enumerable':!![],'get':function(){return _0xada685[_0x503010];}}),Object[_0x536c7d(0x18a)](_0x40d60d,_0x4c4c71,_0x4a9149);}:function(_0x513365,_0x40bbd1,_0x48801e,_0x2da6b2){if(_0x2da6b2===undefined)_0x2da6b2=_0x48801e;_0x513365[_0x2da6b2]=_0x40bbd1[_0x48801e];}),__setModuleDefault=this&&this[a26_0x3f6d6e(0x1b6)]||(Object[a26_0x3f6d6e(0x158)]?function(_0x58dc58,_0x35097b){const _0x2a2825=a26_0x3f6d6e;Object[_0x2a2825(0x18a)](_0x58dc58,_0x2a2825(0x18e),{'enumerable':!![],'value':_0x35097b});}:function(_0x2a556f,_0x48c12e){const _0x422e68=a26_0x3f6d6e;_0x2a556f[_0x422e68(0x18e)]=_0x48c12e;}),__importStar=this&&this[a26_0x3f6d6e(0x13b)]||function(_0xdfc6be){const _0x43028e=a26_0x3f6d6e;if(_0xdfc6be&&_0xdfc6be[_0x43028e(0x1a1)])return _0xdfc6be;var _0x4fc1ef={};if(_0xdfc6be!=null){for(var _0x3ca22c in _0xdfc6be)if(_0x3ca22c!==_0x43028e(0x18e)&&Object[_0x43028e(0x1b9)][_0x43028e(0x149)][_0x43028e(0x154)](_0xdfc6be,_0x3ca22c))__createBinding(_0x4fc1ef,_0xdfc6be,_0x3ca22c);}return __setModuleDefault(_0x4fc1ef,_0xdfc6be),_0x4fc1ef;},__importDefault=this&&this[a26_0x3f6d6e(0x151)]||function(_0x1635ba){const _0x4093f9=a26_0x3f6d6e;return _0x1635ba&&_0x1635ba[_0x4093f9(0x1a1)]?_0x1635ba:{'default':_0x1635ba};};Object[a26_0x3f6d6e(0x18a)](exports,a26_0x3f6d6e(0x1a1),{'value':!![]}),exports['forwardMessage']=exports['storeAudio']=exports['addReaction']=exports[a26_0x3f6d6e(0x1ae)]=exports['typing']=exports[a26_0x3f6d6e(0x164)]=exports['edit']=exports[a26_0x3f6d6e(0x141)]=exports[a26_0x3f6d6e(0x16a)]=exports[a26_0x3f6d6e(0x138)]=void 0x0;const AppError_1=__importDefault(require(a26_0x3f6d6e(0x140))),SetTicketMessagesAsRead_1=__importDefault(require(a26_0x3f6d6e(0x15e))),socket_1=require(a26_0x3f6d6e(0x159)),Message_1=__importDefault(require(a26_0x3f6d6e(0x16e))),Ticket_1=__importDefault(require(a26_0x3f6d6e(0x1b1))),Queue_1=__importDefault(require(a26_0x3f6d6e(0x14f))),User_1=__importDefault(require(a26_0x3f6d6e(0x19a))),Whatsapp_1=__importDefault(require(a26_0x3f6d6e(0x13a))),Mustache_1=__importDefault(require(a26_0x3f6d6e(0x1b8))),ListMessagesService_1=__importDefault(require(a26_0x3f6d6e(0x1b7))),ShowTicketService_1=__importDefault(require(a26_0x3f6d6e(0x184))),FindOrCreateTicketService_1=__importDefault(require('../services/TicketServices/FindOrCreateTicketService')),UpdateTicketService_1=__importDefault(require(a26_0x3f6d6e(0x1b2))),DeleteWhatsAppMessage_1=__importDefault(require(a26_0x3f6d6e(0x17d))),SendWhatsAppMedia_1=__importStar(require(a26_0x3f6d6e(0x180))),SendWhatsAppMessage_1=__importDefault(require(a26_0x3f6d6e(0x16c))),SendWhatsAppReaction_1=__importDefault(require(a26_0x3f6d6e(0x15b))),CheckNumber_1=__importDefault(require(a26_0x3f6d6e(0x135))),EditWhatsAppMessage_1=__importDefault(require(a26_0x3f6d6e(0x144))),TranslateAudioService_1=__importDefault(require('../services/MessageServices/TranslateAudioService')),CreateOrUpdateContactService_1=__importDefault(require(a26_0x3f6d6e(0x1a4))),ShowMessageService_1=__importStar(require(a26_0x3f6d6e(0x145))),ShowContactService_1=require(a26_0x3f6d6e(0x1a0)),ShowUserService_1=__importDefault(require('../services/UserServices/ShowUserService')),user_1=require(a26_0x3f6d6e(0x174)),UpdateTicketService_2=require('../services/TicketServices/UpdateTicketService'),ListAllMessagesService_1=__importDefault(require(a26_0x3f6d6e(0x17a))),validator_1=require(a26_0x3f6d6e(0x16f)),ffmpeg_static_1=__importDefault(require(a26_0x3f6d6e(0x1c2))),fluent_ffmpeg_1=__importDefault(require('fluent-ffmpeg')),crypto_1=__importDefault(require(a26_0x3f6d6e(0x146))),GetWhatsappWbot_1=__importDefault(require(a26_0x3f6d6e(0x13f))),wbot_1=require(a26_0x3f6d6e(0x167)),SendPresenceStatus_1=require(a26_0x3f6d6e(0x18d));fluent_ffmpeg_1[a26_0x3f6d6e(0x18e)][a26_0x3f6d6e(0x1a3)](ffmpeg_static_1['default']);const index=async(_0x524396,_0x58aaaa)=>{const _0xd2614e=a26_0x3f6d6e,{ticketId:_0x4a75e0}=_0x524396[_0xd2614e(0x19b)],{pageNumber:_0x5985b8}=_0x524396[_0xd2614e(0x172)],{companyId:_0x1364ac,profile:_0x404396}=_0x524396['user'],_0x3a3bcb=[];if(_0x404396!=='admin'){const _0x136297=await User_1[_0xd2614e(0x18e)][_0xd2614e(0x190)](_0x524396[_0xd2614e(0x1b3)]['id'],{'include':[{'model':Queue_1[_0xd2614e(0x18e)],'as':_0xd2614e(0x195)}]});_0x136297['queues'][_0xd2614e(0x142)](_0x3159c4=>{_0x3a3bcb['push'](_0x3159c4['id']);});}const {count:_0x4ace22,messages:_0x19becc,ticket:_0x3d5bf1,hasMore:_0x46131e}=await(0x0,ListMessagesService_1['default'])({'pageNumber':_0x5985b8,'ticketId':_0x4a75e0,'companyId':_0x1364ac,'queues':_0x3a3bcb});return(0x0,SetTicketMessagesAsRead_1['default'])(_0x3d5bf1),_0x58aaaa[_0xd2614e(0x197)]({'count':_0x4ace22,'messages':_0x19becc,'ticket':_0x3d5bf1,'hasMore':_0x46131e});};exports[a26_0x3f6d6e(0x138)]=index;function a26_0x4522(_0x1cf570,_0x3af22c){const _0x21d3ac=a26_0x557c();return a26_0x4522=function(_0x2c0209,_0x20e336){_0x2c0209=_0x2c0209-0x12f;let _0x557c66=_0x21d3ac[_0x2c0209];return _0x557c66;},a26_0x4522(_0x1cf570,_0x3af22c);}const store=async(_0x16e175,_0x21d4ff)=>{const _0x4d0de7=a26_0x3f6d6e,{ticketId:_0x4a3dba}=_0x16e175[_0x4d0de7(0x19b)],{body:_0x4a8094,quotedMsg:_0x2dc721,vCard:_0x517d75}=_0x16e175[_0x4d0de7(0x17c)],_0x84ad6b=_0x16e175[_0x4d0de7(0x198)],{companyId:_0x3debe9,id:_0x5d7c35}=_0x16e175[_0x4d0de7(0x1b3)],_0x2d5ff2=await(0x0,ShowTicketService_1[_0x4d0de7(0x18e)])(_0x4a3dba,_0x3debe9);_0x2d5ff2[_0x4d0de7(0x130)]!==_0x4d0de7(0x1a7)&&await(0x0,UpdateTicketService_1[_0x4d0de7(0x18e)])({'ticketId':_0x2d5ff2['id'],'ticketData':{'status':_0x4d0de7(0x1a7),'userId':parseInt(_0x5d7c35)},'companyId':_0x3debe9});if(_0x2d5ff2[_0x4d0de7(0x1ac)]>0x0)(0x0,SetTicketMessagesAsRead_1[_0x4d0de7(0x18e)])(_0x2d5ff2);if(_0x84ad6b)await Promise[_0x4d0de7(0x1af)](_0x84ad6b[_0x4d0de7(0x1c5)](async(_0x3ff110,_0x2249c5)=>{const _0x4abe2a=_0x4d0de7;return(0x0,SendWhatsAppMedia_1[_0x4abe2a(0x18e)])({'media':_0x3ff110,'ticket':_0x2d5ff2,'body':Array[_0x4abe2a(0x14d)](_0x4a8094)?_0x4a8094[_0x2249c5]:_0x4a8094});}));else{const _0x559f89=await(0x0,SendWhatsAppMessage_1[_0x4d0de7(0x18e)])({'body':_0x4a8094,'ticket':_0x2d5ff2,'quotedMsg':_0x2dc721,'vCard':_0x517d75});}return _0x21d4ff['send']();};exports[a26_0x3f6d6e(0x16a)]=store;const getAll=async(_0x57919a,_0x399068)=>{const _0x25df5a=a26_0x3f6d6e,_0x1cb334=_0x57919a[_0x25df5a(0x172)]['dateStart'],_0x5709f2=_0x57919a[_0x25df5a(0x172)][_0x25df5a(0x19e)],_0x1d7875=(0x0,validator_1[_0x25df5a(0x152)])(_0x57919a[_0x25df5a(0x172)][_0x25df5a(0x189)]),{companyId:_0xdd7b5a}=_0x57919a[_0x25df5a(0x1b3)],{count:_0x4e4495}=await(0x0,ListAllMessagesService_1[_0x25df5a(0x18e)])({'companyId':_0xdd7b5a,'fromMe':_0x1d7875,'dateStart':_0x1cb334,'dateEnd':_0x5709f2});return _0x399068[_0x25df5a(0x197)]({'count':_0x4e4495});};exports[a26_0x3f6d6e(0x141)]=getAll;const edit=async(_0x3d7adc,_0x9831c3)=>{const _0x612bee=a26_0x3f6d6e,{messageId:_0x12fdae}=_0x3d7adc[_0x612bee(0x19b)],{companyId:_0x1a4ed2}=_0x3d7adc[_0x612bee(0x1b3)],{body:_0x5c86e1}=_0x3d7adc['body'],{ticketId:_0x7bda45,message:_0x5000f4}=await(0x0,EditWhatsAppMessage_1['default'])({'messageId':_0x12fdae,'companyId':_0x1a4ed2,'body':_0x5c86e1}),_0x2e3a53=(0x0,socket_1[_0x612bee(0x156)])();return _0x2e3a53['to'](_0x7bda45[_0x612bee(0x16b)]())[_0x612bee(0x16d)]('company-'+_0x1a4ed2+_0x612bee(0x185),{'action':'update','message':_0x5000f4}),_0x9831c3['send']();};exports[a26_0x3f6d6e(0x155)]=edit;const remove=async(_0x5ad3ee,_0x3d8415)=>{const _0x839a1d=a26_0x3f6d6e,{messageId:_0x1e0070}=_0x5ad3ee[_0x839a1d(0x19b)],{companyId:_0x137175}=_0x5ad3ee['user'],_0x529c0f=await(0x0,DeleteWhatsAppMessage_1[_0x839a1d(0x18e)])(_0x1e0070),_0xc00bb5=(0x0,socket_1[_0x839a1d(0x156)])();return _0xc00bb5['to'](_0x529c0f[_0x839a1d(0x19f)]['toString']())[_0x839a1d(0x16d)](_0x839a1d(0x1be)+_0x137175+_0x839a1d(0x185),{'action':_0x839a1d(0x186),'message':_0x529c0f}),_0x3d8415[_0x839a1d(0x1ae)]();};exports[a26_0x3f6d6e(0x164)]=remove;const typing=async(_0x2aff19,_0x95ab91)=>{const _0x5e0794=a26_0x3f6d6e,{ticketId:_0x62645f}=_0x2aff19[_0x5e0794(0x19b)],{companyId:_0x404483}=_0x2aff19['user'],{status:_0x4d876e}=_0x2aff19[_0x5e0794(0x172)];if(!_0x62645f)return _0x95ab91['status'](0x190)['send'](_0x5e0794(0x1bd));const _0x45b7ba=await(0x0,ShowTicketService_1['default'])(_0x62645f,_0x404483);if(!_0x45b7ba)return _0x95ab91[_0x5e0794(0x130)](0x194)['send'](_0x5e0794(0x1ab));let _0x50ec43=(0x0,wbot_1[_0x5e0794(0x178)])(_0x45b7ba[_0x5e0794(0x136)]);return _0x4d876e=='true'?await(0x0,SendPresenceStatus_1[_0x5e0794(0x132)])(_0x50ec43,_0x45b7ba[_0x5e0794(0x196)]['number']+'@'+(_0x45b7ba['isGroup']?'g.us':_0x5e0794(0x1b0))):await(0x0,SendPresenceStatus_1[_0x5e0794(0x163)])(_0x50ec43,_0x45b7ba[_0x5e0794(0x196)][_0x5e0794(0x160)]+'@'+(_0x45b7ba[_0x5e0794(0x1bf)]?_0x5e0794(0x15c):'s.whatsapp.net')),_0x95ab91[_0x5e0794(0x130)](0xc8)[_0x5e0794(0x1ae)]('Status\x20'+_0x4d876e+_0x5e0794(0x1a6));};exports[a26_0x3f6d6e(0x194)]=typing;const send=async(_0x5cc808,_0x362158)=>{const _0x41bbc3=a26_0x3f6d6e,{whatsappId:_0x23ab60}=_0x5cc808[_0x41bbc3(0x19b)],_0x572fbc=_0x5cc808[_0x41bbc3(0x17c)],_0x35b018=_0x5cc808[_0x41bbc3(0x198)];try{const _0x5d0fb9=await Whatsapp_1[_0x41bbc3(0x18e)]['findByPk'](_0x23ab60);if(!_0x5d0fb9)throw new Error(_0x41bbc3(0x13e));if(_0x572fbc[_0x41bbc3(0x160)]===undefined)throw new Error(_0x41bbc3(0x187));const _0x14a4ff=_0x572fbc['number'],_0x4ca1c0=_0x572fbc['body'],_0x452d3e=_0x5d0fb9[_0x41bbc3(0x169)],_0x2f2a2f=await(0x0,CheckNumber_1[_0x41bbc3(0x18e)])(_0x14a4ff,_0x452d3e);var _0x2ae343=_0x2f2a2f[_0x41bbc3(0x14a)][_0x41bbc3(0x150)](_0x41bbc3(0x166));console[_0x41bbc3(0x137)](_0x2ae343);const _0x2f937a=_0x2f2a2f[_0x41bbc3(0x14a)][_0x41bbc3(0x193)](_0x41bbc3(0x139),'')[_0x41bbc3(0x193)](_0x41bbc3(0x166),''),_0xc9107c={'name':''+_0x2f937a,'number':_0x2f937a,'isGroup':_0x2ae343,'companyId':_0x452d3e},_0x14bfe1=await(0x0,GetWhatsappWbot_1['default'])(_0x5d0fb9),_0x24a865=await(0x0,CreateOrUpdateContactService_1[_0x41bbc3(0x18e)])(_0xc9107c,_0x14bfe1,_0x2f2a2f[_0x41bbc3(0x14a)]),_0x5167a1=await(0x0,FindOrCreateTicketService_1[_0x41bbc3(0x18e)])(_0x24a865,_0x5d0fb9['id'],0x0,_0x452d3e);return _0x35b018?await Promise['all'](_0x35b018[_0x41bbc3(0x1c5)](async _0x2ae3dd=>{const _0x304606=_0x41bbc3;await _0x5cc808[_0x304606(0x1a8)][_0x304606(0x1bb)]('queues')[_0x304606(0x15d)][_0x304606(0x1b4)](_0x304606(0x1bc),{'whatsappId':_0x23ab60,'data':{'number':_0x2f937a,'body':_0x4ca1c0?(0x0,Mustache_1['default'])(_0x4ca1c0,_0x5167a1):_0x2ae3dd['originalname'],'mediaPath':_0x2ae3dd[_0x304606(0x1aa)],'finalName':_0x2ae3dd[_0x304606(0x17b)],'fileName':_0x2ae3dd[_0x304606(0x1c1)]}},{'removeOnComplete':!![],'attempts':0x3});})):await(0x0,SendWhatsAppMessage_1[_0x41bbc3(0x18e)])({'body':(0x0,Mustache_1[_0x41bbc3(0x18e)])(_0x4ca1c0,_0x5167a1),'ticket':_0x5167a1}),_0x572fbc[_0x41bbc3(0x1a2)]&&setTimeout(async()=>{const _0x3c186e=_0x41bbc3;await(0x0,UpdateTicketService_1[_0x3c186e(0x18e)])({'ticketId':_0x5167a1['id'],'ticketData':{'status':_0x3c186e(0x165)},'companyId':_0x452d3e});},0x3e8),await(0x0,SetTicketMessagesAsRead_1[_0x41bbc3(0x18e)])(_0x5167a1),_0x362158[_0x41bbc3(0x1ae)]({'mensagem':'Mensagem\x20enviada'});}catch(_0x280bd7){console[_0x41bbc3(0x137)](_0x280bd7);if(Object[_0x41bbc3(0x173)](_0x280bd7)['length']===0x0)throw new AppError_1[(_0x41bbc3(0x18e))](_0x41bbc3(0x148));else throw new AppError_1['default'](_0x280bd7['message']);}};exports[a26_0x3f6d6e(0x1ae)]=send;const addReaction=async(_0x3ff039,_0xfca149)=>{const _0x38cbf0=a26_0x3f6d6e;try{const {messageId:_0x303ae9}=_0x3ff039[_0x38cbf0(0x19b)],{type:_0x358fb7}=_0x3ff039[_0x38cbf0(0x17c)],{companyId:_0x14aca1,id:_0x5bbf3f}=_0x3ff039[_0x38cbf0(0x1b3)],_0x2d9996=await Message_1[_0x38cbf0(0x18e)][_0x38cbf0(0x190)](_0x303ae9),_0x5e82e7=await Ticket_1[_0x38cbf0(0x18e)]['findByPk'](_0x2d9996[_0x38cbf0(0x19f)],{'include':['contact']});if(!_0x2d9996)return _0xfca149[_0x38cbf0(0x130)](0x194)[_0x38cbf0(0x1ae)]({'message':'Mensagem\x20não\x20encontrada'});const _0x2138a8=await(0x0,SendWhatsAppReaction_1['default'])({'messageId':_0x303ae9,'ticket':_0x5e82e7,'reactionType':_0x358fb7}),_0x61c3e7=await _0x2d9996[_0x38cbf0(0x186)]({'reactions':[..._0x2d9996[_0x38cbf0(0x15f)],{'type':_0x358fb7,'userId':_0x5bbf3f}]}),_0x9f3f79=(0x0,socket_1['getIO'])();return _0x9f3f79['to'](_0x2d9996[_0x38cbf0(0x19f)]['toString']())[_0x38cbf0(0x16d)](_0x38cbf0(0x1be)+_0x14aca1+_0x38cbf0(0x185),{'action':'update','message':_0x2d9996}),_0xfca149[_0x38cbf0(0x130)](0xc8)[_0x38cbf0(0x1ae)]({'message':_0x38cbf0(0x18b),'reactionResult':_0x2138a8,'reactions':_0x61c3e7['reactions']});}catch(_0x261a53){console[_0x38cbf0(0x18f)](_0x38cbf0(0x176),_0x261a53);if(_0x261a53 instanceof AppError_1[_0x38cbf0(0x18e)])return _0xfca149[_0x38cbf0(0x130)](0x190)[_0x38cbf0(0x1ae)]({'message':_0x261a53[_0x38cbf0(0x12f)]});return _0xfca149[_0x38cbf0(0x130)](0x1f4)[_0x38cbf0(0x1ae)]({'message':_0x38cbf0(0x175),'error':_0x261a53[_0x38cbf0(0x12f)]});}};exports[a26_0x3f6d6e(0x1ad)]=addReaction;const storeAudio=async(_0x2633b8,_0x237fb1)=>{const _0x4eb354=a26_0x3f6d6e,_0x2c222b=_0x2633b8[_0x4eb354(0x1b3)]['companyId'],_0xfa329c=_0x2633b8[_0x4eb354(0x1c3)];let _0xa06c20='';const _0x2145e5=generateRandomFilename(),_0x408d34=_0x4eb354(0x19c)+_0x2c222b+'/'+_0x2145e5;return await convertToMp3(_0xfa329c[_0x4eb354(0x1aa)],_0x408d34),_0xfa329c&&(_0xa06c20=await(0x0,TranslateAudioService_1['default'])(_0x408d34)),_0x237fb1[_0x4eb354(0x1ae)](_0xa06c20||_0x4eb354(0x131));};exports['storeAudio']=storeAudio;function convertToMp3(_0x2393be,_0x3bafdd){return new Promise((_0x477a06,_0x5454fb)=>{const _0x48272a=a26_0x4522;(0x0,fluent_ffmpeg_1[_0x48272a(0x18e)])(_0x2393be)[_0x48272a(0x162)](_0x48272a(0x19d))['on']('end',()=>{_0x477a06(_0x3bafdd);})['on'](_0x48272a(0x18f),_0x5b7ae6=>{const _0x4aef91=_0x48272a;console['error'](_0x4aef91(0x177),_0x5b7ae6),_0x5454fb(_0x5b7ae6);})[_0x48272a(0x170)](_0x3bafdd);});}function a26_0x557c(){const _0x1883d9=['__createBinding','get','SendMessage','TicketId\x20is\x20required','company-','isGroup','contactId','originalname','ffmpeg-static','file','randomBytes','map','message','status','Transcrição\x20não\x20disponível','SendTypingStatus','userId','search','../services/WbotServices/CheckNumber','whatsappId','log','index','@s.whatsapp.net','../models/Whatsapp','__importStar','apply','conversation','Não\x20foi\x20possível\x20realizar\x20a\x20operação','../helpers/GetWhatsappWbot','../errors/AppError','getAll','forEach','Contact\x20not\x20found','../services/WbotServices/EditWhatsAppMessage','../services/MessageServices/ShowMessageService','crypto','(((.+)+)+)+$','Não\x20foi\x20possível\x20enviar\x20a\x20mensagem,\x20tente\x20novamente\x20em\x20alguns\x20instantes','hasOwnProperty','jid','queueId','ShowContactService1','isArray','Message\x20not\x20found','../models/Queue','includes','__importDefault','toBoolean','mediaUrl','call','edit','getIO','messageId','create','../libs/socket','4ptJNHq','../services/WbotServices/SendWhatsAppReaction','g.us','messageQueue','../helpers/SetTicketMessagesAsRead','reactions','number','firstQueueThisUser','toFormat','SendPausedStatus','remove','closed','@g.us','../libs/wbot','GetWhatsAppFromMessage','companyId','store','toString','../services/WbotServices/SendWhatsAppMessage','emit','../models/Message','validator','saveToFile','4316064UvbeLU','query','keys','../utils/user','Erro\x20ao\x20adicionar\x20reação','Erro\x20ao\x20adicionar\x20reação:','Erro\x20na\x20conversão\x20do\x20áudio:','getWbot','save','../services/MessageServices/ListAllMessagesService','filename','body','../services/WbotServices/DeleteWhatsAppMessage','6388hgGfDA','10HLLuzb','../services/WbotServices/SendWhatsAppMedia','1684701SgHfbY','10070235yZRdZl','1580180uiYjDA','../services/TicketServices/ShowTicketService','-appMessage','update','O\x20número\x20é\x20obrigatório','20013598PaGUfx','fromMe','defineProperty','Reação\x20adicionada\x20com\x20sucesso!','mediaType','../helpers/SendPresenceStatus','default','error','findByPk','16288SJWSyc','4941NLwjYU','replace','typing','queues','contact','json','files','144aZPvEH','../models/User','params','./public/company','mp3','dateEnd','ticketId','../services/ContactServices/ShowContactService','__esModule','closeTicket','setFfmpegPath','../services/ContactServices/CreateOrUpdateContactService','constructor','\x20enviado\x20com\x20sucesso','open','app','forwardMessage','path','Ticket\x20not\x20found','unreadMessages','addReaction','send','all','s.whatsapp.net','../models/Ticket','../services/TicketServices/UpdateTicketService','user','add','Whatsapp\x20from\x20message\x20not\x20found','__setModuleDefault','../services/MessageServices/ListMessagesService','../helpers/Mustache','prototype'];a26_0x557c=function(){return _0x1883d9;};return a26_0x557c();}function generateRandomFilename(){const _0xcfe906=a26_0x3f6d6e,_0x2a921e=crypto_1['default'][_0xcfe906(0x1c4)](0x10)[_0xcfe906(0x16b)]('hex');return _0x2a921e+'.mp3';}const forwardMessage=async(_0x34ff2f,_0x174236)=>{const _0x436763=a26_0x3f6d6e;console[_0x436763(0x137)]('>>>>>>>>>>>>>>>>>forwardMessage\x20X<<<<<<<<<<<<<<<<<<<');const {body:_0x367d32,quotedMsg:_0x446f5a}=_0x34ff2f[_0x436763(0x17c)],_0x31a429=_0x34ff2f[_0x436763(0x17c)][_0x436763(0x157)],_0x111cec=_0x34ff2f[_0x436763(0x17c)][_0x436763(0x1c0)];if(!_0x31a429||!_0x111cec)return _0x174236['status'](0xc8)[_0x436763(0x1ae)]('MessageId\x20or\x20ContactId\x20not\x20found');const _0x48402a=await(0x0,ShowMessageService_1[_0x436763(0x18e)])(_0x31a429),_0x2248e3=await(0x0,ShowContactService_1[_0x436763(0x14c)])(_0x111cec);if(!_0x48402a)return _0x174236[_0x436763(0x130)](0x194)[_0x436763(0x1ae)](_0x436763(0x14e));if(!_0x2248e3)return _0x174236['status'](0x194)[_0x436763(0x1ae)](_0x436763(0x143));const _0x56f2e3=await(0x0,ShowMessageService_1[_0x436763(0x168)])(_0x48402a);if(!_0x56f2e3)return _0x174236['status'](0x194)[_0x436763(0x1ae)](_0x436763(0x1b5));const _0x5cb5ae=_0x34ff2f[_0x436763(0x1b3)]['companyId'],_0x30d026=await(0x0,FindOrCreateTicketService_1[_0x436763(0x18e)])(_0x2248e3,_0x56f2e3,0x0,_0x5cb5ae);await(0x0,SetTicketMessagesAsRead_1[_0x436763(0x18e)])(_0x30d026);_0x48402a[_0x436763(0x18c)]===_0x436763(0x13d)||_0x48402a['mediaType']==='extendedTextMessage'?await(0x0,SendWhatsAppMessage_1[_0x436763(0x18e)])({'body':_0x48402a[_0x436763(0x17c)],'ticket':_0x30d026,'quotedMsg':_0x446f5a}):await(0x0,SendWhatsAppMedia_1['SendWhatsAppMediaFileAddress'])(_0x48402a[_0x436763(0x153)]||'',_0x30d026,_0x48402a['body']);const _0x3856f1=await(0x0,ShowUserService_1[_0x436763(0x18e)])(_0x34ff2f[_0x436763(0x1b3)]['id']),_0x4e7fae=await(0x0,user_1[_0x436763(0x161)])(_0x3856f1);_0x30d026[_0x436763(0x130)]=_0x436763(0x1a7),_0x30d026[_0x436763(0x14b)]=_0x4e7fae?.['id']||null,_0x30d026[_0x436763(0x133)]=_0x3856f1['id'],_0x30d026[_0x436763(0x179)]();const _0x3f04e1=(0x0,socket_1['getIO'])();return(0x0,UpdateTicketService_2['notifyUpdate'])(_0x3f04e1,_0x30d026,_0x30d026['id'],_0x5cb5ae),_0x174236[_0x436763(0x1ae)]();};exports[a26_0x3f6d6e(0x1a9)]=forwardMessage;