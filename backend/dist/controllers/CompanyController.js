const a13_0x1fd278=a13_0x258c;(function(_0x17fe35,_0x3a2e5e){const _0xdf39fb=a13_0x258c,_0x4d6853=_0x17fe35();while(!![]){try{const _0x123c3c=-parseInt(_0xdf39fb(0x157))/0x1+parseInt(_0xdf39fb(0x123))/0x2*(-parseInt(_0xdf39fb(0x11e))/0x3)+-parseInt(_0xdf39fb(0x13e))/0x4*(parseInt(_0xdf39fb(0x124))/0x5)+-parseInt(_0xdf39fb(0x141))/0x6+-parseInt(_0xdf39fb(0x129))/0x7*(parseInt(_0xdf39fb(0x15a))/0x8)+-parseInt(_0xdf39fb(0x154))/0x9+parseInt(_0xdf39fb(0x128))/0xa;if(_0x123c3c===_0x3a2e5e)break;else _0x4d6853['push'](_0x4d6853['shift']());}catch(_0x5c1031){_0x4d6853['push'](_0x4d6853['shift']());}}}(a13_0x4287,0xda5ea));const a13_0x184693=(function(){let _0x14a3ee=!![];return function(_0x245735,_0x3ef419){const _0x3588a5=_0x14a3ee?function(){const _0x6ad177=a13_0x258c;if(_0x3ef419){const _0xee7f55=_0x3ef419[_0x6ad177(0x13a)](_0x245735,arguments);return _0x3ef419=null,_0xee7f55;}}:function(){};return _0x14a3ee=![],_0x3588a5;};}()),a13_0x2adb64=a13_0x184693(this,function(){const _0x196e93=a13_0x258c;return a13_0x2adb64[_0x196e93(0x13d)]()[_0x196e93(0x10d)](_0x196e93(0x113))[_0x196e93(0x13d)]()[_0x196e93(0x139)](a13_0x2adb64)[_0x196e93(0x10d)](_0x196e93(0x113));});a13_0x2adb64();'use strict';var __createBinding=this&&this[a13_0x1fd278(0x133)]||(Object[a13_0x1fd278(0x14a)]?function(_0x878945,_0x3c8852,_0x2f8083,_0x2475d7){const _0x59a7ae=a13_0x1fd278;if(_0x2475d7===undefined)_0x2475d7=_0x2f8083;var _0x307d18=Object[_0x59a7ae(0x147)](_0x3c8852,_0x2f8083);(!_0x307d18||('get'in _0x307d18?!_0x3c8852[_0x59a7ae(0x12f)]:_0x307d18[_0x59a7ae(0x131)]||_0x307d18['configurable']))&&(_0x307d18={'enumerable':!![],'get':function(){return _0x3c8852[_0x2f8083];}}),Object[_0x59a7ae(0x117)](_0x878945,_0x2475d7,_0x307d18);}:function(_0x2b0775,_0x293689,_0xc3f751,_0x10ff07){if(_0x10ff07===undefined)_0x10ff07=_0xc3f751;_0x2b0775[_0x10ff07]=_0x293689[_0xc3f751];}),__setModuleDefault=this&&this[a13_0x1fd278(0x11b)]||(Object[a13_0x1fd278(0x14a)]?function(_0x20191e,_0x228783){const _0x338830=a13_0x1fd278;Object[_0x338830(0x117)](_0x20191e,'default',{'enumerable':!![],'value':_0x228783});}:function(_0xb14211,_0x1ee7a6){const _0x3f69e3=a13_0x1fd278;_0xb14211[_0x3f69e3(0x144)]=_0x1ee7a6;}),__importStar=this&&this['__importStar']||function(_0x59240b){const _0x155ecf=a13_0x1fd278;if(_0x59240b&&_0x59240b[_0x155ecf(0x12f)])return _0x59240b;var _0x3bbd23={};if(_0x59240b!=null){for(var _0x408921 in _0x59240b)if(_0x408921!==_0x155ecf(0x144)&&Object['prototype'][_0x155ecf(0x152)][_0x155ecf(0x126)](_0x59240b,_0x408921))__createBinding(_0x3bbd23,_0x59240b,_0x408921);}return __setModuleDefault(_0x3bbd23,_0x59240b),_0x3bbd23;},__importDefault=this&&this[a13_0x1fd278(0x151)]||function(_0x2beb82){const _0x5352df=a13_0x1fd278;return _0x2beb82&&_0x2beb82[_0x5352df(0x12f)]?_0x2beb82:{'default':_0x2beb82};};Object[a13_0x1fd278(0x117)](exports,a13_0x1fd278(0x12f),{'value':!![]}),exports[a13_0x1fd278(0x148)]=exports['listPlan']=exports[a13_0x1fd278(0x115)]=exports[a13_0x1fd278(0x153)]=exports[a13_0x1fd278(0x14f)]=exports[a13_0x1fd278(0x127)]=exports[a13_0x1fd278(0x14e)]=exports['store']=exports['signup']=exports[a13_0x1fd278(0x159)]=void 0x0;const Yup=__importStar(require(a13_0x1fd278(0x125))),AppError_1=__importDefault(require(a13_0x1fd278(0x137))),auth_1=__importDefault(require(a13_0x1fd278(0x130))),ListCompaniesService_1=__importDefault(require('../services/CompanyService/ListCompaniesService')),CreateCompanyService_1=__importDefault(require('../services/CompanyService/CreateCompanyService')),UpdateCompanyService_1=__importDefault(require(a13_0x1fd278(0x121))),ShowCompanyService_1=__importDefault(require(a13_0x1fd278(0x116))),UpdateSchedulesService_1=__importDefault(require('../services/CompanyService/UpdateSchedulesService')),DeleteCompanyService_1=__importDefault(require(a13_0x1fd278(0x12d))),FindAllCompaniesService_1=__importDefault(require(a13_0x1fd278(0x12c))),jsonwebtoken_1=require('jsonwebtoken'),User_1=__importDefault(require(a13_0x1fd278(0x136))),ShowPlanCompanyService_1=__importDefault(require(a13_0x1fd278(0x10c))),ListCompaniesPlanService_1=__importDefault(require(a13_0x1fd278(0x11f))),CheckSettings_1=__importDefault(require('../helpers/CheckSettings')),moment_1=__importDefault(require(a13_0x1fd278(0x118))),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a13_0x1fd278(0x140))),publicFolder=path_1[a13_0x1fd278(0x144)][a13_0x1fd278(0x13f)](__dirname,'..','..','public'),index=async(_0x5a3b8d,_0x281592)=>{const _0x29eddd=a13_0x1fd278,{searchParam:_0x4cb703,pageNumber:_0xd846f5}=_0x5a3b8d[_0x29eddd(0x10b)],{companies:_0x2b587f,count:_0x188d21,hasMore:_0x19d2be}=await(0x0,ListCompaniesService_1[_0x29eddd(0x144)])({'searchParam':_0x4cb703,'pageNumber':_0xd846f5});return _0x281592[_0x29eddd(0x155)]({'companies':_0x2b587f,'count':_0x188d21,'hasMore':_0x19d2be});};exports[a13_0x1fd278(0x159)]=index;const signup=async(_0x43ed46,_0x2ca766)=>{const _0x50b566=a13_0x1fd278;if(await(0x0,CheckSettings_1[_0x50b566(0x144)])(_0x50b566(0x142))!==_0x50b566(0x134))return _0x2ca766['status'](0x191)[_0x50b566(0x155)]('🙎🏻‍♂️\x20Signup\x20disabled');return await(0x0,exports[_0x50b566(0x158)])(_0x43ed46,_0x2ca766);};exports[a13_0x1fd278(0x122)]=signup;function a13_0x258c(_0x58ecf1,_0x16cbdd){const _0x13367d=a13_0x4287();return a13_0x258c=function(_0x2adb64,_0x184693){_0x2adb64=_0x2adb64-0x10b;let _0x4287dc=_0x13367d[_0x2adb64];return _0x4287dc;},a13_0x258c(_0x58ecf1,_0x16cbdd);}const store=async(_0x3ec70d,_0x27f89b)=>{const _0x23a7d7=a13_0x1fd278,_0x2ce15d=_0x3ec70d[_0x23a7d7(0x14d)];try{const _0x4b98c7=await(0x0,CheckSettings_1['default'])(_0x23a7d7(0x156)),_0x4276aa=parseInt(_0x4b98c7,0xa);isNaN(_0x4276aa)||_0x4276aa<=0x0?_0x2ce15d[_0x23a7d7(0x120)]=(0x0,moment_1['default'])()[_0x23a7d7(0x14b)](0x7,_0x23a7d7(0x138))[_0x23a7d7(0x13c)]():_0x2ce15d[_0x23a7d7(0x120)]=(0x0,moment_1['default'])()['add'](_0x4276aa,'days')[_0x23a7d7(0x13c)]();const _0x51e51a=await(0x0,CreateCompanyService_1[_0x23a7d7(0x144)])(_0x2ce15d);return _0x27f89b[_0x23a7d7(0x10f)](0xc9)[_0x23a7d7(0x155)](_0x51e51a);}catch(_0x5bd3b5){return _0x27f89b[_0x23a7d7(0x10f)](0x1f4)[_0x23a7d7(0x155)]({'message':'Error\x20creating\x20company','error':_0x5bd3b5});}};exports['store']=store;const show=async(_0x1c8596,_0x38faa9)=>{const _0x516975=a13_0x1fd278,{id:_0x394973}=_0x1c8596[_0x516975(0x150)],_0x410743=await User_1[_0x516975(0x144)]['findByPk'](_0x1c8596[_0x516975(0x15b)]['id']);if(!_0x410743['super']&&Number[_0x516975(0x132)](_0x394973,0xa)!==_0x410743[_0x516975(0x143)])throw new AppError_1[(_0x516975(0x144))](_0x516975(0x11d),0x193);const _0x536bdc=await(0x0,ShowCompanyService_1[_0x516975(0x144)])(_0x394973);return _0x38faa9[_0x516975(0x10f)](0xc8)['json'](_0x536bdc);};exports['show']=show;const list=async(_0xa47d34,_0x491051)=>{const _0x568b25=a13_0x1fd278,_0x2791ea=await(0x0,FindAllCompaniesService_1[_0x568b25(0x144)])();return _0x491051[_0x568b25(0x10f)](0xc8)[_0x568b25(0x155)](_0x2791ea);};exports[a13_0x1fd278(0x127)]=list;const update=async(_0x1e066c,_0x179ced)=>{const _0x2cd7ad=a13_0x1fd278,_0x578429=_0x1e066c[_0x2cd7ad(0x14d)],_0x2558cb=Yup['object']()[_0x2cd7ad(0x12e)]({'name':Yup[_0x2cd7ad(0x112)]()[_0x2cd7ad(0x110)](),'email':Yup['string']()[_0x2cd7ad(0x114)]()[_0x2cd7ad(0x13b)](),'phone':Yup[_0x2cd7ad(0x112)]()[_0x2cd7ad(0x13b)](),'status':Yup[_0x2cd7ad(0x149)]()[_0x2cd7ad(0x13b)](),'planId':Yup[_0x2cd7ad(0x119)]()[_0x2cd7ad(0x13b)](),'campaignsEnabled':Yup[_0x2cd7ad(0x149)]()['nullable'](),'dueDate':Yup['date']()[_0x2cd7ad(0x13b)](),'recurrence':Yup['string']()['nullable']()});try{await _0x2558cb[_0x2cd7ad(0x111)](_0x578429);}catch(_0x35c07c){throw new AppError_1[(_0x2cd7ad(0x144))](_0x35c07c[_0x2cd7ad(0x10e)]);}const {id:_0x1c71a4}=_0x1e066c[_0x2cd7ad(0x150)],_0x491e03=await(0x0,UpdateCompanyService_1['default'])({'id':_0x1c71a4,..._0x578429});return _0x179ced[_0x2cd7ad(0x10f)](0xc8)[_0x2cd7ad(0x155)](_0x491e03);};exports[a13_0x1fd278(0x14f)]=update;const updateSchedules=async(_0x334b1f,_0x10593d)=>{const _0xc84273=a13_0x1fd278,{schedules:_0x1052f5}=_0x334b1f['body'],{id:_0x1ffc5b}=_0x334b1f[_0xc84273(0x150)],_0x510269=await User_1['default'][_0xc84273(0x146)](_0x334b1f[_0xc84273(0x15b)]['id']);if(!_0x510269[_0xc84273(0x12a)]&&Number['parseInt'](_0x1ffc5b,0xa)!==_0x510269['companyId'])throw new AppError_1[(_0xc84273(0x144))](_0xc84273(0x11d),0x193);const _0x24cd37=await(0x0,UpdateSchedulesService_1['default'])({'id':_0x1ffc5b,'schedules':_0x1052f5});return _0x10593d[_0xc84273(0x10f)](0xc8)['json'](_0x24cd37);};exports[a13_0x1fd278(0x153)]=updateSchedules;const remove=async(_0x4ccab8,_0x247153)=>{const _0x5d711f=a13_0x1fd278,{id:_0x4eed62}=_0x4ccab8[_0x5d711f(0x150)];fs_1[_0x5d711f(0x144)]['existsSync'](publicFolder+_0x5d711f(0x145)+_0x4eed62+'/')&&fs_1[_0x5d711f(0x144)]['rmdirSync'](publicFolder+'/company'+_0x4eed62+'/',{'recursive':!![]});const _0x314bf9=await(0x0,DeleteCompanyService_1[_0x5d711f(0x144)])(_0x4eed62);return _0x247153[_0x5d711f(0x10f)](0xc8)['json'](_0x314bf9);};exports['remove']=remove;const listPlan=async(_0x3d003f,_0x373c4e)=>{const _0x45032a=a13_0x1fd278,{id:_0x1bd152}=_0x3d003f['params'],_0x5d1ca3=_0x3d003f[_0x45032a(0x12b)]['authorization'],[,_0x23b579]=_0x5d1ca3[_0x45032a(0x135)]('\x20'),_0x52e272=(0x0,jsonwebtoken_1[_0x45032a(0x11c)])(_0x23b579,auth_1[_0x45032a(0x144)]['secret']),{id:_0x133885,profile:_0x708cde,companyId:_0x27c44f}=_0x52e272,_0x322123=await User_1[_0x45032a(0x144)]['findByPk'](_0x133885);if(_0x322123['super']===!![]||_0x27c44f['toString']()===_0x1bd152){const _0x5149d9=await(0x0,ShowPlanCompanyService_1[_0x45032a(0x144)])(_0x1bd152);return _0x373c4e['status'](0xc8)[_0x45032a(0x155)](_0x5149d9);}else return _0x373c4e['status'](0x190)[_0x45032a(0x155)]({'error':'Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!'});};exports[a13_0x1fd278(0x14c)]=listPlan;const indexPlan=async(_0x26dce9,_0x74c53b)=>{const _0x541d2f=a13_0x1fd278,{searchParam:_0x57b399,pageNumber:_0x30bfc8}=_0x26dce9[_0x541d2f(0x10b)],_0x15ec3d=_0x26dce9[_0x541d2f(0x12b)]['authorization'],[,_0x2f17eb]=_0x15ec3d['split']('\x20'),_0x339a5e=(0x0,jsonwebtoken_1[_0x541d2f(0x11c)])(_0x2f17eb,auth_1[_0x541d2f(0x144)]['secret']),{id:_0x198639,profile:_0x25cf93,companyId:_0x2f60f6}=_0x339a5e,_0x5c25ec=await User_1[_0x541d2f(0x144)][_0x541d2f(0x146)](_0x198639);if(_0x5c25ec[_0x541d2f(0x12a)]===!![]){const _0x511fb1=await(0x0,ListCompaniesPlanService_1['default'])();return _0x74c53b[_0x541d2f(0x155)]({'companies':_0x511fb1});}else return _0x74c53b[_0x541d2f(0x10f)](0x190)[_0x541d2f(0x155)]({'error':_0x541d2f(0x11a)});};function a13_0x4287(){const _0x450c4b=['212009NLVpzO','super','headers','../services/CompanyService/FindAllCompaniesService','../services/CompanyService/DeleteCompanyService','shape','__esModule','../config/auth','writable','parseInt','__createBinding','enabled','split','../models/User','../errors/AppError','days','constructor','apply','nullable','toDate','toString','4EJsKXj','resolve','path','1938570qmhVec','allowSignup','companyId','default','/company','findByPk','getOwnPropertyDescriptor','indexPlan','boolean','create','add','listPlan','body','show','update','params','__importDefault','hasOwnProperty','updateSchedules','11756097VMXfDl','json','trialExpiration','1294920VOkdLX','store','index','112plbBDh','user','query','../services/CompanyService/ShowPlanCompanyService','search','message','status','required','validate','string','(((.+)+)+)+$','email','remove','../services/CompanyService/ShowCompanyService','defineProperty','moment','number','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','__setModuleDefault','verify','ERR_FORBIDDEN','9LjTqNl','../services/CompanyService/ListCompaniesPlanService','dueDate','../services/CompanyService/UpdateCompanyService','signup','783236FyuGPb','7717985IuqNbA','yup','call','list','69611590oYVELK'];a13_0x4287=function(){return _0x450c4b;};return a13_0x4287();}exports[a13_0x1fd278(0x148)]=indexPlan;