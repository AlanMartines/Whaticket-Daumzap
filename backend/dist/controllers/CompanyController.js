const a13_0x2b9b6a=a13_0x3c0e;(function(_0x250e36,_0x11849d){const _0x3c489a=a13_0x3c0e,_0x5b94e3=_0x250e36();while(!![]){try{const _0x120b4c=parseInt(_0x3c489a(0x13a))/0x1+parseInt(_0x3c489a(0x105))/0x2+-parseInt(_0x3c489a(0x10f))/0x3+-parseInt(_0x3c489a(0x113))/0x4*(-parseInt(_0x3c489a(0x14a))/0x5)+parseInt(_0x3c489a(0x138))/0x6+-parseInt(_0x3c489a(0x14c))/0x7*(parseInt(_0x3c489a(0x126))/0x8)+parseInt(_0x3c489a(0x13b))/0x9;if(_0x120b4c===_0x11849d)break;else _0x5b94e3['push'](_0x5b94e3['shift']());}catch(_0x584880){_0x5b94e3['push'](_0x5b94e3['shift']());}}}(a13_0x2216,0xcb3a0));const a13_0x2dc20d=(function(){let _0x4e02b1=!![];return function(_0x34ec23,_0x4ea1ab){const _0x1ebc9c=_0x4e02b1?function(){const _0x2d9b97=a13_0x3c0e;if(_0x4ea1ab){const _0x49da6e=_0x4ea1ab[_0x2d9b97(0x10a)](_0x34ec23,arguments);return _0x4ea1ab=null,_0x49da6e;}}:function(){};return _0x4e02b1=![],_0x1ebc9c;};}()),a13_0x26a257=a13_0x2dc20d(this,function(){const _0x525877=a13_0x3c0e;return a13_0x26a257[_0x525877(0x136)]()[_0x525877(0x115)](_0x525877(0x149))[_0x525877(0x136)]()[_0x525877(0x143)](a13_0x26a257)['search']('(((.+)+)+)+$');});function a13_0x3c0e(_0xd50888,_0x34bebb){const _0x322f7f=a13_0x2216();return a13_0x3c0e=function(_0x26a257,_0x2dc20d){_0x26a257=_0x26a257-0xfb;let _0x221678=_0x322f7f[_0x26a257];return _0x221678;},a13_0x3c0e(_0xd50888,_0x34bebb);}a13_0x26a257();'use strict';var __createBinding=this&&this[a13_0x2b9b6a(0x102)]||(Object[a13_0x2b9b6a(0x114)]?function(_0x18b2f6,_0x140564,_0x5dee0d,_0x12481e){const _0x3e37ed=a13_0x2b9b6a;if(_0x12481e===undefined)_0x12481e=_0x5dee0d;var _0x3fb071=Object[_0x3e37ed(0x144)](_0x140564,_0x5dee0d);(!_0x3fb071||(_0x3e37ed(0x140)in _0x3fb071?!_0x140564[_0x3e37ed(0x104)]:_0x3fb071[_0x3e37ed(0x139)]||_0x3fb071[_0x3e37ed(0x11b)]))&&(_0x3fb071={'enumerable':!![],'get':function(){return _0x140564[_0x5dee0d];}}),Object[_0x3e37ed(0x14d)](_0x18b2f6,_0x12481e,_0x3fb071);}:function(_0x463a0f,_0x48ba41,_0x54521b,_0x5990dd){if(_0x5990dd===undefined)_0x5990dd=_0x54521b;_0x463a0f[_0x5990dd]=_0x48ba41[_0x54521b];}),__setModuleDefault=this&&this[a13_0x2b9b6a(0x124)]||(Object['create']?function(_0x45669d,_0xe79ab8){const _0x250a8e=a13_0x2b9b6a;Object[_0x250a8e(0x14d)](_0x45669d,_0x250a8e(0x123),{'enumerable':!![],'value':_0xe79ab8});}:function(_0x1ccab6,_0x1d68c6){const _0x52ad20=a13_0x2b9b6a;_0x1ccab6[_0x52ad20(0x123)]=_0x1d68c6;}),__importStar=this&&this[a13_0x2b9b6a(0x129)]||function(_0x343167){const _0x176fb5=a13_0x2b9b6a;if(_0x343167&&_0x343167[_0x176fb5(0x104)])return _0x343167;var _0x35aaba={};if(_0x343167!=null){for(var _0x59c1a3 in _0x343167)if(_0x59c1a3!==_0x176fb5(0x123)&&Object[_0x176fb5(0x103)]['hasOwnProperty'][_0x176fb5(0x11d)](_0x343167,_0x59c1a3))__createBinding(_0x35aaba,_0x343167,_0x59c1a3);}return __setModuleDefault(_0x35aaba,_0x343167),_0x35aaba;},__importDefault=this&&this['__importDefault']||function(_0x753686){const _0x1d6a23=a13_0x2b9b6a;return _0x753686&&_0x753686[_0x1d6a23(0x104)]?_0x753686:{'default':_0x753686};};Object[a13_0x2b9b6a(0x14d)](exports,a13_0x2b9b6a(0x104),{'value':!![]}),exports[a13_0x2b9b6a(0x12e)]=exports[a13_0x2b9b6a(0x12c)]=exports[a13_0x2b9b6a(0x12d)]=exports[a13_0x2b9b6a(0x13d)]=exports[a13_0x2b9b6a(0x130)]=exports[a13_0x2b9b6a(0x108)]=exports['show']=exports[a13_0x2b9b6a(0xfe)]=exports[a13_0x2b9b6a(0x10d)]=exports[a13_0x2b9b6a(0x141)]=void 0x0;const Yup=__importStar(require(a13_0x2b9b6a(0x148))),AppError_1=__importDefault(require('../errors/AppError')),auth_1=__importDefault(require('../config/auth')),ListCompaniesService_1=__importDefault(require(a13_0x2b9b6a(0xff))),CreateCompanyService_1=__importDefault(require(a13_0x2b9b6a(0x112))),UpdateCompanyService_1=__importDefault(require(a13_0x2b9b6a(0x10c))),ShowCompanyService_1=__importDefault(require(a13_0x2b9b6a(0x135))),UpdateSchedulesService_1=__importDefault(require('../services/CompanyService/UpdateSchedulesService')),DeleteCompanyService_1=__importDefault(require('../services/CompanyService/DeleteCompanyService')),FindAllCompaniesService_1=__importDefault(require(a13_0x2b9b6a(0x13c))),jsonwebtoken_1=require(a13_0x2b9b6a(0x12a)),User_1=__importDefault(require(a13_0x2b9b6a(0x11e))),ShowPlanCompanyService_1=__importDefault(require(a13_0x2b9b6a(0x101))),ListCompaniesPlanService_1=__importDefault(require(a13_0x2b9b6a(0x122))),CheckSettings_1=__importDefault(require(a13_0x2b9b6a(0x146))),moment_1=__importDefault(require('moment')),fs_1=__importDefault(require('fs')),path_1=__importDefault(require(a13_0x2b9b6a(0xfb))),publicFolder=path_1['default']['resolve'](__dirname,'..','..',a13_0x2b9b6a(0x14e)),index=async(_0x526e16,_0x1f52fb)=>{const _0xa9b069=a13_0x2b9b6a,{searchParam:_0x525fb4,pageNumber:_0x1c8a78}=_0x526e16['query'],{companies:_0x427550,count:_0x4cdea7,hasMore:_0xcbd7a5}=await(0x0,ListCompaniesService_1[_0xa9b069(0x123)])({'searchParam':_0x525fb4,'pageNumber':_0x1c8a78});return _0x1f52fb[_0xa9b069(0x11f)]({'companies':_0x427550,'count':_0x4cdea7,'hasMore':_0xcbd7a5});};exports[a13_0x2b9b6a(0x141)]=index;const signup=async(_0x521fde,_0x16dada)=>{const _0x390671=a13_0x2b9b6a;if(await(0x0,CheckSettings_1[_0x390671(0x123)])('allowSignup')!=='enabled')return _0x16dada[_0x390671(0x120)](0x191)[_0x390671(0x11f)](_0x390671(0x127));return await(0x0,exports[_0x390671(0xfe)])(_0x521fde,_0x16dada);};exports['signup']=signup;const store=async(_0x212e5e,_0x2a58a5)=>{const _0x2dfc24=a13_0x2b9b6a,_0x1292ba=_0x212e5e['body'];try{const _0x20e831=await(0x0,CheckSettings_1[_0x2dfc24(0x123)])('trialExpiration'),_0x23c94b=parseInt(_0x20e831,0xa);isNaN(_0x23c94b)||_0x23c94b<=0x0?_0x1292ba['dueDate']=(0x0,moment_1[_0x2dfc24(0x123)])()[_0x2dfc24(0xfd)](0x7,_0x2dfc24(0x11a))[_0x2dfc24(0x142)]():_0x1292ba[_0x2dfc24(0x128)]=(0x0,moment_1[_0x2dfc24(0x123)])()[_0x2dfc24(0xfd)](_0x23c94b,_0x2dfc24(0x11a))[_0x2dfc24(0x142)]();const _0x562acc=await(0x0,CreateCompanyService_1[_0x2dfc24(0x123)])(_0x1292ba);return _0x2a58a5[_0x2dfc24(0x120)](0xc9)[_0x2dfc24(0x11f)](_0x562acc);}catch(_0x4acaae){return _0x2a58a5[_0x2dfc24(0x120)](0x1f4)[_0x2dfc24(0x11f)]({'message':_0x2dfc24(0x132),'error':_0x4acaae});}};exports[a13_0x2b9b6a(0xfe)]=store;const show=async(_0x5f2659,_0x58092d)=>{const _0x2e36fc=a13_0x2b9b6a,{id:_0x208dc7}=_0x5f2659[_0x2e36fc(0x125)],_0x361a4a=await User_1[_0x2e36fc(0x123)][_0x2e36fc(0x118)](_0x5f2659[_0x2e36fc(0x106)]['id']);if(!_0x361a4a['super']&&Number[_0x2e36fc(0x109)](_0x208dc7,0xa)!==_0x361a4a[_0x2e36fc(0x116)])throw new AppError_1['default'](_0x2e36fc(0x107),0x193);const _0x52f210=await(0x0,ShowCompanyService_1[_0x2e36fc(0x123)])(_0x208dc7);return _0x58092d['status'](0xc8)[_0x2e36fc(0x11f)](_0x52f210);};exports['show']=show;const list=async(_0x5bb237,_0x1d8179)=>{const _0x372f89=a13_0x2b9b6a,_0x2735a8=await(0x0,FindAllCompaniesService_1[_0x372f89(0x123)])();return _0x1d8179['status'](0xc8)['json'](_0x2735a8);};exports['list']=list;const update=async(_0x5539cc,_0xacd492)=>{const _0x1bba87=a13_0x2b9b6a,_0x450cba=_0x5539cc[_0x1bba87(0x10b)],_0x117f53=Yup[_0x1bba87(0x145)]()[_0x1bba87(0x131)]({'name':Yup[_0x1bba87(0x137)]()['required'](),'email':Yup[_0x1bba87(0x137)]()[_0x1bba87(0x133)]()['nullable'](),'phone':Yup[_0x1bba87(0x137)]()[_0x1bba87(0x134)](),'status':Yup[_0x1bba87(0x11c)]()[_0x1bba87(0x134)](),'planId':Yup['number']()[_0x1bba87(0x134)](),'campaignsEnabled':Yup['boolean']()[_0x1bba87(0x134)](),'dueDate':Yup[_0x1bba87(0x111)]()[_0x1bba87(0x134)](),'recurrence':Yup['string']()[_0x1bba87(0x134)]()});try{await _0x117f53[_0x1bba87(0x12f)](_0x450cba);}catch(_0x41da61){throw new AppError_1[(_0x1bba87(0x123))](_0x41da61[_0x1bba87(0x13e)]);}const {id:_0x3c01f8}=_0x5539cc[_0x1bba87(0x125)],_0x1f2918=await(0x0,UpdateCompanyService_1[_0x1bba87(0x123)])({'id':_0x3c01f8,..._0x450cba});return _0xacd492['status'](0xc8)[_0x1bba87(0x11f)](_0x1f2918);};exports[a13_0x2b9b6a(0x130)]=update;const updateSchedules=async(_0x29c1e0,_0x190bc4)=>{const _0x5c6304=a13_0x2b9b6a,{schedules:_0x13370e}=_0x29c1e0[_0x5c6304(0x10b)],{id:_0x320153}=_0x29c1e0[_0x5c6304(0x125)],_0x19ba5b=await User_1[_0x5c6304(0x123)][_0x5c6304(0x118)](_0x29c1e0[_0x5c6304(0x106)]['id']);if(!_0x19ba5b['super']&&Number[_0x5c6304(0x109)](_0x320153,0xa)!==_0x19ba5b['companyId'])throw new AppError_1[(_0x5c6304(0x123))]('ERR_FORBIDDEN',0x193);const _0x5f185e=await(0x0,UpdateSchedulesService_1[_0x5c6304(0x123)])({'id':_0x320153,'schedules':_0x13370e});return _0x190bc4['status'](0xc8)[_0x5c6304(0x11f)](_0x5f185e);};exports['updateSchedules']=updateSchedules;const remove=async(_0x1840d8,_0x3fd032)=>{const _0xec5f93=a13_0x2b9b6a,{id:_0x34ce90}=_0x1840d8[_0xec5f93(0x125)];fs_1[_0xec5f93(0x123)][_0xec5f93(0x13f)](publicFolder+_0xec5f93(0x100)+_0x34ce90+'/')&&fs_1[_0xec5f93(0x123)][_0xec5f93(0xfc)](publicFolder+_0xec5f93(0x100)+_0x34ce90+'/',{'recursive':!![]});const _0x543782=await(0x0,DeleteCompanyService_1[_0xec5f93(0x123)])(_0x34ce90);return _0x3fd032['status'](0xc8)[_0xec5f93(0x11f)](_0x543782);};exports['remove']=remove;const listPlan=async(_0x5cd469,_0x54a2f8)=>{const _0xede46a=a13_0x2b9b6a,{id:_0xc5a613}=_0x5cd469[_0xede46a(0x125)],_0x5466b1=_0x5cd469['headers']['authorization'],[,_0x1c9eed]=_0x5466b1['split']('\x20'),_0x4129db=(0x0,jsonwebtoken_1['verify'])(_0x1c9eed,auth_1[_0xede46a(0x123)][_0xede46a(0x121)]),{id:_0x2bd2ac,profile:_0x410382,companyId:_0x5f2fa1}=_0x4129db,_0xf0b6fe=await User_1[_0xede46a(0x123)]['findByPk'](_0x2bd2ac);if(_0xf0b6fe[_0xede46a(0x147)]===!![]||_0x5f2fa1['toString']()===_0xc5a613){const _0x1dfcb3=await(0x0,ShowPlanCompanyService_1['default'])(_0xc5a613);return _0x54a2f8[_0xede46a(0x120)](0xc8)[_0xede46a(0x11f)](_0x1dfcb3);}else return _0x54a2f8[_0xede46a(0x120)](0x190)[_0xede46a(0x11f)]({'error':_0xede46a(0x119)});};exports['listPlan']=listPlan;const indexPlan=async(_0x184118,_0x415a19)=>{const _0x1eaf9d=a13_0x2b9b6a,{searchParam:_0x5e1de0,pageNumber:_0x3f430b}=_0x184118[_0x1eaf9d(0x110)],_0x2e8ed8=_0x184118[_0x1eaf9d(0x10e)][_0x1eaf9d(0x14b)],[,_0x1ce5e3]=_0x2e8ed8[_0x1eaf9d(0x117)]('\x20'),_0x4522fb=(0x0,jsonwebtoken_1[_0x1eaf9d(0x12b)])(_0x1ce5e3,auth_1[_0x1eaf9d(0x123)]['secret']),{id:_0xde195f,profile:_0x466739,companyId:_0x3f931c}=_0x4522fb,_0xd5ecda=await User_1[_0x1eaf9d(0x123)]['findByPk'](_0xde195f);if(_0xd5ecda[_0x1eaf9d(0x147)]===!![]){const _0x45393f=await(0x0,ListCompaniesPlanService_1[_0x1eaf9d(0x123)])();return _0x415a19[_0x1eaf9d(0x11f)]({'companies':_0x45393f});}else return _0x415a19['status'](0x190)[_0x1eaf9d(0x11f)]({'error':_0x1eaf9d(0x119)});};exports[a13_0x2b9b6a(0x12e)]=indexPlan;function a13_0x2216(){const _0x433d55=['468288ZZGXcr','query','date','../services/CompanyService/CreateCompanyService','4fEzKdD','create','search','companyId','split','findByPk','Você\x20não\x20possui\x20permissão\x20para\x20acessar\x20este\x20recurso!','days','configurable','boolean','call','../models/User','json','status','secret','../services/CompanyService/ListCompaniesPlanService','default','__setModuleDefault','params','82608kRFuJb','🙎🏻‍♂️\x20Signup\x20disabled','dueDate','__importStar','jsonwebtoken','verify','listPlan','remove','indexPlan','validate','update','shape','Error\x20creating\x20company','email','nullable','../services/CompanyService/ShowCompanyService','toString','string','4302024leUbjo','writable','656656rZXAwC','1941705HdKYkc','../services/CompanyService/FindAllCompaniesService','updateSchedules','message','existsSync','get','index','toDate','constructor','getOwnPropertyDescriptor','object','../helpers/CheckSettings','super','yup','(((.+)+)+)+$','2504305THDaym','authorization','819SLNFJQ','defineProperty','public','path','rmdirSync','add','store','../services/CompanyService/ListCompaniesService','/company','../services/CompanyService/ShowPlanCompanyService','__createBinding','prototype','__esModule','212776kPnsjo','user','ERR_FORBIDDEN','list','parseInt','apply','body','../services/CompanyService/UpdateCompanyService','signup','headers'];a13_0x2216=function(){return _0x433d55;};return a13_0x2216();}