const a33_0xf33c3c=a33_0x2454;(function(_0x5ca3b6,_0x5a15cd){const _0x394750=a33_0x2454,_0x455f20=_0x5ca3b6();while(!![]){try{const _0x368be1=parseInt(_0x394750(0x72))/0x1+-parseInt(_0x394750(0x91))/0x2+-parseInt(_0x394750(0x8c))/0x3*(-parseInt(_0x394750(0x8d))/0x4)+-parseInt(_0x394750(0x8a))/0x5*(parseInt(_0x394750(0x78))/0x6)+-parseInt(_0x394750(0x7b))/0x7*(-parseInt(_0x394750(0x7d))/0x8)+parseInt(_0x394750(0x69))/0x9*(parseInt(_0x394750(0x80))/0xa)+-parseInt(_0x394750(0x83))/0xb;if(_0x368be1===_0x5a15cd)break;else _0x455f20['push'](_0x455f20['shift']());}catch(_0x175293){_0x455f20['push'](_0x455f20['shift']());}}}(a33_0x4bad,0xa15e6));const a33_0x1c1323=(function(){let _0x35e449=!![];return function(_0x2213a5,_0xe69af0){const _0x4ca26f=_0x35e449?function(){const _0x47409e=a33_0x2454;if(_0xe69af0){const _0x3a1f86=_0xe69af0[_0x47409e(0x84)](_0x2213a5,arguments);return _0xe69af0=null,_0x3a1f86;}}:function(){};return _0x35e449=![],_0x4ca26f;};}()),a33_0x4a1b5a=a33_0x1c1323(this,function(){const _0x5e1e40=a33_0x2454;return a33_0x4a1b5a[_0x5e1e40(0x94)]()['search'](_0x5e1e40(0x92))['toString']()[_0x5e1e40(0x81)](a33_0x4a1b5a)[_0x5e1e40(0x9e)](_0x5e1e40(0x92));});a33_0x4a1b5a();'use strict';function a33_0x2454(_0x57698d,_0x2a120f){const _0xc3a469=a33_0x4bad();return a33_0x2454=function(_0x4a1b5a,_0x1c1323){_0x4a1b5a=_0x4a1b5a-0x68;let _0x4bad2=_0xc3a469[_0x4a1b5a];return _0x4bad2;},a33_0x2454(_0x57698d,_0x2a120f);}var __importDefault=this&&this[a33_0xf33c3c(0x7e)]||function(_0x1bb5dc){const _0x2ebec5=a33_0xf33c3c;return _0x1bb5dc&&_0x1bb5dc[_0x2ebec5(0x9a)]?_0x1bb5dc:{'default':_0x1bb5dc};};Object['defineProperty'](exports,a33_0xf33c3c(0x9a),{'value':!![]});const Ticket_1=__importDefault(require(a33_0xf33c3c(0x8e))),sequelize_1=require(a33_0xf33c3c(0x9d)),moment_1=__importDefault(require(a33_0xf33c3c(0x6f))),User_1=__importDefault(require(a33_0xf33c3c(0x99))),Queue_1=__importDefault(require(a33_0xf33c3c(0x79))),TicketTag_1=__importDefault(require(a33_0xf33c3c(0x98))),Tag_1=__importDefault(require(a33_0xf33c3c(0x96))),Whatsapp_1=__importDefault(require(a33_0xf33c3c(0x86))),TicketTraking_1=__importDefault(require('../models/TicketTraking')),Contact_1=__importDefault(require(a33_0xf33c3c(0x6e))),ReportController={'tickets':async(_0x5526c4,_0x50d9a7)=>{const _0x19c6dc=a33_0xf33c3c,{companyId:_0x1aa0f6}=_0x5526c4['user'];let {dateStart:_0x21ead8,dateEnd:_0x2e89d2,status:_0x1e58c5,queueId:_0x486ac2}=_0x5526c4[_0x19c6dc(0x7f)],_0x458bca={'companyId':_0x1aa0f6};_0x486ac2&&(_0x458bca[_0x19c6dc(0x90)]=_0x486ac2);_0x1e58c5&&(_0x458bca[_0x19c6dc(0x9b)]=_0x1e58c5);let _0x399cdc=await Ticket_1['default'][_0x19c6dc(0x95)]({'where':{..._0x458bca,'createdAt':{[sequelize_1['Op']['between']]:[(0x0,moment_1[_0x19c6dc(0xa0)])(_0x21ead8)[_0x19c6dc(0x68)](_0x19c6dc(0x6c))[_0x19c6dc(0x70)](),(0x0,moment_1['default'])(_0x2e89d2)[_0x19c6dc(0x7a)](_0x19c6dc(0x6c))[_0x19c6dc(0x70)]()]}},'include':[{'model':User_1[_0x19c6dc(0xa0)],'as':_0x19c6dc(0x85),'attributes':['id',_0x19c6dc(0x82),'profile']},{'model':Queue_1['default'],'as':_0x19c6dc(0x76),'attributes':['id',_0x19c6dc(0x82)]},{'model':Whatsapp_1[_0x19c6dc(0xa0)],'as':'whatsapp','attributes':['id',_0x19c6dc(0x82)]}],'attributes':['id',_0x19c6dc(0x89),_0x19c6dc(0x9b),'queueId',_0x19c6dc(0x7c),'contactId'],'order':[[_0x19c6dc(0x89),'DESC']]}),_0x4f88c7=[];for(let _0x4bf6fb of _0x399cdc){const _0x411160=await TicketTag_1[_0x19c6dc(0xa0)][_0x19c6dc(0x95)]({'attributes':[_0x19c6dc(0x71)],'where':{'ticketId':_0x4bf6fb['id']},'include':[{'model':Tag_1[_0x19c6dc(0xa0)],'as':_0x19c6dc(0x97),'attributes':['id','name']}]});var _0x180867=await TicketTraking_1[_0x19c6dc(0xa0)][_0x19c6dc(0x88)]({'where':{'ticketId':_0x4bf6fb['id']},'attributes':['startedAt',_0x19c6dc(0x6b),_0x19c6dc(0x73),'rated',_0x19c6dc(0x89),_0x19c6dc(0x8f)]});let _0x1e7285=await Contact_1['default']['findOne']({'attributes':['createdAt',_0x19c6dc(0x82),'number'],'where':{'id':_0x4bf6fb[_0x19c6dc(0x8b)]}}),_0x4427ab=![];_0x1e7285&&(_0x4427ab=(0x0,moment_1[_0x19c6dc(0xa0)])(_0x1e7285['createdAt'])[_0x19c6dc(0x9c)]((0x0,moment_1[_0x19c6dc(0xa0)])(_0x4bf6fb[_0x19c6dc(0x89)])['subtract'](0x1,_0x19c6dc(0x75)),(0x0,moment_1[_0x19c6dc(0xa0)])(_0x4bf6fb[_0x19c6dc(0x89)])['add'](0x1,_0x19c6dc(0x75)))),_0x4f88c7[_0x19c6dc(0x9f)]({'id':_0x4bf6fb['id'],'contactName':_0x1e7285?.['name']||_0x19c6dc(0x74),'contactNumber':_0x1e7285?.['number']||_0x19c6dc(0x74),'createdAt':_0x4bf6fb?.[_0x19c6dc(0x89)],'startedAt':_0x180867?.[_0x19c6dc(0x93)],'queuedAt':_0x180867?.[_0x19c6dc(0x6b)],'ratingAt':_0x180867?.[_0x19c6dc(0x73)],'rated':_0x180867?.['rated'],'status':_0x4bf6fb[_0x19c6dc(0x9b)],'user':_0x4bf6fb[_0x19c6dc(0x85)]?.[_0x19c6dc(0x82)]||_0x19c6dc(0x74),'userId':_0x4bf6fb['userId'],'queue':_0x4bf6fb[_0x19c6dc(0x76)]?.[_0x19c6dc(0x82)]||_0x19c6dc(0x74),'queueId':_0x4bf6fb[_0x19c6dc(0x90)],'connection':_0x4bf6fb[_0x19c6dc(0x6d)]['name'],'connectionId':_0x4bf6fb[_0x19c6dc(0x6d)]['id'],'firstSentMessageAt':_0x180867?.[_0x19c6dc(0x89)],'resolvedAt':_0x180867?.['finishedAt'],'isNewContact':_0x4427ab,'tags':_0x411160[_0x19c6dc(0x6a)](_0x1b3870=>_0x1b3870[_0x19c6dc(0x97)][_0x19c6dc(0x82)])[_0x19c6dc(0x77)](',')});}return _0x50d9a7[_0x19c6dc(0x87)](_0x4f88c7);}};exports[a33_0xf33c3c(0xa0)]=ReportController;function a33_0x4bad(){const _0x4af18b=['../models/Tag','tag','../models/TicketTag','../models/User','__esModule','status','isBetween','sequelize','search','push','default','startOf','8234307rcYHjK','map','queuedAt','day','whatsapp','../models/Contact','moment/moment','toDate','tagId','996730ALOSBv','ratingAt','N/A','minute','queue','join','27696nIMTWz','../models/Queue','endOf','21eFJTBg','userId','2091776QKNQnY','__importDefault','body','10GTELSi','constructor','name','7237692cwczCk','apply','user','../models/Whatsapp','json','findOne','createdAt','670LoNoTo','contactId','12eEjexz','208UNIgUD','../models/Ticket','finishedAt','queueId','1517590lBDqdQ','(((.+)+)+)+$','startedAt','toString','findAll'];a33_0x4bad=function(){return _0x4af18b;};return a33_0x4bad();}