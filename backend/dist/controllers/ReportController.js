const a33_0x5c18c8=a33_0x4564;(function(_0x4568ad,_0x4cc7b8){const _0x58e4fd=a33_0x4564,_0x2ceb88=_0x4568ad();while(!![]){try{const _0x9d18e1=-parseInt(_0x58e4fd(0xa3))/0x1*(-parseInt(_0x58e4fd(0xb5))/0x2)+parseInt(_0x58e4fd(0xbf))/0x3*(-parseInt(_0x58e4fd(0xb2))/0x4)+parseInt(_0x58e4fd(0x9e))/0x5*(-parseInt(_0x58e4fd(0xa1))/0x6)+-parseInt(_0x58e4fd(0xa0))/0x7+parseInt(_0x58e4fd(0xb0))/0x8+-parseInt(_0x58e4fd(0x92))/0x9+parseInt(_0x58e4fd(0xb3))/0xa;if(_0x9d18e1===_0x4cc7b8)break;else _0x2ceb88['push'](_0x2ceb88['shift']());}catch(_0x54072e){_0x2ceb88['push'](_0x2ceb88['shift']());}}}(a33_0x41e0,0x3d4e7));const a33_0x4eefff=(function(){let _0x19c49c=!![];return function(_0x15ad07,_0x300d12){const _0x34b525=_0x19c49c?function(){const _0x308d6=a33_0x4564;if(_0x300d12){const _0x102ff9=_0x300d12[_0x308d6(0xbd)](_0x15ad07,arguments);return _0x300d12=null,_0x102ff9;}}:function(){};return _0x19c49c=![],_0x34b525;};}()),a33_0x2e1450=a33_0x4eefff(this,function(){const _0x3849c1=a33_0x4564;return a33_0x2e1450[_0x3849c1(0xc1)]()[_0x3849c1(0xa7)]('(((.+)+)+)+$')[_0x3849c1(0xc1)]()[_0x3849c1(0xb4)](a33_0x2e1450)[_0x3849c1(0xa7)](_0x3849c1(0xc3));});function a33_0x41e0(){const _0xc1b6e4=['queueId','(((.+)+)+)+$','finishedAt','../models/Tag','ratingAt','../models/Contact','1656891yisCVU','startedAt','moment/moment','../models/TicketTraking','toDate','map','__esModule','whatsapp','DESC','queuedAt','tag','json','260XhvCYq','N/A','2990708feDQSG','37794yXQcGV','status','2lGpLMT','default','subtract','name','search','findOne','add','userId','body','../models/Whatsapp','isBetween','minute','queue','918592HLQCvP','rated','4DEVANc','13411120ifEAUc','constructor','43742bzGoBO','contactId','../models/TicketTag','findAll','../models/Ticket','profile','push','user','apply','day','929028nkaFXy','createdAt','toString'];a33_0x41e0=function(){return _0xc1b6e4;};return a33_0x41e0();}a33_0x2e1450();function a33_0x4564(_0x4fb5bf,_0x2a901f){const _0xa99d5f=a33_0x41e0();return a33_0x4564=function(_0x2e1450,_0x4eefff){_0x2e1450=_0x2e1450-0x8e;let _0x41e033=_0xa99d5f[_0x2e1450];return _0x41e033;},a33_0x4564(_0x4fb5bf,_0x2a901f);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x49e061){const _0x5dd541=a33_0x4564;return _0x49e061&&_0x49e061[_0x5dd541(0x98)]?_0x49e061:{'default':_0x49e061};};Object['defineProperty'](exports,a33_0x5c18c8(0x98),{'value':!![]});const Ticket_1=__importDefault(require(a33_0x5c18c8(0xb9))),sequelize_1=require('sequelize'),moment_1=__importDefault(require(a33_0x5c18c8(0x94))),User_1=__importDefault(require('../models/User')),Queue_1=__importDefault(require('../models/Queue')),TicketTag_1=__importDefault(require(a33_0x5c18c8(0xb7))),Tag_1=__importDefault(require(a33_0x5c18c8(0x8f))),Whatsapp_1=__importDefault(require(a33_0x5c18c8(0xac))),TicketTraking_1=__importDefault(require(a33_0x5c18c8(0x95))),Contact_1=__importDefault(require(a33_0x5c18c8(0x91))),ReportController={'tickets':async(_0x279a38,_0x31ae09)=>{const _0x1ea685=a33_0x5c18c8,{companyId:_0x12b511}=_0x279a38['user'];let {dateStart:_0x2b8af8,dateEnd:_0x51f6f4,status:_0x357cb1,queueId:_0x5b1abc}=_0x279a38[_0x1ea685(0xab)],_0x23cf41={'companyId':_0x12b511};_0x5b1abc&&(_0x23cf41[_0x1ea685(0xc2)]=_0x5b1abc);_0x357cb1&&(_0x23cf41[_0x1ea685(0xa2)]=_0x357cb1);let _0x9f6faa=await Ticket_1[_0x1ea685(0xa4)][_0x1ea685(0xb8)]({'where':{..._0x23cf41,'createdAt':{[sequelize_1['Op']['between']]:[(0x0,moment_1[_0x1ea685(0xa4)])(_0x2b8af8)['startOf'](_0x1ea685(0xbe))[_0x1ea685(0x96)](),(0x0,moment_1[_0x1ea685(0xa4)])(_0x51f6f4)['endOf']('day')[_0x1ea685(0x96)]()]}},'include':[{'model':User_1[_0x1ea685(0xa4)],'as':_0x1ea685(0xbc),'attributes':['id',_0x1ea685(0xa6),_0x1ea685(0xba)]},{'model':Queue_1[_0x1ea685(0xa4)],'as':_0x1ea685(0xaf),'attributes':['id',_0x1ea685(0xa6)]},{'model':Whatsapp_1[_0x1ea685(0xa4)],'as':_0x1ea685(0x99),'attributes':['id','name']}],'attributes':['id',_0x1ea685(0xc0),_0x1ea685(0xa2),_0x1ea685(0xc2),_0x1ea685(0xaa),_0x1ea685(0xb6)],'order':[[_0x1ea685(0xc0),_0x1ea685(0x9a)]]}),_0x2f25eb=[];for(let _0x152e29 of _0x9f6faa){const _0x1b2d20=await TicketTag_1['default']['findAll']({'attributes':['tagId'],'where':{'ticketId':_0x152e29['id']},'include':[{'model':Tag_1[_0x1ea685(0xa4)],'as':_0x1ea685(0x9c),'attributes':['id','name']}]});var _0x55f3a6=await TicketTraking_1[_0x1ea685(0xa4)][_0x1ea685(0xa8)]({'where':{'ticketId':_0x152e29['id']},'attributes':[_0x1ea685(0x93),_0x1ea685(0x9b),'ratingAt',_0x1ea685(0xb1),_0x1ea685(0xc0),_0x1ea685(0x8e)]});let _0x1e1756=await Contact_1[_0x1ea685(0xa4)][_0x1ea685(0xa8)]({'attributes':['createdAt',_0x1ea685(0xa6),'number'],'where':{'id':_0x152e29['contactId']}}),_0x27a678=![];_0x1e1756&&(_0x27a678=(0x0,moment_1[_0x1ea685(0xa4)])(_0x1e1756[_0x1ea685(0xc0)])[_0x1ea685(0xad)]((0x0,moment_1[_0x1ea685(0xa4)])(_0x152e29[_0x1ea685(0xc0)])[_0x1ea685(0xa5)](0x1,_0x1ea685(0xae)),(0x0,moment_1[_0x1ea685(0xa4)])(_0x152e29[_0x1ea685(0xc0)])[_0x1ea685(0xa9)](0x1,'minute'))),_0x2f25eb[_0x1ea685(0xbb)]({'id':_0x152e29['id'],'contactName':_0x1e1756?.[_0x1ea685(0xa6)]||_0x1ea685(0x9f),'contactNumber':_0x1e1756?.['number']||_0x1ea685(0x9f),'createdAt':_0x152e29?.[_0x1ea685(0xc0)],'startedAt':_0x55f3a6?.['startedAt'],'queuedAt':_0x55f3a6?.[_0x1ea685(0x9b)],'ratingAt':_0x55f3a6?.[_0x1ea685(0x90)],'rated':_0x55f3a6?.[_0x1ea685(0xb1)],'status':_0x152e29[_0x1ea685(0xa2)],'user':_0x152e29['user']?.[_0x1ea685(0xa6)]||_0x1ea685(0x9f),'userId':_0x152e29[_0x1ea685(0xaa)],'queue':_0x152e29[_0x1ea685(0xaf)]?.[_0x1ea685(0xa6)]||'N/A','queueId':_0x152e29['queueId'],'connection':_0x152e29[_0x1ea685(0x99)][_0x1ea685(0xa6)],'connectionId':_0x152e29['whatsapp']['id'],'firstSentMessageAt':_0x55f3a6?.[_0x1ea685(0xc0)],'resolvedAt':_0x55f3a6?.['finishedAt'],'isNewContact':_0x27a678,'tags':_0x1b2d20[_0x1ea685(0x97)](_0xbd7535=>_0xbd7535[_0x1ea685(0x9c)]['name'])['join'](',')});}return _0x31ae09[_0x1ea685(0x9d)](_0x2f25eb);}};exports[a33_0x5c18c8(0xa4)]=ReportController;