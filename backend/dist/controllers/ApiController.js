const a9_0x3c4e11=a9_0x28be;(function(_0xb1cf67,_0x2f1f9b){const _0xc95d80=a9_0x28be,_0x411f79=_0xb1cf67();while(!![]){try{const _0x23d4fb=parseInt(_0xc95d80(0x20e))/0x1*(-parseInt(_0xc95d80(0x1be))/0x2)+-parseInt(_0xc95d80(0x1f5))/0x3*(parseInt(_0xc95d80(0x268))/0x4)+parseInt(_0xc95d80(0x279))/0x5*(-parseInt(_0xc95d80(0x226))/0x6)+parseInt(_0xc95d80(0x236))/0x7+-parseInt(_0xc95d80(0x262))/0x8*(-parseInt(_0xc95d80(0x23c))/0x9)+-parseInt(_0xc95d80(0x1e2))/0xa*(-parseInt(_0xc95d80(0x1bb))/0xb)+parseInt(_0xc95d80(0x1e6))/0xc;if(_0x23d4fb===_0x2f1f9b)break;else _0x411f79['push'](_0x411f79['shift']());}catch(_0x22db52){_0x411f79['push'](_0x411f79['shift']());}}}(a9_0x2201,0x84831));const a9_0x51802f=(function(){let _0x55a07c=!![];return function(_0x5cd721,_0x8be272){const _0x3d9bdf=_0x55a07c?function(){const _0x5dec67=a9_0x28be;if(_0x8be272){const _0x363608=_0x8be272[_0x5dec67(0x27a)](_0x5cd721,arguments);return _0x8be272=null,_0x363608;}}:function(){};return _0x55a07c=![],_0x3d9bdf;};}()),a9_0x12b591=a9_0x51802f(this,function(){const _0x3ba6c0=a9_0x28be;return a9_0x12b591[_0x3ba6c0(0x1bf)]()['search']('(((.+)+)+)+$')['toString']()[_0x3ba6c0(0x1e8)](a9_0x12b591)[_0x3ba6c0(0x1c8)]('(((.+)+)+)+$');});a9_0x12b591();'use strict';var __createBinding=this&&this[a9_0x3c4e11(0x21d)]||(Object['create']?function(_0x4c21a3,_0x3f8d48,_0x294ec8,_0x56d00f){const _0x824da8=a9_0x3c4e11;if(_0x56d00f===undefined)_0x56d00f=_0x294ec8;var _0x42652c=Object['getOwnPropertyDescriptor'](_0x3f8d48,_0x294ec8);(!_0x42652c||('get'in _0x42652c?!_0x3f8d48['__esModule']:_0x42652c[_0x824da8(0x1d6)]||_0x42652c[_0x824da8(0x27f)]))&&(_0x42652c={'enumerable':!![],'get':function(){return _0x3f8d48[_0x294ec8];}}),Object[_0x824da8(0x241)](_0x4c21a3,_0x56d00f,_0x42652c);}:function(_0x12a7ac,_0x2502e5,_0x492947,_0x11ea2b){if(_0x11ea2b===undefined)_0x11ea2b=_0x492947;_0x12a7ac[_0x11ea2b]=_0x2502e5[_0x492947];}),__setModuleDefault=this&&this[a9_0x3c4e11(0x219)]||(Object['create']?function(_0x2d7843,_0x48b669){const _0x577fc2=a9_0x3c4e11;Object[_0x577fc2(0x241)](_0x2d7843,'default',{'enumerable':!![],'value':_0x48b669});}:function(_0x21dc73,_0x37ad16){const _0x50708e=a9_0x3c4e11;_0x21dc73[_0x50708e(0x1af)]=_0x37ad16;}),__importStar=this&&this['__importStar']||function(_0x36b2e2){const _0x3061e4=a9_0x3c4e11;if(_0x36b2e2&&_0x36b2e2[_0x3061e4(0x22c)])return _0x36b2e2;var _0x564551={};if(_0x36b2e2!=null){for(var _0x4e7dea in _0x36b2e2)if(_0x4e7dea!==_0x3061e4(0x1af)&&Object[_0x3061e4(0x1f1)][_0x3061e4(0x21b)][_0x3061e4(0x20f)](_0x36b2e2,_0x4e7dea))__createBinding(_0x564551,_0x36b2e2,_0x4e7dea);}return __setModuleDefault(_0x564551,_0x36b2e2),_0x564551;},__importDefault=this&&this[a9_0x3c4e11(0x22b)]||function(_0x296d79){return _0x296d79&&_0x296d79['__esModule']?_0x296d79:{'default':_0x296d79};};Object[a9_0x3c4e11(0x241)](exports,a9_0x3c4e11(0x22c),{'value':!![]}),exports[a9_0x3c4e11(0x258)]=exports[a9_0x3c4e11(0x22a)]=exports[a9_0x3c4e11(0x25c)]=exports[a9_0x3c4e11(0x26e)]=exports[a9_0x3c4e11(0x224)]=exports[a9_0x3c4e11(0x246)]=exports['findOrCreateContacts']=exports['showContacts']=exports[a9_0x3c4e11(0x1df)]=exports[a9_0x3c4e11(0x23a)]=exports['updateUsageStats']=exports['updateApi']=exports[a9_0x3c4e11(0x251)]=exports[a9_0x3c4e11(0x253)]=exports['indexApi']=exports[a9_0x3c4e11(0x1f4)]=exports['makeid']=exports[a9_0x3c4e11(0x1ca)]=exports[a9_0x3c4e11(0x1f0)]=exports[a9_0x3c4e11(0x27d)]=exports[a9_0x3c4e11(0x1e7)]=exports[a9_0x3c4e11(0x245)]=exports[a9_0x3c4e11(0x216)]=exports[a9_0x3c4e11(0x1aa)]=exports['indexWhatsappsId']=exports['checkNumber']=exports[a9_0x3c4e11(0x240)]=exports['index']=exports[a9_0x3c4e11(0x26b)]=exports[a9_0x3c4e11(0x21c)]=exports[a9_0x3c4e11(0x1ed)]=exports[a9_0x3c4e11(0x25f)]=exports[a9_0x3c4e11(0x1ec)]=void 0x0;const axios_1=__importDefault(require(a9_0x3c4e11(0x238))),fs_1=__importDefault(require('fs')),Yup=__importStar(require('yup')),lodash_1=require(a9_0x3c4e11(0x215)),GetDefaultWhatsApp_1=__importDefault(require(a9_0x3c4e11(0x221))),SetTicketMessagesAsRead_1=__importDefault(require(a9_0x3c4e11(0x23b))),socket_1=require(a9_0x3c4e11(0x1f2)),Whatsapp_1=__importDefault(require(a9_0x3c4e11(0x1d9))),Queue_1=__importDefault(require(a9_0x3c4e11(0x254))),User_1=__importDefault(require(a9_0x3c4e11(0x1fa))),CreateOrUpdateContactService_1=__importDefault(require(a9_0x3c4e11(0x244))),FindOrCreateTicketService_1=__importDefault(require('../services/TicketServices/FindOrCreateTicketService')),ShowTicketService_1=__importDefault(require(a9_0x3c4e11(0x228))),GetProfilePicUrl_1=__importDefault(require(a9_0x3c4e11(0x27e))),SendWhatsAppMedia_1=__importDefault(require(a9_0x3c4e11(0x273))),UpdateTicketService_1=__importDefault(require(a9_0x3c4e11(0x231))),wbot_1=require(a9_0x3c4e11(0x1a6)),SendWhatsAppMessageLink_1=__importDefault(require(a9_0x3c4e11(0x1c1))),SendWhatsAppMessageAPI_1=__importDefault(require(a9_0x3c4e11(0x27b))),SendWhatsappMediaImage_1=__importDefault(require(a9_0x3c4e11(0x1ef))),ListInvoicesServices_1=__importDefault(require(a9_0x3c4e11(0x1ee))),ShowInvoiceService_1=__importDefault(require(a9_0x3c4e11(0x211))),UpdateInvoiceService_1=__importDefault(require(a9_0x3c4e11(0x235))),Invoices_1=__importDefault(require('../models/Invoices')),ListContactsService_1=__importDefault(require('../services/ContactServices/ListContactsService')),CreateContactService_1=__importDefault(require(a9_0x3c4e11(0x249))),ShowContactService_1=__importDefault(require(a9_0x3c4e11(0x24f))),UpdateContactService_1=__importDefault(require(a9_0x3c4e11(0x1fc))),DeleteContactService_1=__importDefault(require(a9_0x3c4e11(0x222))),GetContactService_1=__importDefault(require(a9_0x3c4e11(0x1b4))),ToggleDisableBotService_1=__importDefault(require(a9_0x3c4e11(0x20b))),CheckNumber_1=__importDefault(require(a9_0x3c4e11(0x22d))),CheckIsValidContact_1=__importDefault(require(a9_0x3c4e11(0x1ba))),AppError_1=__importDefault(require(a9_0x3c4e11(0x1ac))),SimpleListService_1=__importDefault(require(a9_0x3c4e11(0x1b0))),ImportXLSContactsService_1=require(a9_0x3c4e11(0x283)),ApiUsages_1=__importDefault(require(a9_0x3c4e11(0x207))),useDate_1=require(a9_0x3c4e11(0x214)),TicketTag_1=__importDefault(require('../models/TicketTag')),Tag_1=__importDefault(require(a9_0x3c4e11(0x209))),moment_1=__importDefault(require(a9_0x3c4e11(0x1dd))),path_1=__importDefault(require(a9_0x3c4e11(0x1a8))),Ticket_1=__importDefault(require(a9_0x3c4e11(0x1a9))),Contact_1=__importDefault(require('../models/Contact')),Company_1=__importDefault(require(a9_0x3c4e11(0x1c3))),SendPresenceStatus_1=require(a9_0x3c4e11(0x1fd));function a9_0x28be(_0xac5d61,_0x12193c){const _0x232365=a9_0x2201();return a9_0x28be=function(_0x12b591,_0x51802f){_0x12b591=_0x12b591-0x1a4;let _0x22018c=_0x232365[_0x12b591];return _0x22018c;},a9_0x28be(_0xac5d61,_0x12193c);}class OnWhatsAppDto{constructor(_0x14afb3,_0x1b9559){this['jid']=_0x14afb3,this['exists']=_0x1b9559;}}function a9_0x2201(){const _0x469950=['Invalid\x20queue\x20for\x20the\x20company','includes','2045RTQXML','apply','../services/WbotServices/SendWhatsAppMessageAPI','extname','listTicketsByCompany','../services/WbotServices/GetProfilePicUrl','configurable','sendMessage','boolean','arraybuffer','../services/ContactServices/ImportXLSContactsService','create','getDate','../libs/wbot','\x20not\x20found','path','../models/Ticket','updateQueueId','profilePicUrl','../errors/AppError','showContacts','usedCheckNumber','default','../services/ContactServices/SimpleListService','pending','Error\x20removing\x20all\x20contacts:','random','../services/ContactServices/GetContactService','files','log','queue','split','-mainchannel','../services/WbotServices/CheckIsValidContact','865777cWQbUU','findByPk','setDate','466982BdStVf','toString','email','../services/WbotServices/SendWhatsAppMessageLink','onWhatsApp','../models/Company','whatsapp','@s.whatsapp.net','@g.us','Error\x20updating\x20usage\x20stats:','search','contact','listTicketsByTagIsAuth','reload','validate','dataValues','indexApi','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','company','parseInt','from','object','company-','name','writable','number','ERRO','../models/Whatsapp','findOne','paid','exists','moment','video','listContacts','usedImage','data','60xmCNFa','length','delete','usedVideo','2342736ybaEuP','removeTicketTag','constructor','string','replace','getIO','OnWhatsAppDto','updateCompany','../services/InvoicesService/ListInvoicesServices','../services/WbotServices/SendWhatsappMediaImage','listTicketsByTag','prototype','../libs/socket','updateUsageStats','handleAudioLink','489741GpyIva','mimetype','usedOther','all','format','../models/User','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','../services/ContactServices/UpdateContactService','../helpers/SendPresenceStatus','Company\x20not\x20found','readFileSync','active','SUCCESS','destroy','.mp3','Internal\x20server\x20error','map','update','../models/ApiUsages','usedText','../models/Tag','checkNumber','../services/ContactServices/ToggleDisableBotService','status','get','4FeBVwl','call','findAll','../services/InvoicesService/ShowInvoiceService','color','Token\x20de\x20autorização\x20inválido','../utils/useDate','lodash','closeTicket','matches','headers','__setModuleDefault','req','hasOwnProperty','blockCompany','__createBinding','floor','params','indexWhatsappsId','../helpers/GetDefaultWhatsApp','../services/ContactServices/DeleteContactService','index','removeAllContacts','Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company','1122gXNJYT','shape','../services/TicketServices/ShowTicketService','usedPDF','uploadContacts','__importDefault','__esModule','../services/WbotServices/CheckNumber','findOrCreateContacts','Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio','Internal\x20Server\x20Error','../services/TicketServices/UpdateTicketService','charAt','pdf','companyId','../services/InvoicesService/UpdateInvoiceService','2800056ECyeqN','error','axios','originalname','indexContacts','../helpers/SetTicketMessagesAsRead','279nSqruC','makeid','useDate','message','indexImage','defineProperty','Not\x20exists\x20on\x20Whatsapp','disableBot','../services/ContactServices/CreateOrUpdateContactService','updateTicketTag','storeContacts','./public/company','json','../services/ContactServices/CreateContactService','authorization','body','send','ERROR','acceptAudioMessage','../services/ContactServices/ShowContactService','tags','showAllApi','dueDate','showApi','../models/Queue','test','ticketData','Legenda\x20do\x20áudio','toggleDisableBotContacts','image','facebookUserToken','Failed\x20to\x20remove\x20ticket\x20tag','removeContacts','required','extraInfo','createCompany','writeFileSync','nullable','167480uvPufK','date','Failed\x20to\x20update\x20ticket\x20tag','query','type','Missing\x20user\x20or\x20companyId','4mLyHfB','jid','user','indexLink','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','toISOString','updateContacts','emit','getWbot','facebookUserId','Erro\x20ao\x20buscar\x20invoices:','../services/WbotServices/SendWhatsAppMedia','-contact','deleteAll','UsedOnDay'];a9_0x2201=function(){return _0x469950;};return a9_0x2201();}exports[a9_0x3c4e11(0x1ec)]=OnWhatsAppDto;const CompanySchema=Yup['object']()['shape']({'name':Yup['string']()[a9_0x3c4e11(0x25d)](),'id':Yup[a9_0x3c4e11(0x1d7)](),'phone':Yup[a9_0x3c4e11(0x1e9)]()[a9_0x3c4e11(0x261)](),'email':Yup[a9_0x3c4e11(0x1e9)]()[a9_0x3c4e11(0x1c0)]()[a9_0x3c4e11(0x261)](),'status':Yup[a9_0x3c4e11(0x281)]()[a9_0x3c4e11(0x261)](),'planId':Yup[a9_0x3c4e11(0x1d7)]()['nullable'](),'campaignsEnabled':Yup[a9_0x3c4e11(0x281)]()['nullable'](),'dueDate':Yup[a9_0x3c4e11(0x263)]()[a9_0x3c4e11(0x261)](),'recurrence':Yup[a9_0x3c4e11(0x1e9)]()[a9_0x3c4e11(0x261)]()}),createCompany=async(_0x25fee6,_0xd69ce3)=>{const _0x4561ad=a9_0x3c4e11;try{await CompanySchema[_0x4561ad(0x1cc)](_0x25fee6[_0x4561ad(0x24b)]);const _0x371f2d=await Company_1[_0x4561ad(0x1af)][_0x4561ad(0x1a4)](_0x25fee6[_0x4561ad(0x24b)]);_0xd69ce3[_0x4561ad(0x20c)](0xc9)[_0x4561ad(0x248)](_0x371f2d);}catch(_0x1b9796){_0xd69ce3[_0x4561ad(0x20c)](0x190)[_0x4561ad(0x248)]({'error':_0x1b9796[_0x4561ad(0x23f)]});}};exports[a9_0x3c4e11(0x25f)]=createCompany;const updateCompany=async(_0x5e037a,_0x2e4776)=>{const _0x709be6=a9_0x3c4e11;try{await CompanySchema[_0x709be6(0x1cc)](_0x5e037a['body']);const {id:_0x4afaba}=_0x5e037a['params'],[_0x2a83ba]=await Company_1[_0x709be6(0x1af)][_0x709be6(0x206)](_0x5e037a[_0x709be6(0x24b)],{'where':{'id':_0x4afaba}});if(_0x2a83ba){const _0x206ad7=await Company_1[_0x709be6(0x1af)][_0x709be6(0x1bc)](_0x4afaba);_0x2e4776[_0x709be6(0x20c)](0xc8)[_0x709be6(0x248)](_0x206ad7);}else _0x2e4776['status'](0x194)[_0x709be6(0x248)]({'error':_0x709be6(0x1fe)});}catch(_0x4729b9){_0x2e4776[_0x709be6(0x20c)](0x190)[_0x709be6(0x248)]({'error':_0x4729b9[_0x709be6(0x23f)]});}};exports[a9_0x3c4e11(0x1ed)]=updateCompany;const blockCompany=async(_0x429077,_0x30fa24)=>{const _0x5db7d3=a9_0x3c4e11;try{const {id:_0x570566}=_0x429077[_0x5db7d3(0x21f)],[_0x2de78f]=await Company_1[_0x5db7d3(0x1af)][_0x5db7d3(0x206)]({'status':![]},{'where':{'id':_0x570566}});if(_0x2de78f){const _0x4f297e=await Company_1[_0x5db7d3(0x1af)][_0x5db7d3(0x1bc)](_0x570566);_0x30fa24[_0x5db7d3(0x20c)](0xc8)[_0x5db7d3(0x248)](_0x4f297e);}else _0x30fa24[_0x5db7d3(0x20c)](0x194)['json']({'error':_0x5db7d3(0x1fe)});}catch(_0x3eea02){_0x30fa24[_0x5db7d3(0x20c)](0x190)['json']({'error':_0x3eea02[_0x5db7d3(0x23f)]});}};exports[a9_0x3c4e11(0x21c)]=blockCompany;const createContact=async(_0x491e93,_0x369e4d,_0x2e63dc)=>{const _0x5b2ed5=a9_0x3c4e11;await(0x0,CheckIsValidContact_1[_0x5b2ed5(0x1af)])(_0x2e63dc,_0x369e4d);const _0x2a7be4=await(0x0,CheckNumber_1[_0x5b2ed5(0x1af)])(_0x2e63dc,_0x369e4d),_0x337a9d=await(0x0,GetProfilePicUrl_1[_0x5b2ed5(0x1af)])(_0x2a7be4,_0x369e4d),_0x156af8=_0x2a7be4,_0xf5f154={'name':''+_0x156af8,'number':_0x156af8,'profilePicUrl':_0x337a9d,'isGroup':![],'companyId':_0x369e4d},_0xd56764=await(0x0,CreateOrUpdateContactService_1[_0x5b2ed5(0x1af)])(_0xf5f154,null,null);let _0x556b98;if(_0x491e93===undefined)_0x556b98=await(0x0,GetDefaultWhatsApp_1[_0x5b2ed5(0x1af)])(_0x369e4d);else{_0x556b98=await Whatsapp_1[_0x5b2ed5(0x1af)][_0x5b2ed5(0x1bc)](_0x491e93);if(_0x556b98===null)throw new AppError_1[(_0x5b2ed5(0x1af))]('whatsapp\x20#'+_0x491e93+_0x5b2ed5(0x1a7));}const _0x42688d=await(0x0,FindOrCreateTicketService_1[_0x5b2ed5(0x1af)])(_0xd56764,_0x556b98['id'],0x0,_0x369e4d),_0x475937=await(0x0,ShowTicketService_1[_0x5b2ed5(0x1af)])(_0x42688d['id'],_0x369e4d);return(0x0,SetTicketMessagesAsRead_1['default'])(_0x475937),_0x475937;};function formatBRNumber(_0x3a617a){const _0x1e3cdb=a9_0x3c4e11,_0x2c1322=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x2c1322[_0x1e3cdb(0x255)](_0x3a617a)){const _0x38ad93=_0x2c1322['exec'](_0x3a617a);if(_0x38ad93&&_0x38ad93[0x1]==='55'&&Number['isInteger'](Number['parseInt'](_0x38ad93[0x2]))){const _0xb2aaa1=Number[_0x1e3cdb(0x1d1)](_0x38ad93[0x2]);if(_0xb2aaa1<0x1f)return _0x38ad93[0x0];else{if(_0xb2aaa1>=0x1f)return _0x38ad93[0x1]+_0x38ad93[0x2]+_0x38ad93[0x3];}}}else return _0x3a617a;}function createJid(_0x1ab273){const _0x35aeb6=a9_0x3c4e11;if(_0x1ab273['includes'](_0x35aeb6(0x1c6))||_0x1ab273[_0x35aeb6(0x278)](_0x35aeb6(0x1c5)))return formatBRNumber(_0x1ab273);return _0x1ab273['includes']('-')?_0x1ab273+_0x35aeb6(0x1c6):formatBRNumber(_0x1ab273)+_0x35aeb6(0x1c5);}const indexLink=async(_0x28cff9,_0x25e0fe)=>{const _0x3cf53d=a9_0x3c4e11,_0x37f35f=_0x28cff9[_0x3cf53d(0x24b)],{whatsappId:_0x564780}=_0x28cff9[_0x3cf53d(0x24b)],{msdelay:_0x42eeec}=_0x28cff9[_0x3cf53d(0x24b)],_0x346316=_0x28cff9[_0x3cf53d(0x24b)]['url'],_0x1cfc9b=_0x28cff9[_0x3cf53d(0x24b)]['caption'],_0x54b861=_0x28cff9[_0x3cf53d(0x218)]['authorization'],[,_0x41123a]=_0x54b861['split']('\x20'),_0x133042=await Whatsapp_1['default'][_0x3cf53d(0x1da)]({'where':{'token':_0x41123a}}),_0x1ed8b9=_0x133042[_0x3cf53d(0x234)];_0x37f35f['number']=_0x37f35f[_0x3cf53d(0x1d7)]['replace']('-','')['replace']('\x20','');const _0x4ebe90=Yup[_0x3cf53d(0x1d3)]()['shape']({'number':Yup[_0x3cf53d(0x1e9)]()[_0x3cf53d(0x25d)]()[_0x3cf53d(0x217)](/^\d+$/,_0x3cf53d(0x1fb))});try{await _0x4ebe90[_0x3cf53d(0x1cc)](_0x37f35f);}catch(_0x15a91){throw new AppError_1[(_0x3cf53d(0x1af))](_0x15a91[_0x3cf53d(0x23f)]);}const _0x534201=await createContact(_0x564780,_0x1ed8b9,_0x37f35f[_0x3cf53d(0x1d7)]);return await(0x0,SendWhatsAppMessageLink_1[_0x3cf53d(0x1af)])({'ticket':_0x534201,'url':_0x346316,'caption':_0x1cfc9b,'msdelay':_0x42eeec}),setTimeout(async()=>{const _0x3201f6=_0x3cf53d;await(0x0,UpdateTicketService_1[_0x3201f6(0x1af)])({'ticketId':_0x534201['id'],'ticketData':{'status':_0x3201f6(0x1b1),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x1ed8b9});},0xc8),setTimeout(async()=>{const _0x234fa2=_0x3cf53d,{dateToClient:_0x23fe8c}=(0x0,useDate_1['useDate'])(),_0x1cc4b2=_0x23fe8c(new Date()[_0x234fa2(0x1bf)]()),_0x15eff8=(0x0,moment_1[_0x234fa2(0x1af)])()[_0x234fa2(0x1f9)](),_0x3299df=await ApiUsages_1[_0x234fa2(0x1af)]['findOne']({'where':{'dateUsed':_0x1cc4b2,'companyId':_0x1ed8b9}});if(_0x3299df)await _0x3299df['update']({'usedPDF':_0x3299df[_0x234fa2(0x1cd)][_0x234fa2(0x229)]+0x1,'UsedOnDay':_0x3299df['dataValues'][_0x234fa2(0x276)]+0x1,'updatedAt':_0x15eff8});else{const _0x1d0a42=await ApiUsages_1['default'][_0x234fa2(0x1a4)]({'companyId':_0x1ed8b9,'dateUsed':_0x1cc4b2});await _0x1d0a42[_0x234fa2(0x206)]({'usedPDF':_0x1d0a42[_0x234fa2(0x1cd)][_0x234fa2(0x229)]+0x1,'UsedOnDay':_0x1d0a42['dataValues'][_0x234fa2(0x276)]+0x1,'updatedAt':_0x15eff8});}},0x64),_0x25e0fe[_0x3cf53d(0x24c)]({'status':_0x3cf53d(0x201)});};exports[a9_0x3c4e11(0x26b)]=indexLink;const index=async(_0x1bff5b,_0x3001ae)=>{const _0x228056=a9_0x3c4e11,_0x2c342d=_0x1bff5b[_0x228056(0x24b)],{whatsappId:_0x38049f}=_0x1bff5b['body'],{msdelay:_0x4dd0bc}=_0x1bff5b[_0x228056(0x24b)],{body:_0x2daf24,quotedMsg:_0x3bcf79}=_0x1bff5b[_0x228056(0x24b)],_0x47254f=_0x1bff5b[_0x228056(0x1b5)],_0x3ad746=_0x1bff5b[_0x228056(0x218)][_0x228056(0x24a)],[,_0x2ccde8]=_0x3ad746[_0x228056(0x1b8)]('\x20'),_0x524a2e=await Whatsapp_1[_0x228056(0x1af)][_0x228056(0x1da)]({'where':{'token':_0x2ccde8}}),_0x2ace5b=_0x524a2e[_0x228056(0x234)];_0x2c342d[_0x228056(0x1d7)]=_0x2c342d[_0x228056(0x1d7)]['replace']('-','')[_0x228056(0x1ea)]('\x20','');const _0x26a1fe=Yup[_0x228056(0x1d3)]()[_0x228056(0x227)]({'number':Yup['string']()['required']()['matches'](/^\d+$/,_0x228056(0x1fb))});try{await _0x26a1fe[_0x228056(0x1cc)](_0x2c342d);}catch(_0x4565a3){throw new AppError_1[(_0x228056(0x1af))](_0x4565a3[_0x228056(0x23f)]);}const _0x1c5d4f=await createContact(_0x38049f,_0x2ace5b,_0x2c342d[_0x228056(0x1d7)]);return _0x47254f?await Promise[_0x228056(0x1f8)](_0x47254f[_0x228056(0x205)](async _0x40762e=>{await(0x0,SendWhatsAppMedia_1['default'])({'body':_0x2daf24,'media':_0x40762e,'ticket':_0x1c5d4f});})):await(0x0,SendWhatsAppMessageAPI_1[_0x228056(0x1af)])({'body':_0x2daf24,'ticket':_0x1c5d4f,'quotedMsg':_0x3bcf79,'msdelay':_0x4dd0bc}),setTimeout(async()=>{await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x1c5d4f['id'],'ticketData':{'status':'pending','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x2ace5b});},0x64),setTimeout(async()=>{const _0x441701=_0x228056,{dateToClient:_0x262358}=(0x0,useDate_1[_0x441701(0x23e)])(),_0x112b92=_0x262358(new Date()['toString']()),_0x559a80=(0x0,moment_1['default'])()[_0x441701(0x1f9)](),_0x6d965c=await ApiUsages_1[_0x441701(0x1af)]['findOne']({'where':{'dateUsed':_0x112b92,'companyId':_0x2ace5b}});_0x6d965c?_0x47254f?await Promise[_0x441701(0x1f8)](_0x47254f[_0x441701(0x205)](async _0x469731=>{const _0x26c3b3=_0x441701;console[_0x26c3b3(0x1b6)]('media',_0x469731);const _0x3b1cc5=path_1[_0x26c3b3(0x1af)][_0x26c3b3(0x27c)](_0x469731[_0x26c3b3(0x239)]);console['log']('type',_0x3b1cc5);if(_0x469731[_0x26c3b3(0x1f6)]['includes'](_0x26c3b3(0x233)))await _0x6d965c['update']({'usedPDF':_0x6d965c['dataValues'][_0x26c3b3(0x229)]+0x1,'UsedOnDay':_0x6d965c[_0x26c3b3(0x1cd)][_0x26c3b3(0x276)]+0x1,'updatedAt':_0x559a80});else{if(_0x469731[_0x26c3b3(0x1f6)]['includes'](_0x26c3b3(0x259)))await _0x6d965c[_0x26c3b3(0x206)]({'usedImage':_0x6d965c['dataValues'][_0x26c3b3(0x1e0)]+0x1,'UsedOnDay':_0x6d965c[_0x26c3b3(0x1cd)][_0x26c3b3(0x276)]+0x1,'updatedAt':_0x559a80});else _0x469731[_0x26c3b3(0x1f6)]['includes'](_0x26c3b3(0x1de))?await _0x6d965c[_0x26c3b3(0x206)]({'usedVideo':_0x6d965c[_0x26c3b3(0x1cd)][_0x26c3b3(0x1e5)]+0x1,'UsedOnDay':_0x6d965c['dataValues'][_0x26c3b3(0x276)]+0x1,'updatedAt':_0x559a80}):await _0x6d965c[_0x26c3b3(0x206)]({'usedOther':_0x6d965c[_0x26c3b3(0x1cd)][_0x26c3b3(0x1f7)]+0x1,'UsedOnDay':_0x6d965c[_0x26c3b3(0x1cd)]['UsedOnDay']+0x1,'updatedAt':_0x559a80});}})):await _0x6d965c[_0x441701(0x206)]({'usedText':_0x6d965c['dataValues'][_0x441701(0x208)]+0x1,'UsedOnDay':_0x6d965c[_0x441701(0x1cd)]['UsedOnDay']+0x1,'updatedAt':_0x559a80}):(await ApiUsages_1[_0x441701(0x1af)][_0x441701(0x1a4)]({'companyId':_0x2ace5b,'dateUsed':_0x112b92}),_0x47254f?await Promise['all'](_0x47254f[_0x441701(0x205)](async _0x24ffc7=>{const _0x39b1ed=_0x441701;console['log']('media',_0x24ffc7);const _0x29caae=path_1[_0x39b1ed(0x1af)][_0x39b1ed(0x27c)](_0x24ffc7[_0x39b1ed(0x239)]);console[_0x39b1ed(0x1b6)](_0x39b1ed(0x266),_0x29caae);if(_0x24ffc7[_0x39b1ed(0x1f6)]['includes'](_0x39b1ed(0x233)))await _0x6d965c[_0x39b1ed(0x206)]({'usedPDF':_0x6d965c[_0x39b1ed(0x1cd)][_0x39b1ed(0x229)]+0x1,'UsedOnDay':_0x6d965c[_0x39b1ed(0x1cd)]['UsedOnDay']+0x1,'updatedAt':_0x559a80});else{if(_0x24ffc7[_0x39b1ed(0x1f6)][_0x39b1ed(0x278)](_0x39b1ed(0x259)))await _0x6d965c[_0x39b1ed(0x206)]({'usedImage':_0x6d965c['dataValues'][_0x39b1ed(0x1e0)]+0x1,'UsedOnDay':_0x6d965c['dataValues'][_0x39b1ed(0x276)]+0x1,'updatedAt':_0x559a80});else _0x24ffc7[_0x39b1ed(0x1f6)][_0x39b1ed(0x278)](_0x39b1ed(0x1de))?await _0x6d965c[_0x39b1ed(0x206)]({'usedVideo':_0x6d965c[_0x39b1ed(0x1cd)][_0x39b1ed(0x1e5)]+0x1,'UsedOnDay':_0x6d965c[_0x39b1ed(0x1cd)][_0x39b1ed(0x276)]+0x1,'updatedAt':_0x559a80}):await _0x6d965c['update']({'usedOther':_0x6d965c[_0x39b1ed(0x1cd)][_0x39b1ed(0x1f7)]+0x1,'UsedOnDay':_0x6d965c[_0x39b1ed(0x1cd)][_0x39b1ed(0x276)]+0x1,'updatedAt':_0x559a80});}})):await _0x6d965c['update']({'usedText':_0x6d965c['dataValues'][_0x441701(0x208)]+0x1,'UsedOnDay':_0x6d965c['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x559a80}));},0x64),_0x3001ae['send']({'status':_0x228056(0x201)});};exports[a9_0x3c4e11(0x223)]=index;const indexImage=async(_0x25d42e,_0x546643)=>{const _0x46b58c=a9_0x3c4e11,_0x10aad3=_0x25d42e[_0x46b58c(0x24b)],{whatsappId:_0x452101}=_0x25d42e[_0x46b58c(0x24b)],{msdelay:_0x2d3561}=_0x25d42e[_0x46b58c(0x24b)],_0x49d391=_0x25d42e[_0x46b58c(0x24b)]['url'],_0x2a4c53=_0x25d42e[_0x46b58c(0x24b)]['caption'],_0x245513=_0x25d42e[_0x46b58c(0x218)][_0x46b58c(0x24a)],[,_0x5b9eaa]=_0x245513[_0x46b58c(0x1b8)]('\x20'),_0x394384=await Whatsapp_1[_0x46b58c(0x1af)]['findOne']({'where':{'token':_0x5b9eaa}}),_0x11bf4f=_0x394384[_0x46b58c(0x234)];_0x10aad3[_0x46b58c(0x1d7)]=_0x10aad3[_0x46b58c(0x1d7)][_0x46b58c(0x1ea)]('-','')[_0x46b58c(0x1ea)]('\x20','');const _0xe1a75=Yup[_0x46b58c(0x1d3)]()[_0x46b58c(0x227)]({'number':Yup['string']()[_0x46b58c(0x25d)]()['matches'](/^\d+$/,_0x46b58c(0x1fb))});try{await _0xe1a75['validate'](_0x10aad3);}catch(_0x12bde9){throw new AppError_1[(_0x46b58c(0x1af))](_0x12bde9['message']);}const _0x114979=await createContact(_0x452101,_0x11bf4f,_0x10aad3[_0x46b58c(0x1d7)]);return _0x49d391&&await(0x0,SendWhatsappMediaImage_1[_0x46b58c(0x1af)])({'ticket':_0x114979,'url':_0x49d391,'caption':_0x2a4c53,'msdelay':_0x2d3561}),setTimeout(async()=>{const _0x4f4aaf=_0x46b58c;await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x114979['id'],'ticketData':{'status':_0x4f4aaf(0x1b1),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x11bf4f});},0x64),setTimeout(async()=>{const _0xcf3e41=_0x46b58c,{dateToClient:_0x49cc39}=(0x0,useDate_1[_0xcf3e41(0x23e)])(),_0xf9727a=_0x49cc39(new Date()[_0xcf3e41(0x1bf)]()),_0x1102eb=(0x0,moment_1[_0xcf3e41(0x1af)])()[_0xcf3e41(0x1f9)](),_0x1c5c1c=await ApiUsages_1[_0xcf3e41(0x1af)][_0xcf3e41(0x1da)]({'where':{'dateUsed':_0xf9727a,'companyId':_0x11bf4f}});if(_0x1c5c1c)await _0x1c5c1c[_0xcf3e41(0x206)]({'usedImage':_0x1c5c1c['dataValues'][_0xcf3e41(0x1e0)]+0x1,'UsedOnDay':_0x1c5c1c[_0xcf3e41(0x1cd)][_0xcf3e41(0x276)]+0x1,'updatedAt':_0x1102eb});else{const _0x15278e=await ApiUsages_1['default']['create']({'companyId':_0x11bf4f,'dateUsed':_0xf9727a});await _0x15278e[_0xcf3e41(0x206)]({'usedImage':_0x15278e[_0xcf3e41(0x1cd)][_0xcf3e41(0x1e0)]+0x1,'UsedOnDay':_0x15278e[_0xcf3e41(0x1cd)]['UsedOnDay']+0x1,'updatedAt':_0x1102eb});}},0x64),_0x546643['send']({'status':_0x46b58c(0x201)});};exports['indexImage']=indexImage;const checkNumber=async(_0x5b58fb,_0x5c4f9)=>{const _0xdbbc59=a9_0x3c4e11,_0xc375b6=_0x5b58fb[_0xdbbc59(0x24b)],_0x49829f=_0x5b58fb[_0xdbbc59(0x218)]['authorization'],[,_0x535620]=_0x49829f[_0xdbbc59(0x1b8)]('\x20'),_0x9b8418=await Whatsapp_1[_0xdbbc59(0x1af)]['findOne']({'where':{'token':_0x535620}}),_0x1c5292=_0x9b8418[_0xdbbc59(0x234)],_0x1fb9c4=_0xc375b6['number'][_0xdbbc59(0x1ea)]('-','')[_0xdbbc59(0x1ea)]('\x20',''),_0x1f17b2=await(0x0,GetDefaultWhatsApp_1['default'])(_0x1c5292),_0x295318=(0x0,wbot_1[_0xdbbc59(0x270)])(_0x1f17b2['id']),_0x42ff50=createJid(_0x1fb9c4);try{const [_0x4e4fc2]=await _0x295318[_0xdbbc59(0x1c2)](_0x42ff50);if(_0x4e4fc2[_0xdbbc59(0x1dc)])return setTimeout(async()=>{const _0x622f49=_0xdbbc59,{dateToClient:_0x5d2cfc}=(0x0,useDate_1['useDate'])(),_0x3af427=_0x5d2cfc(new Date()['toString']()),_0x491ff8=(0x0,moment_1[_0x622f49(0x1af)])()['format'](),_0x13d486=await ApiUsages_1['default'][_0x622f49(0x1da)]({'where':{'dateUsed':_0x3af427,'companyId':_0x1c5292}});if(_0x13d486)await _0x13d486[_0x622f49(0x206)]({'usedCheckNumber':_0x13d486[_0x622f49(0x1cd)][_0x622f49(0x1ae)]+0x1,'UsedOnDay':_0x13d486[_0x622f49(0x1cd)][_0x622f49(0x276)]+0x1,'updatedAt':_0x491ff8});else{const _0x4bd98d=await ApiUsages_1['default'][_0x622f49(0x1a4)]({'companyId':_0x1c5292,'dateUsed':_0x3af427});await _0x4bd98d[_0x622f49(0x206)]({'usedCheckNumber':_0x4bd98d['dataValues'][_0x622f49(0x1ae)]+0x1,'UsedOnDay':_0x4bd98d[_0x622f49(0x1cd)][_0x622f49(0x276)]+0x1,'updatedAt':_0x491ff8});}},0x64),_0x5c4f9['status'](0xc8)[_0xdbbc59(0x248)]({'existsInWhatsapp':!![],'number':_0x1fb9c4,'numberFormatted':_0x4e4fc2[_0xdbbc59(0x269)]});}catch(_0x133a3f){return _0x5c4f9['status'](0x190)[_0xdbbc59(0x248)]({'existsInWhatsapp':![],'number':_0x42ff50,'error':_0xdbbc59(0x242)});}};exports[a9_0x3c4e11(0x20a)]=checkNumber;const indexWhatsappsId=async(_0x2fdb91,_0x491597)=>{const _0x6af935=a9_0x3c4e11;return console[_0x6af935(0x1b6)]('req',_0x2fdb91),console[_0x6af935(0x1b6)](_0x6af935(0x21a),_0x2fdb91[_0x6af935(0x26a)]),_0x491597[_0x6af935(0x20c)](0xc8)[_0x6af935(0x248)]('oi');};exports[a9_0x3c4e11(0x220)]=indexWhatsappsId;const updateQueueId=async(_0x478ac3,_0x51b787)=>{const _0x4a250d=a9_0x3c4e11,{ticketId:_0x343c57}=_0x478ac3[_0x4a250d(0x21f)],{queueId:_0x5ff558}=_0x478ac3[_0x4a250d(0x24b)],_0x3d9b1a=_0x478ac3[_0x4a250d(0x218)][_0x4a250d(0x24a)],[,_0x2bb31c]=_0x3d9b1a[_0x4a250d(0x1b8)]('\x20'),_0x1d9fbd=await Whatsapp_1[_0x4a250d(0x1af)]['findOne']({'where':{'token':_0x2bb31c}}),_0x5b6a5b=_0x1d9fbd[_0x4a250d(0x234)];try{const _0x38274a=await Queue_1['default'][_0x4a250d(0x1da)]({'where':{'id':_0x5ff558,'companyId':_0x5b6a5b}});if(!_0x38274a)return _0x51b787[_0x4a250d(0x20c)](0x190)['json']({'status':_0x4a250d(0x24d),'error':_0x4a250d(0x277)});return await(0x0,UpdateTicketService_1[_0x4a250d(0x1af)])({'ticketId':_0x343c57,'ticketData':{'queueId':_0x5ff558},'companyId':_0x5b6a5b}),_0x51b787[_0x4a250d(0x20c)](0xc8)['json']({'status':_0x4a250d(0x201)});}catch(_0x125049){return console[_0x4a250d(0x237)](_0x125049),_0x51b787[_0x4a250d(0x20c)](0x1f4)[_0x4a250d(0x248)]({'status':'ERROR','error':'Internal\x20Server\x20Error'});}};exports[a9_0x3c4e11(0x1aa)]=updateQueueId;const closeTicket=async(_0x4c1475,_0x32aeba)=>{const _0x29e352=a9_0x3c4e11,_0x2ad57e=_0x4c1475[_0x29e352(0x218)][_0x29e352(0x24a)],[,_0x30af2d]=_0x2ad57e[_0x29e352(0x1b8)]('\x20'),_0x1e18c9=await Whatsapp_1[_0x29e352(0x1af)][_0x29e352(0x1da)]({'where':{'token':_0x30af2d}}),_0x2a9e57=_0x1e18c9[_0x29e352(0x234)],{ticketId:_0x3fd5f4}=_0x4c1475['params'],_0xb91eee=await(0x0,ShowTicketService_1[_0x29e352(0x1af)])(_0x3fd5f4,_0x2a9e57);_0xb91eee['status']=_0x4c1475[_0x29e352(0x24b)][_0x29e352(0x256)][_0x29e352(0x20c)],console[_0x29e352(0x1b6)](_0xb91eee['status']);const {ticket:_0x171b49}=await(0x0,UpdateTicketService_1['default'])({'ticketData':_0xb91eee,'ticketId':_0x3fd5f4,'companyId':_0x2a9e57});return _0x32aeba['status'](0xc8)['json'](_0x171b49);};exports[a9_0x3c4e11(0x216)]=closeTicket;const updateTicketTag=async(_0x197bb4,_0x5504b9)=>{const _0x482051=a9_0x3c4e11,{ticketId:_0x2a2904,tagId:_0x26c682}=_0x197bb4[_0x482051(0x24b)],_0x42ab80=_0x197bb4['headers'][_0x482051(0x24a)],[,_0xffd628]=_0x42ab80[_0x482051(0x1b8)]('\x20');try{const _0x1b0560=await Whatsapp_1['default']['findOne']({'where':{'token':_0xffd628}}),_0x38b4d7=_0x1b0560[_0x482051(0x234)],_0x2e65a6=await Tag_1['default']['findOne']({'where':{'id':_0x26c682,'companyId':_0x38b4d7}});if(!_0x2e65a6)return _0x5504b9[_0x482051(0x20c)](0x190)['json']({'status':_0x482051(0x24d),'error':_0x482051(0x225)});const _0x1c49cb=await TicketTag_1[_0x482051(0x1af)][_0x482051(0x1da)]({'where':{'ticketId':_0x2a2904,'tagId':_0x26c682}});if(_0x1c49cb)return _0x5504b9[_0x482051(0x20c)](0x190)[_0x482051(0x248)]({'status':_0x482051(0x24d),'error':'Tag\x20already\x20associated\x20with\x20the\x20ticket'});const _0x28153c=await TicketTag_1['default'][_0x482051(0x1a4)]({'ticketId':_0x2a2904,'tagId':_0x26c682});return _0x5504b9[_0x482051(0x20c)](0xc8)[_0x482051(0x248)]({'status':'SUCCESS','ticketTag':_0x28153c});}catch(_0x11570c){return console[_0x482051(0x237)](_0x11570c),_0x5504b9['status'](0x1f4)[_0x482051(0x248)]({'status':_0x482051(0x24d),'error':_0x482051(0x264)});}};exports[a9_0x3c4e11(0x245)]=updateTicketTag;const removeTicketTag=async(_0x1456ec,_0x4e074e)=>{const _0x57829a=a9_0x3c4e11,{ticketId:_0x1d4df5,tagId:_0x24aae1}=_0x1456ec[_0x57829a(0x24b)];try{const _0x4e42b7=await TicketTag_1[_0x57829a(0x1af)][_0x57829a(0x1da)]({'where':{'ticketId':_0x1d4df5,'tagId':_0x24aae1}});if(!_0x4e42b7)return _0x4e074e[_0x57829a(0x20c)](0x190)[_0x57829a(0x248)]({'status':_0x57829a(0x24d),'error':'Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket'});return await _0x4e42b7['destroy'](),_0x4e074e[_0x57829a(0x20c)](0xc8)[_0x57829a(0x248)]({'status':_0x57829a(0x201)});}catch(_0x27eda7){return console['error'](_0x27eda7),_0x4e074e[_0x57829a(0x20c)](0x1f4)[_0x57829a(0x248)]({'status':_0x57829a(0x24d),'error':_0x57829a(0x25b)});}};exports[a9_0x3c4e11(0x1e7)]=removeTicketTag;const listTicketsByCompany=async(_0x5c3713,_0x2dbbd9)=>{const _0x2dc723=a9_0x3c4e11,_0x1c481d=_0x5c3713[_0x2dc723(0x218)][_0x2dc723(0x24a)],[,_0x6dc77d]=_0x1c481d['split']('\x20'),_0x2a61dd=await Whatsapp_1['default'][_0x2dc723(0x1da)]({'where':{'token':_0x6dc77d}}),_0x161bb5=_0x2a61dd[_0x2dc723(0x234)];try{const _0x4d4e50=await Ticket_1[_0x2dc723(0x1af)][_0x2dc723(0x210)]({'where':{'companyId':_0x161bb5},'include':[{'model':Contact_1[_0x2dc723(0x1af)],'as':_0x2dc723(0x1c9),'attributes':['id',_0x2dc723(0x1d5),_0x2dc723(0x1d7),_0x2dc723(0x1c0),_0x2dc723(0x1ab),_0x2dc723(0x24e),_0x2dc723(0x200),_0x2dc723(0x243)],'include':['extraInfo']},{'model':Queue_1[_0x2dc723(0x1af)],'as':_0x2dc723(0x1b7),'attributes':['id','name',_0x2dc723(0x212)]},{'model':User_1[_0x2dc723(0x1af)],'as':_0x2dc723(0x26a),'attributes':['id',_0x2dc723(0x1d5)]},{'model':Tag_1[_0x2dc723(0x1af)],'as':_0x2dc723(0x250),'attributes':['id',_0x2dc723(0x1d5),_0x2dc723(0x212)]},{'model':Whatsapp_1[_0x2dc723(0x1af)],'as':'whatsapp','attributes':[_0x2dc723(0x1d5),_0x2dc723(0x25a),'facebookUserId']},{'model':Company_1[_0x2dc723(0x1af)],'as':'company','attributes':['name']}]});return _0x2dbbd9[_0x2dc723(0x20c)](0xc8)[_0x2dc723(0x248)]({'status':'SUCCESS','tickets':_0x4d4e50});}catch(_0x3ece3b){return console[_0x2dc723(0x237)](_0x3ece3b),_0x2dbbd9['status'](0x1f4)[_0x2dc723(0x248)]({'status':_0x2dc723(0x24d),'error':_0x2dc723(0x230)});}};exports[a9_0x3c4e11(0x27d)]=listTicketsByCompany;const listTicketsByTag=async(_0x330190,_0x52332c)=>{const _0x100295=a9_0x3c4e11,{tagId:_0x51a51f}=_0x330190[_0x100295(0x21f)],_0x18dd8f=_0x330190['headers'][_0x100295(0x24a)],[,_0x573ac3]=_0x18dd8f['split']('\x20');try{const _0x55eb09=await Whatsapp_1[_0x100295(0x1af)][_0x100295(0x1da)]({'where':{'token':_0x573ac3}}),_0x3e28e7=_0x55eb09[_0x100295(0x234)],_0x2c7ad3=await Tag_1[_0x100295(0x1af)]['findOne']({'where':{'id':_0x51a51f,'companyId':_0x3e28e7}});if(!_0x2c7ad3)return _0x52332c[_0x100295(0x20c)](0x190)[_0x100295(0x248)]({'status':_0x100295(0x24d),'error':'Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company'});const _0x195c2d=await Ticket_1[_0x100295(0x1af)]['findAll']({'include':[{'model':Tag_1[_0x100295(0x1af)],'as':_0x100295(0x250),'attributes':['id',_0x100295(0x1d5)],'through':{'attributes':[],'where':{'tagId':_0x51a51f}}},{'model':Contact_1['default'],'as':'contact','attributes':['id',_0x100295(0x1d5),'number','email',_0x100295(0x1ab),'acceptAudioMessage',_0x100295(0x200),_0x100295(0x243)],'include':[_0x100295(0x25e)]},{'model':Queue_1[_0x100295(0x1af)],'as':'queue','attributes':['id','name',_0x100295(0x212)]},{'model':User_1[_0x100295(0x1af)],'as':_0x100295(0x26a),'attributes':['id',_0x100295(0x1d5)]},{'model':Whatsapp_1[_0x100295(0x1af)],'as':_0x100295(0x1c4),'attributes':[_0x100295(0x1d5),'facebookUserToken',_0x100295(0x271)]},{'model':Company_1[_0x100295(0x1af)],'as':'company','attributes':[_0x100295(0x1d5)]}],'where':{'companyId':_0x3e28e7,'$tags.id$':_0x51a51f}});return _0x52332c[_0x100295(0x20c)](0xc8)[_0x100295(0x248)]({'status':_0x100295(0x201),'tickets':_0x195c2d});}catch(_0x3fc0c2){return console[_0x100295(0x237)](_0x3fc0c2),_0x52332c[_0x100295(0x20c)](0x1f4)[_0x100295(0x248)]({'status':_0x100295(0x24d),'error':_0x100295(0x230)});}};exports[a9_0x3c4e11(0x1f0)]=listTicketsByTag;const listTicketsByTagIsAuth=async(_0x5900ba,_0x4cee7f)=>{const _0x576878=a9_0x3c4e11,{tagId:_0x4994ba}=_0x5900ba['params'];try{const _0x5f9d73=await Ticket_1[_0x576878(0x1af)][_0x576878(0x210)]({'include':[{'model':Contact_1[_0x576878(0x1af)],'as':_0x576878(0x1c9),'attributes':[_0x576878(0x1d5),_0x576878(0x1d7),'email'],'include':[_0x576878(0x25e)]},{'model':Tag_1[_0x576878(0x1af)],'as':_0x576878(0x250),'attributes':['id',_0x576878(0x1d5),_0x576878(0x212)],'where':{'id':_0x4994ba}},{'model':Whatsapp_1['default'],'as':_0x576878(0x1c4),'attributes':['name','facebookUserToken',_0x576878(0x271)]},{'model':Company_1['default'],'as':_0x576878(0x1d0),'attributes':['name']}]});return _0x4cee7f[_0x576878(0x20c)](0xc8)[_0x576878(0x248)]({'status':'SUCCESS','tickets':_0x5f9d73});}catch(_0x1f1412){return console[_0x576878(0x237)](_0x1f1412),_0x4cee7f[_0x576878(0x20c)](0x1f4)[_0x576878(0x248)]({'status':_0x576878(0x24d),'error':_0x576878(0x230)});}};exports['listTicketsByTagIsAuth']=listTicketsByTagIsAuth;function makeid(_0x104699){const _0x3e06b9=a9_0x3c4e11;var _0x6bf551='',_0x294ea1=_0x3e06b9(0x1cf),_0x4a1e4c=_0x294ea1[_0x3e06b9(0x1e3)];for(var _0xa73c72=0x0;_0xa73c72<_0x104699;_0xa73c72++){_0x6bf551+=_0x294ea1[_0x3e06b9(0x232)](Math[_0x3e06b9(0x21e)](Math[_0x3e06b9(0x1b3)]()*_0x4a1e4c));}return _0x6bf551;}exports[a9_0x3c4e11(0x23d)]=makeid;const handleAudioLink=async(_0xf1b94e,_0x23b04e)=>{const _0x941c13=a9_0x3c4e11,{link:_0x42abde,contactNumber:_0x516b37}=_0xf1b94e[_0x941c13(0x24b)];try{const _0x59add4=_0xf1b94e[_0x941c13(0x218)]['authorization'],[,_0x2118a2]=_0x59add4[_0x941c13(0x1b8)]('\x20'),_0x3d81a4=await Whatsapp_1['default']['findOne']({'where':{'token':_0x2118a2}}),_0x26e54f=_0x3d81a4[_0x941c13(0x234)],_0x8fc154=await(0x0,GetDefaultWhatsApp_1[_0x941c13(0x1af)])(_0x26e54f),_0x36738a=(0x0,wbot_1['getWbot'])(_0x8fc154['id']),_0x3ce60e=_0x941c13(0x247)+_0x26e54f+'/'+makeid(0xa)+_0x941c13(0x203);if(!_0x3d81a4)return _0x23b04e[_0x941c13(0x20c)](0x191)['json']({'status':_0x941c13(0x1d8),'error':_0x941c13(0x213)});const _0x15a358=await axios_1[_0x941c13(0x1af)][_0x941c13(0x20d)](_0x42abde,{'responseType':_0x941c13(0x282)});fs_1[_0x941c13(0x1af)][_0x941c13(0x260)](_0x3ce60e,Buffer[_0x941c13(0x1d2)](_0x15a358[_0x941c13(0x1e1)]));const _0xa9fb61=_0x941c13(0x257);return await(0x0,SendPresenceStatus_1['SendPresenceStatus'])(_0x36738a,_0x516b37),await _0x36738a[_0x941c13(0x280)](_0x516b37+_0x941c13(0x1c5),{'audio':fs_1[_0x941c13(0x1af)][_0x941c13(0x1ff)](_0x3ce60e),'fileName':_0xa9fb61,'caption':_0xa9fb61,'mimetype':'audio/mp4','ptt':!![]}),_0x23b04e[_0x941c13(0x20c)](0xc8)[_0x941c13(0x248)]({'status':'SUCESSO'});}catch(_0x199bc8){return console[_0x941c13(0x237)](_0x199bc8),_0x23b04e[_0x941c13(0x20c)](0x1f4)[_0x941c13(0x248)]({'status':_0x941c13(0x1d8),'error':_0x941c13(0x22f)});}};exports[a9_0x3c4e11(0x1f4)]=handleAudioLink;const indexApi=async(_0x88727,_0x57f44b)=>{const _0x365953=a9_0x3c4e11,_0x416bbe=_0x88727[_0x365953(0x218)][_0x365953(0x24a)],[,_0x31c02d]=_0x416bbe[_0x365953(0x1b8)]('\x20'),_0x1f5add=await Whatsapp_1[_0x365953(0x1af)][_0x365953(0x1da)]({'where':{'token':_0x31c02d}}),_0x2c2a50=_0x1f5add[_0x365953(0x234)],{searchParam:_0xf7ba58,pageNumber:_0x1d0336}=_0x88727['query'];if(_0x2c2a50===0x1){const {invoices:_0x45c7da,count:_0x2a2129,hasMore:_0x3ede3d}=await(0x0,ListInvoicesServices_1[_0x365953(0x1af)])({'searchParam':_0xf7ba58,'pageNumber':_0x1d0336});return _0x57f44b[_0x365953(0x248)]({'invoices':_0x45c7da,'count':_0x2a2129,'hasMore':_0x3ede3d});}else return _0x57f44b[_0x365953(0x20c)](0x191)['json']({'status':_0x365953(0x1d8),'error':_0x365953(0x26c)});};exports[a9_0x3c4e11(0x1ce)]=indexApi;const showApi=async(_0x217786,_0x12a7d9)=>{const _0x1c15c1=a9_0x3c4e11,_0x2f8142=_0x217786[_0x1c15c1(0x218)][_0x1c15c1(0x24a)],[,_0x393d2f]=_0x2f8142['split']('\x20'),_0x518a42=await Whatsapp_1[_0x1c15c1(0x1af)][_0x1c15c1(0x1da)]({'where':{'token':_0x393d2f}}),_0x6ec522=_0x518a42[_0x1c15c1(0x234)],{Invoiceid:_0x1e611d}=_0x217786[_0x1c15c1(0x21f)],_0x2bf758=await(0x0,ShowInvoiceService_1['default'])(_0x1e611d);return _0x12a7d9[_0x1c15c1(0x20c)](0xc8)[_0x1c15c1(0x248)](_0x2bf758);};exports['showApi']=showApi;const showAllApi=async(_0xd266c,_0x530bd9)=>{const _0x1de395=a9_0x3c4e11;try{const _0x5b5942=_0xd266c[_0x1de395(0x218)][_0x1de395(0x24a)],[,_0x53e5a4]=_0x5b5942[_0x1de395(0x1b8)]('\x20'),_0x5a4446=await Whatsapp_1[_0x1de395(0x1af)][_0x1de395(0x1da)]({'where':{'token':_0x53e5a4}}),_0x29f602=_0x5a4446[_0x1de395(0x234)],{companyId:_0x439b64,status:_0x2ea084}=_0xd266c[_0x1de395(0x24b)];if(_0x29f602===0x1){const _0x255e03=await Invoices_1['default'][_0x1de395(0x210)]({'where':{'companyId':_0x439b64,'status':_0x2ea084}});return _0x530bd9[_0x1de395(0x20c)](0xc8)[_0x1de395(0x248)](_0x255e03);}else return _0x530bd9[_0x1de395(0x20c)](0x191)[_0x1de395(0x248)]({'status':_0x1de395(0x1d8),'error':_0x1de395(0x26c)});}catch(_0x27940f){return console[_0x1de395(0x237)](_0x1de395(0x272),_0x27940f),_0x530bd9[_0x1de395(0x20c)](0x1f4)[_0x1de395(0x248)]({'error':'Erro\x20ao\x20buscar\x20invoices'});}};exports[a9_0x3c4e11(0x251)]=showAllApi;const updateApi=async(_0x53e2c9,_0x2bbbc3)=>{const _0x5cd9e5=a9_0x3c4e11,_0x26277d=_0x53e2c9[_0x5cd9e5(0x218)][_0x5cd9e5(0x24a)],[,_0x25a258]=_0x26277d[_0x5cd9e5(0x1b8)]('\x20'),_0x34b2ca=await Whatsapp_1[_0x5cd9e5(0x1af)][_0x5cd9e5(0x1da)]({'where':{'token':_0x25a258}}),_0x47d005=_0x34b2ca['companyId'],_0x22f336=_0x53e2c9[_0x5cd9e5(0x24b)],_0x2d536e=Yup['object']()['shape']({'name':Yup[_0x5cd9e5(0x1e9)]()});try{await _0x2d536e[_0x5cd9e5(0x1cc)](_0x22f336);}catch(_0x363b20){throw new AppError_1['default'](_0x363b20[_0x5cd9e5(0x23f)]);}const {id:_0x46964b,status:_0x5b0965}=_0x22f336;if(_0x47d005===0x1){const _0x11521e=await(0x0,UpdateInvoiceService_1[_0x5cd9e5(0x1af)])({'id':_0x46964b,'status':_0x5b0965}),_0x42b3fe=await Invoices_1[_0x5cd9e5(0x1af)][_0x5cd9e5(0x1bc)](_0x46964b),_0x4e4a49=_0x42b3fe[_0x5cd9e5(0x234)],_0x23d122=await Company_1[_0x5cd9e5(0x1af)]['findByPk'](_0x4e4a49),_0x563cf1=new Date(_0x23d122[_0x5cd9e5(0x252)]);_0x563cf1[_0x5cd9e5(0x1bd)](_0x563cf1[_0x5cd9e5(0x1a5)]()+0x1e);const _0x3ebd12=_0x563cf1[_0x5cd9e5(0x26d)]()[_0x5cd9e5(0x1b8)]('T')[0x0];if(_0x23d122){await _0x23d122[_0x5cd9e5(0x206)]({'dueDate':_0x3ebd12});const _0x36424a=await _0x42b3fe['update']({'id':_0x46964b,'status':_0x5cd9e5(0x1db)});await _0x23d122[_0x5cd9e5(0x1cb)]();const _0x244b04=(0x0,socket_1[_0x5cd9e5(0x1eb)])(),_0x4e18f8=await Company_1[_0x5cd9e5(0x1af)]['findOne']({'where':{'id':_0x4e4a49}});}return _0x2bbbc3[_0x5cd9e5(0x20c)](0xc8)['json'](_0x11521e);}else return _0x2bbbc3['status'](0x191)[_0x5cd9e5(0x248)]({'status':_0x5cd9e5(0x1d8),'error':'Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.'});};exports['updateApi']=updateApi;const updateUsageStats=async(_0x2d648f,_0x4a7d0d)=>{const _0xda2d85=a9_0x3c4e11;if(!_0x2d648f[_0xda2d85(0x26a)]||!_0x2d648f['user']['companyId'])return _0x4a7d0d[_0xda2d85(0x20c)](0x190)['send']({'status':_0xda2d85(0x24d),'message':_0xda2d85(0x267)});const {companyId:_0x24b31b}=_0x2d648f[_0xda2d85(0x26a)],{contactId:_0x46076e}=_0x2d648f[_0xda2d85(0x21f)];return setTimeout(async()=>{const _0x4ec721=_0xda2d85,{dateToClient:_0x47b6fa}=(0x0,useDate_1[_0x4ec721(0x23e)])(),_0x4876c8=_0x47b6fa(new Date()[_0x4ec721(0x1bf)]()),_0x95445d=(0x0,moment_1[_0x4ec721(0x1af)])()['format']();try{const _0x1beba1=await ApiUsages_1[_0x4ec721(0x1af)][_0x4ec721(0x1da)]({'where':{'dateUsed':_0x4876c8,'companyId':_0x24b31b}});if(_0x1beba1)await _0x1beba1[_0x4ec721(0x206)]({'usedOther':_0x1beba1[_0x4ec721(0x1cd)][_0x4ec721(0x1f7)]+0x1,'UsedOnDay':_0x1beba1['dataValues'][_0x4ec721(0x276)]+0x1,'updatedAt':_0x95445d});else{const _0x50f885=await ApiUsages_1['default'][_0x4ec721(0x1a4)]({'companyId':_0x24b31b,'dateUsed':_0x4876c8});await _0x50f885[_0x4ec721(0x206)]({'usedOther':_0x50f885['dataValues'][_0x4ec721(0x1f7)]+0x1,'UsedOnDay':_0x50f885[_0x4ec721(0x1cd)][_0x4ec721(0x276)]+0x1,'updatedAt':_0x95445d});}}catch(_0x32abfa){return console[_0x4ec721(0x237)](_0x4ec721(0x1c7),_0x32abfa),_0x4a7d0d[_0x4ec721(0x20c)](0x1f4)[_0x4ec721(0x24c)]({'status':_0x4ec721(0x24d),'message':_0x4ec721(0x204)});}},0x64),_0x4a7d0d[_0xda2d85(0x24c)]({'status':_0xda2d85(0x201)});};exports[a9_0x3c4e11(0x1f3)]=updateUsageStats;const indexContacts=async(_0x409711,_0x2db6b9)=>{const _0x10f71b=a9_0x3c4e11,{searchParam:_0x1ce89e,pageNumber:_0x586d4b}=_0x409711[_0x10f71b(0x265)],{companyId:_0x512412}=_0x409711['user'],{contacts:_0x3ddc44,count:_0x1c19d3,hasMore:_0x1b12f9}=await(0x0,ListContactsService_1[_0x10f71b(0x1af)])({'searchParam':_0x1ce89e,'pageNumber':_0x586d4b,'companyId':_0x512412});return _0x2db6b9[_0x10f71b(0x248)]({'contacts':_0x3ddc44,'count':_0x1c19d3,'hasMore':_0x1b12f9});};exports[a9_0x3c4e11(0x23a)]=indexContacts;const listContacts=async(_0x20090c,_0xe8b824)=>{const _0x1d5e44=a9_0x3c4e11,{name:_0x5ac3ab}=_0x20090c[_0x1d5e44(0x265)],{companyId:_0x29d0cc}=_0x20090c[_0x1d5e44(0x26a)],_0x3a1a78=await(0x0,SimpleListService_1[_0x1d5e44(0x1af)])({'name':_0x5ac3ab,'companyId':_0x29d0cc});return _0xe8b824[_0x1d5e44(0x248)](_0x3a1a78);};exports[a9_0x3c4e11(0x1df)]=listContacts;const showContacts=async(_0x2cf940,_0x22a102)=>{const _0x262bbd=a9_0x3c4e11,{contactId:_0x162114}=_0x2cf940['params'],{companyId:_0x4da3e9}=_0x2cf940[_0x262bbd(0x26a)],_0x4aa107=await(0x0,ShowContactService_1[_0x262bbd(0x1af)])(_0x162114,_0x4da3e9);return _0x22a102[_0x262bbd(0x20c)](0xc8)[_0x262bbd(0x248)](_0x4aa107);};exports[a9_0x3c4e11(0x1ad)]=showContacts;const findOrCreateContacts=async(_0x102a06,_0x10e29b)=>{const _0x224b87=a9_0x3c4e11,{name:_0x606f41,number:_0x3e729a}=_0x102a06[_0x224b87(0x24b)],{companyId:_0x22e0b1}=_0x102a06[_0x224b87(0x26a)],_0xe10697=await(0x0,GetContactService_1[_0x224b87(0x1af)])({'name':_0x606f41,'number':_0x3e729a,'companyId':_0x22e0b1});return _0x10e29b[_0x224b87(0x20c)](0xc8)[_0x224b87(0x248)](_0xe10697);};exports[a9_0x3c4e11(0x22e)]=findOrCreateContacts;const storeContacts=async(_0xe14b3b,_0x243f21)=>{const _0x38a22d=a9_0x3c4e11,{companyId:_0x3a06e5}=_0xe14b3b[_0x38a22d(0x26a)],_0x2e3cc5=_0xe14b3b[_0x38a22d(0x24b)];_0x2e3cc5[_0x38a22d(0x1d7)]=_0x2e3cc5[_0x38a22d(0x1d7)][_0x38a22d(0x1ea)]('-','')['replace']('\x20','');const _0x1cb8d8=Yup['object']()[_0x38a22d(0x227)]({'name':Yup[_0x38a22d(0x1e9)]()['required'](),'number':Yup[_0x38a22d(0x1e9)]()[_0x38a22d(0x25d)]()[_0x38a22d(0x217)](/^\d+$/,_0x38a22d(0x1fb))});try{await _0x1cb8d8[_0x38a22d(0x1cc)](_0x2e3cc5);}catch(_0x39bfcb){throw new AppError_1[(_0x38a22d(0x1af))](_0x39bfcb[_0x38a22d(0x23f)]);}await(0x0,CheckIsValidContact_1['default'])(_0x2e3cc5['number'],_0x3a06e5);const _0x2eb438=await(0x0,CheckNumber_1['default'])(_0x2e3cc5[_0x38a22d(0x1d7)],_0x3a06e5),_0x520616=_0x2eb438[_0x38a22d(0x269)][_0x38a22d(0x1ea)](/\D/g,'');_0x2e3cc5['number']=_0x520616;const _0x8cd5f0=await(0x0,CreateContactService_1[_0x38a22d(0x1af)])({..._0x2e3cc5,'companyId':_0x3a06e5}),_0x51e22b=(0x0,socket_1['getIO'])();return _0x51e22b[_0x38a22d(0x26f)](_0x38a22d(0x1d4)+_0x3a06e5+_0x38a22d(0x274),{'action':_0x38a22d(0x1a4),'contact':_0x8cd5f0}),_0x243f21[_0x38a22d(0x20c)](0xc8)[_0x38a22d(0x248)](_0x8cd5f0);};exports[a9_0x3c4e11(0x246)]=storeContacts;const removeAllContacts=async(_0x39c48d,_0x2b6d13)=>{const _0x402c2a=a9_0x3c4e11,{companyId:_0x335309}=_0x39c48d[_0x402c2a(0x26a)];try{await Contact_1[_0x402c2a(0x1af)][_0x402c2a(0x202)]({'where':{'companyId':_0x335309}});const _0x42c9bf=(0x0,socket_1[_0x402c2a(0x1eb)])();return _0x42c9bf[_0x402c2a(0x26f)](_0x402c2a(0x1d4)+_0x335309+_0x402c2a(0x274),{'action':_0x402c2a(0x275)}),setTimeout(async()=>{const _0x170aa0=_0x402c2a,{dateToClient:_0xfa7d4d}=(0x0,useDate_1['useDate'])(),_0x55bc76=_0xfa7d4d(new Date()[_0x170aa0(0x1bf)]()),_0x460ed9=(0x0,moment_1[_0x170aa0(0x1af)])()[_0x170aa0(0x1f9)]();try{const _0x196242=await ApiUsages_1[_0x170aa0(0x1af)][_0x170aa0(0x1da)]({'where':{'dateUsed':_0x55bc76,'companyId':_0x335309}});if(_0x196242)await _0x196242['update']({'usedOther':_0x196242[_0x170aa0(0x1cd)][_0x170aa0(0x1f7)]+0x1,'UsedOnDay':_0x196242['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x460ed9});else{const _0x5853ad=await ApiUsages_1['default'][_0x170aa0(0x1a4)]({'companyId':_0x335309,'dateUsed':_0x55bc76});await _0x5853ad[_0x170aa0(0x206)]({'usedOther':_0x5853ad['dataValues'][_0x170aa0(0x1f7)]+0x1,'UsedOnDay':_0x5853ad[_0x170aa0(0x1cd)]['UsedOnDay']+0x1,'updatedAt':_0x460ed9});}}catch(_0xe9283d){return console[_0x170aa0(0x237)]('Error\x20updating\x20usage\x20stats:',_0xe9283d),_0x2b6d13['status'](0x1f4)[_0x170aa0(0x24c)]({'status':'ERROR','message':_0x170aa0(0x204)});}},0x64),_0x2b6d13['status'](0xc8)[_0x402c2a(0x24c)]({'status':_0x402c2a(0x201),'message':'All\x20contacts\x20removed\x20successfully'});}catch(_0x42c0ed){return console[_0x402c2a(0x237)](_0x402c2a(0x1b2),_0x42c0ed),_0x2b6d13[_0x402c2a(0x20c)](0x1f4)['send']({'status':_0x402c2a(0x24d),'message':_0x402c2a(0x204)});}};exports[a9_0x3c4e11(0x224)]=removeAllContacts;const updateContacts=async(_0x589267,_0x4f1a01)=>{const _0x3ed4a1=a9_0x3c4e11,_0x2a6193=_0x589267[_0x3ed4a1(0x24b)],{companyId:_0x4aba90}=_0x589267[_0x3ed4a1(0x26a)],_0x157ac4=Yup['object']()[_0x3ed4a1(0x227)]({'name':Yup[_0x3ed4a1(0x1e9)](),'number':Yup[_0x3ed4a1(0x1e9)]()[_0x3ed4a1(0x217)](/^\d+$/,_0x3ed4a1(0x1fb))});try{await _0x157ac4[_0x3ed4a1(0x1cc)](_0x2a6193);}catch(_0x1cfe54){throw new AppError_1[(_0x3ed4a1(0x1af))](_0x1cfe54[_0x3ed4a1(0x23f)]);}await(0x0,CheckIsValidContact_1[_0x3ed4a1(0x1af)])(_0x2a6193[_0x3ed4a1(0x1d7)],_0x4aba90);const _0x41fa22=await(0x0,CheckNumber_1['default'])(_0x2a6193['number'],_0x4aba90),_0x2b1252=_0x41fa22[_0x3ed4a1(0x269)][_0x3ed4a1(0x1ea)](/\D/g,'');_0x2a6193[_0x3ed4a1(0x1d7)]=_0x2b1252;const {contactId:_0xf20834}=_0x589267['params'],_0x424bcd=await(0x0,UpdateContactService_1[_0x3ed4a1(0x1af)])({'contactData':_0x2a6193,'contactId':_0xf20834,'companyId':_0x4aba90}),_0x5b1384=(0x0,socket_1[_0x3ed4a1(0x1eb)])();return _0x5b1384[_0x3ed4a1(0x26f)](_0x3ed4a1(0x1d4)+_0x4aba90+_0x3ed4a1(0x274),{'action':_0x3ed4a1(0x206),'contact':_0x424bcd}),_0x4f1a01[_0x3ed4a1(0x20c)](0xc8)[_0x3ed4a1(0x248)](_0x424bcd);};exports['updateContacts']=updateContacts;const removeContacts=async(_0x593d79,_0x342d55)=>{const _0x5b9719=a9_0x3c4e11,{contactId:_0x4f8fd2}=_0x593d79[_0x5b9719(0x21f)],{companyId:_0x544e2b}=_0x593d79['user'];await(0x0,ShowContactService_1[_0x5b9719(0x1af)])(_0x4f8fd2,_0x544e2b),await(0x0,DeleteContactService_1['default'])(_0x4f8fd2);const _0x569eec=(0x0,socket_1['getIO'])();return _0x569eec[_0x5b9719(0x26f)](_0x5b9719(0x1d4)+_0x544e2b+_0x5b9719(0x274),{'action':_0x5b9719(0x1e4),'contactId':_0x4f8fd2}),_0x342d55[_0x5b9719(0x20c)](0xc8)['json']({'message':'Contact\x20deleted'});};exports['removeContacts']=removeContacts;const uploadContacts=async(_0x2f241a,_0x5c20a9)=>{const _0x17267b=a9_0x3c4e11,_0x1a46b6=_0x2f241a[_0x17267b(0x1b5)],_0x465eee=(0x0,lodash_1['head'])(_0x1a46b6),{companyId:_0x4ee3f9}=_0x2f241a['user'],_0x4fd67b=await(0x0,ImportXLSContactsService_1['ImportXLSContactsService'])(_0x4ee3f9,_0x465eee),_0x51d30c=(0x0,socket_1[_0x17267b(0x1eb)])(),_0x39e3fd={'action':_0x17267b(0x1cb),'records':_0x4fd67b};return _0x51d30c['to']('company-'+_0x4ee3f9+_0x17267b(0x1b9))[_0x17267b(0x26f)](_0x17267b(0x1d4)+_0x4ee3f9+_0x17267b(0x274),_0x39e3fd),_0x5c20a9['status'](0xc8)[_0x17267b(0x248)](_0x4fd67b);};exports['uploadContacts']=uploadContacts;const toggleDisableBotContacts=async(_0x5434bc,_0x428f60)=>{const _0x3abbfa=a9_0x3c4e11,{contactId:_0x50321b}=_0x5434bc[_0x3abbfa(0x21f)],{companyId:_0x20681c}=_0x5434bc['user'],_0x1acf7e=await(0x0,ToggleDisableBotService_1[_0x3abbfa(0x1af)])(_0x50321b,_0x20681c),_0x4ceb9b=(0x0,socket_1[_0x3abbfa(0x1eb)])();return _0x4ceb9b[_0x3abbfa(0x26f)](_0x3abbfa(0x1d4)+_0x20681c+_0x3abbfa(0x274),{'action':_0x3abbfa(0x206),'contact':_0x1acf7e}),_0x428f60[_0x3abbfa(0x20c)](0xc8)['json'](_0x1acf7e);};exports[a9_0x3c4e11(0x258)]=toggleDisableBotContacts;