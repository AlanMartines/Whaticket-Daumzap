const a9_0x9658bb=a9_0x2413;(function(_0x319bde,_0x333e7e){const _0x36d290=a9_0x2413,_0x32839c=_0x319bde();while(!![]){try{const _0x2a99c6=parseInt(_0x36d290(0x1a4))/0x1*(parseInt(_0x36d290(0x173))/0x2)+-parseInt(_0x36d290(0x176))/0x3+parseInt(_0x36d290(0x151))/0x4+-parseInt(_0x36d290(0x197))/0x5*(-parseInt(_0x36d290(0x157))/0x6)+-parseInt(_0x36d290(0x1ad))/0x7*(parseInt(_0x36d290(0x192))/0x8)+-parseInt(_0x36d290(0x1b8))/0x9*(parseInt(_0x36d290(0x1bf))/0xa)+parseInt(_0x36d290(0x18f))/0xb*(parseInt(_0x36d290(0x125))/0xc);if(_0x2a99c6===_0x333e7e)break;else _0x32839c['push'](_0x32839c['shift']());}catch(_0x2d07f8){_0x32839c['push'](_0x32839c['shift']());}}}(a9_0x352d,0x65425));const a9_0x8e4bc8=(function(){let _0x1c3422=!![];return function(_0x17d016,_0x10499d){const _0x40e70f=_0x1c3422?function(){const _0x18396a=a9_0x2413;if(_0x10499d){const _0x5ba9b5=_0x10499d[_0x18396a(0x1b7)](_0x17d016,arguments);return _0x10499d=null,_0x5ba9b5;}}:function(){};return _0x1c3422=![],_0x40e70f;};}()),a9_0x197dbd=a9_0x8e4bc8(this,function(){const _0x4934b0=a9_0x2413;return a9_0x197dbd[_0x4934b0(0x1f7)]()[_0x4934b0(0x1d5)](_0x4934b0(0x183))['toString']()['constructor'](a9_0x197dbd)[_0x4934b0(0x1d5)](_0x4934b0(0x183));});a9_0x197dbd();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a9_0x9658bb(0x184)]?function(_0x22adf0,_0x1791d8,_0x49d674,_0x4d439a){const _0x26a1fe=a9_0x9658bb;if(_0x4d439a===undefined)_0x4d439a=_0x49d674;var _0x3c5806=Object[_0x26a1fe(0x1e1)](_0x1791d8,_0x49d674);(!_0x3c5806||(_0x26a1fe(0x17a)in _0x3c5806?!_0x1791d8[_0x26a1fe(0x1d6)]:_0x3c5806['writable']||_0x3c5806[_0x26a1fe(0x16e)]))&&(_0x3c5806={'enumerable':!![],'get':function(){return _0x1791d8[_0x49d674];}}),Object[_0x26a1fe(0x19d)](_0x22adf0,_0x4d439a,_0x3c5806);}:function(_0x478771,_0x2127fa,_0x32d5e3,_0x35b78b){if(_0x35b78b===undefined)_0x35b78b=_0x32d5e3;_0x478771[_0x35b78b]=_0x2127fa[_0x32d5e3];}),__setModuleDefault=this&&this[a9_0x9658bb(0x1f1)]||(Object[a9_0x9658bb(0x184)]?function(_0x14668e,_0x56dda2){const _0x1d35b1=a9_0x9658bb;Object['defineProperty'](_0x14668e,_0x1d35b1(0x1d8),{'enumerable':!![],'value':_0x56dda2});}:function(_0x3a4174,_0x23838f){const _0x535070=a9_0x9658bb;_0x3a4174[_0x535070(0x1d8)]=_0x23838f;}),__importStar=this&&this[a9_0x9658bb(0x142)]||function(_0x5c1c31){const _0x507e31=a9_0x9658bb;if(_0x5c1c31&&_0x5c1c31['__esModule'])return _0x5c1c31;var _0x345c8b={};if(_0x5c1c31!=null){for(var _0x229447 in _0x5c1c31)if(_0x229447!==_0x507e31(0x1d8)&&Object[_0x507e31(0x15a)][_0x507e31(0x1e9)]['call'](_0x5c1c31,_0x229447))__createBinding(_0x345c8b,_0x5c1c31,_0x229447);}return __setModuleDefault(_0x345c8b,_0x5c1c31),_0x345c8b;},__importDefault=this&&this[a9_0x9658bb(0x137)]||function(_0x4770c5){const _0x4c2920=a9_0x9658bb;return _0x4770c5&&_0x4770c5[_0x4c2920(0x1d6)]?_0x4770c5:{'default':_0x4770c5};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['toggleDisableBotContacts']=exports[a9_0x9658bb(0x1d3)]=exports['removeContacts']=exports[a9_0x9658bb(0x168)]=exports[a9_0x9658bb(0x140)]=exports[a9_0x9658bb(0x149)]=exports[a9_0x9658bb(0x17e)]=exports[a9_0x9658bb(0x12e)]=exports[a9_0x9658bb(0x1c6)]=exports[a9_0x9658bb(0x14e)]=exports[a9_0x9658bb(0x141)]=exports[a9_0x9658bb(0x18c)]=exports[a9_0x9658bb(0x161)]=exports[a9_0x9658bb(0x1e7)]=exports[a9_0x9658bb(0x126)]=exports[a9_0x9658bb(0x1a3)]=exports['makeid']=exports[a9_0x9658bb(0x1de)]=exports[a9_0x9658bb(0x1ee)]=exports[a9_0x9658bb(0x19e)]=exports[a9_0x9658bb(0x1b5)]=exports[a9_0x9658bb(0x1a0)]=exports['closeTicket']=exports[a9_0x9658bb(0x145)]=exports[a9_0x9658bb(0x16f)]=exports[a9_0x9658bb(0x15d)]=exports['indexImage']=exports[a9_0x9658bb(0x159)]=exports[a9_0x9658bb(0x17c)]=exports[a9_0x9658bb(0x147)]=exports[a9_0x9658bb(0x1bc)]=exports[a9_0x9658bb(0x1e4)]=exports[a9_0x9658bb(0x17f)]=void 0x0;const axios_1=__importDefault(require(a9_0x9658bb(0x1d7))),fs_1=__importDefault(require('fs')),Yup=__importStar(require('yup')),lodash_1=require(a9_0x9658bb(0x15b)),GetDefaultWhatsApp_1=__importDefault(require('../helpers/GetDefaultWhatsApp')),SetTicketMessagesAsRead_1=__importDefault(require('../helpers/SetTicketMessagesAsRead')),socket_1=require(a9_0x9658bb(0x167)),Whatsapp_1=__importDefault(require(a9_0x9658bb(0x1c9))),Queue_1=__importDefault(require(a9_0x9658bb(0x187))),User_1=__importDefault(require(a9_0x9658bb(0x1b2))),CreateOrUpdateContactService_1=__importDefault(require(a9_0x9658bb(0x1ea))),FindOrCreateTicketService_1=__importDefault(require(a9_0x9658bb(0x1af))),ShowTicketService_1=__importDefault(require('../services/TicketServices/ShowTicketService')),GetProfilePicUrl_1=__importDefault(require(a9_0x9658bb(0x1dd))),SendWhatsAppMedia_1=__importDefault(require(a9_0x9658bb(0x1b9))),UpdateTicketService_1=__importDefault(require(a9_0x9658bb(0x170))),wbot_1=require('../libs/wbot'),SendWhatsAppMessageLink_1=__importDefault(require(a9_0x9658bb(0x153))),SendWhatsAppMessageAPI_1=__importDefault(require(a9_0x9658bb(0x14d))),SendWhatsappMediaImage_1=__importDefault(require(a9_0x9658bb(0x138))),ListInvoicesServices_1=__importDefault(require(a9_0x9658bb(0x16d))),ShowInvoiceService_1=__importDefault(require(a9_0x9658bb(0x1b1))),UpdateInvoiceService_1=__importDefault(require(a9_0x9658bb(0x143))),Invoices_1=__importDefault(require(a9_0x9658bb(0x1e5))),ListContactsService_1=__importDefault(require(a9_0x9658bb(0x1f0))),CreateContactService_1=__importDefault(require(a9_0x9658bb(0x1dc))),ShowContactService_1=__importDefault(require(a9_0x9658bb(0x14c))),UpdateContactService_1=__importDefault(require(a9_0x9658bb(0x1c8))),DeleteContactService_1=__importDefault(require(a9_0x9658bb(0x148))),GetContactService_1=__importDefault(require(a9_0x9658bb(0x178))),ToggleDisableBotService_1=__importDefault(require(a9_0x9658bb(0x127))),CheckNumber_1=__importDefault(require(a9_0x9658bb(0x12d))),CheckIsValidContact_1=__importDefault(require(a9_0x9658bb(0x136))),AppError_1=__importDefault(require(a9_0x9658bb(0x193))),SimpleListService_1=__importDefault(require('../services/ContactServices/SimpleListService')),ImportXLSContactsService_1=require(a9_0x9658bb(0x1c4)),ApiUsages_1=__importDefault(require('../models/ApiUsages')),useDate_1=require('../utils/useDate'),TicketTag_1=__importDefault(require('../models/TicketTag')),Tag_1=__importDefault(require(a9_0x9658bb(0x1ec))),moment_1=__importDefault(require(a9_0x9658bb(0x191))),path_1=__importDefault(require('path')),Ticket_1=__importDefault(require('../models/Ticket')),Contact_1=__importDefault(require(a9_0x9658bb(0x1b6))),Company_1=__importDefault(require(a9_0x9658bb(0x1ae))),SendPresenceStatus_1=require(a9_0x9658bb(0x1cc));class OnWhatsAppDto{constructor(_0x13501e,_0x5ede63){const _0x42c2b2=a9_0x9658bb;this[_0x42c2b2(0x1bb)]=_0x13501e,this[_0x42c2b2(0x18a)]=_0x5ede63;}}exports[a9_0x9658bb(0x17f)]=OnWhatsAppDto;const CompanySchema=Yup[a9_0x9658bb(0x17b)]()[a9_0x9658bb(0x1a2)]({'name':Yup[a9_0x9658bb(0x154)]()['required'](),'id':Yup[a9_0x9658bb(0x182)](),'phone':Yup[a9_0x9658bb(0x154)]()[a9_0x9658bb(0x1d2)](),'email':Yup[a9_0x9658bb(0x154)]()[a9_0x9658bb(0x12f)]()[a9_0x9658bb(0x1d2)](),'status':Yup[a9_0x9658bb(0x195)]()[a9_0x9658bb(0x1d2)](),'planId':Yup[a9_0x9658bb(0x182)]()['nullable'](),'campaignsEnabled':Yup[a9_0x9658bb(0x195)]()[a9_0x9658bb(0x1d2)](),'dueDate':Yup[a9_0x9658bb(0x129)]()[a9_0x9658bb(0x1d2)](),'recurrence':Yup[a9_0x9658bb(0x154)]()[a9_0x9658bb(0x1d2)]()}),createCompany=async(_0x5aa767,_0x4bb894)=>{const _0x5dab34=a9_0x9658bb;try{await CompanySchema[_0x5dab34(0x163)](_0x5aa767[_0x5dab34(0x185)]);const _0x4d7e71=await Company_1[_0x5dab34(0x1d8)]['create'](_0x5aa767[_0x5dab34(0x185)]);_0x4bb894[_0x5dab34(0x128)](0xc9)[_0x5dab34(0x1df)](_0x4d7e71);}catch(_0xc9c9f3){_0x4bb894[_0x5dab34(0x128)](0x190)[_0x5dab34(0x1df)]({'error':_0xc9c9f3[_0x5dab34(0x162)]});}};exports[a9_0x9658bb(0x1e4)]=createCompany;const updateCompany=async(_0x14c390,_0x1fd233)=>{const _0x477c7a=a9_0x9658bb;try{await CompanySchema['validate'](_0x14c390[_0x477c7a(0x185)]);const {id:_0x592cb1}=_0x14c390[_0x477c7a(0x1a5)],[_0x4dcef6]=await Company_1['default'][_0x477c7a(0x19f)](_0x14c390[_0x477c7a(0x185)],{'where':{'id':_0x592cb1}});if(_0x4dcef6){const _0x375603=await Company_1[_0x477c7a(0x1d8)][_0x477c7a(0x1c0)](_0x592cb1);_0x1fd233[_0x477c7a(0x128)](0xc8)[_0x477c7a(0x1df)](_0x375603);}else _0x1fd233[_0x477c7a(0x128)](0x194)[_0x477c7a(0x1df)]({'error':_0x477c7a(0x190)});}catch(_0x579146){_0x1fd233[_0x477c7a(0x128)](0x190)[_0x477c7a(0x1df)]({'error':_0x579146['message']});}};exports['updateCompany']=updateCompany;const blockCompany=async(_0x4a329b,_0x7bfb9)=>{const _0x145d57=a9_0x9658bb;try{const {id:_0x7d82f}=_0x4a329b['params'],[_0x177f8b]=await Company_1[_0x145d57(0x1d8)][_0x145d57(0x19f)]({'status':![]},{'where':{'id':_0x7d82f}});if(_0x177f8b){const _0x17ebe4=await Company_1[_0x145d57(0x1d8)][_0x145d57(0x1c0)](_0x7d82f);_0x7bfb9[_0x145d57(0x128)](0xc8)[_0x145d57(0x1df)](_0x17ebe4);}else _0x7bfb9[_0x145d57(0x128)](0x194)[_0x145d57(0x1df)]({'error':_0x145d57(0x190)});}catch(_0x496d50){_0x7bfb9['status'](0x190)['json']({'error':_0x496d50['message']});}};exports['blockCompany']=blockCompany;const createContact=async(_0x2c82e9,_0x19252c,_0x1427f8)=>{const _0x19853b=a9_0x9658bb;await(0x0,CheckIsValidContact_1['default'])(_0x1427f8,_0x19252c);const _0x4b1646=await(0x0,CheckNumber_1[_0x19853b(0x1d8)])(_0x1427f8,_0x19252c),_0x1907d6=await(0x0,GetProfilePicUrl_1[_0x19853b(0x1d8)])(_0x4b1646,_0x19252c),_0x53d0a0=_0x4b1646,_0x59ef86={'name':''+_0x53d0a0,'number':_0x53d0a0,'profilePicUrl':_0x1907d6,'isGroup':![],'companyId':_0x19252c},_0x945ff6=await(0x0,CreateOrUpdateContactService_1[_0x19853b(0x1d8)])(_0x59ef86,null,null);let _0x115ab3;if(_0x2c82e9===undefined)_0x115ab3=await(0x0,GetDefaultWhatsApp_1['default'])(_0x19252c);else{_0x115ab3=await Whatsapp_1[_0x19853b(0x1d8)][_0x19853b(0x1c0)](_0x2c82e9);if(_0x115ab3===null)throw new AppError_1[(_0x19853b(0x1d8))](_0x19853b(0x16c)+_0x2c82e9+_0x19853b(0x14f));}const _0x2e769f=await(0x0,FindOrCreateTicketService_1[_0x19853b(0x1d8)])(_0x945ff6,_0x115ab3['id'],0x0,_0x19252c),_0x25684e=await(0x0,ShowTicketService_1[_0x19853b(0x1d8)])(_0x2e769f['id'],_0x19252c);return(0x0,SetTicketMessagesAsRead_1[_0x19853b(0x1d8)])(_0x25684e),_0x25684e;};function formatBRNumber(_0x1b51d3){const _0x25bc44=a9_0x9658bb,_0x3dcc55=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x3dcc55[_0x25bc44(0x150)](_0x1b51d3)){const _0x23401b=_0x3dcc55['exec'](_0x1b51d3);if(_0x23401b&&_0x23401b[0x1]==='55'&&Number[_0x25bc44(0x144)](Number['parseInt'](_0x23401b[0x2]))){const _0x35a47c=Number[_0x25bc44(0x1d1)](_0x23401b[0x2]);if(_0x35a47c<0x1f)return _0x23401b[0x0];else{if(_0x35a47c>=0x1f)return _0x23401b[0x1]+_0x23401b[0x2]+_0x23401b[0x3];}}}else return _0x1b51d3;}function createJid(_0xf049ac){const _0x237bd3=a9_0x9658bb;if(_0xf049ac[_0x237bd3(0x14a)](_0x237bd3(0x186))||_0xf049ac['includes'](_0x237bd3(0x1fa)))return formatBRNumber(_0xf049ac);return _0xf049ac[_0x237bd3(0x14a)]('-')?_0xf049ac+_0x237bd3(0x186):formatBRNumber(_0xf049ac)+'@s.whatsapp.net';}const indexLink=async(_0x54e327,_0x15a350)=>{const _0x518e53=a9_0x9658bb,_0x26cf85=_0x54e327[_0x518e53(0x185)],{whatsappId:_0x5215f5}=_0x54e327['body'],{msdelay:_0xda7ceb}=_0x54e327[_0x518e53(0x185)],_0x1303f2=_0x54e327[_0x518e53(0x185)][_0x518e53(0x169)],_0x5c12c8=_0x54e327[_0x518e53(0x185)][_0x518e53(0x1d0)],_0x62e297=_0x54e327[_0x518e53(0x12a)][_0x518e53(0x1da)],[,_0x42ba42]=_0x62e297['split']('\x20'),_0x5118f6=await Whatsapp_1[_0x518e53(0x1d8)][_0x518e53(0x1c7)]({'where':{'token':_0x42ba42}}),_0x58ae84=_0x5118f6[_0x518e53(0x131)];_0x26cf85[_0x518e53(0x182)]=_0x26cf85[_0x518e53(0x182)][_0x518e53(0x13c)]('-','')[_0x518e53(0x13c)]('\x20','');const _0xbbc202=Yup['object']()[_0x518e53(0x1a2)]({'number':Yup[_0x518e53(0x154)]()[_0x518e53(0x152)]()[_0x518e53(0x1f4)](/^\d+$/,_0x518e53(0x1cf))});try{await _0xbbc202['validate'](_0x26cf85);}catch(_0x34d9cf){throw new AppError_1[(_0x518e53(0x1d8))](_0x34d9cf[_0x518e53(0x162)]);}const _0x5973f3=await createContact(_0x5215f5,_0x58ae84,_0x26cf85[_0x518e53(0x182)]);return await(0x0,SendWhatsAppMessageLink_1['default'])({'ticket':_0x5973f3,'url':_0x1303f2,'caption':_0x5c12c8,'msdelay':_0xda7ceb}),setTimeout(async()=>{const _0x585e48=_0x518e53;await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x5973f3['id'],'ticketData':{'status':_0x585e48(0x130),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x58ae84});},0xc8),setTimeout(async()=>{const _0x381b75=_0x518e53,{dateToClient:_0x38247b}=(0x0,useDate_1[_0x381b75(0x156)])(),_0x2cb09d=_0x38247b(new Date()['toString']()),_0x503d6c=(0x0,moment_1[_0x381b75(0x1d8)])()[_0x381b75(0x13e)](),_0x58bb66=await ApiUsages_1[_0x381b75(0x1d8)]['findOne']({'where':{'dateUsed':_0x2cb09d,'companyId':_0x58ae84}});if(_0x58bb66)await _0x58bb66[_0x381b75(0x19f)]({'usedPDF':_0x58bb66[_0x381b75(0x18e)][_0x381b75(0x171)]+0x1,'UsedOnDay':_0x58bb66[_0x381b75(0x18e)][_0x381b75(0x1be)]+0x1,'updatedAt':_0x503d6c});else{const _0x59c2f9=await ApiUsages_1[_0x381b75(0x1d8)][_0x381b75(0x184)]({'companyId':_0x58ae84,'dateUsed':_0x2cb09d});await _0x59c2f9[_0x381b75(0x19f)]({'usedPDF':_0x59c2f9['dataValues']['usedPDF']+0x1,'UsedOnDay':_0x59c2f9[_0x381b75(0x18e)][_0x381b75(0x1be)]+0x1,'updatedAt':_0x503d6c});}},0x64),_0x15a350[_0x518e53(0x1c2)]({'status':_0x518e53(0x132)});};exports[a9_0x9658bb(0x17c)]=indexLink;const index=async(_0x2e126b,_0x44e2b9)=>{const _0x39adc6=a9_0x9658bb,_0x2f5c8b=_0x2e126b['body'],{whatsappId:_0x2b5b0b}=_0x2e126b['body'],{msdelay:_0x4f77aa}=_0x2e126b[_0x39adc6(0x185)],{body:_0x33d151,quotedMsg:_0x24d843}=_0x2e126b[_0x39adc6(0x185)],_0x44aa0c=_0x2e126b[_0x39adc6(0x165)],_0x2dc77d=_0x2e126b[_0x39adc6(0x12a)][_0x39adc6(0x1da)],[,_0x34b78b]=_0x2dc77d[_0x39adc6(0x146)]('\x20'),_0x221471=await Whatsapp_1['default'][_0x39adc6(0x1c7)]({'where':{'token':_0x34b78b}}),_0x1568ed=_0x221471[_0x39adc6(0x131)];_0x2f5c8b[_0x39adc6(0x182)]=_0x2f5c8b['number']['replace']('-','')['replace']('\x20','');const _0x4e88c4=Yup[_0x39adc6(0x17b)]()[_0x39adc6(0x1a2)]({'number':Yup['string']()[_0x39adc6(0x152)]()[_0x39adc6(0x1f4)](/^\d+$/,_0x39adc6(0x1cf))});try{await _0x4e88c4[_0x39adc6(0x163)](_0x2f5c8b);}catch(_0x1c39cd){throw new AppError_1[(_0x39adc6(0x1d8))](_0x1c39cd[_0x39adc6(0x162)]);}const _0x4f6cd5=await createContact(_0x2b5b0b,_0x1568ed,_0x2f5c8b[_0x39adc6(0x182)]);return _0x44aa0c?await Promise['all'](_0x44aa0c[_0x39adc6(0x133)](async _0x4d05b7=>{const _0x4ea821=_0x39adc6;await(0x0,SendWhatsAppMedia_1[_0x4ea821(0x1d8)])({'body':_0x33d151,'media':_0x4d05b7,'ticket':_0x4f6cd5});})):await(0x0,SendWhatsAppMessageAPI_1[_0x39adc6(0x1d8)])({'body':_0x33d151,'ticket':_0x4f6cd5,'quotedMsg':_0x24d843,'msdelay':_0x4f77aa}),setTimeout(async()=>{await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x4f6cd5['id'],'ticketData':{'status':'pending','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x1568ed});},0x64),setTimeout(async()=>{const _0x53625a=_0x39adc6,{dateToClient:_0x24aa01}=(0x0,useDate_1['useDate'])(),_0x124115=_0x24aa01(new Date()['toString']()),_0x494876=(0x0,moment_1[_0x53625a(0x1d8)])()[_0x53625a(0x13e)](),_0x14b328=await ApiUsages_1['default']['findOne']({'where':{'dateUsed':_0x124115,'companyId':_0x1568ed}});_0x14b328?_0x44aa0c?await Promise['all'](_0x44aa0c[_0x53625a(0x133)](async _0x318f98=>{const _0x379c38=_0x53625a;console[_0x379c38(0x1e8)](_0x379c38(0x164),_0x318f98);const _0x5748c2=path_1[_0x379c38(0x1d8)][_0x379c38(0x180)](_0x318f98['originalname']);console[_0x379c38(0x1e8)](_0x379c38(0x19c),_0x5748c2);if(_0x318f98[_0x379c38(0x1d4)][_0x379c38(0x14a)](_0x379c38(0x15f)))await _0x14b328[_0x379c38(0x19f)]({'usedPDF':_0x14b328['dataValues']['usedPDF']+0x1,'UsedOnDay':_0x14b328[_0x379c38(0x18e)][_0x379c38(0x1be)]+0x1,'updatedAt':_0x494876});else{if(_0x318f98[_0x379c38(0x1d4)]['includes'](_0x379c38(0x1f9)))await _0x14b328[_0x379c38(0x19f)]({'usedImage':_0x14b328[_0x379c38(0x18e)]['usedImage']+0x1,'UsedOnDay':_0x14b328[_0x379c38(0x18e)][_0x379c38(0x1be)]+0x1,'updatedAt':_0x494876});else _0x318f98[_0x379c38(0x1d4)]['includes']('video')?await _0x14b328[_0x379c38(0x19f)]({'usedVideo':_0x14b328[_0x379c38(0x18e)][_0x379c38(0x1a6)]+0x1,'UsedOnDay':_0x14b328['dataValues'][_0x379c38(0x1be)]+0x1,'updatedAt':_0x494876}):await _0x14b328[_0x379c38(0x19f)]({'usedOther':_0x14b328[_0x379c38(0x18e)][_0x379c38(0x15e)]+0x1,'UsedOnDay':_0x14b328[_0x379c38(0x18e)]['UsedOnDay']+0x1,'updatedAt':_0x494876});}})):await _0x14b328['update']({'usedText':_0x14b328[_0x53625a(0x18e)][_0x53625a(0x1f5)]+0x1,'UsedOnDay':_0x14b328[_0x53625a(0x18e)][_0x53625a(0x1be)]+0x1,'updatedAt':_0x494876}):(await ApiUsages_1[_0x53625a(0x1d8)][_0x53625a(0x184)]({'companyId':_0x1568ed,'dateUsed':_0x124115}),_0x44aa0c?await Promise['all'](_0x44aa0c['map'](async _0x5ee4e5=>{const _0xb86397=_0x53625a;console['log'](_0xb86397(0x164),_0x5ee4e5);const _0x2f4526=path_1['default'][_0xb86397(0x180)](_0x5ee4e5[_0xb86397(0x1a8)]);console[_0xb86397(0x1e8)](_0xb86397(0x19c),_0x2f4526);if(_0x5ee4e5[_0xb86397(0x1d4)]['includes'](_0xb86397(0x15f)))await _0x14b328[_0xb86397(0x19f)]({'usedPDF':_0x14b328[_0xb86397(0x18e)]['usedPDF']+0x1,'UsedOnDay':_0x14b328[_0xb86397(0x18e)][_0xb86397(0x1be)]+0x1,'updatedAt':_0x494876});else{if(_0x5ee4e5['mimetype']['includes'](_0xb86397(0x1f9)))await _0x14b328[_0xb86397(0x19f)]({'usedImage':_0x14b328[_0xb86397(0x18e)][_0xb86397(0x1a7)]+0x1,'UsedOnDay':_0x14b328[_0xb86397(0x18e)][_0xb86397(0x1be)]+0x1,'updatedAt':_0x494876});else _0x5ee4e5[_0xb86397(0x1d4)][_0xb86397(0x14a)](_0xb86397(0x16a))?await _0x14b328[_0xb86397(0x19f)]({'usedVideo':_0x14b328[_0xb86397(0x18e)][_0xb86397(0x1a6)]+0x1,'UsedOnDay':_0x14b328[_0xb86397(0x18e)][_0xb86397(0x1be)]+0x1,'updatedAt':_0x494876}):await _0x14b328[_0xb86397(0x19f)]({'usedOther':_0x14b328[_0xb86397(0x18e)][_0xb86397(0x15e)]+0x1,'UsedOnDay':_0x14b328['dataValues'][_0xb86397(0x1be)]+0x1,'updatedAt':_0x494876});}})):await _0x14b328[_0x53625a(0x19f)]({'usedText':_0x14b328[_0x53625a(0x18e)][_0x53625a(0x1f5)]+0x1,'UsedOnDay':_0x14b328[_0x53625a(0x18e)]['UsedOnDay']+0x1,'updatedAt':_0x494876}));},0x64),_0x44e2b9['send']({'status':'SUCCESS'});};exports['index']=index;const indexImage=async(_0x5113ea,_0x41ce0e)=>{const _0x511f42=a9_0x9658bb,_0x1f1a55=_0x5113ea[_0x511f42(0x185)],{whatsappId:_0xc45338}=_0x5113ea[_0x511f42(0x185)],{msdelay:_0x305877}=_0x5113ea['body'],_0x2f7a3f=_0x5113ea[_0x511f42(0x185)][_0x511f42(0x169)],_0x546a15=_0x5113ea[_0x511f42(0x185)][_0x511f42(0x1d0)],_0x3b8dd2=_0x5113ea[_0x511f42(0x12a)][_0x511f42(0x1da)],[,_0x566578]=_0x3b8dd2['split']('\x20'),_0x1065a9=await Whatsapp_1[_0x511f42(0x1d8)]['findOne']({'where':{'token':_0x566578}}),_0x81c4b2=_0x1065a9[_0x511f42(0x131)];_0x1f1a55[_0x511f42(0x182)]=_0x1f1a55[_0x511f42(0x182)][_0x511f42(0x13c)]('-','')['replace']('\x20','');const _0x362718=Yup[_0x511f42(0x17b)]()['shape']({'number':Yup[_0x511f42(0x154)]()['required']()[_0x511f42(0x1f4)](/^\d+$/,_0x511f42(0x1cf))});try{await _0x362718[_0x511f42(0x163)](_0x1f1a55);}catch(_0x5bf04a){throw new AppError_1[(_0x511f42(0x1d8))](_0x5bf04a[_0x511f42(0x162)]);}const _0xfc3c6f=await createContact(_0xc45338,_0x81c4b2,_0x1f1a55[_0x511f42(0x182)]);return _0x2f7a3f&&await(0x0,SendWhatsappMediaImage_1[_0x511f42(0x1d8)])({'ticket':_0xfc3c6f,'url':_0x2f7a3f,'caption':_0x546a15,'msdelay':_0x305877}),setTimeout(async()=>{const _0x5e4324=_0x511f42;await(0x0,UpdateTicketService_1[_0x5e4324(0x1d8)])({'ticketId':_0xfc3c6f['id'],'ticketData':{'status':_0x5e4324(0x130),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x81c4b2});},0x64),setTimeout(async()=>{const _0x333a9f=_0x511f42,{dateToClient:_0x131318}=(0x0,useDate_1[_0x333a9f(0x156)])(),_0x5a28c8=_0x131318(new Date()[_0x333a9f(0x1f7)]()),_0x4241b6=(0x0,moment_1[_0x333a9f(0x1d8)])()['format'](),_0x56dfee=await ApiUsages_1[_0x333a9f(0x1d8)][_0x333a9f(0x1c7)]({'where':{'dateUsed':_0x5a28c8,'companyId':_0x81c4b2}});if(_0x56dfee)await _0x56dfee[_0x333a9f(0x19f)]({'usedImage':_0x56dfee[_0x333a9f(0x18e)][_0x333a9f(0x1a7)]+0x1,'UsedOnDay':_0x56dfee[_0x333a9f(0x18e)]['UsedOnDay']+0x1,'updatedAt':_0x4241b6});else{const _0x270d36=await ApiUsages_1[_0x333a9f(0x1d8)]['create']({'companyId':_0x81c4b2,'dateUsed':_0x5a28c8});await _0x270d36[_0x333a9f(0x19f)]({'usedImage':_0x270d36[_0x333a9f(0x18e)][_0x333a9f(0x1a7)]+0x1,'UsedOnDay':_0x270d36[_0x333a9f(0x18e)][_0x333a9f(0x1be)]+0x1,'updatedAt':_0x4241b6});}},0x64),_0x41ce0e['send']({'status':_0x511f42(0x132)});};exports[a9_0x9658bb(0x1ed)]=indexImage;const checkNumber=async(_0x38b8f8,_0x149ef2)=>{const _0x113b45=a9_0x9658bb,_0x9069bd=_0x38b8f8[_0x113b45(0x185)],_0x10d87e=_0x38b8f8[_0x113b45(0x12a)][_0x113b45(0x1da)],[,_0x284767]=_0x10d87e[_0x113b45(0x146)]('\x20'),_0x507e82=await Whatsapp_1[_0x113b45(0x1d8)][_0x113b45(0x1c7)]({'where':{'token':_0x284767}}),_0x267a2e=_0x507e82[_0x113b45(0x131)],_0x51e26b=_0x9069bd[_0x113b45(0x182)][_0x113b45(0x13c)]('-','')[_0x113b45(0x13c)]('\x20',''),_0x1edfeb=await(0x0,GetDefaultWhatsApp_1[_0x113b45(0x1d8)])(_0x267a2e),_0x2a26f6=(0x0,wbot_1[_0x113b45(0x1e2)])(_0x1edfeb['id']),_0x255de2=createJid(_0x51e26b);try{const [_0x61d312]=await _0x2a26f6['onWhatsApp'](_0x255de2);if(_0x61d312[_0x113b45(0x18a)])return setTimeout(async()=>{const _0x24829d=_0x113b45,{dateToClient:_0x4d7842}=(0x0,useDate_1[_0x24829d(0x156)])(),_0x1c31ac=_0x4d7842(new Date()[_0x24829d(0x1f7)]()),_0x16c280=(0x0,moment_1['default'])()[_0x24829d(0x13e)](),_0x440ace=await ApiUsages_1[_0x24829d(0x1d8)]['findOne']({'where':{'dateUsed':_0x1c31ac,'companyId':_0x267a2e}});if(_0x440ace)await _0x440ace['update']({'usedCheckNumber':_0x440ace[_0x24829d(0x18e)]['usedCheckNumber']+0x1,'UsedOnDay':_0x440ace[_0x24829d(0x18e)][_0x24829d(0x1be)]+0x1,'updatedAt':_0x16c280});else{const _0x5ca039=await ApiUsages_1[_0x24829d(0x1d8)][_0x24829d(0x184)]({'companyId':_0x267a2e,'dateUsed':_0x1c31ac});await _0x5ca039[_0x24829d(0x19f)]({'usedCheckNumber':_0x5ca039[_0x24829d(0x18e)][_0x24829d(0x139)]+0x1,'UsedOnDay':_0x5ca039['dataValues'][_0x24829d(0x1be)]+0x1,'updatedAt':_0x16c280});}},0x64),_0x149ef2[_0x113b45(0x128)](0xc8)['json']({'existsInWhatsapp':!![],'number':_0x51e26b,'numberFormatted':_0x61d312[_0x113b45(0x1bb)]});}catch(_0x4168ab){return _0x149ef2[_0x113b45(0x128)](0x190)[_0x113b45(0x1df)]({'existsInWhatsapp':![],'number':_0x255de2,'error':_0x113b45(0x1f3)});}};exports[a9_0x9658bb(0x15d)]=checkNumber;const indexWhatsappsId=async(_0x452482,_0x5c5b5d)=>{const _0x2c56db=a9_0x9658bb;return console[_0x2c56db(0x1e8)]('req',_0x452482),console[_0x2c56db(0x1e8)]('req',_0x452482['user']),_0x5c5b5d[_0x2c56db(0x128)](0xc8)[_0x2c56db(0x1df)]('oi');};exports['indexWhatsappsId']=indexWhatsappsId;const updateQueueId=async(_0x457292,_0x5e0167)=>{const _0x1b5539=a9_0x9658bb,{ticketId:_0x45dcda}=_0x457292[_0x1b5539(0x1a5)],{queueId:_0x2bbca1}=_0x457292[_0x1b5539(0x185)],_0x157daf=_0x457292[_0x1b5539(0x12a)][_0x1b5539(0x1da)],[,_0x28715e]=_0x157daf[_0x1b5539(0x146)]('\x20'),_0x26f84e=await Whatsapp_1[_0x1b5539(0x1d8)][_0x1b5539(0x1c7)]({'where':{'token':_0x28715e}}),_0x32679d=_0x26f84e[_0x1b5539(0x131)];try{const _0x517369=await Queue_1['default']['findOne']({'where':{'id':_0x2bbca1,'companyId':_0x32679d}});if(!_0x517369)return _0x5e0167[_0x1b5539(0x128)](0x190)[_0x1b5539(0x1df)]({'status':_0x1b5539(0x1b0),'error':_0x1b5539(0x198)});return await(0x0,UpdateTicketService_1[_0x1b5539(0x1d8)])({'ticketId':_0x45dcda,'ticketData':{'queueId':_0x2bbca1},'companyId':_0x32679d}),_0x5e0167[_0x1b5539(0x128)](0xc8)['json']({'status':'SUCCESS'});}catch(_0x3eb730){return console[_0x1b5539(0x1eb)](_0x3eb730),_0x5e0167[_0x1b5539(0x128)](0x1f4)[_0x1b5539(0x1df)]({'status':_0x1b5539(0x1b0),'error':_0x1b5539(0x12c)});}};exports[a9_0x9658bb(0x145)]=updateQueueId;const closeTicket=async(_0x12594e,_0x47e45e)=>{const _0x4bf54a=a9_0x9658bb,_0x14c2a1=_0x12594e['headers'][_0x4bf54a(0x1da)],[,_0x4164a2]=_0x14c2a1[_0x4bf54a(0x146)]('\x20'),_0x4c9cf5=await Whatsapp_1[_0x4bf54a(0x1d8)]['findOne']({'where':{'token':_0x4164a2}}),_0x301f5f=_0x4c9cf5[_0x4bf54a(0x131)],{ticketId:_0x45acd5}=_0x12594e[_0x4bf54a(0x1a5)],_0x4c439a=await(0x0,ShowTicketService_1[_0x4bf54a(0x1d8)])(_0x45acd5,_0x301f5f);_0x4c439a[_0x4bf54a(0x128)]=_0x12594e[_0x4bf54a(0x185)][_0x4bf54a(0x1f6)][_0x4bf54a(0x128)],console[_0x4bf54a(0x1e8)](_0x4c439a['status']);const {ticket:_0x31c422}=await(0x0,UpdateTicketService_1[_0x4bf54a(0x1d8)])({'ticketData':_0x4c439a,'ticketId':_0x45acd5,'companyId':_0x301f5f});return _0x47e45e[_0x4bf54a(0x128)](0xc8)['json'](_0x31c422);};exports[a9_0x9658bb(0x13d)]=closeTicket;function a9_0x2413(_0x176c70,_0x2c3b57){const _0x9750fd=a9_0x352d();return a9_0x2413=function(_0x197dbd,_0x8e4bc8){_0x197dbd=_0x197dbd-0x124;let _0x352df1=_0x9750fd[_0x197dbd];return _0x352df1;},a9_0x2413(_0x176c70,_0x2c3b57);}const updateTicketTag=async(_0x49b066,_0x344d18)=>{const _0x48921d=a9_0x9658bb,{ticketId:_0x415052,tagId:_0x3a7f12}=_0x49b066['body'],_0x1a43d7=_0x49b066[_0x48921d(0x12a)][_0x48921d(0x1da)],[,_0x36419d]=_0x1a43d7['split']('\x20');try{const _0x22a90f=await Whatsapp_1[_0x48921d(0x1d8)][_0x48921d(0x1c7)]({'where':{'token':_0x36419d}}),_0xa3c70=_0x22a90f['companyId'],_0x5f3730=await Tag_1[_0x48921d(0x1d8)][_0x48921d(0x1c7)]({'where':{'id':_0x3a7f12,'companyId':_0xa3c70}});if(!_0x5f3730)return _0x344d18[_0x48921d(0x128)](0x190)[_0x48921d(0x1df)]({'status':'ERROR','error':_0x48921d(0x175)});const _0x462af2=await TicketTag_1['default'][_0x48921d(0x1c7)]({'where':{'ticketId':_0x415052,'tagId':_0x3a7f12}});if(_0x462af2)return _0x344d18['status'](0x190)[_0x48921d(0x1df)]({'status':_0x48921d(0x1b0),'error':_0x48921d(0x17d)});const _0x5ec96e=await TicketTag_1[_0x48921d(0x1d8)][_0x48921d(0x184)]({'ticketId':_0x415052,'tagId':_0x3a7f12});return _0x344d18['status'](0xc8)[_0x48921d(0x1df)]({'status':_0x48921d(0x132),'ticketTag':_0x5ec96e});}catch(_0x38bd56){return console[_0x48921d(0x1eb)](_0x38bd56),_0x344d18['status'](0x1f4)[_0x48921d(0x1df)]({'status':'ERROR','error':_0x48921d(0x13b)});}};exports[a9_0x9658bb(0x1a0)]=updateTicketTag;const removeTicketTag=async(_0x51075a,_0xa52462)=>{const _0x296629=a9_0x9658bb,{ticketId:_0x4c6b5c,tagId:_0x4fe663}=_0x51075a['body'];try{const _0x566522=await TicketTag_1[_0x296629(0x1d8)][_0x296629(0x1c7)]({'where':{'ticketId':_0x4c6b5c,'tagId':_0x4fe663}});if(!_0x566522)return _0xa52462[_0x296629(0x128)](0x190)['json']({'status':_0x296629(0x1b0),'error':'Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket'});return await _0x566522['destroy'](),_0xa52462[_0x296629(0x128)](0xc8)['json']({'status':'SUCCESS'});}catch(_0x21234d){return console[_0x296629(0x1eb)](_0x21234d),_0xa52462[_0x296629(0x128)](0x1f4)[_0x296629(0x1df)]({'status':'ERROR','error':'Failed\x20to\x20remove\x20ticket\x20tag'});}};exports[a9_0x9658bb(0x1b5)]=removeTicketTag;function a9_0x352d(){const _0xa1709d=['closeTicket','format','arraybuffer','removeAllContacts','updateUsageStats','__importStar','../services/InvoicesService/UpdateInvoiceService','isInteger','updateQueueId','split','blockCompany','../services/ContactServices/DeleteContactService','storeContacts','includes','./public/company','../services/ContactServices/ShowContactService','../services/WbotServices/SendWhatsAppMessageAPI','indexContacts','\x20not\x20found','test','545816WHDXae','required','../services/WbotServices/SendWhatsAppMessageLink','string','Legenda\x20do\x20áudio','useDate','1601994Vnnlue','from','index','prototype','lodash','data','checkNumber','usedOther','pdf','-contact','showAllApi','message','validate','media','files','paid','../libs/socket','updateContacts','url','video','company','whatsapp\x20#','../services/InvoicesService/ListInvoicesServices','configurable','indexWhatsappsId','../services/TicketServices/UpdateTicketService','usedPDF','emit','166TumcJi','Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio','Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company','251544QiqjxW','destroy','../services/ContactServices/GetContactService','All\x20contacts\x20removed\x20successfully','get','object','indexLink','Tag\x20already\x20associated\x20with\x20the\x20ticket','findOrCreateContacts','OnWhatsAppDto','extname','whatsapp','number','(((.+)+)+)+$','create','body','@g.us','../models/Queue','Erro\x20ao\x20buscar\x20invoices','contact','exists','head','updateApi','-mainchannel','dataValues','176HdFIyi','Company\x20not\x20found','moment','48QhULsq','../errors/AppError','delete','boolean','tags','5EqcLzT','Invalid\x20queue\x20for\x20the\x20company','active','facebookUserToken','getIO','type','defineProperty','listTicketsByCompany','update','updateTicketTag','Internal\x20server\x20error','shape','handleAudioLink','602XxRbKp','params','usedVideo','usedImage','originalname','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','Error\x20updating\x20usage\x20stats:','dueDate','queue','846195hYVFRh','../models/Company','../services/TicketServices/FindOrCreateTicketService','ERROR','../services/InvoicesService/ShowInvoiceService','../models/User','color','ERRO','removeTicketTag','../models/Contact','apply','36qlmcXc','../services/WbotServices/SendWhatsAppMedia','user','jid','updateCompany','extraInfo','UsedOnDay','811840zEfevh','findByPk','getDate','send','.mp3','../services/ContactServices/ImportXLSContactsService','facebookUserId','listContacts','findOne','../services/ContactServices/UpdateContactService','../models/Whatsapp','audio/mp4','makeid','../helpers/SendPresenceStatus','SUCESSO','removeContacts','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','caption','parseInt','nullable','uploadContacts','mimetype','search','__esModule','axios','default','toISOString','authorization','random','../services/ContactServices/CreateContactService','../services/WbotServices/GetProfilePicUrl','listTicketsByTagIsAuth','json','Contact\x20deleted','getOwnPropertyDescriptor','getWbot','setDate','createCompany','../models/Invoices','acceptAudioMessage','showApi','log','hasOwnProperty','../services/ContactServices/CreateOrUpdateContactService','error','../models/Tag','indexImage','listTicketsByTag','readFileSync','../services/ContactServices/ListContactsService','__setModuleDefault','findAll','Not\x20exists\x20on\x20Whatsapp','matches','usedText','ticketData','toString','charAt','image','@s.whatsapp.net','name','query','821424uYsAjd','indexApi','../services/ContactServices/ToggleDisableBotService','status','date','headers','Missing\x20user\x20or\x20companyId','Internal\x20Server\x20Error','../services/WbotServices/CheckNumber','showContacts','email','pending','companyId','SUCCESS','map','profilePicUrl','Token\x20de\x20autorização\x20inválido','../services/WbotServices/CheckIsValidContact','__importDefault','../services/WbotServices/SendWhatsappMediaImage','usedCheckNumber','company-','Failed\x20to\x20update\x20ticket\x20tag','replace'];a9_0x352d=function(){return _0xa1709d;};return a9_0x352d();}const listTicketsByCompany=async(_0x19a6d5,_0x34b565)=>{const _0x408541=a9_0x9658bb,_0x540c05=_0x19a6d5[_0x408541(0x12a)]['authorization'],[,_0xc156eb]=_0x540c05[_0x408541(0x146)]('\x20'),_0x2f0b27=await Whatsapp_1['default'][_0x408541(0x1c7)]({'where':{'token':_0xc156eb}}),_0x3d1804=_0x2f0b27[_0x408541(0x131)];try{const _0xe4cf7a=await Ticket_1['default'][_0x408541(0x1f2)]({'where':{'companyId':_0x3d1804},'include':[{'model':Contact_1[_0x408541(0x1d8)],'as':_0x408541(0x189),'attributes':['id',_0x408541(0x1fb),_0x408541(0x182),_0x408541(0x12f),'profilePicUrl',_0x408541(0x1e6),_0x408541(0x199),'disableBot'],'include':[_0x408541(0x1bd)]},{'model':Queue_1[_0x408541(0x1d8)],'as':_0x408541(0x1ac),'attributes':['id',_0x408541(0x1fb),_0x408541(0x1b3)]},{'model':User_1['default'],'as':'user','attributes':['id',_0x408541(0x1fb)]},{'model':Tag_1[_0x408541(0x1d8)],'as':_0x408541(0x196),'attributes':['id','name',_0x408541(0x1b3)]},{'model':Whatsapp_1[_0x408541(0x1d8)],'as':_0x408541(0x181),'attributes':[_0x408541(0x1fb),_0x408541(0x19a),_0x408541(0x1c5)]},{'model':Company_1[_0x408541(0x1d8)],'as':'company','attributes':[_0x408541(0x1fb)]}]});return _0x34b565['status'](0xc8)[_0x408541(0x1df)]({'status':_0x408541(0x132),'tickets':_0xe4cf7a});}catch(_0x21cb02){return console[_0x408541(0x1eb)](_0x21cb02),_0x34b565[_0x408541(0x128)](0x1f4)[_0x408541(0x1df)]({'status':'ERROR','error':_0x408541(0x12c)});}};exports[a9_0x9658bb(0x19e)]=listTicketsByCompany;const listTicketsByTag=async(_0x25f812,_0x1ab086)=>{const _0x4289ca=a9_0x9658bb,{tagId:_0x2bc2ff}=_0x25f812['params'],_0x23ca6b=_0x25f812[_0x4289ca(0x12a)][_0x4289ca(0x1da)],[,_0xa6eb43]=_0x23ca6b['split']('\x20');try{const _0x49242e=await Whatsapp_1['default'][_0x4289ca(0x1c7)]({'where':{'token':_0xa6eb43}}),_0x183d90=_0x49242e[_0x4289ca(0x131)],_0x374947=await Tag_1[_0x4289ca(0x1d8)][_0x4289ca(0x1c7)]({'where':{'id':_0x2bc2ff,'companyId':_0x183d90}});if(!_0x374947)return _0x1ab086[_0x4289ca(0x128)](0x190)[_0x4289ca(0x1df)]({'status':_0x4289ca(0x1b0),'error':'Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company'});const _0x396d7e=await Ticket_1['default']['findAll']({'include':[{'model':Tag_1[_0x4289ca(0x1d8)],'as':_0x4289ca(0x196),'attributes':['id','name'],'through':{'attributes':[],'where':{'tagId':_0x2bc2ff}}},{'model':Contact_1['default'],'as':'contact','attributes':['id',_0x4289ca(0x1fb),_0x4289ca(0x182),'email',_0x4289ca(0x134),'acceptAudioMessage','active','disableBot'],'include':[_0x4289ca(0x1bd)]},{'model':Queue_1[_0x4289ca(0x1d8)],'as':_0x4289ca(0x1ac),'attributes':['id','name',_0x4289ca(0x1b3)]},{'model':User_1[_0x4289ca(0x1d8)],'as':'user','attributes':['id',_0x4289ca(0x1fb)]},{'model':Whatsapp_1['default'],'as':_0x4289ca(0x181),'attributes':[_0x4289ca(0x1fb),'facebookUserToken',_0x4289ca(0x1c5)]},{'model':Company_1['default'],'as':_0x4289ca(0x16b),'attributes':[_0x4289ca(0x1fb)]}],'where':{'companyId':_0x183d90,'$tags.id$':_0x2bc2ff}});return _0x1ab086[_0x4289ca(0x128)](0xc8)[_0x4289ca(0x1df)]({'status':_0x4289ca(0x132),'tickets':_0x396d7e});}catch(_0xf6596c){return console['error'](_0xf6596c),_0x1ab086[_0x4289ca(0x128)](0x1f4)[_0x4289ca(0x1df)]({'status':_0x4289ca(0x1b0),'error':_0x4289ca(0x12c)});}};exports[a9_0x9658bb(0x1ee)]=listTicketsByTag;const listTicketsByTagIsAuth=async(_0x32b10d,_0x2ad831)=>{const _0x194e7c=a9_0x9658bb,{tagId:_0x5642ef}=_0x32b10d[_0x194e7c(0x1a5)];try{const _0x3d8fd=await Ticket_1[_0x194e7c(0x1d8)][_0x194e7c(0x1f2)]({'include':[{'model':Contact_1[_0x194e7c(0x1d8)],'as':_0x194e7c(0x189),'attributes':['name',_0x194e7c(0x182),_0x194e7c(0x12f)],'include':[_0x194e7c(0x1bd)]},{'model':Tag_1[_0x194e7c(0x1d8)],'as':_0x194e7c(0x196),'attributes':['id',_0x194e7c(0x1fb),_0x194e7c(0x1b3)],'where':{'id':_0x5642ef}},{'model':Whatsapp_1[_0x194e7c(0x1d8)],'as':_0x194e7c(0x181),'attributes':[_0x194e7c(0x1fb),_0x194e7c(0x19a),_0x194e7c(0x1c5)]},{'model':Company_1[_0x194e7c(0x1d8)],'as':'company','attributes':[_0x194e7c(0x1fb)]}]});return _0x2ad831['status'](0xc8)[_0x194e7c(0x1df)]({'status':_0x194e7c(0x132),'tickets':_0x3d8fd});}catch(_0x3a7453){return console['error'](_0x3a7453),_0x2ad831[_0x194e7c(0x128)](0x1f4)[_0x194e7c(0x1df)]({'status':_0x194e7c(0x1b0),'error':_0x194e7c(0x12c)});}};exports[a9_0x9658bb(0x1de)]=listTicketsByTagIsAuth;function makeid(_0x134ae8){const _0x1a9c36=a9_0x9658bb;var _0x5e22c3='',_0x1f56d5='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',_0x545fb7=_0x1f56d5['length'];for(var _0x361e8b=0x0;_0x361e8b<_0x134ae8;_0x361e8b++){_0x5e22c3+=_0x1f56d5[_0x1a9c36(0x1f8)](Math['floor'](Math[_0x1a9c36(0x1db)]()*_0x545fb7));}return _0x5e22c3;}exports[a9_0x9658bb(0x1cb)]=makeid;const handleAudioLink=async(_0x5516a3,_0x183eb8)=>{const _0x5ba396=a9_0x9658bb,{link:_0x1c6d0d,contactNumber:_0x4f3cd5}=_0x5516a3[_0x5ba396(0x185)];try{const _0x4f9298=_0x5516a3[_0x5ba396(0x12a)][_0x5ba396(0x1da)],[,_0x33a388]=_0x4f9298['split']('\x20'),_0x24b4ea=await Whatsapp_1[_0x5ba396(0x1d8)]['findOne']({'where':{'token':_0x33a388}}),_0x41fd00=_0x24b4ea[_0x5ba396(0x131)],_0x1028de=await(0x0,GetDefaultWhatsApp_1[_0x5ba396(0x1d8)])(_0x41fd00),_0x5b1882=(0x0,wbot_1['getWbot'])(_0x1028de['id']),_0x272941=_0x5ba396(0x14b)+_0x41fd00+'/'+makeid(0xa)+_0x5ba396(0x1c3);if(!_0x24b4ea)return _0x183eb8['status'](0x191)[_0x5ba396(0x1df)]({'status':_0x5ba396(0x1b4),'error':_0x5ba396(0x135)});const _0x1e0688=await axios_1[_0x5ba396(0x1d8)]['get'](_0x1c6d0d,{'responseType':_0x5ba396(0x13f)});fs_1[_0x5ba396(0x1d8)]['writeFileSync'](_0x272941,Buffer[_0x5ba396(0x158)](_0x1e0688[_0x5ba396(0x15c)]));const _0x30fb1d=_0x5ba396(0x155);return await(0x0,SendPresenceStatus_1['SendPresenceStatus'])(_0x5b1882,_0x4f3cd5),await _0x5b1882['sendMessage'](_0x4f3cd5+_0x5ba396(0x1fa),{'audio':fs_1['default'][_0x5ba396(0x1ef)](_0x272941),'fileName':_0x30fb1d,'caption':_0x30fb1d,'mimetype':_0x5ba396(0x1ca),'ptt':!![]}),_0x183eb8[_0x5ba396(0x128)](0xc8)[_0x5ba396(0x1df)]({'status':_0x5ba396(0x1cd)});}catch(_0x2effed){return console[_0x5ba396(0x1eb)](_0x2effed),_0x183eb8[_0x5ba396(0x128)](0x1f4)['json']({'status':_0x5ba396(0x1b4),'error':_0x5ba396(0x174)});}};exports[a9_0x9658bb(0x1a3)]=handleAudioLink;const indexApi=async(_0x2b84e0,_0x2e2644)=>{const _0x1a7d43=a9_0x9658bb,_0x267273=_0x2b84e0[_0x1a7d43(0x12a)]['authorization'],[,_0x21067b]=_0x267273[_0x1a7d43(0x146)]('\x20'),_0x4362fe=await Whatsapp_1[_0x1a7d43(0x1d8)][_0x1a7d43(0x1c7)]({'where':{'token':_0x21067b}}),_0x3ec132=_0x4362fe[_0x1a7d43(0x131)],{searchParam:_0x340dd2,pageNumber:_0xcadd61}=_0x2b84e0[_0x1a7d43(0x124)];if(_0x3ec132===0x1){const {invoices:_0x1967b3,count:_0x2f1f8f,hasMore:_0x535161}=await(0x0,ListInvoicesServices_1['default'])({'searchParam':_0x340dd2,'pageNumber':_0xcadd61});return _0x2e2644[_0x1a7d43(0x1df)]({'invoices':_0x1967b3,'count':_0x2f1f8f,'hasMore':_0x535161});}else return _0x2e2644[_0x1a7d43(0x128)](0x191)['json']({'status':_0x1a7d43(0x1b4),'error':_0x1a7d43(0x1a9)});};exports[a9_0x9658bb(0x126)]=indexApi;const showApi=async(_0x4799d8,_0x1f88ff)=>{const _0x5be64f=a9_0x9658bb,_0xb524fb=_0x4799d8['headers'][_0x5be64f(0x1da)],[,_0x3623b7]=_0xb524fb['split']('\x20'),_0x5adefc=await Whatsapp_1[_0x5be64f(0x1d8)]['findOne']({'where':{'token':_0x3623b7}}),_0x26d712=_0x5adefc[_0x5be64f(0x131)],{Invoiceid:_0x1b696a}=_0x4799d8['params'],_0x1bd3f9=await(0x0,ShowInvoiceService_1['default'])(_0x1b696a);return _0x1f88ff[_0x5be64f(0x128)](0xc8)[_0x5be64f(0x1df)](_0x1bd3f9);};exports[a9_0x9658bb(0x1e7)]=showApi;const showAllApi=async(_0xd4ea2f,_0xd732df)=>{const _0x24fbf3=a9_0x9658bb;try{const _0x4d9fc2=_0xd4ea2f[_0x24fbf3(0x12a)][_0x24fbf3(0x1da)],[,_0x1d3f34]=_0x4d9fc2[_0x24fbf3(0x146)]('\x20'),_0x3b6e79=await Whatsapp_1[_0x24fbf3(0x1d8)][_0x24fbf3(0x1c7)]({'where':{'token':_0x1d3f34}}),_0xf43b77=_0x3b6e79['companyId'],{companyId:_0x4fb7bf,status:_0x4871f8}=_0xd4ea2f[_0x24fbf3(0x185)];if(_0xf43b77===0x1){const _0x5545d1=await Invoices_1['default']['findAll']({'where':{'companyId':_0x4fb7bf,'status':_0x4871f8}});return _0xd732df['status'](0xc8)[_0x24fbf3(0x1df)](_0x5545d1);}else return _0xd732df[_0x24fbf3(0x128)](0x191)['json']({'status':'ERRO','error':_0x24fbf3(0x1a9)});}catch(_0x5199ce){return console['error']('Erro\x20ao\x20buscar\x20invoices:',_0x5199ce),_0xd732df['status'](0x1f4)['json']({'error':_0x24fbf3(0x188)});}};exports[a9_0x9658bb(0x161)]=showAllApi;const updateApi=async(_0x297b43,_0x48bea6)=>{const _0x398853=a9_0x9658bb,_0x2c72e3=_0x297b43[_0x398853(0x12a)][_0x398853(0x1da)],[,_0x4cc102]=_0x2c72e3['split']('\x20'),_0x15bc80=await Whatsapp_1[_0x398853(0x1d8)][_0x398853(0x1c7)]({'where':{'token':_0x4cc102}}),_0x1cd63f=_0x15bc80['companyId'],_0x5ee244=_0x297b43[_0x398853(0x185)],_0x1e261e=Yup[_0x398853(0x17b)]()[_0x398853(0x1a2)]({'name':Yup['string']()});try{await _0x1e261e[_0x398853(0x163)](_0x5ee244);}catch(_0x1b4422){throw new AppError_1[(_0x398853(0x1d8))](_0x1b4422[_0x398853(0x162)]);}const {id:_0x5414b6,status:_0x3012d4}=_0x5ee244;if(_0x1cd63f===0x1){const _0x407970=await(0x0,UpdateInvoiceService_1['default'])({'id':_0x5414b6,'status':_0x3012d4}),_0x148c05=await Invoices_1[_0x398853(0x1d8)]['findByPk'](_0x5414b6),_0x351a7e=_0x148c05[_0x398853(0x131)],_0x57cc4e=await Company_1['default'][_0x398853(0x1c0)](_0x351a7e),_0x334ed2=new Date(_0x57cc4e[_0x398853(0x1ab)]);_0x334ed2[_0x398853(0x1e3)](_0x334ed2[_0x398853(0x1c1)]()+0x1e);const _0x206fc2=_0x334ed2[_0x398853(0x1d9)]()[_0x398853(0x146)]('T')[0x0];if(_0x57cc4e){await _0x57cc4e[_0x398853(0x19f)]({'dueDate':_0x206fc2});const _0x1820a1=await _0x148c05[_0x398853(0x19f)]({'id':_0x5414b6,'status':_0x398853(0x166)});await _0x57cc4e['reload']();const _0x3ca97f=(0x0,socket_1[_0x398853(0x19b)])(),_0x385e23=await Company_1[_0x398853(0x1d8)][_0x398853(0x1c7)]({'where':{'id':_0x351a7e}});}return _0x48bea6[_0x398853(0x128)](0xc8)[_0x398853(0x1df)](_0x407970);}else return _0x48bea6['status'](0x191)[_0x398853(0x1df)]({'status':_0x398853(0x1b4),'error':_0x398853(0x1a9)});};exports[a9_0x9658bb(0x18c)]=updateApi;const updateUsageStats=async(_0xc18baf,_0xea65da)=>{const _0x208a19=a9_0x9658bb;if(!_0xc18baf[_0x208a19(0x1ba)]||!_0xc18baf[_0x208a19(0x1ba)]['companyId'])return _0xea65da[_0x208a19(0x128)](0x190)['send']({'status':'ERROR','message':_0x208a19(0x12b)});const {companyId:_0x250032}=_0xc18baf[_0x208a19(0x1ba)],{contactId:_0x328577}=_0xc18baf[_0x208a19(0x1a5)];return setTimeout(async()=>{const _0x48020f=_0x208a19,{dateToClient:_0x1d0d18}=(0x0,useDate_1[_0x48020f(0x156)])(),_0x52c387=_0x1d0d18(new Date()[_0x48020f(0x1f7)]()),_0x552499=(0x0,moment_1[_0x48020f(0x1d8)])()[_0x48020f(0x13e)]();try{const _0x71dbd1=await ApiUsages_1[_0x48020f(0x1d8)][_0x48020f(0x1c7)]({'where':{'dateUsed':_0x52c387,'companyId':_0x250032}});if(_0x71dbd1)await _0x71dbd1[_0x48020f(0x19f)]({'usedOther':_0x71dbd1['dataValues'][_0x48020f(0x15e)]+0x1,'UsedOnDay':_0x71dbd1[_0x48020f(0x18e)][_0x48020f(0x1be)]+0x1,'updatedAt':_0x552499});else{const _0x29ed83=await ApiUsages_1[_0x48020f(0x1d8)][_0x48020f(0x184)]({'companyId':_0x250032,'dateUsed':_0x52c387});await _0x29ed83[_0x48020f(0x19f)]({'usedOther':_0x29ed83[_0x48020f(0x18e)][_0x48020f(0x15e)]+0x1,'UsedOnDay':_0x29ed83[_0x48020f(0x18e)][_0x48020f(0x1be)]+0x1,'updatedAt':_0x552499});}}catch(_0x4a4678){return console['error'](_0x48020f(0x1aa),_0x4a4678),_0xea65da[_0x48020f(0x128)](0x1f4)[_0x48020f(0x1c2)]({'status':_0x48020f(0x1b0),'message':_0x48020f(0x1a1)});}},0x64),_0xea65da[_0x208a19(0x1c2)]({'status':_0x208a19(0x132)});};exports[a9_0x9658bb(0x141)]=updateUsageStats;const indexContacts=async(_0x5f4c42,_0x5f130f)=>{const _0x485f00=a9_0x9658bb,{searchParam:_0x4462ec,pageNumber:_0x4a3c9c}=_0x5f4c42[_0x485f00(0x124)],{companyId:_0x4814d9}=_0x5f4c42[_0x485f00(0x1ba)],{contacts:_0x3a16c1,count:_0x426993,hasMore:_0x1b571f}=await(0x0,ListContactsService_1[_0x485f00(0x1d8)])({'searchParam':_0x4462ec,'pageNumber':_0x4a3c9c,'companyId':_0x4814d9});return _0x5f130f['json']({'contacts':_0x3a16c1,'count':_0x426993,'hasMore':_0x1b571f});};exports[a9_0x9658bb(0x14e)]=indexContacts;const listContacts=async(_0x4106df,_0x2d871f)=>{const _0x3c0dc6=a9_0x9658bb,{name:_0x55d419}=_0x4106df[_0x3c0dc6(0x124)],{companyId:_0x5b8223}=_0x4106df[_0x3c0dc6(0x1ba)],_0x3faadc=await(0x0,SimpleListService_1[_0x3c0dc6(0x1d8)])({'name':_0x55d419,'companyId':_0x5b8223});return _0x2d871f[_0x3c0dc6(0x1df)](_0x3faadc);};exports['listContacts']=listContacts;const showContacts=async(_0x526fb7,_0x126afa)=>{const _0x280b73=a9_0x9658bb,{contactId:_0x4e014a}=_0x526fb7['params'],{companyId:_0x58d7ee}=_0x526fb7['user'],_0x1ddb01=await(0x0,ShowContactService_1['default'])(_0x4e014a,_0x58d7ee);return _0x126afa[_0x280b73(0x128)](0xc8)[_0x280b73(0x1df)](_0x1ddb01);};exports['showContacts']=showContacts;const findOrCreateContacts=async(_0x3c8dbf,_0xe919e8)=>{const _0x49880e=a9_0x9658bb,{name:_0x2d5467,number:_0x1caa82}=_0x3c8dbf[_0x49880e(0x185)],{companyId:_0x549d5d}=_0x3c8dbf[_0x49880e(0x1ba)],_0x267b82=await(0x0,GetContactService_1[_0x49880e(0x1d8)])({'name':_0x2d5467,'number':_0x1caa82,'companyId':_0x549d5d});return _0xe919e8[_0x49880e(0x128)](0xc8)[_0x49880e(0x1df)](_0x267b82);};exports[a9_0x9658bb(0x17e)]=findOrCreateContacts;const storeContacts=async(_0x57878d,_0x1b3f3b)=>{const _0x5ea1eb=a9_0x9658bb,{companyId:_0x31cfd6}=_0x57878d[_0x5ea1eb(0x1ba)],_0xb4d7b0=_0x57878d['body'];_0xb4d7b0[_0x5ea1eb(0x182)]=_0xb4d7b0[_0x5ea1eb(0x182)]['replace']('-','')[_0x5ea1eb(0x13c)]('\x20','');const _0x2a23c2=Yup[_0x5ea1eb(0x17b)]()[_0x5ea1eb(0x1a2)]({'name':Yup[_0x5ea1eb(0x154)]()[_0x5ea1eb(0x152)](),'number':Yup['string']()['required']()['matches'](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x2a23c2[_0x5ea1eb(0x163)](_0xb4d7b0);}catch(_0x49ab4b){throw new AppError_1[(_0x5ea1eb(0x1d8))](_0x49ab4b[_0x5ea1eb(0x162)]);}await(0x0,CheckIsValidContact_1[_0x5ea1eb(0x1d8)])(_0xb4d7b0[_0x5ea1eb(0x182)],_0x31cfd6);const _0x3222ee=await(0x0,CheckNumber_1[_0x5ea1eb(0x1d8)])(_0xb4d7b0[_0x5ea1eb(0x182)],_0x31cfd6),_0x228479=_0x3222ee[_0x5ea1eb(0x1bb)]['replace'](/\D/g,'');_0xb4d7b0[_0x5ea1eb(0x182)]=_0x228479;const _0x60f8fa=await(0x0,CreateContactService_1[_0x5ea1eb(0x1d8)])({..._0xb4d7b0,'companyId':_0x31cfd6}),_0x156350=(0x0,socket_1[_0x5ea1eb(0x19b)])();return _0x156350[_0x5ea1eb(0x172)]('company-'+_0x31cfd6+_0x5ea1eb(0x160),{'action':'create','contact':_0x60f8fa}),_0x1b3f3b['status'](0xc8)['json'](_0x60f8fa);};exports[a9_0x9658bb(0x149)]=storeContacts;const removeAllContacts=async(_0x464d30,_0x410eb4)=>{const _0x307253=a9_0x9658bb,{companyId:_0x1ad385}=_0x464d30[_0x307253(0x1ba)];try{await Contact_1[_0x307253(0x1d8)][_0x307253(0x177)]({'where':{'companyId':_0x1ad385}});const _0x419da5=(0x0,socket_1['getIO'])();return _0x419da5[_0x307253(0x172)](_0x307253(0x13a)+_0x1ad385+_0x307253(0x160),{'action':'deleteAll'}),setTimeout(async()=>{const _0x28649c=_0x307253,{dateToClient:_0x457372}=(0x0,useDate_1[_0x28649c(0x156)])(),_0x22252e=_0x457372(new Date()[_0x28649c(0x1f7)]()),_0x2ddf6c=(0x0,moment_1[_0x28649c(0x1d8)])()['format']();try{const _0x3b965e=await ApiUsages_1[_0x28649c(0x1d8)][_0x28649c(0x1c7)]({'where':{'dateUsed':_0x22252e,'companyId':_0x1ad385}});if(_0x3b965e)await _0x3b965e[_0x28649c(0x19f)]({'usedOther':_0x3b965e[_0x28649c(0x18e)]['usedOther']+0x1,'UsedOnDay':_0x3b965e[_0x28649c(0x18e)][_0x28649c(0x1be)]+0x1,'updatedAt':_0x2ddf6c});else{const _0x1fd26f=await ApiUsages_1['default'][_0x28649c(0x184)]({'companyId':_0x1ad385,'dateUsed':_0x22252e});await _0x1fd26f['update']({'usedOther':_0x1fd26f[_0x28649c(0x18e)]['usedOther']+0x1,'UsedOnDay':_0x1fd26f[_0x28649c(0x18e)][_0x28649c(0x1be)]+0x1,'updatedAt':_0x2ddf6c});}}catch(_0x4f32f8){return console[_0x28649c(0x1eb)]('Error\x20updating\x20usage\x20stats:',_0x4f32f8),_0x410eb4[_0x28649c(0x128)](0x1f4)[_0x28649c(0x1c2)]({'status':_0x28649c(0x1b0),'message':_0x28649c(0x1a1)});}},0x64),_0x410eb4['status'](0xc8)['send']({'status':_0x307253(0x132),'message':_0x307253(0x179)});}catch(_0x4122f7){return console[_0x307253(0x1eb)]('Error\x20removing\x20all\x20contacts:',_0x4122f7),_0x410eb4[_0x307253(0x128)](0x1f4)[_0x307253(0x1c2)]({'status':_0x307253(0x1b0),'message':_0x307253(0x1a1)});}};exports['removeAllContacts']=removeAllContacts;const updateContacts=async(_0x3e434a,_0x15152a)=>{const _0x9465c2=a9_0x9658bb,_0xa640f1=_0x3e434a[_0x9465c2(0x185)],{companyId:_0x24fb26}=_0x3e434a[_0x9465c2(0x1ba)],_0x4637a4=Yup[_0x9465c2(0x17b)]()[_0x9465c2(0x1a2)]({'name':Yup[_0x9465c2(0x154)](),'number':Yup['string']()[_0x9465c2(0x1f4)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x4637a4['validate'](_0xa640f1);}catch(_0x3b6754){throw new AppError_1['default'](_0x3b6754[_0x9465c2(0x162)]);}await(0x0,CheckIsValidContact_1[_0x9465c2(0x1d8)])(_0xa640f1['number'],_0x24fb26);const _0x55e79d=await(0x0,CheckNumber_1[_0x9465c2(0x1d8)])(_0xa640f1[_0x9465c2(0x182)],_0x24fb26),_0x53275d=_0x55e79d[_0x9465c2(0x1bb)][_0x9465c2(0x13c)](/\D/g,'');_0xa640f1['number']=_0x53275d;const {contactId:_0x144320}=_0x3e434a[_0x9465c2(0x1a5)],_0x5984dc=await(0x0,UpdateContactService_1[_0x9465c2(0x1d8)])({'contactData':_0xa640f1,'contactId':_0x144320,'companyId':_0x24fb26}),_0x485411=(0x0,socket_1[_0x9465c2(0x19b)])();return _0x485411['emit'](_0x9465c2(0x13a)+_0x24fb26+_0x9465c2(0x160),{'action':_0x9465c2(0x19f),'contact':_0x5984dc}),_0x15152a[_0x9465c2(0x128)](0xc8)['json'](_0x5984dc);};exports[a9_0x9658bb(0x168)]=updateContacts;const removeContacts=async(_0xa855d,_0x2c69e1)=>{const _0x2025e1=a9_0x9658bb,{contactId:_0x1d315b}=_0xa855d[_0x2025e1(0x1a5)],{companyId:_0x1575b1}=_0xa855d[_0x2025e1(0x1ba)];await(0x0,ShowContactService_1[_0x2025e1(0x1d8)])(_0x1d315b,_0x1575b1),await(0x0,DeleteContactService_1['default'])(_0x1d315b);const _0x274b25=(0x0,socket_1[_0x2025e1(0x19b)])();return _0x274b25['emit'](_0x2025e1(0x13a)+_0x1575b1+'-contact',{'action':_0x2025e1(0x194),'contactId':_0x1d315b}),_0x2c69e1[_0x2025e1(0x128)](0xc8)['json']({'message':_0x2025e1(0x1e0)});};exports[a9_0x9658bb(0x1ce)]=removeContacts;const uploadContacts=async(_0x525946,_0x5379d4)=>{const _0x3bab5e=a9_0x9658bb,_0x5ebced=_0x525946['files'],_0x4766da=(0x0,lodash_1[_0x3bab5e(0x18b)])(_0x5ebced),{companyId:_0x124417}=_0x525946[_0x3bab5e(0x1ba)],_0x1fa916=await(0x0,ImportXLSContactsService_1['ImportXLSContactsService'])(_0x124417,_0x4766da),_0x432b8a=(0x0,socket_1[_0x3bab5e(0x19b)])(),_0x12e4c0={'action':'reload','records':_0x1fa916};return _0x432b8a['to'](_0x3bab5e(0x13a)+_0x124417+_0x3bab5e(0x18d))[_0x3bab5e(0x172)](_0x3bab5e(0x13a)+_0x124417+_0x3bab5e(0x160),_0x12e4c0),_0x5379d4[_0x3bab5e(0x128)](0xc8)['json'](_0x1fa916);};exports['uploadContacts']=uploadContacts;const toggleDisableBotContacts=async(_0xe66066,_0x42116d)=>{const _0x121ea7=a9_0x9658bb,{contactId:_0x29afc8}=_0xe66066['params'],{companyId:_0x5b8c27}=_0xe66066['user'],_0x17f548=await(0x0,ToggleDisableBotService_1[_0x121ea7(0x1d8)])(_0x29afc8,_0x5b8c27),_0x3ccbd6=(0x0,socket_1['getIO'])();return _0x3ccbd6[_0x121ea7(0x172)](_0x121ea7(0x13a)+_0x5b8c27+_0x121ea7(0x160),{'action':'update','contact':_0x17f548}),_0x42116d[_0x121ea7(0x128)](0xc8)[_0x121ea7(0x1df)](_0x17f548);};exports['toggleDisableBotContacts']=toggleDisableBotContacts;