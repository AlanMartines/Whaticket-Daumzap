const a9_0x1b523e=a9_0x1bb0;(function(_0x27e886,_0x433903){const _0x12d964=a9_0x1bb0,_0x44b93d=_0x27e886();while(!![]){try{const _0x3c9486=-parseInt(_0x12d964(0xbf))/0x1*(parseInt(_0x12d964(0x105))/0x2)+parseInt(_0x12d964(0x12c))/0x3*(-parseInt(_0x12d964(0xf3))/0x4)+parseInt(_0x12d964(0x10e))/0x5*(parseInt(_0x12d964(0x15d))/0x6)+parseInt(_0x12d964(0x115))/0x7*(-parseInt(_0x12d964(0xe6))/0x8)+parseInt(_0x12d964(0x108))/0x9*(-parseInt(_0x12d964(0x17b))/0xa)+parseInt(_0x12d964(0x11d))/0xb*(-parseInt(_0x12d964(0x127))/0xc)+parseInt(_0x12d964(0x11c))/0xd;if(_0x3c9486===_0x433903)break;else _0x44b93d['push'](_0x44b93d['shift']());}catch(_0x2daeb2){_0x44b93d['push'](_0x44b93d['shift']());}}}(a9_0x4d7b,0x760d9));const a9_0x48f071=(function(){let _0x3d1c32=!![];return function(_0x26a34d,_0x19cb1a){const _0x218d4a=_0x3d1c32?function(){const _0x39ce21=a9_0x1bb0;if(_0x19cb1a){const _0x64d917=_0x19cb1a[_0x39ce21(0xf1)](_0x26a34d,arguments);return _0x19cb1a=null,_0x64d917;}}:function(){};return _0x3d1c32=![],_0x218d4a;};}()),a9_0x29a921=a9_0x48f071(this,function(){const _0x428102=a9_0x1bb0;return a9_0x29a921[_0x428102(0xcc)]()[_0x428102(0x152)](_0x428102(0x12a))[_0x428102(0xcc)]()[_0x428102(0x12f)](a9_0x29a921)[_0x428102(0x152)](_0x428102(0x12a));});a9_0x29a921();'use strict';var __createBinding=this&&this[a9_0x1b523e(0x12b)]||(Object[a9_0x1b523e(0x142)]?function(_0x44978e,_0x4369d7,_0x87cbf7,_0x5876a3){const _0x1b895f=a9_0x1b523e;if(_0x5876a3===undefined)_0x5876a3=_0x87cbf7;var _0x300841=Object[_0x1b895f(0x171)](_0x4369d7,_0x87cbf7);(!_0x300841||(_0x1b895f(0x103)in _0x300841?!_0x4369d7[_0x1b895f(0x144)]:_0x300841[_0x1b895f(0xc5)]||_0x300841['configurable']))&&(_0x300841={'enumerable':!![],'get':function(){return _0x4369d7[_0x87cbf7];}}),Object[_0x1b895f(0xf2)](_0x44978e,_0x5876a3,_0x300841);}:function(_0x1bab66,_0x5ca72e,_0x440cd8,_0x10e741){if(_0x10e741===undefined)_0x10e741=_0x440cd8;_0x1bab66[_0x10e741]=_0x5ca72e[_0x440cd8];}),__setModuleDefault=this&&this[a9_0x1b523e(0x160)]||(Object[a9_0x1b523e(0x142)]?function(_0x2322bc,_0x140f0f){const _0x2ef384=a9_0x1b523e;Object[_0x2ef384(0xf2)](_0x2322bc,_0x2ef384(0xea),{'enumerable':!![],'value':_0x140f0f});}:function(_0xc0244a,_0x54ab2a){const _0x360ba4=a9_0x1b523e;_0xc0244a[_0x360ba4(0xea)]=_0x54ab2a;}),__importStar=this&&this[a9_0x1b523e(0x111)]||function(_0x2fa4ad){const _0xfd1428=a9_0x1b523e;if(_0x2fa4ad&&_0x2fa4ad[_0xfd1428(0x144)])return _0x2fa4ad;var _0x477c8a={};if(_0x2fa4ad!=null){for(var _0x5af01a in _0x2fa4ad)if(_0x5af01a!==_0xfd1428(0xea)&&Object[_0xfd1428(0x13c)][_0xfd1428(0x153)][_0xfd1428(0xb7)](_0x2fa4ad,_0x5af01a))__createBinding(_0x477c8a,_0x2fa4ad,_0x5af01a);}return __setModuleDefault(_0x477c8a,_0x2fa4ad),_0x477c8a;},__importDefault=this&&this[a9_0x1b523e(0x167)]||function(_0x48228f){const _0x4ca0ed=a9_0x1b523e;return _0x48228f&&_0x48228f[_0x4ca0ed(0x144)]?_0x48228f:{'default':_0x48228f};};Object[a9_0x1b523e(0xf2)](exports,a9_0x1b523e(0x144),{'value':!![]}),exports[a9_0x1b523e(0xc0)]=exports[a9_0x1b523e(0xe5)]=exports[a9_0x1b523e(0x182)]=exports['updateContacts']=exports[a9_0x1b523e(0xdc)]=exports[a9_0x1b523e(0x148)]=exports[a9_0x1b523e(0xf9)]=exports[a9_0x1b523e(0xe8)]=exports[a9_0x1b523e(0x162)]=exports[a9_0x1b523e(0x181)]=exports['updateUsageStats']=exports[a9_0x1b523e(0x183)]=exports[a9_0x1b523e(0x104)]=exports[a9_0x1b523e(0xfd)]=exports[a9_0x1b523e(0x157)]=exports[a9_0x1b523e(0x102)]=exports['makeid']=exports[a9_0x1b523e(0x165)]=exports[a9_0x1b523e(0x123)]=exports[a9_0x1b523e(0x149)]=exports[a9_0x1b523e(0x119)]=exports[a9_0x1b523e(0x107)]=exports[a9_0x1b523e(0x143)]=exports[a9_0x1b523e(0xb4)]=exports[a9_0x1b523e(0xb8)]=exports[a9_0x1b523e(0xc6)]=exports['indexImage']=exports['index']=exports[a9_0x1b523e(0x133)]=exports['blockCompany']=exports[a9_0x1b523e(0xca)]=exports[a9_0x1b523e(0x158)]=exports[a9_0x1b523e(0x164)]=void 0x0;const axios_1=__importDefault(require(a9_0x1b523e(0xeb))),fs_1=__importDefault(require('fs')),Yup=__importStar(require(a9_0x1b523e(0x16c))),lodash_1=require('lodash'),GetDefaultWhatsApp_1=__importDefault(require('../helpers/GetDefaultWhatsApp')),SetTicketMessagesAsRead_1=__importDefault(require(a9_0x1b523e(0x16a))),socket_1=require(a9_0x1b523e(0xec)),Whatsapp_1=__importDefault(require(a9_0x1b523e(0xb3))),Queue_1=__importDefault(require('../models/Queue')),User_1=__importDefault(require('../models/User')),CreateOrUpdateContactService_1=__importDefault(require(a9_0x1b523e(0x112))),FindOrCreateTicketService_1=__importDefault(require(a9_0x1b523e(0x170))),ShowTicketService_1=__importDefault(require(a9_0x1b523e(0xf0))),GetProfilePicUrl_1=__importDefault(require(a9_0x1b523e(0xee))),SendWhatsAppMedia_1=__importDefault(require(a9_0x1b523e(0x139))),UpdateTicketService_1=__importDefault(require(a9_0x1b523e(0x16f))),wbot_1=require(a9_0x1b523e(0x15c)),SendWhatsAppMessageLink_1=__importDefault(require(a9_0x1b523e(0xbb))),SendWhatsAppMessageAPI_1=__importDefault(require(a9_0x1b523e(0x13a))),SendWhatsappMediaImage_1=__importDefault(require('../services/WbotServices/SendWhatsappMediaImage')),ListInvoicesServices_1=__importDefault(require(a9_0x1b523e(0x121))),ShowInvoiceService_1=__importDefault(require(a9_0x1b523e(0xb6))),UpdateInvoiceService_1=__importDefault(require('../services/InvoicesService/UpdateInvoiceService')),Invoices_1=__importDefault(require(a9_0x1b523e(0xf4))),ListContactsService_1=__importDefault(require(a9_0x1b523e(0x12d))),CreateContactService_1=__importDefault(require('../services/ContactServices/CreateContactService')),ShowContactService_1=__importDefault(require(a9_0x1b523e(0x15a))),UpdateContactService_1=__importDefault(require(a9_0x1b523e(0xba))),DeleteContactService_1=__importDefault(require('../services/ContactServices/DeleteContactService')),GetContactService_1=__importDefault(require('../services/ContactServices/GetContactService')),ToggleDisableBotService_1=__importDefault(require(a9_0x1b523e(0x116))),CheckNumber_1=__importDefault(require(a9_0x1b523e(0xfb))),CheckIsValidContact_1=__importDefault(require('../services/WbotServices/CheckIsValidContact')),AppError_1=__importDefault(require(a9_0x1b523e(0x177))),SimpleListService_1=__importDefault(require(a9_0x1b523e(0xc3))),ImportXLSContactsService_1=require('../services/ContactServices/ImportXLSContactsService'),ApiUsages_1=__importDefault(require(a9_0x1b523e(0x166))),useDate_1=require(a9_0x1b523e(0x11b)),TicketTag_1=__importDefault(require('../models/TicketTag')),Tag_1=__importDefault(require(a9_0x1b523e(0x16d))),moment_1=__importDefault(require(a9_0x1b523e(0x175))),path_1=__importDefault(require('path')),Ticket_1=__importDefault(require(a9_0x1b523e(0xd8))),Contact_1=__importDefault(require(a9_0x1b523e(0x128))),Company_1=__importDefault(require(a9_0x1b523e(0xc4))),SendPresenceStatus_1=require('../helpers/SendPresenceStatus');class OnWhatsAppDto{constructor(_0x29acbb,_0x23d7b2){const _0x55c124=a9_0x1b523e;this[_0x55c124(0x114)]=_0x29acbb,this[_0x55c124(0x134)]=_0x23d7b2;}}exports['OnWhatsAppDto']=OnWhatsAppDto;const CompanySchema=Yup[a9_0x1b523e(0x161)]()['shape']({'name':Yup[a9_0x1b523e(0xc8)]()['required'](),'id':Yup[a9_0x1b523e(0xda)](),'phone':Yup['string']()[a9_0x1b523e(0x113)](),'email':Yup[a9_0x1b523e(0xc8)]()['email']()['nullable'](),'status':Yup[a9_0x1b523e(0x135)]()['nullable'](),'planId':Yup['number']()[a9_0x1b523e(0x113)](),'campaignsEnabled':Yup['boolean']()[a9_0x1b523e(0x113)](),'dueDate':Yup[a9_0x1b523e(0x17c)]()[a9_0x1b523e(0x113)](),'recurrence':Yup[a9_0x1b523e(0xc8)]()[a9_0x1b523e(0x113)]()}),createCompany=async(_0x2dcb49,_0x26f5df)=>{const _0x55b019=a9_0x1b523e;try{await CompanySchema[_0x55b019(0x117)](_0x2dcb49['body']);const _0x5aebda=await Company_1[_0x55b019(0xea)]['create'](_0x2dcb49[_0x55b019(0xe9)]);_0x26f5df['status'](0xc9)['json'](_0x5aebda);}catch(_0x5e8e72){_0x26f5df['status'](0x190)[_0x55b019(0x17f)]({'error':_0x5e8e72[_0x55b019(0x168)]});}};exports[a9_0x1b523e(0x158)]=createCompany;const updateCompany=async(_0x13871c,_0x24c19e)=>{const _0x12b26a=a9_0x1b523e;try{await CompanySchema[_0x12b26a(0x117)](_0x13871c['body']);const {id:_0x11eaa6}=_0x13871c['params'],[_0x35e22f]=await Company_1[_0x12b26a(0xea)][_0x12b26a(0x14c)](_0x13871c['body'],{'where':{'id':_0x11eaa6}});if(_0x35e22f){const _0x1e7bff=await Company_1[_0x12b26a(0xea)][_0x12b26a(0x14a)](_0x11eaa6);_0x24c19e['status'](0xc8)['json'](_0x1e7bff);}else _0x24c19e[_0x12b26a(0x140)](0x194)[_0x12b26a(0x17f)]({'error':_0x12b26a(0x17e)});}catch(_0x31e54b){_0x24c19e['status'](0x190)['json']({'error':_0x31e54b[_0x12b26a(0x168)]});}};exports['updateCompany']=updateCompany;const blockCompany=async(_0x33c98c,_0x537161)=>{const _0x38b10b=a9_0x1b523e;try{const {id:_0xbabbbf}=_0x33c98c['params'],[_0x26fb7b]=await Company_1[_0x38b10b(0xea)][_0x38b10b(0x14c)]({'status':![]},{'where':{'id':_0xbabbbf}});if(_0x26fb7b){const _0x358736=await Company_1[_0x38b10b(0xea)][_0x38b10b(0x14a)](_0xbabbbf);_0x537161[_0x38b10b(0x140)](0xc8)[_0x38b10b(0x17f)](_0x358736);}else _0x537161['status'](0x194)[_0x38b10b(0x17f)]({'error':_0x38b10b(0x17e)});}catch(_0x33bbcf){_0x537161['status'](0x190)['json']({'error':_0x33bbcf[_0x38b10b(0x168)]});}};exports['blockCompany']=blockCompany;const createContact=async(_0xa7d76c,_0x479bc3,_0x596c00)=>{const _0x427b8e=a9_0x1b523e;await(0x0,CheckIsValidContact_1[_0x427b8e(0xea)])(_0x596c00,_0x479bc3);const _0x52b7cf=await(0x0,CheckNumber_1[_0x427b8e(0xea)])(_0x596c00,_0x479bc3),_0x2059da=await(0x0,GetProfilePicUrl_1[_0x427b8e(0xea)])(_0x52b7cf,_0x479bc3),_0x2e056b=_0x52b7cf,_0x465443={'name':''+_0x2e056b,'number':_0x2e056b,'profilePicUrl':_0x2059da,'isGroup':![],'companyId':_0x479bc3},_0xe50ccc=await(0x0,CreateOrUpdateContactService_1[_0x427b8e(0xea)])(_0x465443,null,null);let _0x92d3d2;if(_0xa7d76c===undefined)_0x92d3d2=await(0x0,GetDefaultWhatsApp_1[_0x427b8e(0xea)])(_0x479bc3);else{_0x92d3d2=await Whatsapp_1[_0x427b8e(0xea)][_0x427b8e(0x14a)](_0xa7d76c);if(_0x92d3d2===null)throw new AppError_1['default'](_0x427b8e(0xb9)+_0xa7d76c+_0x427b8e(0x136));}const _0x17b77e=await(0x0,FindOrCreateTicketService_1['default'])(_0xe50ccc,_0x92d3d2['id'],0x0,_0x479bc3),_0x8db174=await(0x0,ShowTicketService_1['default'])(_0x17b77e['id'],_0x479bc3);return(0x0,SetTicketMessagesAsRead_1['default'])(_0x8db174),_0x8db174;};function formatBRNumber(_0x20c6e5){const _0x3c1496=a9_0x1b523e,_0x259bdd=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x259bdd['test'](_0x20c6e5)){const _0x5c93ea=_0x259bdd[_0x3c1496(0x106)](_0x20c6e5);if(_0x5c93ea&&_0x5c93ea[0x1]==='55'&&Number[_0x3c1496(0xe2)](Number[_0x3c1496(0xef)](_0x5c93ea[0x2]))){const _0x583485=Number[_0x3c1496(0xef)](_0x5c93ea[0x2]);if(_0x583485<0x1f)return _0x5c93ea[0x0];else{if(_0x583485>=0x1f)return _0x5c93ea[0x1]+_0x5c93ea[0x2]+_0x5c93ea[0x3];}}}else return _0x20c6e5;}function createJid(_0x5cb451){const _0x454a53=a9_0x1b523e;if(_0x5cb451[_0x454a53(0x11e)]('@g.us')||_0x5cb451[_0x454a53(0x11e)](_0x454a53(0xbe)))return formatBRNumber(_0x5cb451);return _0x5cb451[_0x454a53(0x11e)]('-')?_0x5cb451+'@g.us':formatBRNumber(_0x5cb451)+_0x454a53(0xbe);}const indexLink=async(_0x1b621b,_0x39fea2)=>{const _0xb355c2=a9_0x1b523e,_0x111d4c=_0x1b621b[_0xb355c2(0xe9)],{whatsappId:_0x54b36f}=_0x1b621b[_0xb355c2(0xe9)],{msdelay:_0x976977}=_0x1b621b['body'],_0x4c9d5a=_0x1b621b[_0xb355c2(0xe9)][_0xb355c2(0x184)],_0x114c86=_0x1b621b[_0xb355c2(0xe9)]['caption'],_0xbb0832=_0x1b621b[_0xb355c2(0xfa)]['authorization'],[,_0x20c78e]=_0xbb0832[_0xb355c2(0xc7)]('\x20'),_0x28f1e6=await Whatsapp_1[_0xb355c2(0xea)][_0xb355c2(0x118)]({'where':{'token':_0x20c78e}}),_0xc44aa5=_0x28f1e6[_0xb355c2(0x141)];_0x111d4c[_0xb355c2(0xda)]=_0x111d4c[_0xb355c2(0xda)][_0xb355c2(0xd2)]('-','')['replace']('\x20','');const _0x5e0bf5=Yup[_0xb355c2(0x161)]()[_0xb355c2(0xc9)]({'number':Yup[_0xb355c2(0xc8)]()['required']()['matches'](/^\d+$/,_0xb355c2(0xcf))});try{await _0x5e0bf5[_0xb355c2(0x117)](_0x111d4c);}catch(_0x336e79){throw new AppError_1[(_0xb355c2(0xea))](_0x336e79[_0xb355c2(0x168)]);}const _0x4bc381=await createContact(_0x54b36f,_0xc44aa5,_0x111d4c[_0xb355c2(0xda)]);return await(0x0,SendWhatsAppMessageLink_1[_0xb355c2(0xea)])({'ticket':_0x4bc381,'url':_0x4c9d5a,'caption':_0x114c86,'msdelay':_0x976977}),setTimeout(async()=>{const _0x2caaa7=_0xb355c2;await(0x0,UpdateTicketService_1[_0x2caaa7(0xea)])({'ticketId':_0x4bc381['id'],'ticketData':{'status':_0x2caaa7(0x122),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0xc44aa5});},0xc8),setTimeout(async()=>{const _0x3215f9=_0xb355c2,{dateToClient:_0x1833a3}=(0x0,useDate_1['useDate'])(),_0x39b003=_0x1833a3(new Date()['toString']()),_0x22a01e=(0x0,moment_1['default'])()[_0x3215f9(0xb5)](),_0x372058=await ApiUsages_1[_0x3215f9(0xea)][_0x3215f9(0x118)]({'where':{'dateUsed':_0x39b003,'companyId':_0xc44aa5}});if(_0x372058)await _0x372058[_0x3215f9(0x14c)]({'usedPDF':_0x372058[_0x3215f9(0x12e)][_0x3215f9(0x145)]+0x1,'UsedOnDay':_0x372058[_0x3215f9(0x12e)]['UsedOnDay']+0x1,'updatedAt':_0x22a01e});else{const _0x5a3c90=await ApiUsages_1[_0x3215f9(0xea)][_0x3215f9(0x142)]({'companyId':_0xc44aa5,'dateUsed':_0x39b003});await _0x5a3c90[_0x3215f9(0x14c)]({'usedPDF':_0x5a3c90[_0x3215f9(0x12e)][_0x3215f9(0x145)]+0x1,'UsedOnDay':_0x5a3c90['dataValues'][_0x3215f9(0x10d)]+0x1,'updatedAt':_0x22a01e});}},0x64),_0x39fea2['send']({'status':'SUCCESS'});};exports['indexLink']=indexLink;const index=async(_0x1e5fa7,_0x3d1ed6)=>{const _0x48e671=a9_0x1b523e,_0x454f60=_0x1e5fa7[_0x48e671(0xe9)],{whatsappId:_0x461398}=_0x1e5fa7[_0x48e671(0xe9)],{msdelay:_0x5d43cd}=_0x1e5fa7[_0x48e671(0xe9)],{body:_0x432e95,quotedMsg:_0x5ce421}=_0x1e5fa7[_0x48e671(0xe9)],_0x3e855=_0x1e5fa7[_0x48e671(0x147)],_0x44ec08=_0x1e5fa7[_0x48e671(0xfa)]['authorization'],[,_0x43ba59]=_0x44ec08[_0x48e671(0xc7)]('\x20'),_0x217743=await Whatsapp_1[_0x48e671(0xea)][_0x48e671(0x118)]({'where':{'token':_0x43ba59}}),_0x4c550a=_0x217743[_0x48e671(0x141)];_0x454f60[_0x48e671(0xda)]=_0x454f60[_0x48e671(0xda)][_0x48e671(0xd2)]('-','')[_0x48e671(0xd2)]('\x20','');const _0x1546d8=Yup[_0x48e671(0x161)]()[_0x48e671(0xc9)]({'number':Yup[_0x48e671(0xc8)]()[_0x48e671(0x137)]()[_0x48e671(0x13d)](/^\d+$/,_0x48e671(0xcf))});try{await _0x1546d8[_0x48e671(0x117)](_0x454f60);}catch(_0x13a7fb){throw new AppError_1[(_0x48e671(0xea))](_0x13a7fb[_0x48e671(0x168)]);}const _0xe7bee7=await createContact(_0x461398,_0x4c550a,_0x454f60[_0x48e671(0xda)]);return _0x3e855?await Promise[_0x48e671(0x14d)](_0x3e855['map'](async _0x222c54=>{const _0x566530=_0x48e671;await(0x0,SendWhatsAppMedia_1[_0x566530(0xea)])({'body':_0x432e95,'media':_0x222c54,'ticket':_0xe7bee7});})):await(0x0,SendWhatsAppMessageAPI_1['default'])({'body':_0x432e95,'ticket':_0xe7bee7,'quotedMsg':_0x5ce421,'msdelay':_0x5d43cd}),setTimeout(async()=>{await(0x0,UpdateTicketService_1['default'])({'ticketId':_0xe7bee7['id'],'ticketData':{'status':'pending','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x4c550a});},0x64),setTimeout(async()=>{const _0x550874=_0x48e671,{dateToClient:_0x5b96e7}=(0x0,useDate_1[_0x550874(0x11a)])(),_0x3d0ff2=_0x5b96e7(new Date()[_0x550874(0xcc)]()),_0x4db9c1=(0x0,moment_1['default'])()[_0x550874(0xb5)](),_0x2766c4=await ApiUsages_1[_0x550874(0xea)]['findOne']({'where':{'dateUsed':_0x3d0ff2,'companyId':_0x4c550a}});_0x2766c4?_0x3e855?await Promise[_0x550874(0x14d)](_0x3e855[_0x550874(0x13b)](async _0x3ced41=>{const _0x1d9e06=_0x550874;console[_0x1d9e06(0x124)](_0x1d9e06(0x146),_0x3ced41);const _0x478aa5=path_1[_0x1d9e06(0xea)]['extname'](_0x3ced41[_0x1d9e06(0xdb)]);console['log'](_0x1d9e06(0x15e),_0x478aa5);if(_0x3ced41['mimetype'][_0x1d9e06(0x11e)](_0x1d9e06(0x151)))await _0x2766c4[_0x1d9e06(0x14c)]({'usedPDF':_0x2766c4[_0x1d9e06(0x12e)][_0x1d9e06(0x145)]+0x1,'UsedOnDay':_0x2766c4[_0x1d9e06(0x12e)]['UsedOnDay']+0x1,'updatedAt':_0x4db9c1});else{if(_0x3ced41[_0x1d9e06(0xf6)][_0x1d9e06(0x11e)](_0x1d9e06(0xe0)))await _0x2766c4[_0x1d9e06(0x14c)]({'usedImage':_0x2766c4[_0x1d9e06(0x12e)][_0x1d9e06(0xd3)]+0x1,'UsedOnDay':_0x2766c4[_0x1d9e06(0x12e)][_0x1d9e06(0x10d)]+0x1,'updatedAt':_0x4db9c1});else _0x3ced41[_0x1d9e06(0xf6)][_0x1d9e06(0x11e)](_0x1d9e06(0x10c))?await _0x2766c4[_0x1d9e06(0x14c)]({'usedVideo':_0x2766c4[_0x1d9e06(0x12e)]['usedVideo']+0x1,'UsedOnDay':_0x2766c4[_0x1d9e06(0x12e)][_0x1d9e06(0x10d)]+0x1,'updatedAt':_0x4db9c1}):await _0x2766c4[_0x1d9e06(0x14c)]({'usedOther':_0x2766c4[_0x1d9e06(0x12e)][_0x1d9e06(0x15f)]+0x1,'UsedOnDay':_0x2766c4['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x4db9c1});}})):await _0x2766c4[_0x550874(0x14c)]({'usedText':_0x2766c4[_0x550874(0x12e)]['usedText']+0x1,'UsedOnDay':_0x2766c4[_0x550874(0x12e)][_0x550874(0x10d)]+0x1,'updatedAt':_0x4db9c1}):(await ApiUsages_1[_0x550874(0xea)][_0x550874(0x142)]({'companyId':_0x4c550a,'dateUsed':_0x3d0ff2}),_0x3e855?await Promise[_0x550874(0x14d)](_0x3e855[_0x550874(0x13b)](async _0xce77c3=>{const _0x48bdeb=_0x550874;console[_0x48bdeb(0x124)](_0x48bdeb(0x146),_0xce77c3);const _0x287826=path_1[_0x48bdeb(0xea)]['extname'](_0xce77c3['originalname']);console['log'](_0x48bdeb(0x15e),_0x287826);if(_0xce77c3[_0x48bdeb(0xf6)][_0x48bdeb(0x11e)](_0x48bdeb(0x151)))await _0x2766c4[_0x48bdeb(0x14c)]({'usedPDF':_0x2766c4[_0x48bdeb(0x12e)][_0x48bdeb(0x145)]+0x1,'UsedOnDay':_0x2766c4[_0x48bdeb(0x12e)][_0x48bdeb(0x10d)]+0x1,'updatedAt':_0x4db9c1});else{if(_0xce77c3['mimetype'][_0x48bdeb(0x11e)](_0x48bdeb(0xe0)))await _0x2766c4['update']({'usedImage':_0x2766c4[_0x48bdeb(0x12e)][_0x48bdeb(0xd3)]+0x1,'UsedOnDay':_0x2766c4['dataValues'][_0x48bdeb(0x10d)]+0x1,'updatedAt':_0x4db9c1});else _0xce77c3[_0x48bdeb(0xf6)][_0x48bdeb(0x11e)](_0x48bdeb(0x10c))?await _0x2766c4['update']({'usedVideo':_0x2766c4[_0x48bdeb(0x12e)]['usedVideo']+0x1,'UsedOnDay':_0x2766c4[_0x48bdeb(0x12e)][_0x48bdeb(0x10d)]+0x1,'updatedAt':_0x4db9c1}):await _0x2766c4[_0x48bdeb(0x14c)]({'usedOther':_0x2766c4[_0x48bdeb(0x12e)][_0x48bdeb(0x15f)]+0x1,'UsedOnDay':_0x2766c4['dataValues'][_0x48bdeb(0x10d)]+0x1,'updatedAt':_0x4db9c1});}})):await _0x2766c4[_0x550874(0x14c)]({'usedText':_0x2766c4[_0x550874(0x12e)]['usedText']+0x1,'UsedOnDay':_0x2766c4[_0x550874(0x12e)][_0x550874(0x10d)]+0x1,'updatedAt':_0x4db9c1}));},0x64),_0x3d1ed6[_0x48e671(0x154)]({'status':'SUCCESS'});};exports['index']=index;const indexImage=async(_0x2c3ed8,_0x853445)=>{const _0x571dcb=a9_0x1b523e,_0x107167=_0x2c3ed8['body'],{whatsappId:_0x14e7c0}=_0x2c3ed8[_0x571dcb(0xe9)],{msdelay:_0x9d9d91}=_0x2c3ed8[_0x571dcb(0xe9)],_0x4f7ad3=_0x2c3ed8['body'][_0x571dcb(0x184)],_0x1f081e=_0x2c3ed8[_0x571dcb(0xe9)][_0x571dcb(0xed)],_0x19700d=_0x2c3ed8['headers'][_0x571dcb(0xff)],[,_0x1627de]=_0x19700d[_0x571dcb(0xc7)]('\x20'),_0x3343b7=await Whatsapp_1[_0x571dcb(0xea)][_0x571dcb(0x118)]({'where':{'token':_0x1627de}}),_0x3a205b=_0x3343b7[_0x571dcb(0x141)];_0x107167[_0x571dcb(0xda)]=_0x107167[_0x571dcb(0xda)][_0x571dcb(0xd2)]('-','')['replace']('\x20','');const _0x2fcd61=Yup['object']()[_0x571dcb(0xc9)]({'number':Yup[_0x571dcb(0xc8)]()[_0x571dcb(0x137)]()[_0x571dcb(0x13d)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x2fcd61[_0x571dcb(0x117)](_0x107167);}catch(_0x304274){throw new AppError_1[(_0x571dcb(0xea))](_0x304274[_0x571dcb(0x168)]);}const _0x1dba17=await createContact(_0x14e7c0,_0x3a205b,_0x107167[_0x571dcb(0xda)]);return _0x4f7ad3&&await(0x0,SendWhatsappMediaImage_1[_0x571dcb(0xea)])({'ticket':_0x1dba17,'url':_0x4f7ad3,'caption':_0x1f081e,'msdelay':_0x9d9d91}),setTimeout(async()=>{const _0x27bea3=_0x571dcb;await(0x0,UpdateTicketService_1[_0x27bea3(0xea)])({'ticketId':_0x1dba17['id'],'ticketData':{'status':_0x27bea3(0x122),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x3a205b});},0x64),setTimeout(async()=>{const _0x1cf17f=_0x571dcb,{dateToClient:_0x1eb2c4}=(0x0,useDate_1[_0x1cf17f(0x11a)])(),_0x51d1c4=_0x1eb2c4(new Date()[_0x1cf17f(0xcc)]()),_0x4e8575=(0x0,moment_1[_0x1cf17f(0xea)])()[_0x1cf17f(0xb5)](),_0x318b46=await ApiUsages_1['default'][_0x1cf17f(0x118)]({'where':{'dateUsed':_0x51d1c4,'companyId':_0x3a205b}});if(_0x318b46)await _0x318b46[_0x1cf17f(0x14c)]({'usedImage':_0x318b46[_0x1cf17f(0x12e)]['usedImage']+0x1,'UsedOnDay':_0x318b46[_0x1cf17f(0x12e)][_0x1cf17f(0x10d)]+0x1,'updatedAt':_0x4e8575});else{const _0x29f3f5=await ApiUsages_1[_0x1cf17f(0xea)]['create']({'companyId':_0x3a205b,'dateUsed':_0x51d1c4});await _0x29f3f5['update']({'usedImage':_0x29f3f5[_0x1cf17f(0x12e)][_0x1cf17f(0xd3)]+0x1,'UsedOnDay':_0x29f3f5[_0x1cf17f(0x12e)][_0x1cf17f(0x10d)]+0x1,'updatedAt':_0x4e8575});}},0x64),_0x853445['send']({'status':_0x571dcb(0xe3)});};exports[a9_0x1b523e(0xbd)]=indexImage;const checkNumber=async(_0x5bb285,_0x5a835f)=>{const _0x572be9=a9_0x1b523e,_0x1c3d02=_0x5bb285[_0x572be9(0xe9)],_0x4f3bf4=_0x5bb285[_0x572be9(0xfa)][_0x572be9(0xff)],[,_0x4f0495]=_0x4f3bf4[_0x572be9(0xc7)]('\x20'),_0x49f992=await Whatsapp_1[_0x572be9(0xea)][_0x572be9(0x118)]({'where':{'token':_0x4f0495}}),_0x103732=_0x49f992[_0x572be9(0x141)],_0x2b27ba=_0x1c3d02['number'][_0x572be9(0xd2)]('-','')[_0x572be9(0xd2)]('\x20',''),_0xca63cd=await(0x0,GetDefaultWhatsApp_1[_0x572be9(0xea)])(_0x103732),_0x4625e7=(0x0,wbot_1[_0x572be9(0x125)])(_0xca63cd['id']),_0x333d96=createJid(_0x2b27ba);try{const [_0x5c687e]=await _0x4625e7['onWhatsApp'](_0x333d96);if(_0x5c687e[_0x572be9(0x134)])return setTimeout(async()=>{const _0x4cd90e=_0x572be9,{dateToClient:_0x2923da}=(0x0,useDate_1['useDate'])(),_0x100c47=_0x2923da(new Date()['toString']()),_0x2d8083=(0x0,moment_1[_0x4cd90e(0xea)])()[_0x4cd90e(0xb5)](),_0x13ba12=await ApiUsages_1[_0x4cd90e(0xea)][_0x4cd90e(0x118)]({'where':{'dateUsed':_0x100c47,'companyId':_0x103732}});if(_0x13ba12)await _0x13ba12['update']({'usedCheckNumber':_0x13ba12[_0x4cd90e(0x12e)]['usedCheckNumber']+0x1,'UsedOnDay':_0x13ba12[_0x4cd90e(0x12e)][_0x4cd90e(0x10d)]+0x1,'updatedAt':_0x2d8083});else{const _0x236433=await ApiUsages_1[_0x4cd90e(0xea)]['create']({'companyId':_0x103732,'dateUsed':_0x100c47});await _0x236433[_0x4cd90e(0x14c)]({'usedCheckNumber':_0x236433[_0x4cd90e(0x12e)]['usedCheckNumber']+0x1,'UsedOnDay':_0x236433[_0x4cd90e(0x12e)][_0x4cd90e(0x10d)]+0x1,'updatedAt':_0x2d8083});}},0x64),_0x5a835f['status'](0xc8)['json']({'existsInWhatsapp':!![],'number':_0x2b27ba,'numberFormatted':_0x5c687e[_0x572be9(0x114)]});}catch(_0x301575){return _0x5a835f[_0x572be9(0x140)](0x190)[_0x572be9(0x17f)]({'existsInWhatsapp':![],'number':_0x333d96,'error':'Not\x20exists\x20on\x20Whatsapp'});}};exports[a9_0x1b523e(0xc6)]=checkNumber;const indexWhatsappsId=async(_0x3ffac5,_0x200481)=>{const _0xaf944d=a9_0x1b523e;return console[_0xaf944d(0x124)](_0xaf944d(0x100),_0x3ffac5),console['log']('req',_0x3ffac5[_0xaf944d(0x110)]),_0x200481[_0xaf944d(0x140)](0xc8)[_0xaf944d(0x17f)]('oi');};exports[a9_0x1b523e(0xb8)]=indexWhatsappsId;const updateQueueId=async(_0x4e4e8f,_0x116f07)=>{const _0x3ed452=a9_0x1b523e,{ticketId:_0x20dc85}=_0x4e4e8f[_0x3ed452(0x10a)],{queueId:_0x407747}=_0x4e4e8f[_0x3ed452(0xe9)],_0x3817cd=_0x4e4e8f[_0x3ed452(0xfa)][_0x3ed452(0xff)],[,_0x29ae10]=_0x3817cd['split']('\x20'),_0x3b3bf5=await Whatsapp_1[_0x3ed452(0xea)][_0x3ed452(0x118)]({'where':{'token':_0x29ae10}}),_0x3bd818=_0x3b3bf5['companyId'];try{const _0x5e046b=await Queue_1[_0x3ed452(0xea)][_0x3ed452(0x118)]({'where':{'id':_0x407747,'companyId':_0x3bd818}});if(!_0x5e046b)return _0x116f07[_0x3ed452(0x140)](0x190)[_0x3ed452(0x17f)]({'status':'ERROR','error':'Invalid\x20queue\x20for\x20the\x20company'});return await(0x0,UpdateTicketService_1[_0x3ed452(0xea)])({'ticketId':_0x20dc85,'ticketData':{'queueId':_0x407747},'companyId':_0x3bd818}),_0x116f07[_0x3ed452(0x140)](0xc8)[_0x3ed452(0x17f)]({'status':'SUCCESS'});}catch(_0x4f0950){return console[_0x3ed452(0xbc)](_0x4f0950),_0x116f07[_0x3ed452(0x140)](0x1f4)[_0x3ed452(0x17f)]({'status':'ERROR','error':_0x3ed452(0xd7)});}};exports[a9_0x1b523e(0xb4)]=updateQueueId;const closeTicket=async(_0x305818,_0x309e66)=>{const _0x576e55=a9_0x1b523e,_0x3a272a=_0x305818[_0x576e55(0xfa)][_0x576e55(0xff)],[,_0x525ae8]=_0x3a272a[_0x576e55(0xc7)]('\x20'),_0x56cc86=await Whatsapp_1[_0x576e55(0xea)][_0x576e55(0x118)]({'where':{'token':_0x525ae8}}),_0x3eaa42=_0x56cc86[_0x576e55(0x141)],{ticketId:_0x400145}=_0x305818[_0x576e55(0x10a)],_0x49a8c8=await(0x0,ShowTicketService_1[_0x576e55(0xea)])(_0x400145,_0x3eaa42);_0x49a8c8['status']=_0x305818['body']['ticketData'][_0x576e55(0x140)],console[_0x576e55(0x124)](_0x49a8c8[_0x576e55(0x140)]);const {ticket:_0x3e32f5}=await(0x0,UpdateTicketService_1['default'])({'ticketData':_0x49a8c8,'ticketId':_0x400145,'companyId':_0x3eaa42});return _0x309e66[_0x576e55(0x140)](0xc8)[_0x576e55(0x17f)](_0x3e32f5);};exports[a9_0x1b523e(0x143)]=closeTicket;const updateTicketTag=async(_0x3ef239,_0x2c4a03)=>{const _0x226c4f=a9_0x1b523e,{ticketId:_0x34ef74,tagId:_0x13902f}=_0x3ef239['body'],_0x1c0c8c=_0x3ef239[_0x226c4f(0xfa)][_0x226c4f(0xff)],[,_0x4940a2]=_0x1c0c8c[_0x226c4f(0xc7)]('\x20');try{const _0x430a6f=await Whatsapp_1['default'][_0x226c4f(0x118)]({'where':{'token':_0x4940a2}}),_0x1ab6bf=_0x430a6f['companyId'],_0x2559b2=await Tag_1[_0x226c4f(0xea)][_0x226c4f(0x118)]({'where':{'id':_0x13902f,'companyId':_0x1ab6bf}});if(!_0x2559b2)return _0x2c4a03[_0x226c4f(0x140)](0x190)[_0x226c4f(0x17f)]({'status':'ERROR','error':_0x226c4f(0x13f)});const _0x57813e=await TicketTag_1[_0x226c4f(0xea)]['findOne']({'where':{'ticketId':_0x34ef74,'tagId':_0x13902f}});if(_0x57813e)return _0x2c4a03[_0x226c4f(0x140)](0x190)[_0x226c4f(0x17f)]({'status':'ERROR','error':_0x226c4f(0xd6)});const _0x2ce941=await TicketTag_1['default'][_0x226c4f(0x142)]({'ticketId':_0x34ef74,'tagId':_0x13902f});return _0x2c4a03[_0x226c4f(0x140)](0xc8)[_0x226c4f(0x17f)]({'status':_0x226c4f(0xe3),'ticketTag':_0x2ce941});}catch(_0x1d6483){return console[_0x226c4f(0xbc)](_0x1d6483),_0x2c4a03['status'](0x1f4)[_0x226c4f(0x17f)]({'status':_0x226c4f(0xde),'error':_0x226c4f(0x150)});}};exports[a9_0x1b523e(0x107)]=updateTicketTag;const removeTicketTag=async(_0x40320a,_0x5d1b75)=>{const _0x519be5=a9_0x1b523e,{ticketId:_0x23a2f9,tagId:_0x2f386f}=_0x40320a[_0x519be5(0xe9)];try{const _0x2a1bd2=await TicketTag_1[_0x519be5(0xea)][_0x519be5(0x118)]({'where':{'ticketId':_0x23a2f9,'tagId':_0x2f386f}});if(!_0x2a1bd2)return _0x5d1b75[_0x519be5(0x140)](0x190)[_0x519be5(0x17f)]({'status':_0x519be5(0xde),'error':'Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket'});return await _0x2a1bd2[_0x519be5(0x138)](),_0x5d1b75[_0x519be5(0x140)](0xc8)[_0x519be5(0x17f)]({'status':_0x519be5(0xe3)});}catch(_0x504fab){return console[_0x519be5(0xbc)](_0x504fab),_0x5d1b75[_0x519be5(0x140)](0x1f4)[_0x519be5(0x17f)]({'status':_0x519be5(0xde),'error':'Failed\x20to\x20remove\x20ticket\x20tag'});}};exports[a9_0x1b523e(0x119)]=removeTicketTag;const listTicketsByCompany=async(_0x51fb3a,_0x128b5f)=>{const _0x9c79d9=a9_0x1b523e,_0xe40c73=_0x51fb3a['headers'][_0x9c79d9(0xff)],[,_0x28eda2]=_0xe40c73['split']('\x20'),_0x360310=await Whatsapp_1[_0x9c79d9(0xea)][_0x9c79d9(0x118)]({'where':{'token':_0x28eda2}}),_0x17ce58=_0x360310[_0x9c79d9(0x141)];try{const _0x37e4e6=await Ticket_1[_0x9c79d9(0xea)][_0x9c79d9(0x178)]({'where':{'companyId':_0x17ce58},'include':[{'model':Contact_1[_0x9c79d9(0xea)],'as':_0x9c79d9(0xd9),'attributes':['id',_0x9c79d9(0x131),_0x9c79d9(0xda),_0x9c79d9(0xd0),_0x9c79d9(0x14b),_0x9c79d9(0xe7),_0x9c79d9(0x129),_0x9c79d9(0xe1)],'include':[_0x9c79d9(0x126)]},{'model':Queue_1[_0x9c79d9(0xea)],'as':'queue','attributes':['id',_0x9c79d9(0x131),'color']},{'model':User_1[_0x9c79d9(0xea)],'as':_0x9c79d9(0x110),'attributes':['id',_0x9c79d9(0x131)]},{'model':Tag_1[_0x9c79d9(0xea)],'as':_0x9c79d9(0x10b),'attributes':['id',_0x9c79d9(0x131),'color']},{'model':Whatsapp_1[_0x9c79d9(0xea)],'as':'whatsapp','attributes':[_0x9c79d9(0x131),'facebookUserToken','facebookUserId']},{'model':Company_1[_0x9c79d9(0xea)],'as':_0x9c79d9(0xc2),'attributes':[_0x9c79d9(0x131)]}]});return _0x128b5f[_0x9c79d9(0x140)](0xc8)[_0x9c79d9(0x17f)]({'status':'SUCCESS','tickets':_0x37e4e6});}catch(_0x428583){return console['error'](_0x428583),_0x128b5f['status'](0x1f4)['json']({'status':'ERROR','error':_0x9c79d9(0xd7)});}};exports[a9_0x1b523e(0x149)]=listTicketsByCompany;const listTicketsByTag=async(_0x395caf,_0x37255c)=>{const _0x949a7b=a9_0x1b523e,{tagId:_0x7e4688}=_0x395caf[_0x949a7b(0x10a)],_0x3ba8de=_0x395caf[_0x949a7b(0xfa)][_0x949a7b(0xff)],[,_0xcdfa4b]=_0x3ba8de['split']('\x20');try{const _0x8121b=await Whatsapp_1['default']['findOne']({'where':{'token':_0xcdfa4b}}),_0x5301df=_0x8121b['companyId'],_0x32e87c=await Tag_1['default'][_0x949a7b(0x118)]({'where':{'id':_0x7e4688,'companyId':_0x5301df}});if(!_0x32e87c)return _0x37255c[_0x949a7b(0x140)](0x190)[_0x949a7b(0x17f)]({'status':_0x949a7b(0xde),'error':'Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company'});const _0x56c477=await Ticket_1[_0x949a7b(0xea)]['findAll']({'include':[{'model':Tag_1[_0x949a7b(0xea)],'as':_0x949a7b(0x10b),'attributes':['id',_0x949a7b(0x131)],'through':{'attributes':[],'where':{'tagId':_0x7e4688}}},{'model':Contact_1[_0x949a7b(0xea)],'as':_0x949a7b(0xd9),'attributes':['id','name',_0x949a7b(0xda),'email',_0x949a7b(0x14b),_0x949a7b(0xe7),_0x949a7b(0x129),_0x949a7b(0xe1)],'include':[_0x949a7b(0x126)]},{'model':Queue_1[_0x949a7b(0xea)],'as':'queue','attributes':['id',_0x949a7b(0x131),'color']},{'model':User_1[_0x949a7b(0xea)],'as':'user','attributes':['id',_0x949a7b(0x131)]},{'model':Whatsapp_1['default'],'as':_0x949a7b(0x176),'attributes':[_0x949a7b(0x131),'facebookUserToken',_0x949a7b(0xdf)]},{'model':Company_1[_0x949a7b(0xea)],'as':_0x949a7b(0xc2),'attributes':[_0x949a7b(0x131)]}],'where':{'companyId':_0x5301df,'$tags.id$':_0x7e4688}});return _0x37255c[_0x949a7b(0x140)](0xc8)[_0x949a7b(0x17f)]({'status':_0x949a7b(0xe3),'tickets':_0x56c477});}catch(_0xcea344){return console['error'](_0xcea344),_0x37255c[_0x949a7b(0x140)](0x1f4)[_0x949a7b(0x17f)]({'status':_0x949a7b(0xde),'error':_0x949a7b(0xd7)});}};exports[a9_0x1b523e(0x123)]=listTicketsByTag;const listTicketsByTagIsAuth=async(_0x56de02,_0x1af270)=>{const _0x5ed7d7=a9_0x1b523e,{tagId:_0x1b38ba}=_0x56de02[_0x5ed7d7(0x10a)];try{const _0x230536=await Ticket_1[_0x5ed7d7(0xea)][_0x5ed7d7(0x178)]({'include':[{'model':Contact_1[_0x5ed7d7(0xea)],'as':_0x5ed7d7(0xd9),'attributes':[_0x5ed7d7(0x131),_0x5ed7d7(0xda),_0x5ed7d7(0xd0)],'include':['extraInfo']},{'model':Tag_1[_0x5ed7d7(0xea)],'as':'tags','attributes':['id',_0x5ed7d7(0x131),_0x5ed7d7(0x156)],'where':{'id':_0x1b38ba}},{'model':Whatsapp_1[_0x5ed7d7(0xea)],'as':_0x5ed7d7(0x176),'attributes':[_0x5ed7d7(0x131),_0x5ed7d7(0x14f),_0x5ed7d7(0xdf)]},{'model':Company_1[_0x5ed7d7(0xea)],'as':_0x5ed7d7(0xc2),'attributes':[_0x5ed7d7(0x131)]}]});return _0x1af270[_0x5ed7d7(0x140)](0xc8)[_0x5ed7d7(0x17f)]({'status':_0x5ed7d7(0xe3),'tickets':_0x230536});}catch(_0x3e9439){return console[_0x5ed7d7(0xbc)](_0x3e9439),_0x1af270[_0x5ed7d7(0x140)](0x1f4)[_0x5ed7d7(0x17f)]({'status':'ERROR','error':_0x5ed7d7(0xd7)});}};exports[a9_0x1b523e(0x165)]=listTicketsByTagIsAuth;function makeid(_0x3add33){const _0xe5cedd=a9_0x1b523e;var _0x587d71='',_0x419aeb='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',_0x29a83a=_0x419aeb[_0xe5cedd(0x17a)];for(var _0x5bce2f=0x0;_0x5bce2f<_0x3add33;_0x5bce2f++){_0x587d71+=_0x419aeb[_0xe5cedd(0xe4)](Math['floor'](Math['random']()*_0x29a83a));}return _0x587d71;}exports['makeid']=makeid;const handleAudioLink=async(_0x474f94,_0x372591)=>{const _0x56eb6b=a9_0x1b523e,{link:_0x525d73,contactNumber:_0x182a90}=_0x474f94[_0x56eb6b(0xe9)];try{const _0x12df96=_0x474f94[_0x56eb6b(0xfa)][_0x56eb6b(0xff)],[,_0x33f70a]=_0x12df96[_0x56eb6b(0xc7)]('\x20'),_0x519da3=await Whatsapp_1[_0x56eb6b(0xea)][_0x56eb6b(0x118)]({'where':{'token':_0x33f70a}}),_0x5091c3=_0x519da3[_0x56eb6b(0x141)],_0x24c2da=await(0x0,GetDefaultWhatsApp_1[_0x56eb6b(0xea)])(_0x5091c3),_0x559829=(0x0,wbot_1[_0x56eb6b(0x125)])(_0x24c2da['id']),_0x562b88=_0x56eb6b(0xf7)+_0x5091c3+'/'+makeid(0xa)+_0x56eb6b(0x17d);if(!_0x519da3)return _0x372591[_0x56eb6b(0x140)](0x191)[_0x56eb6b(0x17f)]({'status':_0x56eb6b(0x130),'error':_0x56eb6b(0x180)});const _0x119033=await axios_1[_0x56eb6b(0xea)][_0x56eb6b(0x103)](_0x525d73,{'responseType':_0x56eb6b(0x16e)});fs_1[_0x56eb6b(0xea)][_0x56eb6b(0xd5)](_0x562b88,Buffer[_0x56eb6b(0xfc)](_0x119033[_0x56eb6b(0x174)]));const _0x3af1f8='Legenda\x20do\x20áudio';return await(0x0,SendPresenceStatus_1[_0x56eb6b(0xcd)])(_0x559829,_0x182a90),await _0x559829[_0x56eb6b(0x179)](_0x182a90+'@s.whatsapp.net',{'audio':fs_1[_0x56eb6b(0xea)][_0x56eb6b(0xd1)](_0x562b88),'fileName':_0x3af1f8,'caption':_0x3af1f8,'mimetype':_0x56eb6b(0x13e),'ptt':!![]}),_0x372591['status'](0xc8)['json']({'status':_0x56eb6b(0x10f)});}catch(_0x1c09f2){return console[_0x56eb6b(0xbc)](_0x1c09f2),_0x372591[_0x56eb6b(0x140)](0x1f4)['json']({'status':_0x56eb6b(0x130),'error':'Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio'});}};exports[a9_0x1b523e(0x102)]=handleAudioLink;const indexApi=async(_0x5efd56,_0x3a6803)=>{const _0x317c20=a9_0x1b523e,_0x18bf37=_0x5efd56[_0x317c20(0xfa)][_0x317c20(0xff)],[,_0x443b27]=_0x18bf37['split']('\x20'),_0x35fda6=await Whatsapp_1[_0x317c20(0xea)][_0x317c20(0x118)]({'where':{'token':_0x443b27}}),_0x4902a2=_0x35fda6[_0x317c20(0x141)],{searchParam:_0x4c42f9,pageNumber:_0x3d240f}=_0x5efd56[_0x317c20(0xf5)];if(_0x4902a2===0x1){const {invoices:_0x980415,count:_0x5c10c9,hasMore:_0x13dc51}=await(0x0,ListInvoicesServices_1['default'])({'searchParam':_0x4c42f9,'pageNumber':_0x3d240f});return _0x3a6803[_0x317c20(0x17f)]({'invoices':_0x980415,'count':_0x5c10c9,'hasMore':_0x13dc51});}else return _0x3a6803['status'](0x191)[_0x317c20(0x17f)]({'status':_0x317c20(0x130),'error':_0x317c20(0x16b)});};exports[a9_0x1b523e(0x157)]=indexApi;const showApi=async(_0x48b8c0,_0xbaa51e)=>{const _0x1b41a1=a9_0x1b523e,_0xbdca16=_0x48b8c0[_0x1b41a1(0xfa)][_0x1b41a1(0xff)],[,_0x2af098]=_0xbdca16['split']('\x20'),_0xa8fa59=await Whatsapp_1[_0x1b41a1(0xea)]['findOne']({'where':{'token':_0x2af098}}),_0x3052e5=_0xa8fa59[_0x1b41a1(0x141)],{Invoiceid:_0x29283a}=_0x48b8c0[_0x1b41a1(0x10a)],_0x59e5bf=await(0x0,ShowInvoiceService_1[_0x1b41a1(0xea)])(_0x29283a);return _0xbaa51e[_0x1b41a1(0x140)](0xc8)[_0x1b41a1(0x17f)](_0x59e5bf);};exports[a9_0x1b523e(0xfd)]=showApi;const showAllApi=async(_0xd157eb,_0x27a214)=>{const _0x5cf54e=a9_0x1b523e;try{const _0x444597=_0xd157eb['headers'][_0x5cf54e(0xff)],[,_0x4246ef]=_0x444597[_0x5cf54e(0xc7)]('\x20'),_0x41576b=await Whatsapp_1[_0x5cf54e(0xea)][_0x5cf54e(0x118)]({'where':{'token':_0x4246ef}}),_0x596c7f=_0x41576b[_0x5cf54e(0x141)],{companyId:_0x4d73ab,status:_0x34ca2c}=_0xd157eb[_0x5cf54e(0xe9)];if(_0x596c7f===0x1){const _0xdf2d8a=await Invoices_1[_0x5cf54e(0xea)][_0x5cf54e(0x178)]({'where':{'companyId':_0x4d73ab,'status':_0x34ca2c}});return _0x27a214[_0x5cf54e(0x140)](0xc8)['json'](_0xdf2d8a);}else return _0x27a214[_0x5cf54e(0x140)](0x191)[_0x5cf54e(0x17f)]({'status':_0x5cf54e(0x130),'error':_0x5cf54e(0x16b)});}catch(_0x15f073){return console[_0x5cf54e(0xbc)](_0x5cf54e(0x11f),_0x15f073),_0x27a214['status'](0x1f4)[_0x5cf54e(0x17f)]({'error':'Erro\x20ao\x20buscar\x20invoices'});}};exports[a9_0x1b523e(0x104)]=showAllApi;const updateApi=async(_0x1746f6,_0x202750)=>{const _0x41f665=a9_0x1b523e,_0xc119d2=_0x1746f6[_0x41f665(0xfa)][_0x41f665(0xff)],[,_0x260c69]=_0xc119d2['split']('\x20'),_0x58beb2=await Whatsapp_1[_0x41f665(0xea)][_0x41f665(0x118)]({'where':{'token':_0x260c69}}),_0x359fa5=_0x58beb2[_0x41f665(0x141)],_0x590ca7=_0x1746f6[_0x41f665(0xe9)],_0x2da613=Yup[_0x41f665(0x161)]()[_0x41f665(0xc9)]({'name':Yup[_0x41f665(0xc8)]()});try{await _0x2da613[_0x41f665(0x117)](_0x590ca7);}catch(_0x11d8a4){throw new AppError_1['default'](_0x11d8a4[_0x41f665(0x168)]);}const {id:_0xd5d6ad,status:_0x30d88c}=_0x590ca7;if(_0x359fa5===0x1){const _0x487fff=await(0x0,UpdateInvoiceService_1[_0x41f665(0xea)])({'id':_0xd5d6ad,'status':_0x30d88c}),_0x2b91e4=await Invoices_1[_0x41f665(0xea)]['findByPk'](_0xd5d6ad),_0xa71e35=_0x2b91e4[_0x41f665(0x141)],_0x4a0d5a=await Company_1[_0x41f665(0xea)][_0x41f665(0x14a)](_0xa71e35),_0x5a3e58=new Date(_0x4a0d5a['dueDate']);_0x5a3e58['setDate'](_0x5a3e58[_0x41f665(0x101)]()+0x1e);const _0x926cb0=_0x5a3e58[_0x41f665(0xce)]()[_0x41f665(0xc7)]('T')[0x0];if(_0x4a0d5a){await _0x4a0d5a[_0x41f665(0x14c)]({'dueDate':_0x926cb0});const _0x2ffadd=await _0x2b91e4[_0x41f665(0x14c)]({'id':_0xd5d6ad,'status':_0x41f665(0xd4)});await _0x4a0d5a[_0x41f665(0xc1)]();const _0x190862=(0x0,socket_1[_0x41f665(0x173)])(),_0xc387c9=await Company_1['default'][_0x41f665(0x118)]({'where':{'id':_0xa71e35}});}return _0x202750[_0x41f665(0x140)](0xc8)[_0x41f665(0x17f)](_0x487fff);}else return _0x202750[_0x41f665(0x140)](0x191)[_0x41f665(0x17f)]({'status':_0x41f665(0x130),'error':_0x41f665(0x16b)});};exports[a9_0x1b523e(0x183)]=updateApi;const updateUsageStats=async(_0x3e645b,_0x3a0146)=>{const _0x5c4334=a9_0x1b523e;if(!_0x3e645b['user']||!_0x3e645b['user'][_0x5c4334(0x141)])return _0x3a0146[_0x5c4334(0x140)](0x190)['send']({'status':_0x5c4334(0xde),'message':'Missing\x20user\x20or\x20companyId'});const {companyId:_0x295945}=_0x3e645b[_0x5c4334(0x110)],{contactId:_0x7f4f02}=_0x3e645b[_0x5c4334(0x10a)];return setTimeout(async()=>{const _0x31255f=_0x5c4334,{dateToClient:_0x3ef344}=(0x0,useDate_1[_0x31255f(0x11a)])(),_0x2d6b0e=_0x3ef344(new Date()[_0x31255f(0xcc)]()),_0x29893e=(0x0,moment_1[_0x31255f(0xea)])()[_0x31255f(0xb5)]();try{const _0x28d479=await ApiUsages_1[_0x31255f(0xea)][_0x31255f(0x118)]({'where':{'dateUsed':_0x2d6b0e,'companyId':_0x295945}});if(_0x28d479)await _0x28d479[_0x31255f(0x14c)]({'usedOther':_0x28d479[_0x31255f(0x12e)][_0x31255f(0x15f)]+0x1,'UsedOnDay':_0x28d479[_0x31255f(0x12e)][_0x31255f(0x10d)]+0x1,'updatedAt':_0x29893e});else{const _0x5b86bc=await ApiUsages_1[_0x31255f(0xea)][_0x31255f(0x142)]({'companyId':_0x295945,'dateUsed':_0x2d6b0e});await _0x5b86bc['update']({'usedOther':_0x5b86bc[_0x31255f(0x12e)][_0x31255f(0x15f)]+0x1,'UsedOnDay':_0x5b86bc[_0x31255f(0x12e)][_0x31255f(0x10d)]+0x1,'updatedAt':_0x29893e});}}catch(_0x274518){return console[_0x31255f(0xbc)](_0x31255f(0x169),_0x274518),_0x3a0146[_0x31255f(0x140)](0x1f4)[_0x31255f(0x154)]({'status':_0x31255f(0xde),'message':_0x31255f(0x120)});}},0x64),_0x3a0146['send']({'status':_0x5c4334(0xe3)});};function a9_0x4d7b(){const _0x6784d3=['Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','email','readFileSync','replace','usedImage','paid','writeFileSync','Tag\x20already\x20associated\x20with\x20the\x20ticket','Internal\x20Server\x20Error','../models/Ticket','contact','number','originalname','removeAllContacts','updateContacts','ERROR','facebookUserId','image','disableBot','isInteger','SUCCESS','charAt','uploadContacts','2102376jJgckE','acceptAudioMessage','showContacts','body','default','axios','../libs/socket','caption','../services/WbotServices/GetProfilePicUrl','parseInt','../services/TicketServices/ShowTicketService','apply','defineProperty','12sucsNV','../models/Invoices','query','mimetype','./public/company','emit','findOrCreateContacts','headers','../services/WbotServices/CheckNumber','from','showApi','-contact','authorization','req','getDate','handleAudioLink','get','showAllApi','1630252LZykNI','exec','updateTicketTag','18jqwdlO','-mainchannel','params','tags','video','UsedOnDay','1800745VbWJCr','SUCESSO','user','__importStar','../services/ContactServices/CreateOrUpdateContactService','nullable','jid','7SmneZU','../services/ContactServices/ToggleDisableBotService','validate','findOne','removeTicketTag','useDate','../utils/useDate','26711360zNgdJi','11pRtciu','includes','Erro\x20ao\x20buscar\x20invoices:','Internal\x20server\x20error','../services/InvoicesService/ListInvoicesServices','pending','listTicketsByTag','log','getWbot','extraInfo','5409804DBNZAo','../models/Contact','active','(((.+)+)+)+$','__createBinding','475023gogqmx','../services/ContactServices/ListContactsService','dataValues','constructor','ERRO','name','All\x20contacts\x20removed\x20successfully','indexLink','exists','boolean','\x20not\x20found','required','destroy','../services/WbotServices/SendWhatsAppMedia','../services/WbotServices/SendWhatsAppMessageAPI','map','prototype','matches','audio/mp4','Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company','status','companyId','create','closeTicket','__esModule','usedPDF','media','files','storeContacts','listTicketsByCompany','findByPk','profilePicUrl','update','all','deleteAll','facebookUserToken','Failed\x20to\x20update\x20ticket\x20tag','pdf','search','hasOwnProperty','send','company-','color','indexApi','createCompany','Error\x20removing\x20all\x20contacts:','../services/ContactServices/ShowContactService','updateUsageStats','../libs/wbot','12DNQhxb','type','usedOther','__setModuleDefault','object','listContacts','delete','OnWhatsAppDto','listTicketsByTagIsAuth','../models/ApiUsages','__importDefault','message','Error\x20updating\x20usage\x20stats:','../helpers/SetTicketMessagesAsRead','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','yup','../models/Tag','arraybuffer','../services/TicketServices/UpdateTicketService','../services/TicketServices/FindOrCreateTicketService','getOwnPropertyDescriptor','head','getIO','data','moment','whatsapp','../errors/AppError','findAll','sendMessage','length','1438550myEKTJ','date','.mp3','Company\x20not\x20found','json','Token\x20de\x20autorização\x20inválido','indexContacts','removeContacts','updateApi','url','Contact\x20deleted','../models/Whatsapp','updateQueueId','format','../services/InvoicesService/ShowInvoiceService','call','indexWhatsappsId','whatsapp\x20#','../services/ContactServices/UpdateContactService','../services/WbotServices/SendWhatsAppMessageLink','error','indexImage','@s.whatsapp.net','1lrToRE','toggleDisableBotContacts','reload','company','../services/ContactServices/SimpleListService','../models/Company','writable','checkNumber','split','string','shape','updateCompany','ImportXLSContactsService','toString','SendPresenceStatus','toISOString'];a9_0x4d7b=function(){return _0x6784d3;};return a9_0x4d7b();}exports[a9_0x1b523e(0x15b)]=updateUsageStats;const indexContacts=async(_0x536304,_0x4c52f9)=>{const _0x521fa9=a9_0x1b523e,{searchParam:_0x16a617,pageNumber:_0x476968}=_0x536304[_0x521fa9(0xf5)],{companyId:_0xefaef9}=_0x536304['user'],{contacts:_0x4b4745,count:_0x5abf2c,hasMore:_0x5b4db5}=await(0x0,ListContactsService_1[_0x521fa9(0xea)])({'searchParam':_0x16a617,'pageNumber':_0x476968,'companyId':_0xefaef9});return _0x4c52f9['json']({'contacts':_0x4b4745,'count':_0x5abf2c,'hasMore':_0x5b4db5});};exports['indexContacts']=indexContacts;const listContacts=async(_0x1e6729,_0x403ef5)=>{const _0x4b18c4=a9_0x1b523e,{name:_0x44e2f8}=_0x1e6729[_0x4b18c4(0xf5)],{companyId:_0x5f496a}=_0x1e6729[_0x4b18c4(0x110)],_0x4ca910=await(0x0,SimpleListService_1[_0x4b18c4(0xea)])({'name':_0x44e2f8,'companyId':_0x5f496a});return _0x403ef5[_0x4b18c4(0x17f)](_0x4ca910);};exports[a9_0x1b523e(0x162)]=listContacts;function a9_0x1bb0(_0xa20be7,_0x97976e){const _0x5ccb12=a9_0x4d7b();return a9_0x1bb0=function(_0x29a921,_0x48f071){_0x29a921=_0x29a921-0xb3;let _0x4d7b4a=_0x5ccb12[_0x29a921];return _0x4d7b4a;},a9_0x1bb0(_0xa20be7,_0x97976e);}const showContacts=async(_0x4c1735,_0xc9fe71)=>{const _0x2ae87f=a9_0x1b523e,{contactId:_0x146fb2}=_0x4c1735[_0x2ae87f(0x10a)],{companyId:_0xb52038}=_0x4c1735[_0x2ae87f(0x110)],_0x4df3b9=await(0x0,ShowContactService_1[_0x2ae87f(0xea)])(_0x146fb2,_0xb52038);return _0xc9fe71['status'](0xc8)['json'](_0x4df3b9);};exports['showContacts']=showContacts;const findOrCreateContacts=async(_0x12e998,_0x18b7c0)=>{const _0x2aaa1f=a9_0x1b523e,{name:_0x3e1289,number:_0x3086fc}=_0x12e998[_0x2aaa1f(0xe9)],{companyId:_0x1148c1}=_0x12e998[_0x2aaa1f(0x110)],_0x263fd5=await(0x0,GetContactService_1[_0x2aaa1f(0xea)])({'name':_0x3e1289,'number':_0x3086fc,'companyId':_0x1148c1});return _0x18b7c0['status'](0xc8)[_0x2aaa1f(0x17f)](_0x263fd5);};exports[a9_0x1b523e(0xf9)]=findOrCreateContacts;const storeContacts=async(_0x1b4dc0,_0x1b4f5f)=>{const _0x40f2fe=a9_0x1b523e,{companyId:_0x79317c}=_0x1b4dc0['user'],_0x127e66=_0x1b4dc0['body'];_0x127e66[_0x40f2fe(0xda)]=_0x127e66['number']['replace']('-','')['replace']('\x20','');const _0x5ab57a=Yup[_0x40f2fe(0x161)]()[_0x40f2fe(0xc9)]({'name':Yup[_0x40f2fe(0xc8)]()['required'](),'number':Yup[_0x40f2fe(0xc8)]()[_0x40f2fe(0x137)]()[_0x40f2fe(0x13d)](/^\d+$/,_0x40f2fe(0xcf))});try{await _0x5ab57a['validate'](_0x127e66);}catch(_0x2ef2e4){throw new AppError_1[(_0x40f2fe(0xea))](_0x2ef2e4[_0x40f2fe(0x168)]);}await(0x0,CheckIsValidContact_1['default'])(_0x127e66[_0x40f2fe(0xda)],_0x79317c);const _0x17ae3d=await(0x0,CheckNumber_1[_0x40f2fe(0xea)])(_0x127e66[_0x40f2fe(0xda)],_0x79317c),_0x231f8e=_0x17ae3d[_0x40f2fe(0x114)][_0x40f2fe(0xd2)](/\D/g,'');_0x127e66['number']=_0x231f8e;const _0x46f535=await(0x0,CreateContactService_1[_0x40f2fe(0xea)])({..._0x127e66,'companyId':_0x79317c}),_0x38580d=(0x0,socket_1[_0x40f2fe(0x173)])();return _0x38580d[_0x40f2fe(0xf8)](_0x40f2fe(0x155)+_0x79317c+_0x40f2fe(0xfe),{'action':'create','contact':_0x46f535}),_0x1b4f5f['status'](0xc8)[_0x40f2fe(0x17f)](_0x46f535);};exports['storeContacts']=storeContacts;const removeAllContacts=async(_0x1e9dba,_0x12b53e)=>{const _0xd1a1a3=a9_0x1b523e,{companyId:_0x6dfa91}=_0x1e9dba['user'];try{await Contact_1['default'][_0xd1a1a3(0x138)]({'where':{'companyId':_0x6dfa91}});const _0x14b4ea=(0x0,socket_1[_0xd1a1a3(0x173)])();return _0x14b4ea[_0xd1a1a3(0xf8)](_0xd1a1a3(0x155)+_0x6dfa91+_0xd1a1a3(0xfe),{'action':_0xd1a1a3(0x14e)}),setTimeout(async()=>{const _0x1bf7f7=_0xd1a1a3,{dateToClient:_0x1f8a1f}=(0x0,useDate_1[_0x1bf7f7(0x11a)])(),_0x26c73f=_0x1f8a1f(new Date()[_0x1bf7f7(0xcc)]()),_0x283049=(0x0,moment_1['default'])()[_0x1bf7f7(0xb5)]();try{const _0x47bad7=await ApiUsages_1[_0x1bf7f7(0xea)]['findOne']({'where':{'dateUsed':_0x26c73f,'companyId':_0x6dfa91}});if(_0x47bad7)await _0x47bad7[_0x1bf7f7(0x14c)]({'usedOther':_0x47bad7[_0x1bf7f7(0x12e)][_0x1bf7f7(0x15f)]+0x1,'UsedOnDay':_0x47bad7[_0x1bf7f7(0x12e)][_0x1bf7f7(0x10d)]+0x1,'updatedAt':_0x283049});else{const _0x3d975e=await ApiUsages_1['default'][_0x1bf7f7(0x142)]({'companyId':_0x6dfa91,'dateUsed':_0x26c73f});await _0x3d975e[_0x1bf7f7(0x14c)]({'usedOther':_0x3d975e['dataValues'][_0x1bf7f7(0x15f)]+0x1,'UsedOnDay':_0x3d975e[_0x1bf7f7(0x12e)][_0x1bf7f7(0x10d)]+0x1,'updatedAt':_0x283049});}}catch(_0x58fbc6){return console['error']('Error\x20updating\x20usage\x20stats:',_0x58fbc6),_0x12b53e[_0x1bf7f7(0x140)](0x1f4)['send']({'status':_0x1bf7f7(0xde),'message':'Internal\x20server\x20error'});}},0x64),_0x12b53e[_0xd1a1a3(0x140)](0xc8)[_0xd1a1a3(0x154)]({'status':'SUCCESS','message':_0xd1a1a3(0x132)});}catch(_0xe5bcb8){return console[_0xd1a1a3(0xbc)](_0xd1a1a3(0x159),_0xe5bcb8),_0x12b53e[_0xd1a1a3(0x140)](0x1f4)[_0xd1a1a3(0x154)]({'status':_0xd1a1a3(0xde),'message':_0xd1a1a3(0x120)});}};exports['removeAllContacts']=removeAllContacts;const updateContacts=async(_0x5064e1,_0x2a0199)=>{const _0x45cc6b=a9_0x1b523e,_0x516a2c=_0x5064e1[_0x45cc6b(0xe9)],{companyId:_0x4de3e3}=_0x5064e1[_0x45cc6b(0x110)],_0x74433d=Yup[_0x45cc6b(0x161)]()[_0x45cc6b(0xc9)]({'name':Yup[_0x45cc6b(0xc8)](),'number':Yup[_0x45cc6b(0xc8)]()[_0x45cc6b(0x13d)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x74433d[_0x45cc6b(0x117)](_0x516a2c);}catch(_0x131b6d){throw new AppError_1['default'](_0x131b6d[_0x45cc6b(0x168)]);}await(0x0,CheckIsValidContact_1[_0x45cc6b(0xea)])(_0x516a2c[_0x45cc6b(0xda)],_0x4de3e3);const _0x54092a=await(0x0,CheckNumber_1[_0x45cc6b(0xea)])(_0x516a2c['number'],_0x4de3e3),_0x83d6e0=_0x54092a[_0x45cc6b(0x114)][_0x45cc6b(0xd2)](/\D/g,'');_0x516a2c[_0x45cc6b(0xda)]=_0x83d6e0;const {contactId:_0x47faf2}=_0x5064e1[_0x45cc6b(0x10a)],_0x31181b=await(0x0,UpdateContactService_1[_0x45cc6b(0xea)])({'contactData':_0x516a2c,'contactId':_0x47faf2,'companyId':_0x4de3e3}),_0x45e6ed=(0x0,socket_1[_0x45cc6b(0x173)])();return _0x45e6ed['emit'](_0x45cc6b(0x155)+_0x4de3e3+_0x45cc6b(0xfe),{'action':_0x45cc6b(0x14c),'contact':_0x31181b}),_0x2a0199[_0x45cc6b(0x140)](0xc8)[_0x45cc6b(0x17f)](_0x31181b);};exports[a9_0x1b523e(0xdd)]=updateContacts;const removeContacts=async(_0x2894c8,_0x4d81a1)=>{const _0x3d73ed=a9_0x1b523e,{contactId:_0xe9a720}=_0x2894c8['params'],{companyId:_0x7a8728}=_0x2894c8[_0x3d73ed(0x110)];await(0x0,ShowContactService_1[_0x3d73ed(0xea)])(_0xe9a720,_0x7a8728),await(0x0,DeleteContactService_1['default'])(_0xe9a720);const _0xf1283a=(0x0,socket_1[_0x3d73ed(0x173)])();return _0xf1283a['emit'](_0x3d73ed(0x155)+_0x7a8728+_0x3d73ed(0xfe),{'action':_0x3d73ed(0x163),'contactId':_0xe9a720}),_0x4d81a1['status'](0xc8)[_0x3d73ed(0x17f)]({'message':_0x3d73ed(0x185)});};exports['removeContacts']=removeContacts;const uploadContacts=async(_0x3e3300,_0x3f0387)=>{const _0x5506fa=a9_0x1b523e,_0x1a76c6=_0x3e3300[_0x5506fa(0x147)],_0x361f5c=(0x0,lodash_1[_0x5506fa(0x172)])(_0x1a76c6),{companyId:_0x23cf87}=_0x3e3300[_0x5506fa(0x110)],_0x2f312e=await(0x0,ImportXLSContactsService_1[_0x5506fa(0xcb)])(_0x23cf87,_0x361f5c),_0x57a59b=(0x0,socket_1[_0x5506fa(0x173)])(),_0x148c8c={'action':_0x5506fa(0xc1),'records':_0x2f312e};return _0x57a59b['to']('company-'+_0x23cf87+_0x5506fa(0x109))[_0x5506fa(0xf8)]('company-'+_0x23cf87+_0x5506fa(0xfe),_0x148c8c),_0x3f0387[_0x5506fa(0x140)](0xc8)[_0x5506fa(0x17f)](_0x2f312e);};exports[a9_0x1b523e(0xe5)]=uploadContacts;const toggleDisableBotContacts=async(_0x447ee6,_0x994405)=>{const _0x33c227=a9_0x1b523e,{contactId:_0x43cf91}=_0x447ee6[_0x33c227(0x10a)],{companyId:_0x1f9111}=_0x447ee6[_0x33c227(0x110)],_0x492536=await(0x0,ToggleDisableBotService_1['default'])(_0x43cf91,_0x1f9111),_0x31e650=(0x0,socket_1['getIO'])();return _0x31e650[_0x33c227(0xf8)](_0x33c227(0x155)+_0x1f9111+_0x33c227(0xfe),{'action':_0x33c227(0x14c),'contact':_0x492536}),_0x994405[_0x33c227(0x140)](0xc8)[_0x33c227(0x17f)](_0x492536);};exports[a9_0x1b523e(0xc0)]=toggleDisableBotContacts;