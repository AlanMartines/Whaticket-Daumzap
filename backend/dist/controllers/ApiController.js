const a9_0x5bb0e3=a9_0x1112;function a9_0x3d78(){const _0x4329c5=['ERRO','__esModule','defineProperty','facebookUserId','paid','uploadContacts','SUCCESS','__importStar','All\x20contacts\x20removed\x20successfully','tags','updateApi','head','../errors/AppError','contact','makeid','updateUsageStats','video','../services/ContactServices/SimpleListService','create','all','65192mFVPdb','-contact','closeTicket','name','constructor','date','companyId','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','Internal\x20server\x20error','getIO','company-','queue','showAllApi','getDate','whatsapp\x20#','writable','string','arraybuffer','data','../helpers/SendPresenceStatus','index','includes','length','-mainchannel','toggleDisableBotContacts','Internal\x20Server\x20Error','showContacts','findByPk','indexContacts','indexApi','handleAudioLink','pending','updateCompany','checkNumber','683670lOFQah','../services/ContactServices/CreateOrUpdateContactService','updateTicketTag','Tag\x20already\x20associated\x20with\x20the\x20ticket','../services/TicketServices/ShowTicketService','(((.+)+)+)+$','__importDefault','format','user','.mp3','authorization','active','exists','type','call','listTicketsByCompany','updateContacts','error','acceptAudioMessage','listTicketsByTag','status','showApi','exec','298326axHBqX','../services/ContactServices/CreateContactService','@g.us','usedImage','emit','listTicketsByTagIsAuth','indexWhatsappsId','6316178TdhdBy','ImportXLSContactsService','1310742HnxeZn','number','Erro\x20ao\x20buscar\x20invoices:','indexImage','required','send','mimetype','parseInt','yup','./public/company','search','ticketData','destroy','indexLink','../services/WbotServices/SendWhatsappMediaImage','profilePicUrl','../models/Invoices','__setModuleDefault','SendPresenceStatus','updateQueueId','../models/Contact','media','../services/ContactServices/ToggleDisableBotService','json','charAt','shape','split','update','replace','pdf','map','facebookUserToken','readFileSync','from','floor','toString','findOrCreateContacts','email','Invalid\x20queue\x20for\x20the\x20company','Failed\x20to\x20update\x20ticket\x20tag','caption','listContacts','../services/WbotServices/SendWhatsAppMessageLink','Error\x20updating\x20usage\x20stats:','files','req','originalname','dataValues','company','whatsapp','removeAllContacts','getOwnPropertyDescriptor','sendMessage','../models/TicketTag','prototype','validate','Contact\x20deleted','../helpers/SetTicketMessagesAsRead','blockCompany','getWbot','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','../services/ContactServices/UpdateContactService','createCompany','get','findOne','nullable','matches','removeContacts','8tkmriI','../services/WbotServices/CheckNumber','462IYLdQQ','findAll','ERROR','disableBot','../services/ContactServices/ListContactsService','../libs/socket','../services/InvoicesService/ShowInvoiceService','message','query','axios','reload','../services/TicketServices/UpdateTicketService','../services/WbotServices/SendWhatsAppMedia','81WiPNxl','jid','log','../services/ContactServices/GetContactService','../models/User','Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company','boolean','hasOwnProperty','useDate','30930CvWbPA','usedVideo','configurable','object','extraInfo','Token\x20de\x20autorização\x20inválido','storeContacts','UsedOnDay','Not\x20exists\x20on\x20Whatsapp','extname','usedOther','3AQqDQO','../helpers/GetDefaultWhatsApp','test','Legenda\x20do\x20áudio','OnWhatsAppDto','image','isInteger','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','default','removeTicketTag','../models/ApiUsages','99986IzkCtH','color','writeFileSync','deleteAll','moment','@s.whatsapp.net','params','../services/ContactServices/DeleteContactService','../models/Queue','headers','body','delete','Company\x20not\x20found','lodash'];a9_0x3d78=function(){return _0x4329c5;};return a9_0x3d78();}(function(_0x20e54f,_0x56a9f7){const _0x3acbb4=a9_0x1112,_0x2db01f=_0x20e54f();while(!![]){try{const _0xbbfa3e=parseInt(_0x3acbb4(0x152))/0x1+parseInt(_0x3acbb4(0x1ad))/0x2*(parseInt(_0x3acbb4(0x21d))/0x3)+parseInt(_0x3acbb4(0x1fa))/0x4*(parseInt(_0x3acbb4(0x196))/0x5)+-parseInt(_0x3acbb4(0x1b6))/0x6+-parseInt(_0x3acbb4(0x1fc))/0x7*(-parseInt(_0x3acbb4(0x174))/0x8)+parseInt(_0x3acbb4(0x209))/0x9*(parseInt(_0x3acbb4(0x212))/0xa)+-parseInt(_0x3acbb4(0x1b4))/0xb;if(_0xbbfa3e===_0x56a9f7)break;else _0x2db01f['push'](_0x2db01f['shift']());}catch(_0x42f3ae){_0x2db01f['push'](_0x2db01f['shift']());}}}(a9_0x3d78,0x482d1));const a9_0x2ff459=(function(){let _0x3399b2=!![];return function(_0x14d3ed,_0x49ce16){const _0x1b5fd5=_0x3399b2?function(){if(_0x49ce16){const _0x4aa96a=_0x49ce16['apply'](_0x14d3ed,arguments);return _0x49ce16=null,_0x4aa96a;}}:function(){};return _0x3399b2=![],_0x1b5fd5;};}()),a9_0x4f6145=a9_0x2ff459(this,function(){const _0x194d3a=a9_0x1112;return a9_0x4f6145[_0x194d3a(0x1d9)]()[_0x194d3a(0x1c0)]('(((.+)+)+)+$')[_0x194d3a(0x1d9)]()[_0x194d3a(0x178)](a9_0x4f6145)[_0x194d3a(0x1c0)](_0x194d3a(0x19b));});a9_0x4f6145();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a9_0x5bb0e3(0x172)]?function(_0x11516d,_0x1a1875,_0x403ba0,_0xe03ef3){const _0x344bd9=a9_0x5bb0e3;if(_0xe03ef3===undefined)_0xe03ef3=_0x403ba0;var _0x3fdcc8=Object[_0x344bd9(0x1e9)](_0x1a1875,_0x403ba0);(!_0x3fdcc8||(_0x344bd9(0x1f5)in _0x3fdcc8?!_0x1a1875['__esModule']:_0x3fdcc8[_0x344bd9(0x183)]||_0x3fdcc8[_0x344bd9(0x214)]))&&(_0x3fdcc8={'enumerable':!![],'get':function(){return _0x1a1875[_0x403ba0];}}),Object[_0x344bd9(0x162)](_0x11516d,_0xe03ef3,_0x3fdcc8);}:function(_0x11312c,_0x4d5d6d,_0x20a189,_0x2de956){if(_0x2de956===undefined)_0x2de956=_0x20a189;_0x11312c[_0x2de956]=_0x4d5d6d[_0x20a189];}),__setModuleDefault=this&&this[a9_0x5bb0e3(0x1c7)]||(Object[a9_0x5bb0e3(0x172)]?function(_0x20578b,_0x3cca40){const _0x513ef3=a9_0x5bb0e3;Object[_0x513ef3(0x162)](_0x20578b,'default',{'enumerable':!![],'value':_0x3cca40});}:function(_0x18e7f7,_0x28956f){const _0x3c1069=a9_0x5bb0e3;_0x18e7f7[_0x3c1069(0x14f)]=_0x28956f;}),__importStar=this&&this[a9_0x5bb0e3(0x167)]||function(_0x2d79d8){const _0x4fdd6b=a9_0x5bb0e3;if(_0x2d79d8&&_0x2d79d8[_0x4fdd6b(0x161)])return _0x2d79d8;var _0x4fc278={};if(_0x2d79d8!=null){for(var _0x40f3d5 in _0x2d79d8)if(_0x40f3d5!==_0x4fdd6b(0x14f)&&Object[_0x4fdd6b(0x1ec)][_0x4fdd6b(0x210)][_0x4fdd6b(0x1a4)](_0x2d79d8,_0x40f3d5))__createBinding(_0x4fc278,_0x2d79d8,_0x40f3d5);}return __setModuleDefault(_0x4fc278,_0x2d79d8),_0x4fc278;},__importDefault=this&&this[a9_0x5bb0e3(0x19c)]||function(_0x5aecf8){const _0xb3b9e1=a9_0x5bb0e3;return _0x5aecf8&&_0x5aecf8[_0xb3b9e1(0x161)]?_0x5aecf8:{'default':_0x5aecf8};};Object[a9_0x5bb0e3(0x162)](exports,'__esModule',{'value':!![]}),exports[a9_0x5bb0e3(0x18c)]=exports['uploadContacts']=exports[a9_0x5bb0e3(0x1f9)]=exports[a9_0x5bb0e3(0x1a6)]=exports[a9_0x5bb0e3(0x1e8)]=exports['storeContacts']=exports['findOrCreateContacts']=exports['showContacts']=exports[a9_0x5bb0e3(0x1df)]=exports[a9_0x5bb0e3(0x190)]=exports['updateUsageStats']=exports[a9_0x5bb0e3(0x16a)]=exports[a9_0x5bb0e3(0x180)]=exports[a9_0x5bb0e3(0x1ab)]=exports['indexApi']=exports[a9_0x5bb0e3(0x192)]=exports[a9_0x5bb0e3(0x16e)]=exports['listTicketsByTagIsAuth']=exports[a9_0x5bb0e3(0x1a9)]=exports[a9_0x5bb0e3(0x1a5)]=exports[a9_0x5bb0e3(0x150)]=exports[a9_0x5bb0e3(0x198)]=exports[a9_0x5bb0e3(0x176)]=exports[a9_0x5bb0e3(0x1c9)]=exports[a9_0x5bb0e3(0x1b3)]=exports[a9_0x5bb0e3(0x195)]=exports[a9_0x5bb0e3(0x1b9)]=exports[a9_0x5bb0e3(0x188)]=exports[a9_0x5bb0e3(0x1c3)]=exports['blockCompany']=exports[a9_0x5bb0e3(0x194)]=exports['createCompany']=exports[a9_0x5bb0e3(0x221)]=void 0x0;const axios_1=__importDefault(require(a9_0x5bb0e3(0x205))),fs_1=__importDefault(require('fs')),Yup=__importStar(require(a9_0x5bb0e3(0x1be))),lodash_1=require(a9_0x5bb0e3(0x15f)),GetDefaultWhatsApp_1=__importDefault(require(a9_0x5bb0e3(0x21e))),SetTicketMessagesAsRead_1=__importDefault(require(a9_0x5bb0e3(0x1ef))),socket_1=require(a9_0x5bb0e3(0x201)),Whatsapp_1=__importDefault(require('../models/Whatsapp')),Queue_1=__importDefault(require(a9_0x5bb0e3(0x15a))),User_1=__importDefault(require(a9_0x5bb0e3(0x20d))),CreateOrUpdateContactService_1=__importDefault(require(a9_0x5bb0e3(0x197))),FindOrCreateTicketService_1=__importDefault(require('../services/TicketServices/FindOrCreateTicketService')),ShowTicketService_1=__importDefault(require(a9_0x5bb0e3(0x19a))),GetProfilePicUrl_1=__importDefault(require('../services/WbotServices/GetProfilePicUrl')),SendWhatsAppMedia_1=__importDefault(require(a9_0x5bb0e3(0x208))),UpdateTicketService_1=__importDefault(require(a9_0x5bb0e3(0x207))),wbot_1=require('../libs/wbot'),SendWhatsAppMessageLink_1=__importDefault(require(a9_0x5bb0e3(0x1e0))),SendWhatsAppMessageAPI_1=__importDefault(require('../services/WbotServices/SendWhatsAppMessageAPI')),SendWhatsappMediaImage_1=__importDefault(require(a9_0x5bb0e3(0x1c4))),ListInvoicesServices_1=__importDefault(require('../services/InvoicesService/ListInvoicesServices')),ShowInvoiceService_1=__importDefault(require(a9_0x5bb0e3(0x202))),UpdateInvoiceService_1=__importDefault(require('../services/InvoicesService/UpdateInvoiceService')),Invoices_1=__importDefault(require(a9_0x5bb0e3(0x1c6))),ListContactsService_1=__importDefault(require(a9_0x5bb0e3(0x200))),CreateContactService_1=__importDefault(require(a9_0x5bb0e3(0x1ae))),ShowContactService_1=__importDefault(require('../services/ContactServices/ShowContactService')),UpdateContactService_1=__importDefault(require(a9_0x5bb0e3(0x1f3))),DeleteContactService_1=__importDefault(require(a9_0x5bb0e3(0x159))),GetContactService_1=__importDefault(require(a9_0x5bb0e3(0x20c))),ToggleDisableBotService_1=__importDefault(require(a9_0x5bb0e3(0x1cc))),CheckNumber_1=__importDefault(require(a9_0x5bb0e3(0x1fb))),CheckIsValidContact_1=__importDefault(require('../services/WbotServices/CheckIsValidContact')),AppError_1=__importDefault(require(a9_0x5bb0e3(0x16c))),SimpleListService_1=__importDefault(require(a9_0x5bb0e3(0x171))),ImportXLSContactsService_1=require('../services/ContactServices/ImportXLSContactsService'),ApiUsages_1=__importDefault(require(a9_0x5bb0e3(0x151))),useDate_1=require('../utils/useDate'),TicketTag_1=__importDefault(require(a9_0x5bb0e3(0x1eb))),Tag_1=__importDefault(require('../models/Tag')),moment_1=__importDefault(require(a9_0x5bb0e3(0x156))),path_1=__importDefault(require('path')),Ticket_1=__importDefault(require('../models/Ticket')),Contact_1=__importDefault(require(a9_0x5bb0e3(0x1ca))),Company_1=__importDefault(require('../models/Company')),SendPresenceStatus_1=require(a9_0x5bb0e3(0x187));class OnWhatsAppDto{constructor(_0xd445d1,_0x3ef22f){const _0x554c29=a9_0x5bb0e3;this['jid']=_0xd445d1,this[_0x554c29(0x1a2)]=_0x3ef22f;}}exports[a9_0x5bb0e3(0x221)]=OnWhatsAppDto;const CompanySchema=Yup[a9_0x5bb0e3(0x215)]()['shape']({'name':Yup[a9_0x5bb0e3(0x184)]()['required'](),'id':Yup[a9_0x5bb0e3(0x1b7)](),'phone':Yup[a9_0x5bb0e3(0x184)]()[a9_0x5bb0e3(0x1f7)](),'email':Yup['string']()['email']()[a9_0x5bb0e3(0x1f7)](),'status':Yup[a9_0x5bb0e3(0x20f)]()[a9_0x5bb0e3(0x1f7)](),'planId':Yup[a9_0x5bb0e3(0x1b7)]()[a9_0x5bb0e3(0x1f7)](),'campaignsEnabled':Yup['boolean']()[a9_0x5bb0e3(0x1f7)](),'dueDate':Yup[a9_0x5bb0e3(0x179)]()[a9_0x5bb0e3(0x1f7)](),'recurrence':Yup[a9_0x5bb0e3(0x184)]()[a9_0x5bb0e3(0x1f7)]()}),createCompany=async(_0xaf5e59,_0xab2b1d)=>{const _0x1dc49d=a9_0x5bb0e3;try{await CompanySchema[_0x1dc49d(0x1ed)](_0xaf5e59[_0x1dc49d(0x15c)]);const _0x301ae1=await Company_1['default'][_0x1dc49d(0x172)](_0xaf5e59[_0x1dc49d(0x15c)]);_0xab2b1d['status'](0xc9)['json'](_0x301ae1);}catch(_0x34e019){_0xab2b1d[_0x1dc49d(0x1aa)](0x190)[_0x1dc49d(0x1cd)]({'error':_0x34e019[_0x1dc49d(0x203)]});}};exports[a9_0x5bb0e3(0x1f4)]=createCompany;const updateCompany=async(_0x1a6a06,_0x374d96)=>{const _0x4597b8=a9_0x5bb0e3;try{await CompanySchema[_0x4597b8(0x1ed)](_0x1a6a06['body']);const {id:_0x2a024e}=_0x1a6a06[_0x4597b8(0x158)],[_0x47d003]=await Company_1[_0x4597b8(0x14f)][_0x4597b8(0x1d1)](_0x1a6a06[_0x4597b8(0x15c)],{'where':{'id':_0x2a024e}});if(_0x47d003){const _0x39363e=await Company_1[_0x4597b8(0x14f)][_0x4597b8(0x18f)](_0x2a024e);_0x374d96[_0x4597b8(0x1aa)](0xc8)[_0x4597b8(0x1cd)](_0x39363e);}else _0x374d96['status'](0x194)[_0x4597b8(0x1cd)]({'error':_0x4597b8(0x15e)});}catch(_0xbdb27d){_0x374d96[_0x4597b8(0x1aa)](0x190)[_0x4597b8(0x1cd)]({'error':_0xbdb27d[_0x4597b8(0x203)]});}};exports['updateCompany']=updateCompany;const blockCompany=async(_0x449e91,_0x3e772d)=>{const _0x374832=a9_0x5bb0e3;try{const {id:_0x42e817}=_0x449e91['params'],[_0xad29ef]=await Company_1[_0x374832(0x14f)][_0x374832(0x1d1)]({'status':![]},{'where':{'id':_0x42e817}});if(_0xad29ef){const _0x15d4d6=await Company_1[_0x374832(0x14f)][_0x374832(0x18f)](_0x42e817);_0x3e772d['status'](0xc8)[_0x374832(0x1cd)](_0x15d4d6);}else _0x3e772d[_0x374832(0x1aa)](0x194)[_0x374832(0x1cd)]({'error':_0x374832(0x15e)});}catch(_0x599a6f){_0x3e772d[_0x374832(0x1aa)](0x190)[_0x374832(0x1cd)]({'error':_0x599a6f[_0x374832(0x203)]});}};exports[a9_0x5bb0e3(0x1f0)]=blockCompany;const createContact=async(_0x2fe35f,_0x1fd002,_0x569fa5)=>{const _0x290462=a9_0x5bb0e3;await(0x0,CheckIsValidContact_1['default'])(_0x569fa5,_0x1fd002);const _0x4471af=await(0x0,CheckNumber_1['default'])(_0x569fa5,_0x1fd002),_0x1a08c2=await(0x0,GetProfilePicUrl_1[_0x290462(0x14f)])(_0x4471af,_0x1fd002),_0x17d002=_0x4471af,_0x20a316={'name':''+_0x17d002,'number':_0x17d002,'profilePicUrl':_0x1a08c2,'isGroup':![],'companyId':_0x1fd002},_0x537dee=await(0x0,CreateOrUpdateContactService_1[_0x290462(0x14f)])(_0x20a316,null,null);let _0x18c222;if(_0x2fe35f===undefined)_0x18c222=await(0x0,GetDefaultWhatsApp_1[_0x290462(0x14f)])(_0x1fd002);else{_0x18c222=await Whatsapp_1[_0x290462(0x14f)]['findByPk'](_0x2fe35f);if(_0x18c222===null)throw new AppError_1[(_0x290462(0x14f))](_0x290462(0x182)+_0x2fe35f+'\x20not\x20found');}const _0x4ed0ea=await(0x0,FindOrCreateTicketService_1[_0x290462(0x14f)])(_0x537dee,_0x18c222['id'],0x0,_0x1fd002),_0x3eed71=await(0x0,ShowTicketService_1[_0x290462(0x14f)])(_0x4ed0ea['id'],_0x1fd002);return(0x0,SetTicketMessagesAsRead_1[_0x290462(0x14f)])(_0x3eed71),_0x3eed71;};function formatBRNumber(_0x36debf){const _0x2046b5=a9_0x5bb0e3,_0x499082=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x499082[_0x2046b5(0x21f)](_0x36debf)){const _0x35b8ca=_0x499082[_0x2046b5(0x1ac)](_0x36debf);if(_0x35b8ca&&_0x35b8ca[0x1]==='55'&&Number[_0x2046b5(0x14d)](Number['parseInt'](_0x35b8ca[0x2]))){const _0x15670d=Number[_0x2046b5(0x1bd)](_0x35b8ca[0x2]);if(_0x15670d<0x1f)return _0x35b8ca[0x0];else{if(_0x15670d>=0x1f)return _0x35b8ca[0x1]+_0x35b8ca[0x2]+_0x35b8ca[0x3];}}}else return _0x36debf;}function createJid(_0x321ac7){const _0xfab808=a9_0x5bb0e3;if(_0x321ac7[_0xfab808(0x189)]('@g.us')||_0x321ac7[_0xfab808(0x189)]('@s.whatsapp.net'))return formatBRNumber(_0x321ac7);return _0x321ac7[_0xfab808(0x189)]('-')?_0x321ac7+_0xfab808(0x1af):formatBRNumber(_0x321ac7)+'@s.whatsapp.net';}const indexLink=async(_0x723dd6,_0x537ae0)=>{const _0x5ad637=a9_0x5bb0e3,_0x2fa324=_0x723dd6['body'],{whatsappId:_0x50107a}=_0x723dd6[_0x5ad637(0x15c)],{msdelay:_0x51f07c}=_0x723dd6['body'],_0x5e60ae=_0x723dd6['body']['url'],_0x3b133a=_0x723dd6[_0x5ad637(0x15c)][_0x5ad637(0x1de)],_0x1f11be=_0x723dd6[_0x5ad637(0x15b)][_0x5ad637(0x1a0)],[,_0x50c482]=_0x1f11be[_0x5ad637(0x1d0)]('\x20'),_0x22242e=await Whatsapp_1[_0x5ad637(0x14f)][_0x5ad637(0x1f6)]({'where':{'token':_0x50c482}}),_0x3df6cb=_0x22242e[_0x5ad637(0x17a)];_0x2fa324['number']=_0x2fa324['number'][_0x5ad637(0x1d2)]('-','')['replace']('\x20','');const _0x5e022a=Yup[_0x5ad637(0x215)]()[_0x5ad637(0x1cf)]({'number':Yup[_0x5ad637(0x184)]()[_0x5ad637(0x1ba)]()[_0x5ad637(0x1f8)](/^\d+$/,_0x5ad637(0x14e))});try{await _0x5e022a[_0x5ad637(0x1ed)](_0x2fa324);}catch(_0x4a3fd8){throw new AppError_1[(_0x5ad637(0x14f))](_0x4a3fd8['message']);}const _0x174309=await createContact(_0x50107a,_0x3df6cb,_0x2fa324['number']);return await(0x0,SendWhatsAppMessageLink_1[_0x5ad637(0x14f)])({'ticket':_0x174309,'url':_0x5e60ae,'caption':_0x3b133a,'msdelay':_0x51f07c}),setTimeout(async()=>{await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x174309['id'],'ticketData':{'status':'pending','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x3df6cb});},0xc8),setTimeout(async()=>{const _0x1a9071=_0x5ad637,{dateToClient:_0x79737d}=(0x0,useDate_1[_0x1a9071(0x211)])(),_0x45d6a5=_0x79737d(new Date()[_0x1a9071(0x1d9)]()),_0x427cbd=(0x0,moment_1[_0x1a9071(0x14f)])()[_0x1a9071(0x19d)](),_0xa65bd9=await ApiUsages_1['default'][_0x1a9071(0x1f6)]({'where':{'dateUsed':_0x45d6a5,'companyId':_0x3df6cb}});if(_0xa65bd9)await _0xa65bd9[_0x1a9071(0x1d1)]({'usedPDF':_0xa65bd9['dataValues']['usedPDF']+0x1,'UsedOnDay':_0xa65bd9[_0x1a9071(0x1e5)][_0x1a9071(0x219)]+0x1,'updatedAt':_0x427cbd});else{const _0x293be4=await ApiUsages_1[_0x1a9071(0x14f)][_0x1a9071(0x172)]({'companyId':_0x3df6cb,'dateUsed':_0x45d6a5});await _0x293be4[_0x1a9071(0x1d1)]({'usedPDF':_0x293be4[_0x1a9071(0x1e5)]['usedPDF']+0x1,'UsedOnDay':_0x293be4['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x427cbd});}},0x64),_0x537ae0['send']({'status':'SUCCESS'});};exports[a9_0x5bb0e3(0x1c3)]=indexLink;const index=async(_0x496ade,_0xfb5779)=>{const _0x3404b4=a9_0x5bb0e3,_0x5855b5=_0x496ade['body'],{whatsappId:_0x4dffd6}=_0x496ade['body'],{msdelay:_0x3f17c0}=_0x496ade['body'],{body:_0x557f8b,quotedMsg:_0x399600}=_0x496ade[_0x3404b4(0x15c)],_0x4ac929=_0x496ade[_0x3404b4(0x1e2)],_0x570671=_0x496ade[_0x3404b4(0x15b)][_0x3404b4(0x1a0)],[,_0x2e5359]=_0x570671['split']('\x20'),_0x417df3=await Whatsapp_1[_0x3404b4(0x14f)][_0x3404b4(0x1f6)]({'where':{'token':_0x2e5359}}),_0x2b688d=_0x417df3[_0x3404b4(0x17a)];_0x5855b5['number']=_0x5855b5[_0x3404b4(0x1b7)][_0x3404b4(0x1d2)]('-','')[_0x3404b4(0x1d2)]('\x20','');const _0x277d9c=Yup[_0x3404b4(0x215)]()[_0x3404b4(0x1cf)]({'number':Yup[_0x3404b4(0x184)]()[_0x3404b4(0x1ba)]()[_0x3404b4(0x1f8)](/^\d+$/,_0x3404b4(0x14e))});try{await _0x277d9c['validate'](_0x5855b5);}catch(_0x7825fc){throw new AppError_1[(_0x3404b4(0x14f))](_0x7825fc[_0x3404b4(0x203)]);}const _0x591b5b=await createContact(_0x4dffd6,_0x2b688d,_0x5855b5['number']);return _0x4ac929?await Promise[_0x3404b4(0x173)](_0x4ac929[_0x3404b4(0x1d4)](async _0x258599=>{const _0x1b611c=_0x3404b4;await(0x0,SendWhatsAppMedia_1[_0x1b611c(0x14f)])({'body':_0x557f8b,'media':_0x258599,'ticket':_0x591b5b});})):await(0x0,SendWhatsAppMessageAPI_1[_0x3404b4(0x14f)])({'body':_0x557f8b,'ticket':_0x591b5b,'quotedMsg':_0x399600,'msdelay':_0x3f17c0}),setTimeout(async()=>{const _0x4f370b=_0x3404b4;await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x591b5b['id'],'ticketData':{'status':_0x4f370b(0x193),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x2b688d});},0x64),setTimeout(async()=>{const _0x3b7137=_0x3404b4,{dateToClient:_0x4c23fe}=(0x0,useDate_1['useDate'])(),_0x3a9f1d=_0x4c23fe(new Date()[_0x3b7137(0x1d9)]()),_0x381c0d=(0x0,moment_1[_0x3b7137(0x14f)])()[_0x3b7137(0x19d)](),_0x962990=await ApiUsages_1[_0x3b7137(0x14f)][_0x3b7137(0x1f6)]({'where':{'dateUsed':_0x3a9f1d,'companyId':_0x2b688d}});_0x962990?_0x4ac929?await Promise['all'](_0x4ac929[_0x3b7137(0x1d4)](async _0x2d205a=>{const _0x2e78be=_0x3b7137;console['log']('media',_0x2d205a);const _0x1480bb=path_1[_0x2e78be(0x14f)][_0x2e78be(0x21b)](_0x2d205a[_0x2e78be(0x1e4)]);console['log'](_0x2e78be(0x1a3),_0x1480bb);if(_0x2d205a[_0x2e78be(0x1bc)][_0x2e78be(0x189)](_0x2e78be(0x1d3)))await _0x962990['update']({'usedPDF':_0x962990[_0x2e78be(0x1e5)]['usedPDF']+0x1,'UsedOnDay':_0x962990['dataValues'][_0x2e78be(0x219)]+0x1,'updatedAt':_0x381c0d});else{if(_0x2d205a[_0x2e78be(0x1bc)][_0x2e78be(0x189)](_0x2e78be(0x14c)))await _0x962990['update']({'usedImage':_0x962990[_0x2e78be(0x1e5)]['usedImage']+0x1,'UsedOnDay':_0x962990[_0x2e78be(0x1e5)][_0x2e78be(0x219)]+0x1,'updatedAt':_0x381c0d});else _0x2d205a['mimetype'][_0x2e78be(0x189)](_0x2e78be(0x170))?await _0x962990[_0x2e78be(0x1d1)]({'usedVideo':_0x962990[_0x2e78be(0x1e5)][_0x2e78be(0x213)]+0x1,'UsedOnDay':_0x962990[_0x2e78be(0x1e5)][_0x2e78be(0x219)]+0x1,'updatedAt':_0x381c0d}):await _0x962990[_0x2e78be(0x1d1)]({'usedOther':_0x962990[_0x2e78be(0x1e5)][_0x2e78be(0x21c)]+0x1,'UsedOnDay':_0x962990[_0x2e78be(0x1e5)]['UsedOnDay']+0x1,'updatedAt':_0x381c0d});}})):await _0x962990[_0x3b7137(0x1d1)]({'usedText':_0x962990[_0x3b7137(0x1e5)]['usedText']+0x1,'UsedOnDay':_0x962990['dataValues'][_0x3b7137(0x219)]+0x1,'updatedAt':_0x381c0d}):(await ApiUsages_1[_0x3b7137(0x14f)]['create']({'companyId':_0x2b688d,'dateUsed':_0x3a9f1d}),_0x4ac929?await Promise[_0x3b7137(0x173)](_0x4ac929['map'](async _0x307b90=>{const _0x313154=_0x3b7137;console['log'](_0x313154(0x1cb),_0x307b90);const _0xbc27ff=path_1[_0x313154(0x14f)][_0x313154(0x21b)](_0x307b90[_0x313154(0x1e4)]);console['log'](_0x313154(0x1a3),_0xbc27ff);if(_0x307b90['mimetype'][_0x313154(0x189)](_0x313154(0x1d3)))await _0x962990[_0x313154(0x1d1)]({'usedPDF':_0x962990[_0x313154(0x1e5)]['usedPDF']+0x1,'UsedOnDay':_0x962990['dataValues'][_0x313154(0x219)]+0x1,'updatedAt':_0x381c0d});else{if(_0x307b90[_0x313154(0x1bc)][_0x313154(0x189)](_0x313154(0x14c)))await _0x962990[_0x313154(0x1d1)]({'usedImage':_0x962990[_0x313154(0x1e5)][_0x313154(0x1b0)]+0x1,'UsedOnDay':_0x962990[_0x313154(0x1e5)][_0x313154(0x219)]+0x1,'updatedAt':_0x381c0d});else _0x307b90[_0x313154(0x1bc)][_0x313154(0x189)]('video')?await _0x962990[_0x313154(0x1d1)]({'usedVideo':_0x962990[_0x313154(0x1e5)]['usedVideo']+0x1,'UsedOnDay':_0x962990[_0x313154(0x1e5)][_0x313154(0x219)]+0x1,'updatedAt':_0x381c0d}):await _0x962990[_0x313154(0x1d1)]({'usedOther':_0x962990['dataValues'][_0x313154(0x21c)]+0x1,'UsedOnDay':_0x962990[_0x313154(0x1e5)][_0x313154(0x219)]+0x1,'updatedAt':_0x381c0d});}})):await _0x962990[_0x3b7137(0x1d1)]({'usedText':_0x962990[_0x3b7137(0x1e5)]['usedText']+0x1,'UsedOnDay':_0x962990[_0x3b7137(0x1e5)][_0x3b7137(0x219)]+0x1,'updatedAt':_0x381c0d}));},0x64),_0xfb5779['send']({'status':_0x3404b4(0x166)});};exports[a9_0x5bb0e3(0x188)]=index;const indexImage=async(_0x48d84a,_0x12231d)=>{const _0x3dc701=a9_0x5bb0e3,_0x5dc679=_0x48d84a[_0x3dc701(0x15c)],{whatsappId:_0x527193}=_0x48d84a[_0x3dc701(0x15c)],{msdelay:_0x46000d}=_0x48d84a[_0x3dc701(0x15c)],_0x5f5909=_0x48d84a[_0x3dc701(0x15c)]['url'],_0x4a6ff7=_0x48d84a[_0x3dc701(0x15c)][_0x3dc701(0x1de)],_0x413c2e=_0x48d84a[_0x3dc701(0x15b)][_0x3dc701(0x1a0)],[,_0x3678f7]=_0x413c2e[_0x3dc701(0x1d0)]('\x20'),_0x3685c4=await Whatsapp_1[_0x3dc701(0x14f)][_0x3dc701(0x1f6)]({'where':{'token':_0x3678f7}}),_0xebc88a=_0x3685c4[_0x3dc701(0x17a)];_0x5dc679[_0x3dc701(0x1b7)]=_0x5dc679[_0x3dc701(0x1b7)][_0x3dc701(0x1d2)]('-','')['replace']('\x20','');const _0x1c8fca=Yup[_0x3dc701(0x215)]()['shape']({'number':Yup[_0x3dc701(0x184)]()['required']()[_0x3dc701(0x1f8)](/^\d+$/,_0x3dc701(0x14e))});try{await _0x1c8fca[_0x3dc701(0x1ed)](_0x5dc679);}catch(_0x1d22ed){throw new AppError_1[(_0x3dc701(0x14f))](_0x1d22ed[_0x3dc701(0x203)]);}const _0x4de695=await createContact(_0x527193,_0xebc88a,_0x5dc679[_0x3dc701(0x1b7)]);return _0x5f5909&&await(0x0,SendWhatsappMediaImage_1['default'])({'ticket':_0x4de695,'url':_0x5f5909,'caption':_0x4a6ff7,'msdelay':_0x46000d}),setTimeout(async()=>{const _0x59dbd4=_0x3dc701;await(0x0,UpdateTicketService_1[_0x59dbd4(0x14f)])({'ticketId':_0x4de695['id'],'ticketData':{'status':_0x59dbd4(0x193),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0xebc88a});},0x64),setTimeout(async()=>{const _0x5ed0a3=_0x3dc701,{dateToClient:_0x1a1067}=(0x0,useDate_1[_0x5ed0a3(0x211)])(),_0x35393a=_0x1a1067(new Date()['toString']()),_0x419ff5=(0x0,moment_1[_0x5ed0a3(0x14f)])()[_0x5ed0a3(0x19d)](),_0x3c8f40=await ApiUsages_1[_0x5ed0a3(0x14f)]['findOne']({'where':{'dateUsed':_0x35393a,'companyId':_0xebc88a}});if(_0x3c8f40)await _0x3c8f40[_0x5ed0a3(0x1d1)]({'usedImage':_0x3c8f40[_0x5ed0a3(0x1e5)][_0x5ed0a3(0x1b0)]+0x1,'UsedOnDay':_0x3c8f40[_0x5ed0a3(0x1e5)]['UsedOnDay']+0x1,'updatedAt':_0x419ff5});else{const _0x54906d=await ApiUsages_1[_0x5ed0a3(0x14f)][_0x5ed0a3(0x172)]({'companyId':_0xebc88a,'dateUsed':_0x35393a});await _0x54906d[_0x5ed0a3(0x1d1)]({'usedImage':_0x54906d[_0x5ed0a3(0x1e5)][_0x5ed0a3(0x1b0)]+0x1,'UsedOnDay':_0x54906d[_0x5ed0a3(0x1e5)][_0x5ed0a3(0x219)]+0x1,'updatedAt':_0x419ff5});}},0x64),_0x12231d[_0x3dc701(0x1bb)]({'status':_0x3dc701(0x166)});};exports[a9_0x5bb0e3(0x1b9)]=indexImage;const checkNumber=async(_0x185a08,_0x2a8a5f)=>{const _0x4d6326=a9_0x5bb0e3,_0x2e8d2b=_0x185a08[_0x4d6326(0x15c)],_0x3120ef=_0x185a08[_0x4d6326(0x15b)][_0x4d6326(0x1a0)],[,_0x3eff90]=_0x3120ef[_0x4d6326(0x1d0)]('\x20'),_0x51d69f=await Whatsapp_1[_0x4d6326(0x14f)][_0x4d6326(0x1f6)]({'where':{'token':_0x3eff90}}),_0xd358ed=_0x51d69f['companyId'],_0x3c37d9=_0x2e8d2b[_0x4d6326(0x1b7)][_0x4d6326(0x1d2)]('-','')[_0x4d6326(0x1d2)]('\x20',''),_0x449e4b=await(0x0,GetDefaultWhatsApp_1[_0x4d6326(0x14f)])(_0xd358ed),_0x30c63f=(0x0,wbot_1[_0x4d6326(0x1f1)])(_0x449e4b['id']),_0x75196d=createJid(_0x3c37d9);try{const [_0x111ffc]=await _0x30c63f['onWhatsApp'](_0x75196d);if(_0x111ffc[_0x4d6326(0x1a2)])return setTimeout(async()=>{const _0x9a84aa=_0x4d6326,{dateToClient:_0x316483}=(0x0,useDate_1[_0x9a84aa(0x211)])(),_0x26e588=_0x316483(new Date()[_0x9a84aa(0x1d9)]()),_0x196958=(0x0,moment_1[_0x9a84aa(0x14f)])()[_0x9a84aa(0x19d)](),_0xad6e0a=await ApiUsages_1[_0x9a84aa(0x14f)][_0x9a84aa(0x1f6)]({'where':{'dateUsed':_0x26e588,'companyId':_0xd358ed}});if(_0xad6e0a)await _0xad6e0a['update']({'usedCheckNumber':_0xad6e0a['dataValues']['usedCheckNumber']+0x1,'UsedOnDay':_0xad6e0a['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x196958});else{const _0x2b7d25=await ApiUsages_1['default'][_0x9a84aa(0x172)]({'companyId':_0xd358ed,'dateUsed':_0x26e588});await _0x2b7d25[_0x9a84aa(0x1d1)]({'usedCheckNumber':_0x2b7d25['dataValues']['usedCheckNumber']+0x1,'UsedOnDay':_0x2b7d25['dataValues'][_0x9a84aa(0x219)]+0x1,'updatedAt':_0x196958});}},0x64),_0x2a8a5f[_0x4d6326(0x1aa)](0xc8)[_0x4d6326(0x1cd)]({'existsInWhatsapp':!![],'number':_0x3c37d9,'numberFormatted':_0x111ffc[_0x4d6326(0x20a)]});}catch(_0x55eab5){return _0x2a8a5f[_0x4d6326(0x1aa)](0x190)[_0x4d6326(0x1cd)]({'existsInWhatsapp':![],'number':_0x75196d,'error':_0x4d6326(0x21a)});}};exports['checkNumber']=checkNumber;const indexWhatsappsId=async(_0x21f5ac,_0x42c93e)=>{const _0x2017b7=a9_0x5bb0e3;return console[_0x2017b7(0x20b)](_0x2017b7(0x1e3),_0x21f5ac),console[_0x2017b7(0x20b)](_0x2017b7(0x1e3),_0x21f5ac[_0x2017b7(0x19e)]),_0x42c93e[_0x2017b7(0x1aa)](0xc8)[_0x2017b7(0x1cd)]('oi');};exports['indexWhatsappsId']=indexWhatsappsId;const updateQueueId=async(_0x106aa9,_0x43714f)=>{const _0xed975a=a9_0x5bb0e3,{ticketId:_0x52705e}=_0x106aa9[_0xed975a(0x158)],{queueId:_0x578978}=_0x106aa9['body'],_0x295afb=_0x106aa9[_0xed975a(0x15b)][_0xed975a(0x1a0)],[,_0x1cafdf]=_0x295afb[_0xed975a(0x1d0)]('\x20'),_0x1a83ba=await Whatsapp_1['default'][_0xed975a(0x1f6)]({'where':{'token':_0x1cafdf}}),_0x256471=_0x1a83ba['companyId'];try{const _0x1f2dcc=await Queue_1['default'][_0xed975a(0x1f6)]({'where':{'id':_0x578978,'companyId':_0x256471}});if(!_0x1f2dcc)return _0x43714f[_0xed975a(0x1aa)](0x190)[_0xed975a(0x1cd)]({'status':'ERROR','error':_0xed975a(0x1dc)});return await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x52705e,'ticketData':{'queueId':_0x578978},'companyId':_0x256471}),_0x43714f['status'](0xc8)[_0xed975a(0x1cd)]({'status':_0xed975a(0x166)});}catch(_0x177812){return console[_0xed975a(0x1a7)](_0x177812),_0x43714f[_0xed975a(0x1aa)](0x1f4)['json']({'status':_0xed975a(0x1fe),'error':'Internal\x20Server\x20Error'});}};exports[a9_0x5bb0e3(0x1c9)]=updateQueueId;const closeTicket=async(_0x5eb88e,_0x3a75e2)=>{const _0x4c196d=a9_0x5bb0e3,_0x3a6d1a=_0x5eb88e[_0x4c196d(0x15b)]['authorization'],[,_0x43e570]=_0x3a6d1a['split']('\x20'),_0x58b43a=await Whatsapp_1[_0x4c196d(0x14f)][_0x4c196d(0x1f6)]({'where':{'token':_0x43e570}}),_0x5d1187=_0x58b43a[_0x4c196d(0x17a)],{ticketId:_0x29cfd8}=_0x5eb88e[_0x4c196d(0x158)],_0x5ace01=await(0x0,ShowTicketService_1['default'])(_0x29cfd8,_0x5d1187);_0x5ace01['status']=_0x5eb88e[_0x4c196d(0x15c)][_0x4c196d(0x1c1)][_0x4c196d(0x1aa)],console[_0x4c196d(0x20b)](_0x5ace01['status']);const {ticket:_0x556782}=await(0x0,UpdateTicketService_1['default'])({'ticketData':_0x5ace01,'ticketId':_0x29cfd8,'companyId':_0x5d1187});return _0x3a75e2[_0x4c196d(0x1aa)](0xc8)['json'](_0x556782);};exports[a9_0x5bb0e3(0x176)]=closeTicket;const updateTicketTag=async(_0x186a67,_0x2fc8da)=>{const _0x46ff01=a9_0x5bb0e3,{ticketId:_0x5a0554,tagId:_0x10f90c}=_0x186a67['body'],_0x2f16f2=_0x186a67[_0x46ff01(0x15b)][_0x46ff01(0x1a0)],[,_0x3473d3]=_0x2f16f2[_0x46ff01(0x1d0)]('\x20');try{const _0xd8dca7=await Whatsapp_1['default']['findOne']({'where':{'token':_0x3473d3}}),_0x3fe03d=_0xd8dca7[_0x46ff01(0x17a)],_0x5cd0c4=await Tag_1['default'][_0x46ff01(0x1f6)]({'where':{'id':_0x10f90c,'companyId':_0x3fe03d}});if(!_0x5cd0c4)return _0x2fc8da['status'](0x190)[_0x46ff01(0x1cd)]({'status':'ERROR','error':_0x46ff01(0x20e)});const _0x258560=await TicketTag_1[_0x46ff01(0x14f)][_0x46ff01(0x1f6)]({'where':{'ticketId':_0x5a0554,'tagId':_0x10f90c}});if(_0x258560)return _0x2fc8da[_0x46ff01(0x1aa)](0x190)[_0x46ff01(0x1cd)]({'status':_0x46ff01(0x1fe),'error':_0x46ff01(0x199)});const _0x4153b9=await TicketTag_1[_0x46ff01(0x14f)][_0x46ff01(0x172)]({'ticketId':_0x5a0554,'tagId':_0x10f90c});return _0x2fc8da[_0x46ff01(0x1aa)](0xc8)[_0x46ff01(0x1cd)]({'status':_0x46ff01(0x166),'ticketTag':_0x4153b9});}catch(_0x56f5c1){return console[_0x46ff01(0x1a7)](_0x56f5c1),_0x2fc8da[_0x46ff01(0x1aa)](0x1f4)[_0x46ff01(0x1cd)]({'status':_0x46ff01(0x1fe),'error':_0x46ff01(0x1dd)});}};exports[a9_0x5bb0e3(0x198)]=updateTicketTag;const removeTicketTag=async(_0x46fd0b,_0x267e88)=>{const _0x235296=a9_0x5bb0e3,{ticketId:_0x5b7852,tagId:_0x41133f}=_0x46fd0b['body'];try{const _0x55ddfc=await TicketTag_1['default']['findOne']({'where':{'ticketId':_0x5b7852,'tagId':_0x41133f}});if(!_0x55ddfc)return _0x267e88[_0x235296(0x1aa)](0x190)[_0x235296(0x1cd)]({'status':_0x235296(0x1fe),'error':'Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket'});return await _0x55ddfc[_0x235296(0x1c2)](),_0x267e88['status'](0xc8)[_0x235296(0x1cd)]({'status':_0x235296(0x166)});}catch(_0x54a123){return console[_0x235296(0x1a7)](_0x54a123),_0x267e88['status'](0x1f4)['json']({'status':'ERROR','error':'Failed\x20to\x20remove\x20ticket\x20tag'});}};exports[a9_0x5bb0e3(0x150)]=removeTicketTag;const listTicketsByCompany=async(_0x283ae6,_0x1505b9)=>{const _0x453faf=a9_0x5bb0e3,_0x117b75=_0x283ae6['headers'][_0x453faf(0x1a0)],[,_0x579f23]=_0x117b75[_0x453faf(0x1d0)]('\x20'),_0x22909c=await Whatsapp_1[_0x453faf(0x14f)][_0x453faf(0x1f6)]({'where':{'token':_0x579f23}}),_0x1a404e=_0x22909c[_0x453faf(0x17a)];try{const _0xc00999=await Ticket_1[_0x453faf(0x14f)][_0x453faf(0x1fd)]({'where':{'companyId':_0x1a404e},'include':[{'model':Contact_1[_0x453faf(0x14f)],'as':_0x453faf(0x16d),'attributes':['id','name','number',_0x453faf(0x1db),_0x453faf(0x1c5),_0x453faf(0x1a8),'active',_0x453faf(0x1ff)],'include':[_0x453faf(0x216)]},{'model':Queue_1[_0x453faf(0x14f)],'as':'queue','attributes':['id',_0x453faf(0x177),_0x453faf(0x153)]},{'model':User_1[_0x453faf(0x14f)],'as':_0x453faf(0x19e),'attributes':['id','name']},{'model':Tag_1[_0x453faf(0x14f)],'as':_0x453faf(0x169),'attributes':['id',_0x453faf(0x177),_0x453faf(0x153)]},{'model':Whatsapp_1['default'],'as':_0x453faf(0x1e7),'attributes':[_0x453faf(0x177),_0x453faf(0x1d5),'facebookUserId']},{'model':Company_1[_0x453faf(0x14f)],'as':_0x453faf(0x1e6),'attributes':[_0x453faf(0x177)]}]});return _0x1505b9[_0x453faf(0x1aa)](0xc8)[_0x453faf(0x1cd)]({'status':_0x453faf(0x166),'tickets':_0xc00999});}catch(_0x130f31){return console[_0x453faf(0x1a7)](_0x130f31),_0x1505b9['status'](0x1f4)[_0x453faf(0x1cd)]({'status':_0x453faf(0x1fe),'error':'Internal\x20Server\x20Error'});}};exports[a9_0x5bb0e3(0x1a5)]=listTicketsByCompany;const listTicketsByTag=async(_0x5a7b3e,_0x1dcbf8)=>{const _0x16d330=a9_0x5bb0e3,{tagId:_0x1b6c64}=_0x5a7b3e[_0x16d330(0x158)],_0x29833a=_0x5a7b3e[_0x16d330(0x15b)][_0x16d330(0x1a0)],[,_0x146093]=_0x29833a['split']('\x20');try{const _0x32512c=await Whatsapp_1[_0x16d330(0x14f)][_0x16d330(0x1f6)]({'where':{'token':_0x146093}}),_0x40e276=_0x32512c[_0x16d330(0x17a)],_0x3aef32=await Tag_1[_0x16d330(0x14f)][_0x16d330(0x1f6)]({'where':{'id':_0x1b6c64,'companyId':_0x40e276}});if(!_0x3aef32)return _0x1dcbf8[_0x16d330(0x1aa)](0x190)['json']({'status':_0x16d330(0x1fe),'error':_0x16d330(0x20e)});const _0x2a5a53=await Ticket_1[_0x16d330(0x14f)][_0x16d330(0x1fd)]({'include':[{'model':Tag_1[_0x16d330(0x14f)],'as':_0x16d330(0x169),'attributes':['id',_0x16d330(0x177)],'through':{'attributes':[],'where':{'tagId':_0x1b6c64}}},{'model':Contact_1['default'],'as':'contact','attributes':['id',_0x16d330(0x177),_0x16d330(0x1b7),_0x16d330(0x1db),_0x16d330(0x1c5),_0x16d330(0x1a8),_0x16d330(0x1a1),'disableBot'],'include':[_0x16d330(0x216)]},{'model':Queue_1['default'],'as':_0x16d330(0x17f),'attributes':['id','name',_0x16d330(0x153)]},{'model':User_1[_0x16d330(0x14f)],'as':_0x16d330(0x19e),'attributes':['id',_0x16d330(0x177)]},{'model':Whatsapp_1['default'],'as':_0x16d330(0x1e7),'attributes':[_0x16d330(0x177),_0x16d330(0x1d5),_0x16d330(0x163)]},{'model':Company_1['default'],'as':'company','attributes':[_0x16d330(0x177)]}],'where':{'companyId':_0x40e276,'$tags.id$':_0x1b6c64}});return _0x1dcbf8[_0x16d330(0x1aa)](0xc8)[_0x16d330(0x1cd)]({'status':_0x16d330(0x166),'tickets':_0x2a5a53});}catch(_0x1fb6dd){return console[_0x16d330(0x1a7)](_0x1fb6dd),_0x1dcbf8['status'](0x1f4)[_0x16d330(0x1cd)]({'status':_0x16d330(0x1fe),'error':_0x16d330(0x18d)});}};exports[a9_0x5bb0e3(0x1a9)]=listTicketsByTag;const listTicketsByTagIsAuth=async(_0x2b3773,_0x437369)=>{const _0x269570=a9_0x5bb0e3,{tagId:_0x2347ed}=_0x2b3773[_0x269570(0x158)];try{const _0x59dbba=await Ticket_1[_0x269570(0x14f)]['findAll']({'include':[{'model':Contact_1[_0x269570(0x14f)],'as':'contact','attributes':['name',_0x269570(0x1b7),_0x269570(0x1db)],'include':[_0x269570(0x216)]},{'model':Tag_1[_0x269570(0x14f)],'as':_0x269570(0x169),'attributes':['id','name',_0x269570(0x153)],'where':{'id':_0x2347ed}},{'model':Whatsapp_1[_0x269570(0x14f)],'as':_0x269570(0x1e7),'attributes':['name',_0x269570(0x1d5),'facebookUserId']},{'model':Company_1[_0x269570(0x14f)],'as':_0x269570(0x1e6),'attributes':[_0x269570(0x177)]}]});return _0x437369['status'](0xc8)[_0x269570(0x1cd)]({'status':'SUCCESS','tickets':_0x59dbba});}catch(_0x184bd2){return console['error'](_0x184bd2),_0x437369[_0x269570(0x1aa)](0x1f4)[_0x269570(0x1cd)]({'status':_0x269570(0x1fe),'error':_0x269570(0x18d)});}};exports[a9_0x5bb0e3(0x1b2)]=listTicketsByTagIsAuth;function makeid(_0x22b5f3){const _0x1a7432=a9_0x5bb0e3;var _0x533e85='',_0xefb84e=_0x1a7432(0x17b),_0x2b3f7d=_0xefb84e[_0x1a7432(0x18a)];for(var _0x7418cb=0x0;_0x7418cb<_0x22b5f3;_0x7418cb++){_0x533e85+=_0xefb84e[_0x1a7432(0x1ce)](Math[_0x1a7432(0x1d8)](Math['random']()*_0x2b3f7d));}return _0x533e85;}exports[a9_0x5bb0e3(0x16e)]=makeid;const handleAudioLink=async(_0x23f058,_0x34fe90)=>{const _0xfb63e4=a9_0x5bb0e3,{link:_0x3fa59b,contactNumber:_0x2d24a2}=_0x23f058[_0xfb63e4(0x15c)];try{const _0x4d4a04=_0x23f058[_0xfb63e4(0x15b)][_0xfb63e4(0x1a0)],[,_0x2ee4d0]=_0x4d4a04['split']('\x20'),_0x55a34e=await Whatsapp_1[_0xfb63e4(0x14f)][_0xfb63e4(0x1f6)]({'where':{'token':_0x2ee4d0}}),_0x2f1d02=_0x55a34e[_0xfb63e4(0x17a)],_0x5b544f=await(0x0,GetDefaultWhatsApp_1[_0xfb63e4(0x14f)])(_0x2f1d02),_0x3689f8=(0x0,wbot_1[_0xfb63e4(0x1f1)])(_0x5b544f['id']),_0x2c3a37=_0xfb63e4(0x1bf)+_0x2f1d02+'/'+makeid(0xa)+_0xfb63e4(0x19f);if(!_0x55a34e)return _0x34fe90[_0xfb63e4(0x1aa)](0x191)[_0xfb63e4(0x1cd)]({'status':_0xfb63e4(0x160),'error':_0xfb63e4(0x217)});const _0x582b35=await axios_1[_0xfb63e4(0x14f)][_0xfb63e4(0x1f5)](_0x3fa59b,{'responseType':_0xfb63e4(0x185)});fs_1[_0xfb63e4(0x14f)][_0xfb63e4(0x154)](_0x2c3a37,Buffer[_0xfb63e4(0x1d7)](_0x582b35[_0xfb63e4(0x186)]));const _0x651823=_0xfb63e4(0x220);return await(0x0,SendPresenceStatus_1[_0xfb63e4(0x1c8)])(_0x3689f8,_0x2d24a2),await _0x3689f8[_0xfb63e4(0x1ea)](_0x2d24a2+_0xfb63e4(0x157),{'audio':fs_1[_0xfb63e4(0x14f)][_0xfb63e4(0x1d6)](_0x2c3a37),'fileName':_0x651823,'caption':_0x651823,'mimetype':'audio/mp4','ptt':!![]}),_0x34fe90[_0xfb63e4(0x1aa)](0xc8)[_0xfb63e4(0x1cd)]({'status':'SUCESSO'});}catch(_0x5612a6){return console[_0xfb63e4(0x1a7)](_0x5612a6),_0x34fe90[_0xfb63e4(0x1aa)](0x1f4)[_0xfb63e4(0x1cd)]({'status':_0xfb63e4(0x160),'error':'Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio'});}};exports[a9_0x5bb0e3(0x192)]=handleAudioLink;const indexApi=async(_0x17ef3d,_0x521aa1)=>{const _0x1419fe=a9_0x5bb0e3,_0x22b892=_0x17ef3d[_0x1419fe(0x15b)]['authorization'],[,_0x46af6e]=_0x22b892[_0x1419fe(0x1d0)]('\x20'),_0x2e2cb0=await Whatsapp_1[_0x1419fe(0x14f)][_0x1419fe(0x1f6)]({'where':{'token':_0x46af6e}}),_0x3b96de=_0x2e2cb0[_0x1419fe(0x17a)],{searchParam:_0x37fa64,pageNumber:_0x4bfc2b}=_0x17ef3d[_0x1419fe(0x204)];if(_0x3b96de===0x1){const {invoices:_0x319754,count:_0x4c14a1,hasMore:_0x219108}=await(0x0,ListInvoicesServices_1['default'])({'searchParam':_0x37fa64,'pageNumber':_0x4bfc2b});return _0x521aa1['json']({'invoices':_0x319754,'count':_0x4c14a1,'hasMore':_0x219108});}else return _0x521aa1['status'](0x191)[_0x1419fe(0x1cd)]({'status':_0x1419fe(0x160),'error':'Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.'});};exports[a9_0x5bb0e3(0x191)]=indexApi;const showApi=async(_0x4ec0ae,_0x5157de)=>{const _0x5a8190=a9_0x5bb0e3,_0x3c93a3=_0x4ec0ae[_0x5a8190(0x15b)][_0x5a8190(0x1a0)],[,_0x176c65]=_0x3c93a3[_0x5a8190(0x1d0)]('\x20'),_0x29b2a0=await Whatsapp_1[_0x5a8190(0x14f)][_0x5a8190(0x1f6)]({'where':{'token':_0x176c65}}),_0x55f182=_0x29b2a0[_0x5a8190(0x17a)],{Invoiceid:_0x3fdbd8}=_0x4ec0ae[_0x5a8190(0x158)],_0x330efb=await(0x0,ShowInvoiceService_1[_0x5a8190(0x14f)])(_0x3fdbd8);return _0x5157de['status'](0xc8)[_0x5a8190(0x1cd)](_0x330efb);};exports['showApi']=showApi;const showAllApi=async(_0x34be3b,_0x1b51d1)=>{const _0x49d42c=a9_0x5bb0e3;try{const _0x48886a=_0x34be3b[_0x49d42c(0x15b)][_0x49d42c(0x1a0)],[,_0x483a31]=_0x48886a[_0x49d42c(0x1d0)]('\x20'),_0x251a01=await Whatsapp_1[_0x49d42c(0x14f)][_0x49d42c(0x1f6)]({'where':{'token':_0x483a31}}),_0x2dbe32=_0x251a01[_0x49d42c(0x17a)],{companyId:_0x20372d,status:_0x28da5c}=_0x34be3b[_0x49d42c(0x15c)];if(_0x2dbe32===0x1){const _0x364fe3=await Invoices_1['default'][_0x49d42c(0x1fd)]({'where':{'companyId':_0x20372d,'status':_0x28da5c}});return _0x1b51d1[_0x49d42c(0x1aa)](0xc8)[_0x49d42c(0x1cd)](_0x364fe3);}else return _0x1b51d1[_0x49d42c(0x1aa)](0x191)[_0x49d42c(0x1cd)]({'status':_0x49d42c(0x160),'error':_0x49d42c(0x1f2)});}catch(_0x488e3a){return console[_0x49d42c(0x1a7)](_0x49d42c(0x1b8),_0x488e3a),_0x1b51d1[_0x49d42c(0x1aa)](0x1f4)[_0x49d42c(0x1cd)]({'error':'Erro\x20ao\x20buscar\x20invoices'});}};exports[a9_0x5bb0e3(0x180)]=showAllApi;const updateApi=async(_0x1af045,_0x5e5db8)=>{const _0x4a74b6=a9_0x5bb0e3,_0x237f30=_0x1af045[_0x4a74b6(0x15b)][_0x4a74b6(0x1a0)],[,_0x36eab1]=_0x237f30[_0x4a74b6(0x1d0)]('\x20'),_0x1afbd5=await Whatsapp_1[_0x4a74b6(0x14f)]['findOne']({'where':{'token':_0x36eab1}}),_0x1aac2a=_0x1afbd5[_0x4a74b6(0x17a)],_0x2cd630=_0x1af045['body'],_0x2c9088=Yup[_0x4a74b6(0x215)]()[_0x4a74b6(0x1cf)]({'name':Yup['string']()});try{await _0x2c9088['validate'](_0x2cd630);}catch(_0x296369){throw new AppError_1[(_0x4a74b6(0x14f))](_0x296369[_0x4a74b6(0x203)]);}const {id:_0x4e74a3,status:_0x261e08}=_0x2cd630;if(_0x1aac2a===0x1){const _0x539b02=await(0x0,UpdateInvoiceService_1[_0x4a74b6(0x14f)])({'id':_0x4e74a3,'status':_0x261e08}),_0x4d98f7=await Invoices_1[_0x4a74b6(0x14f)]['findByPk'](_0x4e74a3),_0x242c05=_0x4d98f7[_0x4a74b6(0x17a)],_0x2293f5=await Company_1[_0x4a74b6(0x14f)][_0x4a74b6(0x18f)](_0x242c05),_0x5ed9b5=new Date(_0x2293f5['dueDate']);_0x5ed9b5['setDate'](_0x5ed9b5[_0x4a74b6(0x181)]()+0x1e);const _0xb25165=_0x5ed9b5['toISOString']()['split']('T')[0x0];if(_0x2293f5){await _0x2293f5['update']({'dueDate':_0xb25165});const _0xe74029=await _0x4d98f7[_0x4a74b6(0x1d1)]({'id':_0x4e74a3,'status':_0x4a74b6(0x164)});await _0x2293f5[_0x4a74b6(0x206)]();const _0x33ffd2=(0x0,socket_1['getIO'])(),_0x1c8a97=await Company_1[_0x4a74b6(0x14f)][_0x4a74b6(0x1f6)]({'where':{'id':_0x242c05}});}return _0x5e5db8[_0x4a74b6(0x1aa)](0xc8)[_0x4a74b6(0x1cd)](_0x539b02);}else return _0x5e5db8[_0x4a74b6(0x1aa)](0x191)[_0x4a74b6(0x1cd)]({'status':'ERRO','error':'Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.'});};function a9_0x1112(_0xad01be,_0x17370b){const _0x48efd2=a9_0x3d78();return a9_0x1112=function(_0x4f6145,_0x2ff459){_0x4f6145=_0x4f6145-0x14c;let _0x3d78be=_0x48efd2[_0x4f6145];return _0x3d78be;},a9_0x1112(_0xad01be,_0x17370b);}exports['updateApi']=updateApi;const updateUsageStats=async(_0x266089,_0x179894)=>{const _0x361fd3=a9_0x5bb0e3;if(!_0x266089[_0x361fd3(0x19e)]||!_0x266089[_0x361fd3(0x19e)][_0x361fd3(0x17a)])return _0x179894[_0x361fd3(0x1aa)](0x190)['send']({'status':_0x361fd3(0x1fe),'message':'Missing\x20user\x20or\x20companyId'});const {companyId:_0x246683}=_0x266089['user'],{contactId:_0x5e6793}=_0x266089[_0x361fd3(0x158)];return setTimeout(async()=>{const _0x23b924=_0x361fd3,{dateToClient:_0x2c7307}=(0x0,useDate_1[_0x23b924(0x211)])(),_0x4df734=_0x2c7307(new Date()[_0x23b924(0x1d9)]()),_0x1b2544=(0x0,moment_1[_0x23b924(0x14f)])()[_0x23b924(0x19d)]();try{const _0x3ea011=await ApiUsages_1[_0x23b924(0x14f)][_0x23b924(0x1f6)]({'where':{'dateUsed':_0x4df734,'companyId':_0x246683}});if(_0x3ea011)await _0x3ea011[_0x23b924(0x1d1)]({'usedOther':_0x3ea011['dataValues'][_0x23b924(0x21c)]+0x1,'UsedOnDay':_0x3ea011['dataValues'][_0x23b924(0x219)]+0x1,'updatedAt':_0x1b2544});else{const _0x10ac4a=await ApiUsages_1[_0x23b924(0x14f)][_0x23b924(0x172)]({'companyId':_0x246683,'dateUsed':_0x4df734});await _0x10ac4a['update']({'usedOther':_0x10ac4a['dataValues'][_0x23b924(0x21c)]+0x1,'UsedOnDay':_0x10ac4a[_0x23b924(0x1e5)]['UsedOnDay']+0x1,'updatedAt':_0x1b2544});}}catch(_0x2cfdc1){return console[_0x23b924(0x1a7)](_0x23b924(0x1e1),_0x2cfdc1),_0x179894[_0x23b924(0x1aa)](0x1f4)[_0x23b924(0x1bb)]({'status':_0x23b924(0x1fe),'message':_0x23b924(0x17c)});}},0x64),_0x179894['send']({'status':_0x361fd3(0x166)});};exports[a9_0x5bb0e3(0x16f)]=updateUsageStats;const indexContacts=async(_0x479966,_0x49b1ac)=>{const _0x25980f=a9_0x5bb0e3,{searchParam:_0x3edfe2,pageNumber:_0x121c08}=_0x479966[_0x25980f(0x204)],{companyId:_0x3185cb}=_0x479966[_0x25980f(0x19e)],{contacts:_0x1d200b,count:_0x336373,hasMore:_0x1cd4a6}=await(0x0,ListContactsService_1['default'])({'searchParam':_0x3edfe2,'pageNumber':_0x121c08,'companyId':_0x3185cb});return _0x49b1ac['json']({'contacts':_0x1d200b,'count':_0x336373,'hasMore':_0x1cd4a6});};exports[a9_0x5bb0e3(0x190)]=indexContacts;const listContacts=async(_0x3c9828,_0x5be24d)=>{const _0x2dacf3=a9_0x5bb0e3,{name:_0x5aea62}=_0x3c9828[_0x2dacf3(0x204)],{companyId:_0x215d42}=_0x3c9828['user'],_0x263946=await(0x0,SimpleListService_1[_0x2dacf3(0x14f)])({'name':_0x5aea62,'companyId':_0x215d42});return _0x5be24d['json'](_0x263946);};exports['listContacts']=listContacts;const showContacts=async(_0x5d25ef,_0x334895)=>{const _0x2eeb2c=a9_0x5bb0e3,{contactId:_0x456342}=_0x5d25ef[_0x2eeb2c(0x158)],{companyId:_0x5a0f26}=_0x5d25ef[_0x2eeb2c(0x19e)],_0xae3089=await(0x0,ShowContactService_1['default'])(_0x456342,_0x5a0f26);return _0x334895[_0x2eeb2c(0x1aa)](0xc8)[_0x2eeb2c(0x1cd)](_0xae3089);};exports[a9_0x5bb0e3(0x18e)]=showContacts;const findOrCreateContacts=async(_0x364484,_0x16e4b)=>{const _0x5ac587=a9_0x5bb0e3,{name:_0x1441de,number:_0x2038b8}=_0x364484[_0x5ac587(0x15c)],{companyId:_0x2faa43}=_0x364484[_0x5ac587(0x19e)],_0x3c6b46=await(0x0,GetContactService_1[_0x5ac587(0x14f)])({'name':_0x1441de,'number':_0x2038b8,'companyId':_0x2faa43});return _0x16e4b[_0x5ac587(0x1aa)](0xc8)[_0x5ac587(0x1cd)](_0x3c6b46);};exports[a9_0x5bb0e3(0x1da)]=findOrCreateContacts;const storeContacts=async(_0x53633b,_0x40ee02)=>{const _0x1ab9f6=a9_0x5bb0e3,{companyId:_0x33a6e2}=_0x53633b[_0x1ab9f6(0x19e)],_0x4140f3=_0x53633b[_0x1ab9f6(0x15c)];_0x4140f3[_0x1ab9f6(0x1b7)]=_0x4140f3[_0x1ab9f6(0x1b7)][_0x1ab9f6(0x1d2)]('-','')['replace']('\x20','');const _0x420cd2=Yup[_0x1ab9f6(0x215)]()['shape']({'name':Yup['string']()[_0x1ab9f6(0x1ba)](),'number':Yup[_0x1ab9f6(0x184)]()[_0x1ab9f6(0x1ba)]()[_0x1ab9f6(0x1f8)](/^\d+$/,_0x1ab9f6(0x14e))});try{await _0x420cd2[_0x1ab9f6(0x1ed)](_0x4140f3);}catch(_0x14a419){throw new AppError_1[(_0x1ab9f6(0x14f))](_0x14a419['message']);}await(0x0,CheckIsValidContact_1[_0x1ab9f6(0x14f)])(_0x4140f3['number'],_0x33a6e2);const _0x5b5bd7=await(0x0,CheckNumber_1['default'])(_0x4140f3['number'],_0x33a6e2),_0x1c9688=_0x5b5bd7['jid'][_0x1ab9f6(0x1d2)](/\D/g,'');_0x4140f3[_0x1ab9f6(0x1b7)]=_0x1c9688;const _0x3e0c61=await(0x0,CreateContactService_1[_0x1ab9f6(0x14f)])({..._0x4140f3,'companyId':_0x33a6e2}),_0x4d5786=(0x0,socket_1['getIO'])();return _0x4d5786[_0x1ab9f6(0x1b1)](_0x1ab9f6(0x17e)+_0x33a6e2+'-contact',{'action':_0x1ab9f6(0x172),'contact':_0x3e0c61}),_0x40ee02['status'](0xc8)['json'](_0x3e0c61);};exports[a9_0x5bb0e3(0x218)]=storeContacts;const removeAllContacts=async(_0x1e4a37,_0x5557c0)=>{const _0x419ea0=a9_0x5bb0e3,{companyId:_0x334fb5}=_0x1e4a37[_0x419ea0(0x19e)];try{await Contact_1['default']['destroy']({'where':{'companyId':_0x334fb5}});const _0x270440=(0x0,socket_1['getIO'])();return _0x270440[_0x419ea0(0x1b1)](_0x419ea0(0x17e)+_0x334fb5+'-contact',{'action':_0x419ea0(0x155)}),setTimeout(async()=>{const _0x38b4c7=_0x419ea0,{dateToClient:_0x598cc5}=(0x0,useDate_1[_0x38b4c7(0x211)])(),_0x2292f9=_0x598cc5(new Date()[_0x38b4c7(0x1d9)]()),_0x3c237d=(0x0,moment_1[_0x38b4c7(0x14f)])()[_0x38b4c7(0x19d)]();try{const _0x33571b=await ApiUsages_1['default']['findOne']({'where':{'dateUsed':_0x2292f9,'companyId':_0x334fb5}});if(_0x33571b)await _0x33571b[_0x38b4c7(0x1d1)]({'usedOther':_0x33571b[_0x38b4c7(0x1e5)][_0x38b4c7(0x21c)]+0x1,'UsedOnDay':_0x33571b[_0x38b4c7(0x1e5)]['UsedOnDay']+0x1,'updatedAt':_0x3c237d});else{const _0x3c5846=await ApiUsages_1['default'][_0x38b4c7(0x172)]({'companyId':_0x334fb5,'dateUsed':_0x2292f9});await _0x3c5846[_0x38b4c7(0x1d1)]({'usedOther':_0x3c5846['dataValues'][_0x38b4c7(0x21c)]+0x1,'UsedOnDay':_0x3c5846[_0x38b4c7(0x1e5)]['UsedOnDay']+0x1,'updatedAt':_0x3c237d});}}catch(_0x1da1b0){return console[_0x38b4c7(0x1a7)](_0x38b4c7(0x1e1),_0x1da1b0),_0x5557c0[_0x38b4c7(0x1aa)](0x1f4)['send']({'status':_0x38b4c7(0x1fe),'message':_0x38b4c7(0x17c)});}},0x64),_0x5557c0['status'](0xc8)[_0x419ea0(0x1bb)]({'status':_0x419ea0(0x166),'message':_0x419ea0(0x168)});}catch(_0xe5b3b1){return console[_0x419ea0(0x1a7)]('Error\x20removing\x20all\x20contacts:',_0xe5b3b1),_0x5557c0['status'](0x1f4)['send']({'status':'ERROR','message':'Internal\x20server\x20error'});}};exports[a9_0x5bb0e3(0x1e8)]=removeAllContacts;const updateContacts=async(_0x4db77e,_0x5b51f2)=>{const _0x5b137d=a9_0x5bb0e3,_0x4b7aa1=_0x4db77e[_0x5b137d(0x15c)],{companyId:_0x567691}=_0x4db77e[_0x5b137d(0x19e)],_0x46f8a4=Yup['object']()['shape']({'name':Yup[_0x5b137d(0x184)](),'number':Yup[_0x5b137d(0x184)]()[_0x5b137d(0x1f8)](/^\d+$/,_0x5b137d(0x14e))});try{await _0x46f8a4['validate'](_0x4b7aa1);}catch(_0x5ed285){throw new AppError_1[(_0x5b137d(0x14f))](_0x5ed285[_0x5b137d(0x203)]);}await(0x0,CheckIsValidContact_1['default'])(_0x4b7aa1[_0x5b137d(0x1b7)],_0x567691);const _0x4624bb=await(0x0,CheckNumber_1['default'])(_0x4b7aa1['number'],_0x567691),_0x2fbb61=_0x4624bb[_0x5b137d(0x20a)][_0x5b137d(0x1d2)](/\D/g,'');_0x4b7aa1[_0x5b137d(0x1b7)]=_0x2fbb61;const {contactId:_0x74cc3b}=_0x4db77e[_0x5b137d(0x158)],_0x1652b1=await(0x0,UpdateContactService_1[_0x5b137d(0x14f)])({'contactData':_0x4b7aa1,'contactId':_0x74cc3b,'companyId':_0x567691}),_0x2d083e=(0x0,socket_1[_0x5b137d(0x17d)])();return _0x2d083e[_0x5b137d(0x1b1)]('company-'+_0x567691+_0x5b137d(0x175),{'action':_0x5b137d(0x1d1),'contact':_0x1652b1}),_0x5b51f2[_0x5b137d(0x1aa)](0xc8)[_0x5b137d(0x1cd)](_0x1652b1);};exports[a9_0x5bb0e3(0x1a6)]=updateContacts;const removeContacts=async(_0x216ded,_0x48f698)=>{const _0xe1ca8f=a9_0x5bb0e3,{contactId:_0xaefbaf}=_0x216ded['params'],{companyId:_0x39b6fe}=_0x216ded[_0xe1ca8f(0x19e)];await(0x0,ShowContactService_1[_0xe1ca8f(0x14f)])(_0xaefbaf,_0x39b6fe),await(0x0,DeleteContactService_1[_0xe1ca8f(0x14f)])(_0xaefbaf);const _0x1c89c1=(0x0,socket_1[_0xe1ca8f(0x17d)])();return _0x1c89c1[_0xe1ca8f(0x1b1)](_0xe1ca8f(0x17e)+_0x39b6fe+_0xe1ca8f(0x175),{'action':_0xe1ca8f(0x15d),'contactId':_0xaefbaf}),_0x48f698['status'](0xc8)[_0xe1ca8f(0x1cd)]({'message':_0xe1ca8f(0x1ee)});};exports[a9_0x5bb0e3(0x1f9)]=removeContacts;const uploadContacts=async(_0x3c0052,_0x135e57)=>{const _0x304ffb=a9_0x5bb0e3,_0x313f87=_0x3c0052[_0x304ffb(0x1e2)],_0x5d852c=(0x0,lodash_1[_0x304ffb(0x16b)])(_0x313f87),{companyId:_0x15cf41}=_0x3c0052[_0x304ffb(0x19e)],_0x382166=await(0x0,ImportXLSContactsService_1[_0x304ffb(0x1b5)])(_0x15cf41,_0x5d852c),_0x40107f=(0x0,socket_1['getIO'])(),_0x3caeb8={'action':'reload','records':_0x382166};return _0x40107f['to'](_0x304ffb(0x17e)+_0x15cf41+_0x304ffb(0x18b))[_0x304ffb(0x1b1)](_0x304ffb(0x17e)+_0x15cf41+'-contact',_0x3caeb8),_0x135e57[_0x304ffb(0x1aa)](0xc8)[_0x304ffb(0x1cd)](_0x382166);};exports[a9_0x5bb0e3(0x165)]=uploadContacts;const toggleDisableBotContacts=async(_0x10d31b,_0x30d58f)=>{const _0x5c9a75=a9_0x5bb0e3,{contactId:_0x3e9ad3}=_0x10d31b[_0x5c9a75(0x158)],{companyId:_0x49d935}=_0x10d31b[_0x5c9a75(0x19e)],_0x515cf9=await(0x0,ToggleDisableBotService_1[_0x5c9a75(0x14f)])(_0x3e9ad3,_0x49d935),_0x17ec61=(0x0,socket_1['getIO'])();return _0x17ec61[_0x5c9a75(0x1b1)](_0x5c9a75(0x17e)+_0x49d935+_0x5c9a75(0x175),{'action':_0x5c9a75(0x1d1),'contact':_0x515cf9}),_0x30d58f[_0x5c9a75(0x1aa)](0xc8)[_0x5c9a75(0x1cd)](_0x515cf9);};exports['toggleDisableBotContacts']=toggleDisableBotContacts;