const a9_0x1e2aab=a9_0x3e81;(function(_0x11787c,_0x1c1bb0){const _0x5021ff=a9_0x3e81,_0x12a0ab=_0x11787c();while(!![]){try{const _0x3c9184=-parseInt(_0x5021ff(0x127))/0x1*(parseInt(_0x5021ff(0xf0))/0x2)+-parseInt(_0x5021ff(0x173))/0x3+parseInt(_0x5021ff(0x11c))/0x4*(parseInt(_0x5021ff(0xfe))/0x5)+parseInt(_0x5021ff(0x18a))/0x6*(-parseInt(_0x5021ff(0x121))/0x7)+parseInt(_0x5021ff(0x130))/0x8*(-parseInt(_0x5021ff(0x12e))/0x9)+-parseInt(_0x5021ff(0x195))/0xa*(parseInt(_0x5021ff(0xfa))/0xb)+parseInt(_0x5021ff(0xe8))/0xc*(parseInt(_0x5021ff(0x1b4))/0xd);if(_0x3c9184===_0x1c1bb0)break;else _0x12a0ab['push'](_0x12a0ab['shift']());}catch(_0x34558e){_0x12a0ab['push'](_0x12a0ab['shift']());}}}(a9_0x19db,0xc5289));const a9_0x4d17d9=(function(){let _0x2c5655=!![];return function(_0x2f0219,_0x1c006e){const _0x17c14f=_0x2c5655?function(){const _0x5dac8c=a9_0x3e81;if(_0x1c006e){const _0x363f74=_0x1c006e[_0x5dac8c(0x12f)](_0x2f0219,arguments);return _0x1c006e=null,_0x363f74;}}:function(){};return _0x2c5655=![],_0x17c14f;};}()),a9_0x33fa13=a9_0x4d17d9(this,function(){const _0xdc0dac=a9_0x3e81;return a9_0x33fa13[_0xdc0dac(0x132)]()['search']('(((.+)+)+)+$')['toString']()[_0xdc0dac(0x1a6)](a9_0x33fa13)['search'](_0xdc0dac(0x120));});a9_0x33fa13();'use strict';var __createBinding=this&&this[a9_0x1e2aab(0x17d)]||(Object[a9_0x1e2aab(0xef)]?function(_0x1abd0e,_0x382298,_0x5e64b2,_0x4ca177){const _0xf57f6c=a9_0x1e2aab;if(_0x4ca177===undefined)_0x4ca177=_0x5e64b2;var _0x31bb10=Object[_0xf57f6c(0xec)](_0x382298,_0x5e64b2);(!_0x31bb10||('get'in _0x31bb10?!_0x382298[_0xf57f6c(0xe7)]:_0x31bb10['writable']||_0x31bb10['configurable']))&&(_0x31bb10={'enumerable':!![],'get':function(){return _0x382298[_0x5e64b2];}}),Object[_0xf57f6c(0x124)](_0x1abd0e,_0x4ca177,_0x31bb10);}:function(_0x1c44ba,_0x4453f9,_0x5840ed,_0x58a02b){if(_0x58a02b===undefined)_0x58a02b=_0x5840ed;_0x1c44ba[_0x58a02b]=_0x4453f9[_0x5840ed];}),__setModuleDefault=this&&this[a9_0x1e2aab(0x10d)]||(Object[a9_0x1e2aab(0xef)]?function(_0x422790,_0x4072c9){const _0x28ca9f=a9_0x1e2aab;Object[_0x28ca9f(0x124)](_0x422790,_0x28ca9f(0x114),{'enumerable':!![],'value':_0x4072c9});}:function(_0x155174,_0x40dd65){const _0x256765=a9_0x1e2aab;_0x155174[_0x256765(0x114)]=_0x40dd65;}),__importStar=this&&this[a9_0x1e2aab(0x17a)]||function(_0x3dc2a1){const _0x3ced84=a9_0x1e2aab;if(_0x3dc2a1&&_0x3dc2a1[_0x3ced84(0xe7)])return _0x3dc2a1;var _0x1f2c2c={};if(_0x3dc2a1!=null){for(var _0x20346c in _0x3dc2a1)if(_0x20346c!==_0x3ced84(0x114)&&Object[_0x3ced84(0x181)][_0x3ced84(0x18f)][_0x3ced84(0x171)](_0x3dc2a1,_0x20346c))__createBinding(_0x1f2c2c,_0x3dc2a1,_0x20346c);}return __setModuleDefault(_0x1f2c2c,_0x3dc2a1),_0x1f2c2c;},__importDefault=this&&this[a9_0x1e2aab(0x18e)]||function(_0x30b37a){return _0x30b37a&&_0x30b37a['__esModule']?_0x30b37a:{'default':_0x30b37a};};Object[a9_0x1e2aab(0x124)](exports,a9_0x1e2aab(0xe7),{'value':!![]}),exports[a9_0x1e2aab(0x10a)]=exports[a9_0x1e2aab(0x155)]=exports[a9_0x1e2aab(0x1b6)]=exports[a9_0x1e2aab(0x16a)]=exports[a9_0x1e2aab(0x102)]=exports['storeContacts']=exports[a9_0x1e2aab(0x1a7)]=exports[a9_0x1e2aab(0x118)]=exports[a9_0x1e2aab(0xf2)]=exports[a9_0x1e2aab(0xf3)]=exports[a9_0x1e2aab(0x117)]=exports['updateApi']=exports[a9_0x1e2aab(0xf7)]=exports[a9_0x1e2aab(0x103)]=exports['indexApi']=exports[a9_0x1e2aab(0x149)]=exports[a9_0x1e2aab(0x179)]=exports[a9_0x1e2aab(0x166)]=exports[a9_0x1e2aab(0x17b)]=exports[a9_0x1e2aab(0x186)]=exports[a9_0x1e2aab(0x140)]=exports['updateTicketTag']=exports['closeTicket']=exports[a9_0x1e2aab(0xeb)]=exports['indexWhatsappsId']=exports[a9_0x1e2aab(0x17e)]=exports[a9_0x1e2aab(0x139)]=exports[a9_0x1e2aab(0x193)]=exports[a9_0x1e2aab(0x19a)]=exports['blockCompany']=exports[a9_0x1e2aab(0x198)]=exports[a9_0x1e2aab(0x165)]=exports[a9_0x1e2aab(0x174)]=void 0x0;const axios_1=__importDefault(require(a9_0x1e2aab(0x17f))),fs_1=__importDefault(require('fs')),Yup=__importStar(require('yup')),lodash_1=require('lodash'),GetDefaultWhatsApp_1=__importDefault(require(a9_0x1e2aab(0xf5))),SetTicketMessagesAsRead_1=__importDefault(require(a9_0x1e2aab(0x15a))),socket_1=require(a9_0x1e2aab(0x175)),Whatsapp_1=__importDefault(require(a9_0x1e2aab(0x123))),Queue_1=__importDefault(require(a9_0x1e2aab(0xf8))),User_1=__importDefault(require(a9_0x1e2aab(0x167))),CreateOrUpdateContactService_1=__importDefault(require(a9_0x1e2aab(0x10b))),FindOrCreateTicketService_1=__importDefault(require(a9_0x1e2aab(0xf1))),ShowTicketService_1=__importDefault(require(a9_0x1e2aab(0x15d))),GetProfilePicUrl_1=__importDefault(require(a9_0x1e2aab(0x11f))),SendWhatsAppMedia_1=__importDefault(require('../services/WbotServices/SendWhatsAppMedia')),UpdateTicketService_1=__importDefault(require(a9_0x1e2aab(0x196))),wbot_1=require(a9_0x1e2aab(0x194)),SendWhatsAppMessageLink_1=__importDefault(require(a9_0x1e2aab(0x163))),SendWhatsAppMessageAPI_1=__importDefault(require(a9_0x1e2aab(0x14f))),SendWhatsappMediaImage_1=__importDefault(require('../services/WbotServices/SendWhatsappMediaImage')),ListInvoicesServices_1=__importDefault(require(a9_0x1e2aab(0x14b))),ShowInvoiceService_1=__importDefault(require('../services/InvoicesService/ShowInvoiceService')),UpdateInvoiceService_1=__importDefault(require(a9_0x1e2aab(0x150))),Invoices_1=__importDefault(require(a9_0x1e2aab(0x1a1))),ListContactsService_1=__importDefault(require(a9_0x1e2aab(0x16e))),CreateContactService_1=__importDefault(require('../services/ContactServices/CreateContactService')),ShowContactService_1=__importDefault(require(a9_0x1e2aab(0x19b))),UpdateContactService_1=__importDefault(require('../services/ContactServices/UpdateContactService')),DeleteContactService_1=__importDefault(require('../services/ContactServices/DeleteContactService')),GetContactService_1=__importDefault(require('../services/ContactServices/GetContactService')),ToggleDisableBotService_1=__importDefault(require(a9_0x1e2aab(0x19d))),CheckNumber_1=__importDefault(require(a9_0x1e2aab(0xfd))),CheckIsValidContact_1=__importDefault(require(a9_0x1e2aab(0x17c))),AppError_1=__importDefault(require(a9_0x1e2aab(0xfb))),SimpleListService_1=__importDefault(require(a9_0x1e2aab(0x1b1))),ImportXLSContactsService_1=require('../services/ContactServices/ImportXLSContactsService'),ApiUsages_1=__importDefault(require(a9_0x1e2aab(0x1b3))),useDate_1=require(a9_0x1e2aab(0x126)),TicketTag_1=__importDefault(require(a9_0x1e2aab(0xf4))),Tag_1=__importDefault(require('../models/Tag')),moment_1=__importDefault(require(a9_0x1e2aab(0x164))),path_1=__importDefault(require('path')),Ticket_1=__importDefault(require(a9_0x1e2aab(0x19c))),Contact_1=__importDefault(require(a9_0x1e2aab(0x1b5))),Company_1=__importDefault(require(a9_0x1e2aab(0x145))),SendPresenceStatus_1=require(a9_0x1e2aab(0x119));class OnWhatsAppDto{constructor(_0x2b97c6,_0x2147ec){const _0x3fc638=a9_0x1e2aab;this[_0x3fc638(0x15e)]=_0x2b97c6,this['exists']=_0x2147ec;}}exports['OnWhatsAppDto']=OnWhatsAppDto;const CompanySchema=Yup[a9_0x1e2aab(0xf6)]()[a9_0x1e2aab(0x142)]({'name':Yup['string']()[a9_0x1e2aab(0x1b0)](),'id':Yup[a9_0x1e2aab(0xf9)](),'phone':Yup[a9_0x1e2aab(0x158)]()[a9_0x1e2aab(0x111)](),'email':Yup[a9_0x1e2aab(0x158)]()[a9_0x1e2aab(0x14c)]()[a9_0x1e2aab(0x111)](),'status':Yup[a9_0x1e2aab(0x11d)]()[a9_0x1e2aab(0x111)](),'planId':Yup[a9_0x1e2aab(0xf9)]()[a9_0x1e2aab(0x111)](),'campaignsEnabled':Yup['boolean']()[a9_0x1e2aab(0x111)](),'dueDate':Yup[a9_0x1e2aab(0x13e)]()['nullable'](),'recurrence':Yup['string']()[a9_0x1e2aab(0x111)]()}),createCompany=async(_0x42303b,_0x18dcd9)=>{const _0xd2e088=a9_0x1e2aab;try{await CompanySchema[_0xd2e088(0x147)](_0x42303b['body']);const _0x1fe3bb=await Company_1[_0xd2e088(0x114)][_0xd2e088(0xef)](_0x42303b[_0xd2e088(0x12a)]);_0x18dcd9[_0xd2e088(0x162)](0xc9)[_0xd2e088(0x115)](_0x1fe3bb);}catch(_0x4350c1){_0x18dcd9['status'](0x190)['json']({'error':_0x4350c1[_0xd2e088(0x15b)]});}};exports[a9_0x1e2aab(0x165)]=createCompany;const updateCompany=async(_0x22fd7c,_0x56d992)=>{const _0x5169c0=a9_0x1e2aab;try{await CompanySchema['validate'](_0x22fd7c[_0x5169c0(0x12a)]);const {id:_0x39ee67}=_0x22fd7c[_0x5169c0(0x146)],[_0x1adb30]=await Company_1[_0x5169c0(0x114)][_0x5169c0(0x141)](_0x22fd7c[_0x5169c0(0x12a)],{'where':{'id':_0x39ee67}});if(_0x1adb30){const _0x2975e5=await Company_1['default'][_0x5169c0(0x10f)](_0x39ee67);_0x56d992[_0x5169c0(0x162)](0xc8)[_0x5169c0(0x115)](_0x2975e5);}else _0x56d992[_0x5169c0(0x162)](0x194)[_0x5169c0(0x115)]({'error':'Company\x20not\x20found'});}catch(_0x1fa264){_0x56d992[_0x5169c0(0x162)](0x190)[_0x5169c0(0x115)]({'error':_0x1fa264[_0x5169c0(0x15b)]});}};exports['updateCompany']=updateCompany;const blockCompany=async(_0x43c25b,_0x211ea1)=>{const _0x486e68=a9_0x1e2aab;try{const {id:_0x724b4c}=_0x43c25b['params'],[_0x1a9d4b]=await Company_1[_0x486e68(0x114)]['update']({'status':![]},{'where':{'id':_0x724b4c}});if(_0x1a9d4b){const _0x54be75=await Company_1[_0x486e68(0x114)]['findByPk'](_0x724b4c);_0x211ea1['status'](0xc8)[_0x486e68(0x115)](_0x54be75);}else _0x211ea1[_0x486e68(0x162)](0x194)['json']({'error':'Company\x20not\x20found'});}catch(_0x111029){_0x211ea1[_0x486e68(0x162)](0x190)[_0x486e68(0x115)]({'error':_0x111029[_0x486e68(0x15b)]});}};exports[a9_0x1e2aab(0x191)]=blockCompany;function a9_0x19db(){const _0x54af97=['1434080FMlEcy','company-','toString','usedOther','format','Token\x20de\x20autorização\x20inválido','ERRO','type','arraybuffer','indexImage','getDate','color','Not\x20exists\x20on\x20Whatsapp','contact','date','.mp3','removeTicketTag','update','shape','profilePicUrl','Tag\x20does\x20not\x20belong\x20to\x20the\x20specified\x20company','../models/Company','params','validate','onWhatsApp','handleAudioLink','map','../services/InvoicesService/ListInvoicesServices','email','Legenda\x20do\x20áudio','includes','../services/WbotServices/SendWhatsAppMessageAPI','../services/InvoicesService/UpdateInvoiceService','split','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','video','files','uploadContacts','Failed\x20to\x20update\x20ticket\x20tag','queue','string','ERROR','../helpers/SetTicketMessagesAsRead','message','log','../services/TicketServices/ShowTicketService','jid','Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.','Invalid\x20queue\x20for\x20the\x20company','Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.','status','../services/WbotServices/SendWhatsAppMessageLink','moment','createCompany','listTicketsByTagIsAuth','../models/User','req','authorization','updateContacts','facebookUserToken','caption','facebookUserId','../services/ContactServices/ListContactsService','dueDate','writeFileSync','call','replace','3444537CrPZYS','OnWhatsAppDto','../libs/socket','mimetype','findOne','company','makeid','__importStar','listTicketsByTag','../services/WbotServices/CheckIsValidContact','__createBinding','checkNumber','axios','readFileSync','prototype','parseInt','name','all','-contact','listTicketsByCompany','Internal\x20server\x20error','closeTicket','Internal\x20Server\x20Error','502338BKuNCs','UsedOnDay','extraInfo','usedPDF','__importDefault','hasOwnProperty','usedImage','blockCompany','headers','index','../libs/wbot','19390fUSigj','../services/TicketServices/UpdateTicketService','@s.whatsapp.net','updateCompany','./public/company','indexLink','../services/ContactServices/ShowContactService','../models/Ticket','../services/ContactServices/ToggleDisableBotService','destroy','whatsapp','send','../models/Invoices','getWbot','companyId','audio/mp4','toISOString','constructor','findOrCreateContacts','length','matches','deleteAll','url','useDate','All\x20contacts\x20removed\x20successfully','getIO','SUCCESS','required','../services/ContactServices/SimpleListService','acceptAudioMessage','../models/ApiUsages','51749633cXXxCM','../models/Contact','removeContacts','pdf','__esModule','12uBNuYI','emit','pending','updateQueueId','getOwnPropertyDescriptor','reload','indexApi','create','38680KRWjLA','../services/TicketServices/FindOrCreateTicketService','listContacts','indexContacts','../models/TicketTag','../helpers/GetDefaultWhatsApp','object','showAllApi','../models/Queue','number','6138OCaOoP','../errors/AppError','delete','../services/WbotServices/CheckNumber','30bcBEjx','usedVideo','@g.us','from','removeAllContacts','showApi','paid','usedCheckNumber','usedText','query','user','disableBot','toggleDisableBotContacts','../services/ContactServices/CreateOrUpdateContactService','indexWhatsappsId','__setModuleDefault','Error\x20updating\x20usage\x20stats:','findByPk','dataValues','nullable','extname','Erro\x20ao\x20buscar\x20invoices:','default','json','findAll','updateUsageStats','showContacts','../helpers/SendPresenceStatus','tags','Failed\x20to\x20remove\x20ticket\x20tag','890668klhIqu','boolean','head','../services/WbotServices/GetProfilePicUrl','(((.+)+)+)+$','49ONMHWz','charAt','../models/Whatsapp','defineProperty','Missing\x20user\x20or\x20companyId','../utils/useDate','69rqBjQP','data','originalname','body','exists','test','error','18xPRtxj','apply'];a9_0x19db=function(){return _0x54af97;};return a9_0x19db();}const createContact=async(_0x156356,_0x3eab15,_0x4ae823)=>{const _0x1c5002=a9_0x1e2aab;await(0x0,CheckIsValidContact_1[_0x1c5002(0x114)])(_0x4ae823,_0x3eab15);const _0x2209e4=await(0x0,CheckNumber_1[_0x1c5002(0x114)])(_0x4ae823,_0x3eab15),_0x21b207=await(0x0,GetProfilePicUrl_1[_0x1c5002(0x114)])(_0x2209e4,_0x3eab15),_0x1035af=_0x2209e4,_0x52687b={'name':''+_0x1035af,'number':_0x1035af,'profilePicUrl':_0x21b207,'isGroup':![],'companyId':_0x3eab15},_0x26c963=await(0x0,CreateOrUpdateContactService_1[_0x1c5002(0x114)])(_0x52687b,null,null);let _0x5eeb71;if(_0x156356===undefined)_0x5eeb71=await(0x0,GetDefaultWhatsApp_1['default'])(_0x3eab15);else{_0x5eeb71=await Whatsapp_1[_0x1c5002(0x114)][_0x1c5002(0x10f)](_0x156356);if(_0x5eeb71===null)throw new AppError_1['default']('whatsapp\x20#'+_0x156356+'\x20not\x20found');}const _0x388054=await(0x0,FindOrCreateTicketService_1[_0x1c5002(0x114)])(_0x26c963,_0x5eeb71['id'],0x0,_0x3eab15),_0x2c9d58=await(0x0,ShowTicketService_1['default'])(_0x388054['id'],_0x3eab15);return(0x0,SetTicketMessagesAsRead_1[_0x1c5002(0x114)])(_0x2c9d58),_0x2c9d58;};function formatBRNumber(_0x1f82b1){const _0x509e48=a9_0x1e2aab,_0x5d3352=new RegExp(/^(\d{2})(\d{2})\d{1}(\d{8})$/);if(_0x5d3352[_0x509e48(0x12c)](_0x1f82b1)){const _0x4828c8=_0x5d3352['exec'](_0x1f82b1);if(_0x4828c8&&_0x4828c8[0x1]==='55'&&Number['isInteger'](Number[_0x509e48(0x182)](_0x4828c8[0x2]))){const _0x544639=Number[_0x509e48(0x182)](_0x4828c8[0x2]);if(_0x544639<0x1f)return _0x4828c8[0x0];else{if(_0x544639>=0x1f)return _0x4828c8[0x1]+_0x4828c8[0x2]+_0x4828c8[0x3];}}}else return _0x1f82b1;}function createJid(_0xc21a57){const _0x43c3a1=a9_0x1e2aab;if(_0xc21a57[_0x43c3a1(0x14e)](_0x43c3a1(0x100))||_0xc21a57['includes'](_0x43c3a1(0x197)))return formatBRNumber(_0xc21a57);return _0xc21a57[_0x43c3a1(0x14e)]('-')?_0xc21a57+_0x43c3a1(0x100):formatBRNumber(_0xc21a57)+_0x43c3a1(0x197);}const indexLink=async(_0x26c8f6,_0x264e77)=>{const _0x3e1456=a9_0x1e2aab,_0x5e1086=_0x26c8f6[_0x3e1456(0x12a)],{whatsappId:_0xadb99b}=_0x26c8f6[_0x3e1456(0x12a)],{msdelay:_0x10c775}=_0x26c8f6[_0x3e1456(0x12a)],_0x41175f=_0x26c8f6['body'][_0x3e1456(0x1ab)],_0x1c19cf=_0x26c8f6[_0x3e1456(0x12a)]['caption'],_0x556b68=_0x26c8f6['headers'][_0x3e1456(0x169)],[,_0x24221c]=_0x556b68['split']('\x20'),_0x32b451=await Whatsapp_1['default'][_0x3e1456(0x177)]({'where':{'token':_0x24221c}}),_0x4692ae=_0x32b451[_0x3e1456(0x1a3)];_0x5e1086[_0x3e1456(0xf9)]=_0x5e1086[_0x3e1456(0xf9)][_0x3e1456(0x172)]('-','')['replace']('\x20','');const _0xe4f5a9=Yup[_0x3e1456(0xf6)]()[_0x3e1456(0x142)]({'number':Yup['string']()[_0x3e1456(0x1b0)]()[_0x3e1456(0x1a9)](/^\d+$/,_0x3e1456(0x161))});try{await _0xe4f5a9[_0x3e1456(0x147)](_0x5e1086);}catch(_0x591196){throw new AppError_1[(_0x3e1456(0x114))](_0x591196['message']);}const _0x5cce31=await createContact(_0xadb99b,_0x4692ae,_0x5e1086[_0x3e1456(0xf9)]);return await(0x0,SendWhatsAppMessageLink_1['default'])({'ticket':_0x5cce31,'url':_0x41175f,'caption':_0x1c19cf,'msdelay':_0x10c775}),setTimeout(async()=>{const _0x1097d7=_0x3e1456;await(0x0,UpdateTicketService_1[_0x1097d7(0x114)])({'ticketId':_0x5cce31['id'],'ticketData':{'status':'pending','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x4692ae});},0xc8),setTimeout(async()=>{const _0x33d930=_0x3e1456,{dateToClient:_0x3e0b52}=(0x0,useDate_1[_0x33d930(0x1ac)])(),_0x34a141=_0x3e0b52(new Date()[_0x33d930(0x132)]()),_0x549de0=(0x0,moment_1['default'])()['format'](),_0x258078=await ApiUsages_1[_0x33d930(0x114)][_0x33d930(0x177)]({'where':{'dateUsed':_0x34a141,'companyId':_0x4692ae}});if(_0x258078)await _0x258078['update']({'usedPDF':_0x258078[_0x33d930(0x110)]['usedPDF']+0x1,'UsedOnDay':_0x258078['dataValues'][_0x33d930(0x18b)]+0x1,'updatedAt':_0x549de0});else{const _0x424299=await ApiUsages_1['default'][_0x33d930(0xef)]({'companyId':_0x4692ae,'dateUsed':_0x34a141});await _0x424299[_0x33d930(0x141)]({'usedPDF':_0x424299[_0x33d930(0x110)][_0x33d930(0x18d)]+0x1,'UsedOnDay':_0x424299[_0x33d930(0x110)]['UsedOnDay']+0x1,'updatedAt':_0x549de0});}},0x64),_0x264e77['send']({'status':_0x3e1456(0x1af)});};exports['indexLink']=indexLink;const index=async(_0x2dd541,_0x5932d1)=>{const _0x5e22b9=a9_0x1e2aab,_0x4d56a0=_0x2dd541[_0x5e22b9(0x12a)],{whatsappId:_0x23af38}=_0x2dd541[_0x5e22b9(0x12a)],{msdelay:_0x1f486d}=_0x2dd541[_0x5e22b9(0x12a)],{body:_0x1ff88c,quotedMsg:_0x43720e}=_0x2dd541[_0x5e22b9(0x12a)],_0x3ee059=_0x2dd541[_0x5e22b9(0x154)],_0xa7ba97=_0x2dd541[_0x5e22b9(0x192)][_0x5e22b9(0x169)],[,_0x3f4cf8]=_0xa7ba97[_0x5e22b9(0x151)]('\x20'),_0x1146b3=await Whatsapp_1[_0x5e22b9(0x114)][_0x5e22b9(0x177)]({'where':{'token':_0x3f4cf8}}),_0x2b92c7=_0x1146b3[_0x5e22b9(0x1a3)];_0x4d56a0['number']=_0x4d56a0[_0x5e22b9(0xf9)][_0x5e22b9(0x172)]('-','')['replace']('\x20','');const _0x2c7e8c=Yup[_0x5e22b9(0xf6)]()['shape']({'number':Yup['string']()[_0x5e22b9(0x1b0)]()[_0x5e22b9(0x1a9)](/^\d+$/,'Invalid\x20number\x20format.\x20Only\x20numbers\x20is\x20allowed.')});try{await _0x2c7e8c[_0x5e22b9(0x147)](_0x4d56a0);}catch(_0x35cc09){throw new AppError_1[(_0x5e22b9(0x114))](_0x35cc09[_0x5e22b9(0x15b)]);}const _0x2c0107=await createContact(_0x23af38,_0x2b92c7,_0x4d56a0[_0x5e22b9(0xf9)]);return _0x3ee059?await Promise['all'](_0x3ee059[_0x5e22b9(0x14a)](async _0x52519d=>{const _0x26b81c=_0x5e22b9;await(0x0,SendWhatsAppMedia_1[_0x26b81c(0x114)])({'body':_0x1ff88c,'media':_0x52519d,'ticket':_0x2c0107});})):await(0x0,SendWhatsAppMessageAPI_1[_0x5e22b9(0x114)])({'body':_0x1ff88c,'ticket':_0x2c0107,'quotedMsg':_0x43720e,'msdelay':_0x1f486d}),setTimeout(async()=>{await(0x0,UpdateTicketService_1['default'])({'ticketId':_0x2c0107['id'],'ticketData':{'status':'pending','sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x2b92c7});},0x64),setTimeout(async()=>{const _0x470e3f=_0x5e22b9,{dateToClient:_0xcadeba}=(0x0,useDate_1[_0x470e3f(0x1ac)])(),_0x31f433=_0xcadeba(new Date()[_0x470e3f(0x132)]()),_0x5ae427=(0x0,moment_1['default'])()[_0x470e3f(0x134)](),_0x271c5f=await ApiUsages_1[_0x470e3f(0x114)][_0x470e3f(0x177)]({'where':{'dateUsed':_0x31f433,'companyId':_0x2b92c7}});_0x271c5f?_0x3ee059?await Promise[_0x470e3f(0x184)](_0x3ee059[_0x470e3f(0x14a)](async _0x3ece36=>{const _0x4f7c1c=_0x470e3f;console[_0x4f7c1c(0x15c)]('media',_0x3ece36);const _0x8bb4f3=path_1[_0x4f7c1c(0x114)]['extname'](_0x3ece36[_0x4f7c1c(0x129)]);console['log'](_0x4f7c1c(0x137),_0x8bb4f3);if(_0x3ece36[_0x4f7c1c(0x176)][_0x4f7c1c(0x14e)](_0x4f7c1c(0x1b7)))await _0x271c5f[_0x4f7c1c(0x141)]({'usedPDF':_0x271c5f[_0x4f7c1c(0x110)][_0x4f7c1c(0x18d)]+0x1,'UsedOnDay':_0x271c5f[_0x4f7c1c(0x110)][_0x4f7c1c(0x18b)]+0x1,'updatedAt':_0x5ae427});else{if(_0x3ece36['mimetype']['includes']('image'))await _0x271c5f[_0x4f7c1c(0x141)]({'usedImage':_0x271c5f[_0x4f7c1c(0x110)][_0x4f7c1c(0x190)]+0x1,'UsedOnDay':_0x271c5f[_0x4f7c1c(0x110)][_0x4f7c1c(0x18b)]+0x1,'updatedAt':_0x5ae427});else _0x3ece36[_0x4f7c1c(0x176)][_0x4f7c1c(0x14e)](_0x4f7c1c(0x153))?await _0x271c5f['update']({'usedVideo':_0x271c5f[_0x4f7c1c(0x110)][_0x4f7c1c(0xff)]+0x1,'UsedOnDay':_0x271c5f[_0x4f7c1c(0x110)][_0x4f7c1c(0x18b)]+0x1,'updatedAt':_0x5ae427}):await _0x271c5f['update']({'usedOther':_0x271c5f[_0x4f7c1c(0x110)]['usedOther']+0x1,'UsedOnDay':_0x271c5f[_0x4f7c1c(0x110)]['UsedOnDay']+0x1,'updatedAt':_0x5ae427});}})):await _0x271c5f[_0x470e3f(0x141)]({'usedText':_0x271c5f['dataValues']['usedText']+0x1,'UsedOnDay':_0x271c5f[_0x470e3f(0x110)][_0x470e3f(0x18b)]+0x1,'updatedAt':_0x5ae427}):(await ApiUsages_1[_0x470e3f(0x114)][_0x470e3f(0xef)]({'companyId':_0x2b92c7,'dateUsed':_0x31f433}),_0x3ee059?await Promise[_0x470e3f(0x184)](_0x3ee059[_0x470e3f(0x14a)](async _0x4810bc=>{const _0x10e8a1=_0x470e3f;console[_0x10e8a1(0x15c)]('media',_0x4810bc);const _0x5d2dfd=path_1[_0x10e8a1(0x114)][_0x10e8a1(0x112)](_0x4810bc['originalname']);console[_0x10e8a1(0x15c)](_0x10e8a1(0x137),_0x5d2dfd);if(_0x4810bc[_0x10e8a1(0x176)][_0x10e8a1(0x14e)](_0x10e8a1(0x1b7)))await _0x271c5f[_0x10e8a1(0x141)]({'usedPDF':_0x271c5f[_0x10e8a1(0x110)][_0x10e8a1(0x18d)]+0x1,'UsedOnDay':_0x271c5f[_0x10e8a1(0x110)][_0x10e8a1(0x18b)]+0x1,'updatedAt':_0x5ae427});else{if(_0x4810bc[_0x10e8a1(0x176)][_0x10e8a1(0x14e)]('image'))await _0x271c5f[_0x10e8a1(0x141)]({'usedImage':_0x271c5f[_0x10e8a1(0x110)]['usedImage']+0x1,'UsedOnDay':_0x271c5f[_0x10e8a1(0x110)]['UsedOnDay']+0x1,'updatedAt':_0x5ae427});else _0x4810bc['mimetype'][_0x10e8a1(0x14e)](_0x10e8a1(0x153))?await _0x271c5f[_0x10e8a1(0x141)]({'usedVideo':_0x271c5f['dataValues'][_0x10e8a1(0xff)]+0x1,'UsedOnDay':_0x271c5f[_0x10e8a1(0x110)][_0x10e8a1(0x18b)]+0x1,'updatedAt':_0x5ae427}):await _0x271c5f[_0x10e8a1(0x141)]({'usedOther':_0x271c5f[_0x10e8a1(0x110)][_0x10e8a1(0x133)]+0x1,'UsedOnDay':_0x271c5f[_0x10e8a1(0x110)][_0x10e8a1(0x18b)]+0x1,'updatedAt':_0x5ae427});}})):await _0x271c5f[_0x470e3f(0x141)]({'usedText':_0x271c5f[_0x470e3f(0x110)][_0x470e3f(0x106)]+0x1,'UsedOnDay':_0x271c5f[_0x470e3f(0x110)][_0x470e3f(0x18b)]+0x1,'updatedAt':_0x5ae427}));},0x64),_0x5932d1[_0x5e22b9(0x1a0)]({'status':_0x5e22b9(0x1af)});};exports[a9_0x1e2aab(0x193)]=index;const indexImage=async(_0x486744,_0xca5bf)=>{const _0x2fb45d=a9_0x1e2aab,_0x26e117=_0x486744['body'],{whatsappId:_0xb65efb}=_0x486744[_0x2fb45d(0x12a)],{msdelay:_0x22ff9b}=_0x486744['body'],_0x35a54a=_0x486744[_0x2fb45d(0x12a)][_0x2fb45d(0x1ab)],_0x34b645=_0x486744[_0x2fb45d(0x12a)][_0x2fb45d(0x16c)],_0x642920=_0x486744['headers'][_0x2fb45d(0x169)],[,_0x574cfb]=_0x642920['split']('\x20'),_0x4ffc7a=await Whatsapp_1[_0x2fb45d(0x114)][_0x2fb45d(0x177)]({'where':{'token':_0x574cfb}}),_0x1e25cd=_0x4ffc7a[_0x2fb45d(0x1a3)];_0x26e117['number']=_0x26e117[_0x2fb45d(0xf9)][_0x2fb45d(0x172)]('-','')[_0x2fb45d(0x172)]('\x20','');const _0x2233a3=Yup['object']()['shape']({'number':Yup['string']()[_0x2fb45d(0x1b0)]()['matches'](/^\d+$/,_0x2fb45d(0x161))});try{await _0x2233a3['validate'](_0x26e117);}catch(_0x3aa2ed){throw new AppError_1[(_0x2fb45d(0x114))](_0x3aa2ed[_0x2fb45d(0x15b)]);}const _0x315a9d=await createContact(_0xb65efb,_0x1e25cd,_0x26e117[_0x2fb45d(0xf9)]);return _0x35a54a&&await(0x0,SendWhatsappMediaImage_1[_0x2fb45d(0x114)])({'ticket':_0x315a9d,'url':_0x35a54a,'caption':_0x34b645,'msdelay':_0x22ff9b}),setTimeout(async()=>{const _0xa9154a=_0x2fb45d;await(0x0,UpdateTicketService_1[_0xa9154a(0x114)])({'ticketId':_0x315a9d['id'],'ticketData':{'status':_0xa9154a(0xea),'sendFarewellMessage':![],'amountUsedBotQueues':0x0},'companyId':_0x1e25cd});},0x64),setTimeout(async()=>{const _0x4703ee=_0x2fb45d,{dateToClient:_0x133fca}=(0x0,useDate_1[_0x4703ee(0x1ac)])(),_0xa306c6=_0x133fca(new Date()[_0x4703ee(0x132)]()),_0x1226d7=(0x0,moment_1[_0x4703ee(0x114)])()[_0x4703ee(0x134)](),_0x2e3851=await ApiUsages_1[_0x4703ee(0x114)][_0x4703ee(0x177)]({'where':{'dateUsed':_0xa306c6,'companyId':_0x1e25cd}});if(_0x2e3851)await _0x2e3851[_0x4703ee(0x141)]({'usedImage':_0x2e3851[_0x4703ee(0x110)][_0x4703ee(0x190)]+0x1,'UsedOnDay':_0x2e3851[_0x4703ee(0x110)][_0x4703ee(0x18b)]+0x1,'updatedAt':_0x1226d7});else{const _0x594685=await ApiUsages_1['default'][_0x4703ee(0xef)]({'companyId':_0x1e25cd,'dateUsed':_0xa306c6});await _0x594685[_0x4703ee(0x141)]({'usedImage':_0x594685[_0x4703ee(0x110)][_0x4703ee(0x190)]+0x1,'UsedOnDay':_0x594685[_0x4703ee(0x110)]['UsedOnDay']+0x1,'updatedAt':_0x1226d7});}},0x64),_0xca5bf[_0x2fb45d(0x1a0)]({'status':_0x2fb45d(0x1af)});};exports[a9_0x1e2aab(0x139)]=indexImage;const checkNumber=async(_0x469e1b,_0x19dd06)=>{const _0x2505f4=a9_0x1e2aab,_0x311fca=_0x469e1b['body'],_0x1ceafd=_0x469e1b[_0x2505f4(0x192)][_0x2505f4(0x169)],[,_0x4d82cd]=_0x1ceafd['split']('\x20'),_0x4744fa=await Whatsapp_1[_0x2505f4(0x114)][_0x2505f4(0x177)]({'where':{'token':_0x4d82cd}}),_0xe4c120=_0x4744fa[_0x2505f4(0x1a3)],_0x444ddd=_0x311fca[_0x2505f4(0xf9)][_0x2505f4(0x172)]('-','')[_0x2505f4(0x172)]('\x20',''),_0x5218bf=await(0x0,GetDefaultWhatsApp_1[_0x2505f4(0x114)])(_0xe4c120),_0x2f8518=(0x0,wbot_1['getWbot'])(_0x5218bf['id']),_0x9bca0c=createJid(_0x444ddd);try{const [_0x299f91]=await _0x2f8518[_0x2505f4(0x148)](_0x9bca0c);if(_0x299f91[_0x2505f4(0x12b)])return setTimeout(async()=>{const _0x5474f6=_0x2505f4,{dateToClient:_0x179693}=(0x0,useDate_1[_0x5474f6(0x1ac)])(),_0x1e820f=_0x179693(new Date()[_0x5474f6(0x132)]()),_0x4dfdaf=(0x0,moment_1[_0x5474f6(0x114)])()[_0x5474f6(0x134)](),_0x45ce08=await ApiUsages_1[_0x5474f6(0x114)][_0x5474f6(0x177)]({'where':{'dateUsed':_0x1e820f,'companyId':_0xe4c120}});if(_0x45ce08)await _0x45ce08[_0x5474f6(0x141)]({'usedCheckNumber':_0x45ce08['dataValues'][_0x5474f6(0x105)]+0x1,'UsedOnDay':_0x45ce08[_0x5474f6(0x110)][_0x5474f6(0x18b)]+0x1,'updatedAt':_0x4dfdaf});else{const _0x521bb9=await ApiUsages_1[_0x5474f6(0x114)][_0x5474f6(0xef)]({'companyId':_0xe4c120,'dateUsed':_0x1e820f});await _0x521bb9[_0x5474f6(0x141)]({'usedCheckNumber':_0x521bb9[_0x5474f6(0x110)]['usedCheckNumber']+0x1,'UsedOnDay':_0x521bb9[_0x5474f6(0x110)][_0x5474f6(0x18b)]+0x1,'updatedAt':_0x4dfdaf});}},0x64),_0x19dd06['status'](0xc8)[_0x2505f4(0x115)]({'existsInWhatsapp':!![],'number':_0x444ddd,'numberFormatted':_0x299f91[_0x2505f4(0x15e)]});}catch(_0x4dc3d8){return _0x19dd06['status'](0x190)[_0x2505f4(0x115)]({'existsInWhatsapp':![],'number':_0x9bca0c,'error':_0x2505f4(0x13c)});}};exports[a9_0x1e2aab(0x17e)]=checkNumber;const indexWhatsappsId=async(_0x216cf9,_0x33d98e)=>{const _0xe8b798=a9_0x1e2aab;return console[_0xe8b798(0x15c)](_0xe8b798(0x168),_0x216cf9),console['log'](_0xe8b798(0x168),_0x216cf9['user']),_0x33d98e['status'](0xc8)[_0xe8b798(0x115)]('oi');};exports[a9_0x1e2aab(0x10c)]=indexWhatsappsId;const updateQueueId=async(_0x3f3ad8,_0x244835)=>{const _0x1da916=a9_0x1e2aab,{ticketId:_0x5d248a}=_0x3f3ad8[_0x1da916(0x146)],{queueId:_0x2024b5}=_0x3f3ad8[_0x1da916(0x12a)],_0xeeae17=_0x3f3ad8[_0x1da916(0x192)][_0x1da916(0x169)],[,_0x2f0ed4]=_0xeeae17[_0x1da916(0x151)]('\x20'),_0x5963fd=await Whatsapp_1[_0x1da916(0x114)][_0x1da916(0x177)]({'where':{'token':_0x2f0ed4}}),_0x2cb769=_0x5963fd[_0x1da916(0x1a3)];try{const _0x3ce4f4=await Queue_1[_0x1da916(0x114)][_0x1da916(0x177)]({'where':{'id':_0x2024b5,'companyId':_0x2cb769}});if(!_0x3ce4f4)return _0x244835[_0x1da916(0x162)](0x190)[_0x1da916(0x115)]({'status':'ERROR','error':_0x1da916(0x160)});return await(0x0,UpdateTicketService_1[_0x1da916(0x114)])({'ticketId':_0x5d248a,'ticketData':{'queueId':_0x2024b5},'companyId':_0x2cb769}),_0x244835[_0x1da916(0x162)](0xc8)[_0x1da916(0x115)]({'status':_0x1da916(0x1af)});}catch(_0x3e1a57){return console[_0x1da916(0x12d)](_0x3e1a57),_0x244835[_0x1da916(0x162)](0x1f4)['json']({'status':_0x1da916(0x159),'error':_0x1da916(0x189)});}};exports[a9_0x1e2aab(0xeb)]=updateQueueId;const closeTicket=async(_0x4c4ba8,_0x34c2d7)=>{const _0x4ca287=a9_0x1e2aab,_0xe383cc=_0x4c4ba8['headers'][_0x4ca287(0x169)],[,_0xf5952e]=_0xe383cc['split']('\x20'),_0x8c5bba=await Whatsapp_1['default'][_0x4ca287(0x177)]({'where':{'token':_0xf5952e}}),_0x468733=_0x8c5bba[_0x4ca287(0x1a3)],{ticketId:_0x99796b}=_0x4c4ba8[_0x4ca287(0x146)],_0x120b66=await(0x0,ShowTicketService_1[_0x4ca287(0x114)])(_0x99796b,_0x468733);_0x120b66[_0x4ca287(0x162)]=_0x4c4ba8[_0x4ca287(0x12a)]['ticketData'][_0x4ca287(0x162)],console['log'](_0x120b66[_0x4ca287(0x162)]);const {ticket:_0xa511eb}=await(0x0,UpdateTicketService_1[_0x4ca287(0x114)])({'ticketData':_0x120b66,'ticketId':_0x99796b,'companyId':_0x468733});return _0x34c2d7[_0x4ca287(0x162)](0xc8)['json'](_0xa511eb);};exports[a9_0x1e2aab(0x188)]=closeTicket;const updateTicketTag=async(_0x59aee0,_0xabf0b7)=>{const _0x25785d=a9_0x1e2aab,{ticketId:_0x14f479,tagId:_0x2ba975}=_0x59aee0[_0x25785d(0x12a)],_0x472957=_0x59aee0['headers'][_0x25785d(0x169)],[,_0x1f686c]=_0x472957[_0x25785d(0x151)]('\x20');try{const _0x47cd60=await Whatsapp_1[_0x25785d(0x114)][_0x25785d(0x177)]({'where':{'token':_0x1f686c}}),_0x457e89=_0x47cd60[_0x25785d(0x1a3)],_0x222d75=await Tag_1[_0x25785d(0x114)][_0x25785d(0x177)]({'where':{'id':_0x2ba975,'companyId':_0x457e89}});if(!_0x222d75)return _0xabf0b7[_0x25785d(0x162)](0x190)[_0x25785d(0x115)]({'status':'ERROR','error':_0x25785d(0x144)});const _0x173101=await TicketTag_1[_0x25785d(0x114)][_0x25785d(0x177)]({'where':{'ticketId':_0x14f479,'tagId':_0x2ba975}});if(_0x173101)return _0xabf0b7[_0x25785d(0x162)](0x190)[_0x25785d(0x115)]({'status':'ERROR','error':'Tag\x20already\x20associated\x20with\x20the\x20ticket'});const _0x22cc33=await TicketTag_1['default']['create']({'ticketId':_0x14f479,'tagId':_0x2ba975});return _0xabf0b7['status'](0xc8)[_0x25785d(0x115)]({'status':_0x25785d(0x1af),'ticketTag':_0x22cc33});}catch(_0x13796f){return console[_0x25785d(0x12d)](_0x13796f),_0xabf0b7[_0x25785d(0x162)](0x1f4)[_0x25785d(0x115)]({'status':'ERROR','error':_0x25785d(0x156)});}};exports['updateTicketTag']=updateTicketTag;const removeTicketTag=async(_0x4e4f44,_0x14bfe4)=>{const _0x210a4f=a9_0x1e2aab,{ticketId:_0x135de8,tagId:_0x334c5f}=_0x4e4f44[_0x210a4f(0x12a)];try{const _0xbd0f3b=await TicketTag_1[_0x210a4f(0x114)]['findOne']({'where':{'ticketId':_0x135de8,'tagId':_0x334c5f}});if(!_0xbd0f3b)return _0x14bfe4[_0x210a4f(0x162)](0x190)[_0x210a4f(0x115)]({'status':'ERROR','error':'Tag\x20is\x20not\x20associated\x20with\x20the\x20ticket'});return await _0xbd0f3b[_0x210a4f(0x19e)](),_0x14bfe4[_0x210a4f(0x162)](0xc8)['json']({'status':_0x210a4f(0x1af)});}catch(_0x2dda48){return console[_0x210a4f(0x12d)](_0x2dda48),_0x14bfe4['status'](0x1f4)[_0x210a4f(0x115)]({'status':_0x210a4f(0x159),'error':_0x210a4f(0x11b)});}};exports[a9_0x1e2aab(0x140)]=removeTicketTag;const listTicketsByCompany=async(_0x36bc45,_0x30e553)=>{const _0xff3797=a9_0x1e2aab,_0x2ebebf=_0x36bc45[_0xff3797(0x192)][_0xff3797(0x169)],[,_0x46debd]=_0x2ebebf[_0xff3797(0x151)]('\x20'),_0x5bcfe6=await Whatsapp_1['default'][_0xff3797(0x177)]({'where':{'token':_0x46debd}}),_0x4e1eb5=_0x5bcfe6[_0xff3797(0x1a3)];try{const _0x2788a7=await Ticket_1[_0xff3797(0x114)]['findAll']({'where':{'companyId':_0x4e1eb5},'include':[{'model':Contact_1[_0xff3797(0x114)],'as':_0xff3797(0x13d),'attributes':['id','name',_0xff3797(0xf9),_0xff3797(0x14c),_0xff3797(0x143),'acceptAudioMessage','active',_0xff3797(0x109)],'include':[_0xff3797(0x18c)]},{'model':Queue_1[_0xff3797(0x114)],'as':_0xff3797(0x157),'attributes':['id',_0xff3797(0x183),_0xff3797(0x13b)]},{'model':User_1[_0xff3797(0x114)],'as':_0xff3797(0x108),'attributes':['id',_0xff3797(0x183)]},{'model':Tag_1[_0xff3797(0x114)],'as':_0xff3797(0x11a),'attributes':['id',_0xff3797(0x183),_0xff3797(0x13b)]},{'model':Whatsapp_1[_0xff3797(0x114)],'as':_0xff3797(0x19f),'attributes':[_0xff3797(0x183),_0xff3797(0x16b),_0xff3797(0x16d)]},{'model':Company_1[_0xff3797(0x114)],'as':_0xff3797(0x178),'attributes':[_0xff3797(0x183)]}]});return _0x30e553[_0xff3797(0x162)](0xc8)[_0xff3797(0x115)]({'status':_0xff3797(0x1af),'tickets':_0x2788a7});}catch(_0x3fd8d3){return console[_0xff3797(0x12d)](_0x3fd8d3),_0x30e553[_0xff3797(0x162)](0x1f4)[_0xff3797(0x115)]({'status':_0xff3797(0x159),'error':'Internal\x20Server\x20Error'});}};exports['listTicketsByCompany']=listTicketsByCompany;const listTicketsByTag=async(_0x4e0652,_0x306dd0)=>{const _0x2fc0f9=a9_0x1e2aab,{tagId:_0x42c6a9}=_0x4e0652['params'],_0x37e984=_0x4e0652['headers'][_0x2fc0f9(0x169)],[,_0x27124b]=_0x37e984[_0x2fc0f9(0x151)]('\x20');try{const _0x4f2c1d=await Whatsapp_1['default'][_0x2fc0f9(0x177)]({'where':{'token':_0x27124b}}),_0x50999f=_0x4f2c1d['companyId'],_0x56395a=await Tag_1['default'][_0x2fc0f9(0x177)]({'where':{'id':_0x42c6a9,'companyId':_0x50999f}});if(!_0x56395a)return _0x306dd0[_0x2fc0f9(0x162)](0x190)[_0x2fc0f9(0x115)]({'status':'ERROR','error':_0x2fc0f9(0x144)});const _0x4fb487=await Ticket_1[_0x2fc0f9(0x114)][_0x2fc0f9(0x116)]({'include':[{'model':Tag_1[_0x2fc0f9(0x114)],'as':_0x2fc0f9(0x11a),'attributes':['id',_0x2fc0f9(0x183)],'through':{'attributes':[],'where':{'tagId':_0x42c6a9}}},{'model':Contact_1['default'],'as':_0x2fc0f9(0x13d),'attributes':['id',_0x2fc0f9(0x183),_0x2fc0f9(0xf9),'email',_0x2fc0f9(0x143),_0x2fc0f9(0x1b2),'active','disableBot'],'include':[_0x2fc0f9(0x18c)]},{'model':Queue_1[_0x2fc0f9(0x114)],'as':'queue','attributes':['id',_0x2fc0f9(0x183),'color']},{'model':User_1[_0x2fc0f9(0x114)],'as':_0x2fc0f9(0x108),'attributes':['id','name']},{'model':Whatsapp_1[_0x2fc0f9(0x114)],'as':_0x2fc0f9(0x19f),'attributes':[_0x2fc0f9(0x183),'facebookUserToken',_0x2fc0f9(0x16d)]},{'model':Company_1[_0x2fc0f9(0x114)],'as':_0x2fc0f9(0x178),'attributes':[_0x2fc0f9(0x183)]}],'where':{'companyId':_0x50999f,'$tags.id$':_0x42c6a9}});return _0x306dd0[_0x2fc0f9(0x162)](0xc8)[_0x2fc0f9(0x115)]({'status':_0x2fc0f9(0x1af),'tickets':_0x4fb487});}catch(_0x5add0e){return console['error'](_0x5add0e),_0x306dd0['status'](0x1f4)[_0x2fc0f9(0x115)]({'status':'ERROR','error':_0x2fc0f9(0x189)});}};exports[a9_0x1e2aab(0x17b)]=listTicketsByTag;const listTicketsByTagIsAuth=async(_0x1b7893,_0x524288)=>{const _0x437567=a9_0x1e2aab,{tagId:_0x3ad4bf}=_0x1b7893[_0x437567(0x146)];try{const _0x44216f=await Ticket_1[_0x437567(0x114)]['findAll']({'include':[{'model':Contact_1['default'],'as':'contact','attributes':[_0x437567(0x183),'number',_0x437567(0x14c)],'include':[_0x437567(0x18c)]},{'model':Tag_1['default'],'as':_0x437567(0x11a),'attributes':['id','name',_0x437567(0x13b)],'where':{'id':_0x3ad4bf}},{'model':Whatsapp_1[_0x437567(0x114)],'as':_0x437567(0x19f),'attributes':[_0x437567(0x183),'facebookUserToken',_0x437567(0x16d)]},{'model':Company_1[_0x437567(0x114)],'as':_0x437567(0x178),'attributes':[_0x437567(0x183)]}]});return _0x524288[_0x437567(0x162)](0xc8)[_0x437567(0x115)]({'status':_0x437567(0x1af),'tickets':_0x44216f});}catch(_0x1ade0d){return console[_0x437567(0x12d)](_0x1ade0d),_0x524288[_0x437567(0x162)](0x1f4)['json']({'status':_0x437567(0x159),'error':_0x437567(0x189)});}};exports[a9_0x1e2aab(0x166)]=listTicketsByTagIsAuth;function makeid(_0x47fd9f){const _0x5378eb=a9_0x1e2aab;var _0x26091b='',_0x430741=_0x5378eb(0x152),_0xc9f23e=_0x430741[_0x5378eb(0x1a8)];for(var _0x4bb0dc=0x0;_0x4bb0dc<_0x47fd9f;_0x4bb0dc++){_0x26091b+=_0x430741[_0x5378eb(0x122)](Math['floor'](Math['random']()*_0xc9f23e));}return _0x26091b;}exports['makeid']=makeid;const handleAudioLink=async(_0x32194c,_0x502b65)=>{const _0x4b1e8c=a9_0x1e2aab,{link:_0x3e3a21,contactNumber:_0x4f1bc0}=_0x32194c[_0x4b1e8c(0x12a)];try{const _0x51cccd=_0x32194c[_0x4b1e8c(0x192)][_0x4b1e8c(0x169)],[,_0x2f7558]=_0x51cccd['split']('\x20'),_0x342b8f=await Whatsapp_1[_0x4b1e8c(0x114)]['findOne']({'where':{'token':_0x2f7558}}),_0x4a4459=_0x342b8f['companyId'],_0x5177dd=await(0x0,GetDefaultWhatsApp_1[_0x4b1e8c(0x114)])(_0x4a4459),_0x484456=(0x0,wbot_1[_0x4b1e8c(0x1a2)])(_0x5177dd['id']),_0x15a44f=_0x4b1e8c(0x199)+_0x4a4459+'/'+makeid(0xa)+_0x4b1e8c(0x13f);if(!_0x342b8f)return _0x502b65[_0x4b1e8c(0x162)](0x191)[_0x4b1e8c(0x115)]({'status':_0x4b1e8c(0x136),'error':_0x4b1e8c(0x135)});const _0x22f23e=await axios_1[_0x4b1e8c(0x114)]['get'](_0x3e3a21,{'responseType':_0x4b1e8c(0x138)});fs_1['default'][_0x4b1e8c(0x170)](_0x15a44f,Buffer[_0x4b1e8c(0x101)](_0x22f23e[_0x4b1e8c(0x128)]));const _0x5b32b0=_0x4b1e8c(0x14d);return await(0x0,SendPresenceStatus_1['SendPresenceStatus'])(_0x484456,_0x4f1bc0),await _0x484456['sendMessage'](_0x4f1bc0+_0x4b1e8c(0x197),{'audio':fs_1[_0x4b1e8c(0x114)][_0x4b1e8c(0x180)](_0x15a44f),'fileName':_0x5b32b0,'caption':_0x5b32b0,'mimetype':_0x4b1e8c(0x1a4),'ptt':!![]}),_0x502b65[_0x4b1e8c(0x162)](0xc8)[_0x4b1e8c(0x115)]({'status':'SUCESSO'});}catch(_0x3e3857){return console[_0x4b1e8c(0x12d)](_0x3e3857),_0x502b65[_0x4b1e8c(0x162)](0x1f4)[_0x4b1e8c(0x115)]({'status':_0x4b1e8c(0x136),'error':'Erro\x20ao\x20lidar\x20com\x20o\x20link\x20de\x20áudio'});}};exports[a9_0x1e2aab(0x149)]=handleAudioLink;const indexApi=async(_0x24bbb8,_0x247529)=>{const _0x17e52c=a9_0x1e2aab,_0x2a5706=_0x24bbb8[_0x17e52c(0x192)]['authorization'],[,_0x38ab32]=_0x2a5706['split']('\x20'),_0xa071da=await Whatsapp_1['default'][_0x17e52c(0x177)]({'where':{'token':_0x38ab32}}),_0x2ef1e9=_0xa071da[_0x17e52c(0x1a3)],{searchParam:_0x1e85a8,pageNumber:_0x8cbac5}=_0x24bbb8['query'];if(_0x2ef1e9===0x1){const {invoices:_0x3eb395,count:_0x2956a9,hasMore:_0xfded3e}=await(0x0,ListInvoicesServices_1[_0x17e52c(0x114)])({'searchParam':_0x1e85a8,'pageNumber':_0x8cbac5});return _0x247529[_0x17e52c(0x115)]({'invoices':_0x3eb395,'count':_0x2956a9,'hasMore':_0xfded3e});}else return _0x247529[_0x17e52c(0x162)](0x191)[_0x17e52c(0x115)]({'status':'ERRO','error':'Acesso\x20não\x20autorizado.\x20Por\x20favor,\x20forneça\x20credenciais\x20válidas.'});};exports[a9_0x1e2aab(0xee)]=indexApi;const showApi=async(_0x465c1f,_0x174b7c)=>{const _0xaf68bf=a9_0x1e2aab,_0x10ddcf=_0x465c1f[_0xaf68bf(0x192)][_0xaf68bf(0x169)],[,_0x231219]=_0x10ddcf[_0xaf68bf(0x151)]('\x20'),_0x3c8547=await Whatsapp_1[_0xaf68bf(0x114)][_0xaf68bf(0x177)]({'where':{'token':_0x231219}}),_0x35a8f0=_0x3c8547['companyId'],{Invoiceid:_0x29dd5b}=_0x465c1f[_0xaf68bf(0x146)],_0x5210c2=await(0x0,ShowInvoiceService_1['default'])(_0x29dd5b);return _0x174b7c[_0xaf68bf(0x162)](0xc8)['json'](_0x5210c2);};exports[a9_0x1e2aab(0x103)]=showApi;const showAllApi=async(_0x1f9b3a,_0x8a07d)=>{const _0x217e63=a9_0x1e2aab;try{const _0xaf9e28=_0x1f9b3a[_0x217e63(0x192)]['authorization'],[,_0x2e2f84]=_0xaf9e28['split']('\x20'),_0x570931=await Whatsapp_1[_0x217e63(0x114)][_0x217e63(0x177)]({'where':{'token':_0x2e2f84}}),_0x285996=_0x570931[_0x217e63(0x1a3)],{companyId:_0x285832,status:_0x4bd121}=_0x1f9b3a[_0x217e63(0x12a)];if(_0x285996===0x1){const _0x284983=await Invoices_1[_0x217e63(0x114)][_0x217e63(0x116)]({'where':{'companyId':_0x285832,'status':_0x4bd121}});return _0x8a07d[_0x217e63(0x162)](0xc8)[_0x217e63(0x115)](_0x284983);}else return _0x8a07d[_0x217e63(0x162)](0x191)[_0x217e63(0x115)]({'status':_0x217e63(0x136),'error':_0x217e63(0x15f)});}catch(_0x5b7ca1){return console[_0x217e63(0x12d)](_0x217e63(0x113),_0x5b7ca1),_0x8a07d[_0x217e63(0x162)](0x1f4)[_0x217e63(0x115)]({'error':'Erro\x20ao\x20buscar\x20invoices'});}};exports[a9_0x1e2aab(0xf7)]=showAllApi;const updateApi=async(_0x22ee57,_0x2dd09d)=>{const _0x158b85=a9_0x1e2aab,_0x1a1592=_0x22ee57[_0x158b85(0x192)][_0x158b85(0x169)],[,_0x1e5ef0]=_0x1a1592['split']('\x20'),_0x1d4e7d=await Whatsapp_1[_0x158b85(0x114)]['findOne']({'where':{'token':_0x1e5ef0}}),_0x5309cf=_0x1d4e7d[_0x158b85(0x1a3)],_0x48a13b=_0x22ee57[_0x158b85(0x12a)],_0x203efd=Yup[_0x158b85(0xf6)]()['shape']({'name':Yup[_0x158b85(0x158)]()});try{await _0x203efd['validate'](_0x48a13b);}catch(_0x112e35){throw new AppError_1[(_0x158b85(0x114))](_0x112e35[_0x158b85(0x15b)]);}const {id:_0x3a553a,status:_0x38b672}=_0x48a13b;if(_0x5309cf===0x1){const _0x19fa84=await(0x0,UpdateInvoiceService_1[_0x158b85(0x114)])({'id':_0x3a553a,'status':_0x38b672}),_0x5ba2ff=await Invoices_1[_0x158b85(0x114)][_0x158b85(0x10f)](_0x3a553a),_0x3d2db7=_0x5ba2ff[_0x158b85(0x1a3)],_0x55806a=await Company_1[_0x158b85(0x114)][_0x158b85(0x10f)](_0x3d2db7),_0x5c2664=new Date(_0x55806a[_0x158b85(0x16f)]);_0x5c2664['setDate'](_0x5c2664[_0x158b85(0x13a)]()+0x1e);const _0x519dac=_0x5c2664[_0x158b85(0x1a5)]()[_0x158b85(0x151)]('T')[0x0];if(_0x55806a){await _0x55806a[_0x158b85(0x141)]({'dueDate':_0x519dac});const _0x7beaa=await _0x5ba2ff[_0x158b85(0x141)]({'id':_0x3a553a,'status':_0x158b85(0x104)});await _0x55806a[_0x158b85(0xed)]();const _0x59ed4c=(0x0,socket_1[_0x158b85(0x1ae)])(),_0x58480a=await Company_1['default']['findOne']({'where':{'id':_0x3d2db7}});}return _0x2dd09d[_0x158b85(0x162)](0xc8)[_0x158b85(0x115)](_0x19fa84);}else return _0x2dd09d['status'](0x191)['json']({'status':_0x158b85(0x136),'error':_0x158b85(0x15f)});};exports['updateApi']=updateApi;const updateUsageStats=async(_0x1862e9,_0x520b01)=>{const _0x227895=a9_0x1e2aab;if(!_0x1862e9['user']||!_0x1862e9[_0x227895(0x108)][_0x227895(0x1a3)])return _0x520b01[_0x227895(0x162)](0x190)[_0x227895(0x1a0)]({'status':_0x227895(0x159),'message':_0x227895(0x125)});const {companyId:_0x588af1}=_0x1862e9[_0x227895(0x108)],{contactId:_0x1093eb}=_0x1862e9[_0x227895(0x146)];return setTimeout(async()=>{const _0x346c21=_0x227895,{dateToClient:_0x2f5204}=(0x0,useDate_1[_0x346c21(0x1ac)])(),_0x5484c6=_0x2f5204(new Date()[_0x346c21(0x132)]()),_0x2d2855=(0x0,moment_1[_0x346c21(0x114)])()[_0x346c21(0x134)]();try{const _0x108c7c=await ApiUsages_1[_0x346c21(0x114)][_0x346c21(0x177)]({'where':{'dateUsed':_0x5484c6,'companyId':_0x588af1}});if(_0x108c7c)await _0x108c7c[_0x346c21(0x141)]({'usedOther':_0x108c7c[_0x346c21(0x110)][_0x346c21(0x133)]+0x1,'UsedOnDay':_0x108c7c['dataValues'][_0x346c21(0x18b)]+0x1,'updatedAt':_0x2d2855});else{const _0x35ad2e=await ApiUsages_1[_0x346c21(0x114)][_0x346c21(0xef)]({'companyId':_0x588af1,'dateUsed':_0x5484c6});await _0x35ad2e[_0x346c21(0x141)]({'usedOther':_0x35ad2e[_0x346c21(0x110)][_0x346c21(0x133)]+0x1,'UsedOnDay':_0x35ad2e[_0x346c21(0x110)][_0x346c21(0x18b)]+0x1,'updatedAt':_0x2d2855});}}catch(_0x3522d2){return console[_0x346c21(0x12d)](_0x346c21(0x10e),_0x3522d2),_0x520b01[_0x346c21(0x162)](0x1f4)[_0x346c21(0x1a0)]({'status':_0x346c21(0x159),'message':_0x346c21(0x187)});}},0x64),_0x520b01['send']({'status':'SUCCESS'});};exports[a9_0x1e2aab(0x117)]=updateUsageStats;const indexContacts=async(_0x449209,_0x1c1594)=>{const _0x4bb158=a9_0x1e2aab,{searchParam:_0x122eeb,pageNumber:_0x3d39a3}=_0x449209[_0x4bb158(0x107)],{companyId:_0xb02c65}=_0x449209[_0x4bb158(0x108)],{contacts:_0x34f811,count:_0x1261a2,hasMore:_0x13824a}=await(0x0,ListContactsService_1[_0x4bb158(0x114)])({'searchParam':_0x122eeb,'pageNumber':_0x3d39a3,'companyId':_0xb02c65});return _0x1c1594['json']({'contacts':_0x34f811,'count':_0x1261a2,'hasMore':_0x13824a});};exports[a9_0x1e2aab(0xf3)]=indexContacts;const listContacts=async(_0xd5418f,_0x158203)=>{const _0x1db695=a9_0x1e2aab,{name:_0x59736d}=_0xd5418f['query'],{companyId:_0x3c907e}=_0xd5418f['user'],_0x576d69=await(0x0,SimpleListService_1[_0x1db695(0x114)])({'name':_0x59736d,'companyId':_0x3c907e});return _0x158203['json'](_0x576d69);};exports['listContacts']=listContacts;const showContacts=async(_0x24482a,_0x269b64)=>{const _0x4c2510=a9_0x1e2aab,{contactId:_0x299026}=_0x24482a[_0x4c2510(0x146)],{companyId:_0xfd8460}=_0x24482a[_0x4c2510(0x108)],_0x29bb65=await(0x0,ShowContactService_1['default'])(_0x299026,_0xfd8460);return _0x269b64['status'](0xc8)[_0x4c2510(0x115)](_0x29bb65);};exports[a9_0x1e2aab(0x118)]=showContacts;const findOrCreateContacts=async(_0x3cfdc3,_0x5489f1)=>{const _0x1b64e4=a9_0x1e2aab,{name:_0x3c1036,number:_0x882fda}=_0x3cfdc3[_0x1b64e4(0x12a)],{companyId:_0x43449d}=_0x3cfdc3[_0x1b64e4(0x108)],_0xcd084a=await(0x0,GetContactService_1[_0x1b64e4(0x114)])({'name':_0x3c1036,'number':_0x882fda,'companyId':_0x43449d});return _0x5489f1[_0x1b64e4(0x162)](0xc8)['json'](_0xcd084a);};exports[a9_0x1e2aab(0x1a7)]=findOrCreateContacts;const storeContacts=async(_0x1224f3,_0x1032f2)=>{const _0x482c0a=a9_0x1e2aab,{companyId:_0x2f195f}=_0x1224f3[_0x482c0a(0x108)],_0x501bd3=_0x1224f3[_0x482c0a(0x12a)];_0x501bd3[_0x482c0a(0xf9)]=_0x501bd3[_0x482c0a(0xf9)][_0x482c0a(0x172)]('-','')['replace']('\x20','');const _0x8d23b=Yup[_0x482c0a(0xf6)]()[_0x482c0a(0x142)]({'name':Yup['string']()[_0x482c0a(0x1b0)](),'number':Yup[_0x482c0a(0x158)]()[_0x482c0a(0x1b0)]()[_0x482c0a(0x1a9)](/^\d+$/,_0x482c0a(0x161))});try{await _0x8d23b[_0x482c0a(0x147)](_0x501bd3);}catch(_0x18d99f){throw new AppError_1[(_0x482c0a(0x114))](_0x18d99f[_0x482c0a(0x15b)]);}await(0x0,CheckIsValidContact_1['default'])(_0x501bd3['number'],_0x2f195f);const _0x488879=await(0x0,CheckNumber_1[_0x482c0a(0x114)])(_0x501bd3[_0x482c0a(0xf9)],_0x2f195f),_0x3e1dcd=_0x488879[_0x482c0a(0x15e)][_0x482c0a(0x172)](/\D/g,'');_0x501bd3['number']=_0x3e1dcd;const _0x592c3e=await(0x0,CreateContactService_1[_0x482c0a(0x114)])({..._0x501bd3,'companyId':_0x2f195f}),_0x1fef90=(0x0,socket_1[_0x482c0a(0x1ae)])();return _0x1fef90['emit']('company-'+_0x2f195f+_0x482c0a(0x185),{'action':_0x482c0a(0xef),'contact':_0x592c3e}),_0x1032f2['status'](0xc8)[_0x482c0a(0x115)](_0x592c3e);};exports['storeContacts']=storeContacts;const removeAllContacts=async(_0x19e0c6,_0x5512b6)=>{const _0x5400bd=a9_0x1e2aab,{companyId:_0x4467e6}=_0x19e0c6['user'];try{await Contact_1[_0x5400bd(0x114)]['destroy']({'where':{'companyId':_0x4467e6}});const _0x34abdd=(0x0,socket_1[_0x5400bd(0x1ae)])();return _0x34abdd[_0x5400bd(0xe9)](_0x5400bd(0x131)+_0x4467e6+_0x5400bd(0x185),{'action':_0x5400bd(0x1aa)}),setTimeout(async()=>{const _0x1059c9=_0x5400bd,{dateToClient:_0x2299ee}=(0x0,useDate_1['useDate'])(),_0x5333a5=_0x2299ee(new Date()[_0x1059c9(0x132)]()),_0x9451c2=(0x0,moment_1['default'])()[_0x1059c9(0x134)]();try{const _0x21fa8a=await ApiUsages_1[_0x1059c9(0x114)][_0x1059c9(0x177)]({'where':{'dateUsed':_0x5333a5,'companyId':_0x4467e6}});if(_0x21fa8a)await _0x21fa8a[_0x1059c9(0x141)]({'usedOther':_0x21fa8a[_0x1059c9(0x110)]['usedOther']+0x1,'UsedOnDay':_0x21fa8a[_0x1059c9(0x110)][_0x1059c9(0x18b)]+0x1,'updatedAt':_0x9451c2});else{const _0x8715ef=await ApiUsages_1['default']['create']({'companyId':_0x4467e6,'dateUsed':_0x5333a5});await _0x8715ef[_0x1059c9(0x141)]({'usedOther':_0x8715ef[_0x1059c9(0x110)][_0x1059c9(0x133)]+0x1,'UsedOnDay':_0x8715ef['dataValues']['UsedOnDay']+0x1,'updatedAt':_0x9451c2});}}catch(_0xf6f021){return console[_0x1059c9(0x12d)]('Error\x20updating\x20usage\x20stats:',_0xf6f021),_0x5512b6['status'](0x1f4)[_0x1059c9(0x1a0)]({'status':_0x1059c9(0x159),'message':_0x1059c9(0x187)});}},0x64),_0x5512b6[_0x5400bd(0x162)](0xc8)[_0x5400bd(0x1a0)]({'status':_0x5400bd(0x1af),'message':_0x5400bd(0x1ad)});}catch(_0x2e7446){return console[_0x5400bd(0x12d)]('Error\x20removing\x20all\x20contacts:',_0x2e7446),_0x5512b6[_0x5400bd(0x162)](0x1f4)[_0x5400bd(0x1a0)]({'status':_0x5400bd(0x159),'message':_0x5400bd(0x187)});}};exports[a9_0x1e2aab(0x102)]=removeAllContacts;const updateContacts=async(_0x424def,_0x237fed)=>{const _0xa9b849=a9_0x1e2aab,_0x3ff5cf=_0x424def[_0xa9b849(0x12a)],{companyId:_0x215c24}=_0x424def[_0xa9b849(0x108)],_0x1b0b35=Yup[_0xa9b849(0xf6)]()['shape']({'name':Yup[_0xa9b849(0x158)](),'number':Yup[_0xa9b849(0x158)]()[_0xa9b849(0x1a9)](/^\d+$/,_0xa9b849(0x161))});try{await _0x1b0b35[_0xa9b849(0x147)](_0x3ff5cf);}catch(_0x3b803e){throw new AppError_1['default'](_0x3b803e[_0xa9b849(0x15b)]);}await(0x0,CheckIsValidContact_1[_0xa9b849(0x114)])(_0x3ff5cf[_0xa9b849(0xf9)],_0x215c24);const _0x1dcf25=await(0x0,CheckNumber_1['default'])(_0x3ff5cf[_0xa9b849(0xf9)],_0x215c24),_0x492042=_0x1dcf25['jid']['replace'](/\D/g,'');_0x3ff5cf[_0xa9b849(0xf9)]=_0x492042;const {contactId:_0x365960}=_0x424def[_0xa9b849(0x146)],_0x55be59=await(0x0,UpdateContactService_1[_0xa9b849(0x114)])({'contactData':_0x3ff5cf,'contactId':_0x365960,'companyId':_0x215c24}),_0x5eb290=(0x0,socket_1[_0xa9b849(0x1ae)])();return _0x5eb290['emit'](_0xa9b849(0x131)+_0x215c24+'-contact',{'action':'update','contact':_0x55be59}),_0x237fed[_0xa9b849(0x162)](0xc8)[_0xa9b849(0x115)](_0x55be59);};exports['updateContacts']=updateContacts;const removeContacts=async(_0x3e6674,_0x5ef87a)=>{const _0x2c6955=a9_0x1e2aab,{contactId:_0x2ac926}=_0x3e6674[_0x2c6955(0x146)],{companyId:_0x3c0965}=_0x3e6674[_0x2c6955(0x108)];await(0x0,ShowContactService_1[_0x2c6955(0x114)])(_0x2ac926,_0x3c0965),await(0x0,DeleteContactService_1['default'])(_0x2ac926);const _0x494a32=(0x0,socket_1[_0x2c6955(0x1ae)])();return _0x494a32[_0x2c6955(0xe9)](_0x2c6955(0x131)+_0x3c0965+_0x2c6955(0x185),{'action':_0x2c6955(0xfc),'contactId':_0x2ac926}),_0x5ef87a['status'](0xc8)[_0x2c6955(0x115)]({'message':'Contact\x20deleted'});};exports[a9_0x1e2aab(0x1b6)]=removeContacts;const uploadContacts=async(_0x3d3647,_0x55bc8c)=>{const _0x202ac5=a9_0x1e2aab,_0x189b72=_0x3d3647['files'],_0x3724ad=(0x0,lodash_1[_0x202ac5(0x11e)])(_0x189b72),{companyId:_0x466136}=_0x3d3647[_0x202ac5(0x108)],_0x193cec=await(0x0,ImportXLSContactsService_1['ImportXLSContactsService'])(_0x466136,_0x3724ad),_0xad5458=(0x0,socket_1[_0x202ac5(0x1ae)])(),_0x4b8f1d={'action':_0x202ac5(0xed),'records':_0x193cec};return _0xad5458['to'](_0x202ac5(0x131)+_0x466136+'-mainchannel')[_0x202ac5(0xe9)]('company-'+_0x466136+_0x202ac5(0x185),_0x4b8f1d),_0x55bc8c[_0x202ac5(0x162)](0xc8)['json'](_0x193cec);};exports[a9_0x1e2aab(0x155)]=uploadContacts;const toggleDisableBotContacts=async(_0x1a9a53,_0x423b8f)=>{const _0x41d51c=a9_0x1e2aab,{contactId:_0x3ddfec}=_0x1a9a53[_0x41d51c(0x146)],{companyId:_0x223c32}=_0x1a9a53['user'],_0x318468=await(0x0,ToggleDisableBotService_1[_0x41d51c(0x114)])(_0x3ddfec,_0x223c32),_0x2c1fd1=(0x0,socket_1[_0x41d51c(0x1ae)])();return _0x2c1fd1[_0x41d51c(0xe9)]('company-'+_0x223c32+'-contact',{'action':_0x41d51c(0x141),'contact':_0x318468}),_0x423b8f[_0x41d51c(0x162)](0xc8)[_0x41d51c(0x115)](_0x318468);};function a9_0x3e81(_0x47100,_0x135fcf){const _0x520579=a9_0x19db();return a9_0x3e81=function(_0x33fa13,_0x4d17d9){_0x33fa13=_0x33fa13-0xe7;let _0x19db5b=_0x520579[_0x33fa13];return _0x19db5b;},a9_0x3e81(_0x47100,_0x135fcf);}exports['toggleDisableBotContacts']=toggleDisableBotContacts;