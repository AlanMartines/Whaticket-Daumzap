const a444_0x22ca0f=a444_0xb4e8;(function(_0xc4ccde,_0x3ca540){const _0x4574e5=a444_0xb4e8,_0x4e6bb6=_0xc4ccde();while(!![]){try{const _0x158265=parseInt(_0x4574e5(0x1d7))/0x1*(parseInt(_0x4574e5(0x1d2))/0x2)+-parseInt(_0x4574e5(0x1bf))/0x3+-parseInt(_0x4574e5(0x1e0))/0x4+parseInt(_0x4574e5(0x1cb))/0x5+-parseInt(_0x4574e5(0x1d6))/0x6+parseInt(_0x4574e5(0x1c0))/0x7+parseInt(_0x4574e5(0x1d5))/0x8;if(_0x158265===_0x3ca540)break;else _0x4e6bb6['push'](_0x4e6bb6['shift']());}catch(_0x3ac3fd){_0x4e6bb6['push'](_0x4e6bb6['shift']());}}}(a444_0x892d,0x34859));const a444_0x22282b=(function(){let _0x491717=!![];return function(_0x4e5d14,_0x5bfba8){const _0x3f2bcb=_0x491717?function(){const _0x179567=a444_0xb4e8;if(_0x5bfba8){const _0x566028=_0x5bfba8[_0x179567(0x1bb)](_0x4e5d14,arguments);return _0x5bfba8=null,_0x566028;}}:function(){};return _0x491717=![],_0x3f2bcb;};}()),a444_0x2d0e91=a444_0x22282b(this,function(){const _0x264792=a444_0xb4e8;return a444_0x2d0e91[_0x264792(0x1cc)]()[_0x264792(0x1db)](_0x264792(0x1c4))[_0x264792(0x1cc)]()[_0x264792(0x1be)](a444_0x2d0e91)[_0x264792(0x1db)](_0x264792(0x1c4));});a444_0x2d0e91();'use strict';function a444_0xb4e8(_0x5e101a,_0xa0847e){const _0x370af3=a444_0x892d();return a444_0xb4e8=function(_0x2d0e91,_0x22282b){_0x2d0e91=_0x2d0e91-0x1bb;let _0x892d64=_0x370af3[_0x2d0e91];return _0x892d64;},a444_0xb4e8(_0x5e101a,_0xa0847e);}function a444_0x892d(){const _0x3aa60b=['update','1697456FiThTg','quotedMsg','../../models/OldMessage','../../models/Ticket','apply','available','__esModule','constructor','71142lfPVAF','2850400XOLorg','ERR_CREATING_MESSAGE','status','company-','(((.+)+)+)+$','-notification','../../libs/socket','reload','-contact','-appMessage','ticketId','1186680QVPTcK','toString','queue','default','upsert','../../models/Message','emit','106XNWBWH','queue-','__importDefault','304360qTmIZs','1664904mkseED','4870YdiJPX','contact','-mainchannel','findByPk','search','create','queueId','whatsapp'];a444_0x892d=function(){return _0x3aa60b;};return a444_0x892d();}var __importDefault=this&&this[a444_0x22ca0f(0x1d4)]||function(_0x60d0d8){const _0x37e3b6=a444_0x22ca0f;return _0x60d0d8&&_0x60d0d8[_0x37e3b6(0x1bd)]?_0x60d0d8:{'default':_0x60d0d8};};Object['defineProperty'](exports,a444_0x22ca0f(0x1bd),{'value':!![]});const socket_1=require(a444_0x22ca0f(0x1c6)),Message_1=__importDefault(require(a444_0x22ca0f(0x1d0))),Ticket_1=__importDefault(require(a444_0x22ca0f(0x1e3))),OldMessage_1=__importDefault(require(a444_0x22ca0f(0x1e2))),CreateMessageService=async({messageData:_0x5b486c,ticket:_0x370379,companyId:_0x813639})=>{const _0x5bc545=a444_0x22ca0f;await Message_1[_0x5bc545(0x1ce)][_0x5bc545(0x1cf)]({..._0x5b486c,'companyId':_0x813639});const _0x43b6e1=await Message_1[_0x5bc545(0x1ce)][_0x5bc545(0x1da)](_0x5b486c['id'],{'include':[_0x5bc545(0x1d8),{'model':Ticket_1[_0x5bc545(0x1ce)],'as':'ticket','include':[_0x5bc545(0x1d8),_0x5bc545(0x1cd),_0x5bc545(0x1de)]},{'model':Message_1[_0x5bc545(0x1ce)],'as':_0x5bc545(0x1e1),'include':[_0x5bc545(0x1d8)]},{'model':OldMessage_1['default'],'as':'oldMessages'}]});if(_0x370379[_0x5bc545(0x1d8)])await _0x370379[_0x5bc545(0x1d8)][_0x5bc545(0x1df)]({'presence':_0x5bc545(0x1bc)}),await _0x370379[_0x5bc545(0x1d8)][_0x5bc545(0x1c7)](),_0x370379[_0x5bc545(0x1dd)]!==null&&_0x43b6e1[_0x5bc545(0x1dd)]===null&&await _0x43b6e1[_0x5bc545(0x1df)]({'queueId':_0x370379[_0x5bc545(0x1dd)]});else throw new Error(_0x5bc545(0x1c1));if(!_0x43b6e1)throw new Error('ERR_CREATING_MESSAGE');const _0x1de289=(0x0,socket_1['getIO'])();return _0x1de289['to'](_0x43b6e1[_0x5bc545(0x1ca)][_0x5bc545(0x1cc)]())['to'](_0x5bc545(0x1c3)+_0x813639+'-'+_0x370379[_0x5bc545(0x1c2)])['to']('company-'+_0x813639+_0x5bc545(0x1c5))['to']('queue-'+_0x43b6e1[_0x5bc545(0x1dd)]+_0x5bc545(0x1c5))['to'](_0x5bc545(0x1d3)+_0x43b6e1[_0x5bc545(0x1dd)]+'-'+_0x370379['status'])[_0x5bc545(0x1d1)](_0x5bc545(0x1c3)+_0x813639+_0x5bc545(0x1c9),{'action':_0x5bc545(0x1dc),'message':_0x43b6e1,'ticket':_0x370379,'contact':_0x370379[_0x5bc545(0x1d8)]}),_0x1de289['to'](_0x5bc545(0x1c3)+_0x813639+_0x5bc545(0x1d9))[_0x5bc545(0x1d1)](_0x5bc545(0x1c3)+_0x813639+_0x5bc545(0x1c8),{'action':_0x5bc545(0x1df),'contact':_0x370379[_0x5bc545(0x1d8)]}),_0x43b6e1;};exports[a444_0x22ca0f(0x1ce)]=CreateMessageService;