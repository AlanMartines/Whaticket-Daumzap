const a491_0x4e3bc1=a491_0x50e0;(function(_0x2e56a8,_0x376c58){const _0x5870f2=a491_0x50e0,_0x2005b0=_0x2e56a8();while(!![]){try{const _0x32e6c0=parseInt(_0x5870f2(0xab))/0x1+-parseInt(_0x5870f2(0x8e))/0x2*(parseInt(_0x5870f2(0x9c))/0x3)+-parseInt(_0x5870f2(0xaa))/0x4*(-parseInt(_0x5870f2(0x9d))/0x5)+parseInt(_0x5870f2(0xb0))/0x6*(-parseInt(_0x5870f2(0xa8))/0x7)+-parseInt(_0x5870f2(0x89))/0x8+parseInt(_0x5870f2(0x8a))/0x9+parseInt(_0x5870f2(0xae))/0xa*(parseInt(_0x5870f2(0xad))/0xb);if(_0x32e6c0===_0x376c58)break;else _0x2005b0['push'](_0x2005b0['shift']());}catch(_0x85a1d0){_0x2005b0['push'](_0x2005b0['shift']());}}}(a491_0x42af,0xb2244));const a491_0x25b2da=(function(){let _0x4177c9=!![];return function(_0x1d1935,_0x17f51d){const _0x57a348=_0x4177c9?function(){if(_0x17f51d){const _0x3d1316=_0x17f51d['apply'](_0x1d1935,arguments);return _0x17f51d=null,_0x3d1316;}}:function(){};return _0x4177c9=![],_0x57a348;};}()),a491_0x59f750=a491_0x25b2da(this,function(){const _0x26e5f6=a491_0x50e0;return a491_0x59f750[_0x26e5f6(0x8d)]()[_0x26e5f6(0x92)](_0x26e5f6(0xb1))[_0x26e5f6(0x8d)]()[_0x26e5f6(0x93)](a491_0x59f750)[_0x26e5f6(0x92)](_0x26e5f6(0xb1));});a491_0x59f750();function a491_0x50e0(_0x40fd55,_0x4d6621){const _0x6c6982=a491_0x42af();return a491_0x50e0=function(_0x59f750,_0x25b2da){_0x59f750=_0x59f750-0x87;let _0x42afaa=_0x6c6982[_0x59f750];return _0x42afaa;},a491_0x50e0(_0x40fd55,_0x4d6621);}'use strict';var __importDefault=this&&this[a491_0x4e3bc1(0x94)]||function(_0x68fc11){return _0x68fc11&&_0x68fc11['__esModule']?_0x68fc11:{'default':_0x68fc11};};function a491_0x42af(){const _0x2b4297=['nodemailer','sequelize','Erro\x20interno\x20do\x20servidor','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','sendMail','Senha\x20Alterada\x20com\x20Sucesso','4239KqHeGQ','5YgHDqv','hash','../../database','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','QueryTypes','findOne','clientsecretsmtpauth','Email\x20ou\x20token\x20não\x20encontrado','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','7CMJvAG','query','5730472MkLmRy','867738ikMXva','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','33zIXjlW','1282370cgxfvE','defineProperty','6021726NlSmxe','(((.+)+)+)+$','smtpauth','all','SELECT','1869784FMyaVt','938799ekAJPL','createTransport','default','toString','1164rFFMPx','value','Configurações\x20SMTP\x20estão\x20incompletas','bcryptjs','search','constructor','__importDefault','Erro\x20ao\x20redefinir\x20senha:'];a491_0x42af=function(){return _0x2b4297;};return a491_0x42af();}Object[a491_0x4e3bc1(0xaf)](exports,'__esModule',{'value':!![]});const sequelize_1=__importDefault(require(a491_0x4e3bc1(0x97))),database_1=__importDefault(require(a491_0x4e3bc1(0x9f))),nodemailer_1=__importDefault(require(a491_0x4e3bc1(0x96))),Setting_1=__importDefault(require('../../models/Setting')),bcryptjs_1=require(a491_0x4e3bc1(0x91)),ResetPassword=async(_0x3535e6,_0x17661a,_0x1e1c48)=>{const _0x4a2f2a=a491_0x4e3bc1;try{const {hasResult:_0x634df7,data:_0x574997}=await filterUser(_0x3535e6,_0x17661a);if(!_0x634df7)return{'status':0x194,'message':_0x4a2f2a(0xa6)};const _0x45624f=await(0x0,bcryptjs_1[_0x4a2f2a(0x9e)])(_0x1e1c48,0x8),{hasResults:_0x47e3a7,datas:_0x500d1a}=await insertHasPassword(_0x3535e6,_0x17661a,_0x45624f);if(!_0x47e3a7)return{'status':0x194,'message':'Token\x20não\x20encontrado\x20ou\x20inválido'};const [_0x31a5a6,_0x59122b,_0x56204b,_0x31feb4]=await Promise[_0x4a2f2a(0x87)]([Setting_1[_0x4a2f2a(0x8c)]['findOne']({'where':{'key':_0x4a2f2a(0xb2)}}),Setting_1[_0x4a2f2a(0x8c)][_0x4a2f2a(0xa4)]({'where':{'key':'usersmtpauth'}}),Setting_1[_0x4a2f2a(0x8c)][_0x4a2f2a(0xa4)]({'where':{'key':_0x4a2f2a(0xa5)}}),Setting_1[_0x4a2f2a(0x8c)]['findOne']({'where':{'key':'smtpport'}})]),_0x2b716b=_0x31a5a6?.[_0x4a2f2a(0x8f)],_0xed33ab=_0x59122b?.[_0x4a2f2a(0x8f)],_0x359adc=_0x56204b?.['value'],_0x5141a7=_0xed33ab,_0x566246=_0x31feb4?.[_0x4a2f2a(0x8f)];if(!_0x2b716b||!_0xed33ab||!_0x359adc||!_0x566246)throw new Error(_0x4a2f2a(0x90));const _0x294bb3=nodemailer_1[_0x4a2f2a(0x8c)][_0x4a2f2a(0x8b)]({'host':_0x2b716b,'port':Number(_0x566246),'secure':![],'auth':{'user':_0xed33ab,'pass':_0x359adc}}),_0x1e0ee5={'from':_0x5141a7,'to':_0x3535e6,'subject':_0x4a2f2a(0x9b),'text':_0x4a2f2a(0xa7)},_0x2b072e=await _0x294bb3[_0x4a2f2a(0x9a)](_0x1e0ee5);return _0x2b072e;}catch(_0x159718){return console['error'](_0x4a2f2a(0x95),_0x159718),{'status':0x1f4,'message':_0x4a2f2a(0x98)};}},filterUser=async(_0x552575,_0x555080)=>{const _0x7034f8=a491_0x4e3bc1,_0x17bf37=_0x7034f8(0xa0)+_0x552575+_0x7034f8(0xa1),_0x35a8dc=await database_1['default']['query'](_0x17bf37,{'type':sequelize_1['default'][_0x7034f8(0xa3)][_0x7034f8(0x88)]});return{'hasResult':_0x35a8dc['length']>0x0,'data':_0x35a8dc};},insertHasPassword=async(_0x4e8c78,_0x13f853,_0x98d586)=>{const _0x2c997d=a491_0x4e3bc1,_0x12d910=_0x2c997d(0xa0)+_0x4e8c78+_0x2c997d(0xa2)+_0x13f853+'\x27',_0x515e1b=await database_1[_0x2c997d(0x8c)][_0x2c997d(0xa9)](_0x12d910,{'type':sequelize_1[_0x2c997d(0x8c)]['QueryTypes'][_0x2c997d(0x88)]}),_0x260519=_0x2c997d(0xac)+_0x98d586+_0x2c997d(0x99)+_0x4e8c78+_0x2c997d(0xa2)+_0x13f853+'\x27',_0x5545e6=await database_1[_0x2c997d(0x8c)][_0x2c997d(0xa9)](_0x260519,{'type':sequelize_1[_0x2c997d(0x8c)][_0x2c997d(0xa3)]['UPDATE']});return{'hasResults':_0x5545e6[0x1]>0x0,'datas':_0x515e1b};};exports[a491_0x4e3bc1(0x8c)]=ResetPassword;