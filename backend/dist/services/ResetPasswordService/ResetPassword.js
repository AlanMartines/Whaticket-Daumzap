const a491_0x13730c=a491_0x1496;(function(_0x58cf93,_0x3cd70b){const _0x4c12b0=a491_0x1496,_0xb964ee=_0x58cf93();while(!![]){try{const _0xb2ff4c=parseInt(_0x4c12b0(0xd7))/0x1*(-parseInt(_0x4c12b0(0xe9))/0x2)+-parseInt(_0x4c12b0(0xc3))/0x3*(-parseInt(_0x4c12b0(0xe7))/0x4)+-parseInt(_0x4c12b0(0xe0))/0x5*(parseInt(_0x4c12b0(0xe6))/0x6)+-parseInt(_0x4c12b0(0xce))/0x7+-parseInt(_0x4c12b0(0xcf))/0x8+parseInt(_0x4c12b0(0xbf))/0x9*(-parseInt(_0x4c12b0(0xc0))/0xa)+-parseInt(_0x4c12b0(0xd2))/0xb*(-parseInt(_0x4c12b0(0xe1))/0xc);if(_0xb2ff4c===_0x3cd70b)break;else _0xb964ee['push'](_0xb964ee['shift']());}catch(_0x123783){_0xb964ee['push'](_0xb964ee['shift']());}}}(a491_0x5ab7,0xc88a2));function a491_0x1496(_0x2645ab,_0x53f62c){const _0xe65248=a491_0x5ab7();return a491_0x1496=function(_0x4e9638,_0x421b4f){_0x4e9638=_0x4e9638-0xbb;let _0x5ab754=_0xe65248[_0x4e9638];return _0x5ab754;},a491_0x1496(_0x2645ab,_0x53f62c);}function a491_0x5ab7(){const _0x5d13b7=['defineProperty','apply','length','nodemailer','__esModule','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','default','139915ZiZaHZ','16404kdtJzv','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','hash','SELECT','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','6GCwQHp','1300gBoWZt','Configurações\x20SMTP\x20estão\x20incompletas','2DbFAzK','../../database','query','QueryTypes','clientsecretsmtpauth','createTransport','148329dnVpnD','320yXfCre','Token\x20não\x20encontrado\x20ou\x20inválido','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','3288cdKElQ','Senha\x20Alterada\x20com\x20Sucesso','smtpauth','usersmtpauth','smtpport','value','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','sequelize','Email\x20ou\x20token\x20não\x20encontrado','bcryptjs','findOne','7103278pYmKhh','10791912HzwMEY','../../models/Setting','toString','32351dbVGra','UPDATE','search','sendMail','(((.+)+)+)+$','636019jOZpEq'];a491_0x5ab7=function(){return _0x5d13b7;};return a491_0x5ab7();}const a491_0x421b4f=(function(){let _0x4cb264=!![];return function(_0x126caa,_0x31e228){const _0x2809f5=_0x4cb264?function(){const _0x5a8876=a491_0x1496;if(_0x31e228){const _0x36c5fb=_0x31e228[_0x5a8876(0xd9)](_0x126caa,arguments);return _0x31e228=null,_0x36c5fb;}}:function(){};return _0x4cb264=![],_0x2809f5;};}()),a491_0x4e9638=a491_0x421b4f(this,function(){const _0x43efdd=a491_0x1496;return a491_0x4e9638[_0x43efdd(0xd1)]()[_0x43efdd(0xd4)]('(((.+)+)+)+$')[_0x43efdd(0xd1)]()['constructor'](a491_0x4e9638)[_0x43efdd(0xd4)](_0x43efdd(0xd6));});a491_0x4e9638();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x7ac424){const _0xf28ab6=a491_0x1496;return _0x7ac424&&_0x7ac424[_0xf28ab6(0xdc)]?_0x7ac424:{'default':_0x7ac424};};Object[a491_0x13730c(0xd8)](exports,a491_0x13730c(0xdc),{'value':!![]});const sequelize_1=__importDefault(require(a491_0x13730c(0xca))),database_1=__importDefault(require(a491_0x13730c(0xea))),nodemailer_1=__importDefault(require(a491_0x13730c(0xdb))),Setting_1=__importDefault(require(a491_0x13730c(0xd0))),bcryptjs_1=require(a491_0x13730c(0xcc)),ResetPassword=async(_0x1b1273,_0x2b7c77,_0x542a5e)=>{const _0x214e40=a491_0x13730c;try{const {hasResult:_0xb80c1,data:_0x5c0c01}=await filterUser(_0x1b1273,_0x2b7c77);if(!_0xb80c1)return{'status':0x194,'message':_0x214e40(0xcb)};const _0x50a33a=await(0x0,bcryptjs_1[_0x214e40(0xe3)])(_0x542a5e,0x8),{hasResults:_0x2648ec,datas:_0x112951}=await insertHasPassword(_0x1b1273,_0x2b7c77,_0x50a33a);if(!_0x2648ec)return{'status':0x194,'message':_0x214e40(0xc1)};const [_0x31ef58,_0x2d6c08,_0x1dcbe8,_0x91adf2]=await Promise['all']([Setting_1[_0x214e40(0xdf)][_0x214e40(0xcd)]({'where':{'key':_0x214e40(0xc5)}}),Setting_1[_0x214e40(0xdf)][_0x214e40(0xcd)]({'where':{'key':_0x214e40(0xc6)}}),Setting_1['default'][_0x214e40(0xcd)]({'where':{'key':_0x214e40(0xbd)}}),Setting_1[_0x214e40(0xdf)][_0x214e40(0xcd)]({'where':{'key':_0x214e40(0xc7)}})]),_0x5094f8=_0x31ef58?.[_0x214e40(0xc8)],_0xfcc3f=_0x2d6c08?.[_0x214e40(0xc8)],_0x4e9b4c=_0x1dcbe8?.[_0x214e40(0xc8)],_0x1dd542=_0xfcc3f,_0x5c2e2c=_0x91adf2?.[_0x214e40(0xc8)];if(!_0x5094f8||!_0xfcc3f||!_0x4e9b4c||!_0x5c2e2c)throw new Error(_0x214e40(0xe8));const _0x2a0f28=nodemailer_1['default'][_0x214e40(0xbe)]({'host':_0x5094f8,'port':Number(_0x5c2e2c),'secure':![],'auth':{'user':_0xfcc3f,'pass':_0x4e9b4c}}),_0x2f6fb6={'from':_0x1dd542,'to':_0x1b1273,'subject':_0x214e40(0xc4),'text':_0x214e40(0xde)},_0x1566d2=await _0x2a0f28[_0x214e40(0xd5)](_0x2f6fb6);return _0x1566d2;}catch(_0x352feb){return console['error']('Erro\x20ao\x20redefinir\x20senha:',_0x352feb),{'status':0x1f4,'message':'Erro\x20interno\x20do\x20servidor'};}},filterUser=async(_0x494038,_0x309b80)=>{const _0x56500c=a491_0x13730c,_0x74ba08=_0x56500c(0xe2)+_0x494038+_0x56500c(0xe5),_0x408b61=await database_1[_0x56500c(0xdf)][_0x56500c(0xbb)](_0x74ba08,{'type':sequelize_1[_0x56500c(0xdf)]['QueryTypes'][_0x56500c(0xe4)]});return{'hasResult':_0x408b61[_0x56500c(0xda)]>0x0,'data':_0x408b61};},insertHasPassword=async(_0x3879d8,_0x257469,_0x103a66)=>{const _0x34da71=a491_0x13730c,_0x3dae52='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27'+_0x3879d8+_0x34da71(0xdd)+_0x257469+'\x27',_0x579a2c=await database_1[_0x34da71(0xdf)][_0x34da71(0xbb)](_0x3dae52,{'type':sequelize_1[_0x34da71(0xdf)]['QueryTypes']['SELECT']}),_0x46551e=_0x34da71(0xc2)+_0x103a66+_0x34da71(0xc9)+_0x3879d8+_0x34da71(0xdd)+_0x257469+'\x27',_0x312e10=await database_1[_0x34da71(0xdf)][_0x34da71(0xbb)](_0x46551e,{'type':sequelize_1[_0x34da71(0xdf)][_0x34da71(0xbc)][_0x34da71(0xd3)]});return{'hasResults':_0x312e10[0x1]>0x0,'datas':_0x579a2c};};exports[a491_0x13730c(0xdf)]=ResetPassword;