const a491_0x193888=a491_0x163d;(function(_0x538c7e,_0x503d93){const _0x3159e0=a491_0x163d,_0x52e9f3=_0x538c7e();while(!![]){try{const _0x1a4a46=parseInt(_0x3159e0(0x18b))/0x1+parseInt(_0x3159e0(0x18d))/0x2*(-parseInt(_0x3159e0(0x1a7))/0x3)+-parseInt(_0x3159e0(0x1a4))/0x4+parseInt(_0x3159e0(0x1a1))/0x5*(parseInt(_0x3159e0(0x19e))/0x6)+parseInt(_0x3159e0(0x1a0))/0x7+parseInt(_0x3159e0(0x1ad))/0x8+parseInt(_0x3159e0(0x19b))/0x9*(parseInt(_0x3159e0(0x19d))/0xa);if(_0x1a4a46===_0x503d93)break;else _0x52e9f3['push'](_0x52e9f3['shift']());}catch(_0x40e52b){_0x52e9f3['push'](_0x52e9f3['shift']());}}}(a491_0x6224,0xd854a));function a491_0x6224(){const _0x197958=['createTransport','all','findOne','search','729701uEzuFW','../../database','16sTfoQP','bcryptjs','smtpport','value','SELECT','Email\x20ou\x20token\x20não\x20encontrado','Erro\x20interno\x20do\x20servidor','hash','sequelize','../../models/Setting','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','apply','__esModule','error','1573731tEwEQN','Token\x20não\x20encontrado\x20ou\x20inválido','40bGGhkT','204rZVxcf','Senha\x20Alterada\x20com\x20Sucesso','676690zIKatA','243305zAFdSc','defineProperty','toString','4237072wPomxk','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','__importDefault','537798KdgqCu','default','sendMail','Configurações\x20SMTP\x20estão\x20incompletas','(((.+)+)+)+$','UPDATE','1593640RSyXLt','clientsecretsmtpauth','length','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','QueryTypes','query'];a491_0x6224=function(){return _0x197958;};return a491_0x6224();}const a491_0xb99f4e=(function(){let _0x23767e=!![];return function(_0x528573,_0x34703c){const _0x2f7c77=_0x23767e?function(){const _0x22da99=a491_0x163d;if(_0x34703c){const _0x1c08a6=_0x34703c[_0x22da99(0x198)](_0x528573,arguments);return _0x34703c=null,_0x1c08a6;}}:function(){};return _0x23767e=![],_0x2f7c77;};}()),a491_0x593707=a491_0xb99f4e(this,function(){const _0x1bbb17=a491_0x163d;return a491_0x593707[_0x1bbb17(0x1a3)]()[_0x1bbb17(0x18a)](_0x1bbb17(0x1ab))['toString']()['constructor'](a491_0x593707)['search'](_0x1bbb17(0x1ab));});a491_0x593707();'use strict';var __importDefault=this&&this[a491_0x193888(0x1a6)]||function(_0x2d2f1a){const _0x17afa4=a491_0x193888;return _0x2d2f1a&&_0x2d2f1a[_0x17afa4(0x199)]?_0x2d2f1a:{'default':_0x2d2f1a};};Object[a491_0x193888(0x1a2)](exports,a491_0x193888(0x199),{'value':!![]});function a491_0x163d(_0x4a0a15,_0x3928e6){const _0x1b8546=a491_0x6224();return a491_0x163d=function(_0x593707,_0xb99f4e){_0x593707=_0x593707-0x183;let _0x622409=_0x1b8546[_0x593707];return _0x622409;},a491_0x163d(_0x4a0a15,_0x3928e6);}const sequelize_1=__importDefault(require(a491_0x193888(0x195))),database_1=__importDefault(require(a491_0x193888(0x18c))),nodemailer_1=__importDefault(require('nodemailer')),Setting_1=__importDefault(require(a491_0x193888(0x196))),bcryptjs_1=require(a491_0x193888(0x18e)),ResetPassword=async(_0x4a2e27,_0x5d999d,_0x4237ef)=>{const _0x63edc4=a491_0x193888;try{const {hasResult:_0x34925a,data:_0x5d1fb8}=await filterUser(_0x4a2e27,_0x5d999d);if(!_0x34925a)return{'status':0x194,'message':_0x63edc4(0x192)};const _0x5d5d20=await(0x0,bcryptjs_1[_0x63edc4(0x194)])(_0x4237ef,0x8),{hasResults:_0x520eae,datas:_0x2320d4}=await insertHasPassword(_0x4a2e27,_0x5d999d,_0x5d5d20);if(!_0x520eae)return{'status':0x194,'message':_0x63edc4(0x19c)};const [_0x401a16,_0x5d26e2,_0x223f96,_0x10262b]=await Promise[_0x63edc4(0x188)]([Setting_1['default'][_0x63edc4(0x189)]({'where':{'key':'smtpauth'}}),Setting_1[_0x63edc4(0x1a8)][_0x63edc4(0x189)]({'where':{'key':'usersmtpauth'}}),Setting_1['default'][_0x63edc4(0x189)]({'where':{'key':_0x63edc4(0x1ae)}}),Setting_1[_0x63edc4(0x1a8)][_0x63edc4(0x189)]({'where':{'key':_0x63edc4(0x18f)}})]),_0x4764ba=_0x401a16?.[_0x63edc4(0x190)],_0x596af8=_0x5d26e2?.['value'],_0x9173aa=_0x223f96?.[_0x63edc4(0x190)],_0x42ae43=_0x596af8,_0x34392e=_0x10262b?.['value'];if(!_0x4764ba||!_0x596af8||!_0x9173aa||!_0x34392e)throw new Error(_0x63edc4(0x1aa));const _0x4d5c45=nodemailer_1[_0x63edc4(0x1a8)][_0x63edc4(0x187)]({'host':_0x4764ba,'port':Number(_0x34392e),'secure':![],'auth':{'user':_0x596af8,'pass':_0x9173aa}}),_0x452bf4={'from':_0x42ae43,'to':_0x4a2e27,'subject':_0x63edc4(0x19f),'text':_0x63edc4(0x184)},_0xc8421e=await _0x4d5c45[_0x63edc4(0x1a9)](_0x452bf4);return _0xc8421e;}catch(_0x2caa30){return console[_0x63edc4(0x19a)]('Erro\x20ao\x20redefinir\x20senha:',_0x2caa30),{'status':0x1f4,'message':_0x63edc4(0x193)};}},filterUser=async(_0x273141,_0x30bad8)=>{const _0x103c80=a491_0x193888,_0x4b5b07=_0x103c80(0x1a5)+_0x273141+'\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27',_0xe1bcce=await database_1[_0x103c80(0x1a8)][_0x103c80(0x186)](_0x4b5b07,{'type':sequelize_1[_0x103c80(0x1a8)][_0x103c80(0x185)][_0x103c80(0x191)]});return{'hasResult':_0xe1bcce[_0x103c80(0x1af)]>0x0,'data':_0xe1bcce};},insertHasPassword=async(_0xe1607f,_0x3076b0,_0x4e6e02)=>{const _0x59d779=a491_0x193888,_0x41e16c='SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27'+_0xe1607f+'\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27'+_0x3076b0+'\x27',_0x42fc42=await database_1[_0x59d779(0x1a8)][_0x59d779(0x186)](_0x41e16c,{'type':sequelize_1[_0x59d779(0x1a8)][_0x59d779(0x185)][_0x59d779(0x191)]}),_0x4b2d6a=_0x59d779(0x183)+_0x4e6e02+_0x59d779(0x197)+_0xe1607f+'\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27'+_0x3076b0+'\x27',_0x1328e9=await database_1['default']['query'](_0x4b2d6a,{'type':sequelize_1[_0x59d779(0x1a8)]['QueryTypes'][_0x59d779(0x1ac)]});return{'hasResults':_0x1328e9[0x1]>0x0,'datas':_0x42fc42};};exports[a491_0x193888(0x1a8)]=ResetPassword;