function a491_0x242e(_0x143a87,_0x4bac76){const _0x2a55f3=a491_0x4e5c();return a491_0x242e=function(_0x4009da,_0x21c4e2){_0x4009da=_0x4009da-0x191;let _0x4e5c62=_0x2a55f3[_0x4009da];return _0x4e5c62;},a491_0x242e(_0x143a87,_0x4bac76);}const a491_0x19f922=a491_0x242e;(function(_0x3be5b7,_0x2522d7){const _0x359dd2=a491_0x242e,_0x320ff0=_0x3be5b7();while(!![]){try{const _0x5b5513=-parseInt(_0x359dd2(0x1ad))/0x1*(-parseInt(_0x359dd2(0x1a4))/0x2)+parseInt(_0x359dd2(0x1ac))/0x3+-parseInt(_0x359dd2(0x1aa))/0x4*(-parseInt(_0x359dd2(0x1a3))/0x5)+-parseInt(_0x359dd2(0x1a6))/0x6+parseInt(_0x359dd2(0x1a8))/0x7*(parseInt(_0x359dd2(0x1b2))/0x8)+parseInt(_0x359dd2(0x1b5))/0x9+-parseInt(_0x359dd2(0x19e))/0xa*(-parseInt(_0x359dd2(0x1b8))/0xb);if(_0x5b5513===_0x2522d7)break;else _0x320ff0['push'](_0x320ff0['shift']());}catch(_0x532027){_0x320ff0['push'](_0x320ff0['shift']());}}}(a491_0x4e5c,0x36a74));function a491_0x4e5c(){const _0x2059b1=['205570KvlkuD','length','../../database','sendMail','bcryptjs','85490CIOmVU','7416QrGegy','Senha\x20Alterada\x20com\x20Sucesso','2339220SECiKt','UPDATE','7PQxWaA','apply','32BTdGKK','error','540465QQEqVB','14BtOvMf','SELECT','value','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x20\x27','default','337376XXmPaf','sequelize','QueryTypes','529272xfZFFH','search','\x27,\x20\x22resetPassword\x22\x20=\x20\x27\x27\x20WHERE\x20email=\x20\x27','77ftqGtp','smtpauth','createTransport','\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27','(((.+)+)+)+$','all','UPDATE\x20\x22Users\x22\x20SET\x20\x22passwordHash\x22=\x20\x27','__importDefault','\x27\x20AND\x20\x22resetPassword\x22\x20!=\x20\x27\x27','Configurações\x20SMTP\x20estão\x20incompletas','nodemailer','query','Olá,\x0a\x0aSua\x20senha\x20foi\x20alterada\x20com\x20sucesso.\x0a\x0aSe\x20você\x20não\x20realizou\x20essa\x20alteração,\x20entre\x20em\x20contato\x20conosco\x20imediatamente.\x0a\x0aAtenciosamente','Erro\x20ao\x20redefinir\x20senha:','Email\x20ou\x20token\x20não\x20encontrado','findOne'];a491_0x4e5c=function(){return _0x2059b1;};return a491_0x4e5c();}const a491_0x21c4e2=(function(){let _0x1c83ba=!![];return function(_0x4c21b6,_0x432e84){const _0x54a5de=_0x1c83ba?function(){const _0xef5e83=a491_0x242e;if(_0x432e84){const _0x421aaf=_0x432e84[_0xef5e83(0x1a9)](_0x4c21b6,arguments);return _0x432e84=null,_0x421aaf;}}:function(){};return _0x1c83ba=![],_0x54a5de;};}()),a491_0x4009da=a491_0x21c4e2(this,function(){const _0x59019f=a491_0x242e;return a491_0x4009da['toString']()[_0x59019f(0x1b6)](_0x59019f(0x192))['toString']()['constructor'](a491_0x4009da)['search'](_0x59019f(0x192));});a491_0x4009da();'use strict';var __importDefault=this&&this[a491_0x19f922(0x195)]||function(_0x1f1d28){return _0x1f1d28&&_0x1f1d28['__esModule']?_0x1f1d28:{'default':_0x1f1d28};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const sequelize_1=__importDefault(require(a491_0x19f922(0x1b3))),database_1=__importDefault(require(a491_0x19f922(0x1a0))),nodemailer_1=__importDefault(require(a491_0x19f922(0x198))),Setting_1=__importDefault(require('../../models/Setting')),bcryptjs_1=require(a491_0x19f922(0x1a2)),ResetPassword=async(_0x4c5b0b,_0x4b1325,_0x395149)=>{const _0x4c0e53=a491_0x19f922;try{const {hasResult:_0x4e9834,data:_0x1d1caa}=await filterUser(_0x4c5b0b,_0x4b1325);if(!_0x4e9834)return{'status':0x194,'message':_0x4c0e53(0x19c)};const _0x1da17d=await(0x0,bcryptjs_1['hash'])(_0x395149,0x8),{hasResults:_0x25c20f,datas:_0x1dd997}=await insertHasPassword(_0x4c5b0b,_0x4b1325,_0x1da17d);if(!_0x25c20f)return{'status':0x194,'message':'Token\x20não\x20encontrado\x20ou\x20inválido'};const [_0x331b2a,_0x2a7180,_0x16d7b2,_0x4d5346]=await Promise[_0x4c0e53(0x193)]([Setting_1[_0x4c0e53(0x1b1)][_0x4c0e53(0x19d)]({'where':{'key':_0x4c0e53(0x1b9)}}),Setting_1['default'][_0x4c0e53(0x19d)]({'where':{'key':'usersmtpauth'}}),Setting_1['default'][_0x4c0e53(0x19d)]({'where':{'key':'clientsecretsmtpauth'}}),Setting_1[_0x4c0e53(0x1b1)][_0x4c0e53(0x19d)]({'where':{'key':'smtpport'}})]),_0x37a56f=_0x331b2a?.['value'],_0x34c33d=_0x2a7180?.[_0x4c0e53(0x1af)],_0x17e118=_0x16d7b2?.[_0x4c0e53(0x1af)],_0x2b05f3=_0x34c33d,_0x4dec9b=_0x4d5346?.['value'];if(!_0x37a56f||!_0x34c33d||!_0x17e118||!_0x4dec9b)throw new Error(_0x4c0e53(0x197));const _0x256da4=nodemailer_1[_0x4c0e53(0x1b1)][_0x4c0e53(0x1ba)]({'host':_0x37a56f,'port':Number(_0x4dec9b),'secure':![],'auth':{'user':_0x34c33d,'pass':_0x17e118}}),_0xb7693a={'from':_0x2b05f3,'to':_0x4c5b0b,'subject':_0x4c0e53(0x1a5),'text':_0x4c0e53(0x19a)},_0x409a07=await _0x256da4[_0x4c0e53(0x1a1)](_0xb7693a);return _0x409a07;}catch(_0x34ec86){return console[_0x4c0e53(0x1ab)](_0x4c0e53(0x19b),_0x34ec86),{'status':0x1f4,'message':'Erro\x20interno\x20do\x20servidor'};}},filterUser=async(_0x11bf13,_0x26229a)=>{const _0x37bd57=a491_0x19f922,_0xffc2e=_0x37bd57(0x1b0)+_0x11bf13+_0x37bd57(0x196),_0x2dc853=await database_1[_0x37bd57(0x1b1)][_0x37bd57(0x199)](_0xffc2e,{'type':sequelize_1['default'][_0x37bd57(0x1b4)]['SELECT']});return{'hasResult':_0x2dc853[_0x37bd57(0x19f)]>0x0,'data':_0x2dc853};},insertHasPassword=async(_0x39019b,_0x378e05,_0x47bfec)=>{const _0x1da2a0=a491_0x19f922,_0x2d9af1=_0x1da2a0(0x1b0)+_0x39019b+_0x1da2a0(0x191)+_0x378e05+'\x27',_0x5c018=await database_1[_0x1da2a0(0x1b1)][_0x1da2a0(0x199)](_0x2d9af1,{'type':sequelize_1['default']['QueryTypes'][_0x1da2a0(0x1ae)]}),_0x41d56d=_0x1da2a0(0x194)+_0x47bfec+_0x1da2a0(0x1b7)+_0x39019b+'\x27\x20AND\x20\x22resetPassword\x22\x20=\x20\x27'+_0x378e05+'\x27',_0x1a8262=await database_1[_0x1da2a0(0x1b1)][_0x1da2a0(0x199)](_0x41d56d,{'type':sequelize_1[_0x1da2a0(0x1b1)]['QueryTypes'][_0x1da2a0(0x1a7)]});return{'hasResults':_0x1a8262[0x1]>0x0,'datas':_0x5c018};};exports['default']=ResetPassword;