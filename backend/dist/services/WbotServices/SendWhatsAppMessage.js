const a550_0x1db49b=a550_0x1089;(function(_0x294854,_0x43cf52){const _0x3e570d=a550_0x1089,_0x53d638=_0x294854();while(!![]){try{const _0x35ea7c=-parseInt(_0x3e570d(0x20d))/0x1*(-parseInt(_0x3e570d(0x1f3))/0x2)+-parseInt(_0x3e570d(0x20a))/0x3+-parseInt(_0x3e570d(0x207))/0x4*(parseInt(_0x3e570d(0x20f))/0x5)+-parseInt(_0x3e570d(0x1ee))/0x6*(parseInt(_0x3e570d(0x1e0))/0x7)+-parseInt(_0x3e570d(0x20c))/0x8+-parseInt(_0x3e570d(0x211))/0x9+parseInt(_0x3e570d(0x1f9))/0xa*(parseInt(_0x3e570d(0x200))/0xb);if(_0x35ea7c===_0x43cf52)break;else _0x53d638['push'](_0x53d638['shift']());}catch(_0x3c2829){_0x53d638['push'](_0x53d638['shift']());}}}(a550_0x5b05,0x34c74));function a550_0x1089(_0x9f933,_0x7e5efe){const _0x20f806=a550_0x5b05();return a550_0x1089=function(_0x534d62,_0x34eb33){_0x534d62=_0x534d62-0x1de;let _0x5b054e=_0x20f806[_0x534d62];return _0x5b054e;},a550_0x1089(_0x9f933,_0x7e5efe);}const a550_0x34eb33=(function(){let _0x5b24cc=!![];return function(_0x5523c9,_0x15cf89){const _0x47f8a1=_0x5b24cc?function(){if(_0x15cf89){const _0xf55a1b=_0x15cf89['apply'](_0x5523c9,arguments);return _0x15cf89=null,_0xf55a1b;}}:function(){};return _0x5b24cc=![],_0x47f8a1;};}()),a550_0x534d62=a550_0x34eb33(this,function(){const _0x4a3201=a550_0x1089;return a550_0x534d62[_0x4a3201(0x215)]()[_0x4a3201(0x1f0)](_0x4a3201(0x1e7))[_0x4a3201(0x215)]()[_0x4a3201(0x209)](a550_0x534d62)[_0x4a3201(0x1f0)](_0x4a3201(0x1e7));});function a550_0x5b05(){const _0x320ee4=['../../models/Message','update','prototype','isGroup','264319lDlFLO','ERR_SENDING_WAPP_MSG','contact','configurable','__esModule','FN:','parse','829316ffTUSq','isNil','constructor','757533FWMyVt','../../helpers/GetTicketWbot','785320TOCHeI','251VOkTmj','../../helpers/Mustache','5lBYVFk','__importDefault','357147xCzMYj','dataJson','g.us','sendMessage','toString','split','BEGIN:VCARD\x0aVERSION:3.0\x0a','trace','6538jmiHjn',';;;\x0a','__importStar','get','defineProperty','@sentry/node','s.whatsapp.net','(((.+)+)+)+$','key','number','create','getOwnPropertyDescriptor','__setModuleDefault','__createBinding','906ulqbwA','captureException','search','default','extendedTextMessage','716HMiirF','message','../../errors/AppError','findOne','call','TEL;type=CELL;waid=','360aGeiwA','name','ERR_WBOT_NOT_FOUND'];a550_0x5b05=function(){return _0x320ee4;};return a550_0x5b05();}a550_0x534d62();'use strict';var __createBinding=this&&this[a550_0x1db49b(0x1ed)]||(Object[a550_0x1db49b(0x1ea)]?function(_0x36595c,_0x581ccb,_0x10bbea,_0x4853bc){const _0x39eb5d=a550_0x1db49b;if(_0x4853bc===undefined)_0x4853bc=_0x10bbea;var _0x2eca7b=Object[_0x39eb5d(0x1eb)](_0x581ccb,_0x10bbea);(!_0x2eca7b||(_0x39eb5d(0x1e3)in _0x2eca7b?!_0x581ccb[_0x39eb5d(0x204)]:_0x2eca7b['writable']||_0x2eca7b[_0x39eb5d(0x203)]))&&(_0x2eca7b={'enumerable':!![],'get':function(){return _0x581ccb[_0x10bbea];}}),Object['defineProperty'](_0x36595c,_0x4853bc,_0x2eca7b);}:function(_0x10744e,_0x16b4e1,_0x144bc9,_0x17577d){if(_0x17577d===undefined)_0x17577d=_0x144bc9;_0x10744e[_0x17577d]=_0x16b4e1[_0x144bc9];}),__setModuleDefault=this&&this[a550_0x1db49b(0x1ec)]||(Object[a550_0x1db49b(0x1ea)]?function(_0x546e6e,_0xe4ff33){Object['defineProperty'](_0x546e6e,'default',{'enumerable':!![],'value':_0xe4ff33});}:function(_0x163ae8,_0x39d578){const _0x19f859=a550_0x1db49b;_0x163ae8[_0x19f859(0x1f1)]=_0x39d578;}),__importStar=this&&this[a550_0x1db49b(0x1e2)]||function(_0x5d7322){const _0x2839b8=a550_0x1db49b;if(_0x5d7322&&_0x5d7322[_0x2839b8(0x204)])return _0x5d7322;var _0x3cad32={};if(_0x5d7322!=null){for(var _0x575900 in _0x5d7322)if(_0x575900!==_0x2839b8(0x1f1)&&Object[_0x2839b8(0x1fe)]['hasOwnProperty'][_0x2839b8(0x1f7)](_0x5d7322,_0x575900))__createBinding(_0x3cad32,_0x5d7322,_0x575900);}return __setModuleDefault(_0x3cad32,_0x5d7322),_0x3cad32;},__importDefault=this&&this[a550_0x1db49b(0x210)]||function(_0x3940b6){const _0x27ead4=a550_0x1db49b;return _0x3940b6&&_0x3940b6[_0x27ead4(0x204)]?_0x3940b6:{'default':_0x3940b6};};Object[a550_0x1db49b(0x1e4)](exports,a550_0x1db49b(0x204),{'value':!![]});const Sentry=__importStar(require(a550_0x1db49b(0x1e5))),AppError_1=__importDefault(require(a550_0x1db49b(0x1f5))),GetTicketWbot_1=__importDefault(require(a550_0x1db49b(0x20b))),Message_1=__importDefault(require(a550_0x1db49b(0x1fc))),lodash_1=__importDefault(require('lodash')),Mustache_1=__importDefault(require(a550_0x1db49b(0x20e))),SendWhatsAppMessage=async({body:_0x66e81f,ticket:_0x52157d,quotedMsg:_0x4a0e93,vCard:_0x165c31})=>{const _0x332035=a550_0x1db49b;let _0x8dabdb={};const _0x36fb70=await(0x0,GetTicketWbot_1[_0x332035(0x1f1)])(_0x52157d);if(!_0x36fb70)throw new AppError_1['default'](_0x332035(0x1fb));const _0x4a9979=_0x52157d[_0x332035(0x202)][_0x332035(0x1e9)]+'@'+(_0x52157d[_0x332035(0x1ff)]?_0x332035(0x213):_0x332035(0x1e6));if(_0x4a0e93){const _0x1b711a=await Message_1['default'][_0x332035(0x1f6)]({'where':{'id':_0x4a0e93['id']}});if(_0x1b711a){const _0x3460f8=JSON[_0x332035(0x206)](_0x1b711a[_0x332035(0x212)]);_0x8dabdb={'quoted':{'key':_0x3460f8[_0x332035(0x1e8)]||_0x1b711a['id'],'message':{'extendedTextMessage':_0x3460f8?.[_0x332035(0x1f4)][_0x332035(0x1f2)]}}};}}if(!lodash_1['default'][_0x332035(0x208)](_0x165c31)){const _0x18f549=_0x165c31[_0x332035(0x1e9)],_0x5b2fff=_0x165c31[_0x332035(0x1fa)][_0x332035(0x216)]('\x20')[0x0],_0x31cb67=String(_0x165c31[_0x332035(0x1fa)])['replace'](_0x165c31[_0x332035(0x1fa)][_0x332035(0x216)]('\x20')[0x0],''),_0x411684=_0x332035(0x1de)+('N:'+_0x31cb67+';'+_0x5b2fff+_0x332035(0x1e1))+(_0x332035(0x205)+_0x165c31[_0x332035(0x1fa)]+'\x0a')+(_0x332035(0x1f8)+_0x18f549+':+'+_0x18f549+'\x0a')+'END:VCARD';try{const _0x2cec8c=await _0x36fb70['sendMessage'](_0x4a9979,{'contacts':{'displayName':''+_0x165c31[_0x332035(0x1fa)],'contacts':[{'vcard':_0x411684}]}});return await _0x52157d[_0x332035(0x1fd)]({'lastMessage':(0x0,Mustache_1[_0x332035(0x1f1)])(_0x411684,_0x52157d),'imported':null}),_0x2cec8c;}catch(_0x30b67e){Sentry[_0x332035(0x1ef)](_0x30b67e),console[_0x332035(0x1df)](_0x30b67e);throw new AppError_1[(_0x332035(0x1f1))](_0x332035(0x201));}}try{const _0x4eccbd=await _0x36fb70[_0x332035(0x214)](_0x4a9979,{'text':(0x0,Mustache_1[_0x332035(0x1f1)])(_0x66e81f,_0x52157d)},{..._0x8dabdb});return await _0x52157d[_0x332035(0x1fd)]({'lastMessage':(0x0,Mustache_1['default'])(_0x66e81f,_0x52157d)}),_0x4eccbd;}catch(_0x4ed7fb){Sentry['captureException'](_0x4ed7fb),console['log'](_0x4ed7fb);throw new AppError_1[(_0x332035(0x1f1))](_0x332035(0x201));}};exports[a550_0x1db49b(0x1f1)]=SendWhatsAppMessage;