const a550_0x4df682=a550_0x2351;(function(_0x4fd328,_0x2c4b54){const _0x3df5b0=a550_0x2351,_0x5d68e7=_0x4fd328();while(!![]){try{const _0x1c81c4=parseInt(_0x3df5b0(0x1d0))/0x1+parseInt(_0x3df5b0(0x1c3))/0x2*(-parseInt(_0x3df5b0(0x1bc))/0x3)+-parseInt(_0x3df5b0(0x1ae))/0x4+-parseInt(_0x3df5b0(0x1ab))/0x5*(-parseInt(_0x3df5b0(0x1b0))/0x6)+-parseInt(_0x3df5b0(0x1ca))/0x7+parseInt(_0x3df5b0(0x1ce))/0x8+parseInt(_0x3df5b0(0x1d6))/0x9;if(_0x1c81c4===_0x2c4b54)break;else _0x5d68e7['push'](_0x5d68e7['shift']());}catch(_0x187d78){_0x5d68e7['push'](_0x5d68e7['shift']());}}}(a550_0x4851,0x9c7d9));const a550_0x965576=(function(){let _0x2d956e=!![];return function(_0x3f3f7b,_0x1a7c1b){const _0x19b82b=_0x2d956e?function(){const _0x175416=a550_0x2351;if(_0x1a7c1b){const _0x26a1eb=_0x1a7c1b[_0x175416(0x1b2)](_0x3f3f7b,arguments);return _0x1a7c1b=null,_0x26a1eb;}}:function(){};return _0x2d956e=![],_0x19b82b;};}()),a550_0x29633d=a550_0x965576(this,function(){const _0x4cf859=a550_0x2351;return a550_0x29633d[_0x4cf859(0x1d1)]()[_0x4cf859(0x1c8)](_0x4cf859(0x1cc))[_0x4cf859(0x1d1)]()['constructor'](a550_0x29633d)[_0x4cf859(0x1c8)](_0x4cf859(0x1cc));});a550_0x29633d();'use strict';var __createBinding=this&&this[a550_0x4df682(0x1a6)]||(Object[a550_0x4df682(0x1d5)]?function(_0x312d4a,_0x3c13e4,_0x17de84,_0x4bdc71){const _0x2a0666=a550_0x4df682;if(_0x4bdc71===undefined)_0x4bdc71=_0x17de84;var _0x39414e=Object[_0x2a0666(0x1a7)](_0x3c13e4,_0x17de84);(!_0x39414e||(_0x2a0666(0x1be)in _0x39414e?!_0x3c13e4[_0x2a0666(0x1c6)]:_0x39414e[_0x2a0666(0x1bd)]||_0x39414e['configurable']))&&(_0x39414e={'enumerable':!![],'get':function(){return _0x3c13e4[_0x17de84];}}),Object[_0x2a0666(0x1c2)](_0x312d4a,_0x4bdc71,_0x39414e);}:function(_0x4bd38b,_0x353ecc,_0x34b6f4,_0x3829ab){if(_0x3829ab===undefined)_0x3829ab=_0x34b6f4;_0x4bd38b[_0x3829ab]=_0x353ecc[_0x34b6f4];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a550_0x4df682(0x1d5)]?function(_0x2ed7b3,_0x441f84){const _0x8ae5b4=a550_0x4df682;Object[_0x8ae5b4(0x1c2)](_0x2ed7b3,_0x8ae5b4(0x1c1),{'enumerable':!![],'value':_0x441f84});}:function(_0x363029,_0x539506){const _0x4a5d7e=a550_0x4df682;_0x363029[_0x4a5d7e(0x1c1)]=_0x539506;}),__importStar=this&&this[a550_0x4df682(0x1b1)]||function(_0x5b6e1c){const _0x23b764=a550_0x4df682;if(_0x5b6e1c&&_0x5b6e1c[_0x23b764(0x1c6)])return _0x5b6e1c;var _0x3e1444={};if(_0x5b6e1c!=null){for(var _0x158093 in _0x5b6e1c)if(_0x158093!==_0x23b764(0x1c1)&&Object[_0x23b764(0x1d3)]['hasOwnProperty'][_0x23b764(0x1d7)](_0x5b6e1c,_0x158093))__createBinding(_0x3e1444,_0x5b6e1c,_0x158093);}return __setModuleDefault(_0x3e1444,_0x5b6e1c),_0x3e1444;},__importDefault=this&&this[a550_0x4df682(0x1b4)]||function(_0x11b0a5){const _0x12f64e=a550_0x4df682;return _0x11b0a5&&_0x11b0a5[_0x12f64e(0x1c6)]?_0x11b0a5:{'default':_0x11b0a5};};function a550_0x2351(_0x42d8e3,_0x239685){const _0x347a87=a550_0x4851();return a550_0x2351=function(_0x29633d,_0x965576){_0x29633d=_0x29633d-0x1a6;let _0x48514d=_0x347a87[_0x29633d];return _0x48514d;},a550_0x2351(_0x42d8e3,_0x239685);}Object[a550_0x4df682(0x1c2)](exports,a550_0x4df682(0x1c6),{'value':!![]});const Sentry=__importStar(require(a550_0x4df682(0x1b8))),AppError_1=__importDefault(require('../../errors/AppError')),GetTicketWbot_1=__importDefault(require(a550_0x4df682(0x1bf))),Message_1=__importDefault(require(a550_0x4df682(0x1c4))),lodash_1=__importDefault(require(a550_0x4df682(0x1c0))),Mustache_1=__importDefault(require(a550_0x4df682(0x1b9))),SendWhatsAppMessage=async({body:_0x5f20d7,ticket:_0xae313b,quotedMsg:_0x12f9e8,vCard:_0x39ef17})=>{const _0x36a1b4=a550_0x4df682;let _0x21395a={};const _0x3dbd47=await(0x0,GetTicketWbot_1[_0x36a1b4(0x1c1)])(_0xae313b);if(!_0x3dbd47)throw new AppError_1['default'](_0x36a1b4(0x1bb));const _0x515c9d=_0xae313b['contact']['number']+'@'+(_0xae313b[_0x36a1b4(0x1a9)]?_0x36a1b4(0x1cb):_0x36a1b4(0x1cf));if(_0x12f9e8){const _0x16a32d=await Message_1[_0x36a1b4(0x1c1)][_0x36a1b4(0x1c9)]({'where':{'id':_0x12f9e8['id']}});if(_0x16a32d){const _0x36ce93=JSON[_0x36a1b4(0x1ad)](_0x16a32d[_0x36a1b4(0x1a8)]);_0x21395a={'quoted':{'key':_0x36ce93[_0x36a1b4(0x1c7)]||_0x16a32d['id'],'message':{'extendedTextMessage':_0x36ce93?.['message'][_0x36a1b4(0x1b5)]}}};}}if(!lodash_1[_0x36a1b4(0x1c1)]['isNil'](_0x39ef17)){const _0x466355=_0x39ef17[_0x36a1b4(0x1b6)],_0x1a438a=_0x39ef17['name'][_0x36a1b4(0x1cd)]('\x20')[0x0],_0x38ff67=String(_0x39ef17[_0x36a1b4(0x1ac)])[_0x36a1b4(0x1d9)](_0x39ef17[_0x36a1b4(0x1ac)]['split']('\x20')[0x0],''),_0x2a8511=_0x36a1b4(0x1af)+('N:'+_0x38ff67+';'+_0x1a438a+';;;\x0a')+(_0x36a1b4(0x1b3)+_0x39ef17['name']+'\x0a')+(_0x36a1b4(0x1aa)+_0x466355+':+'+_0x466355+'\x0a')+'END:VCARD';try{const _0x2be03a=await _0x3dbd47[_0x36a1b4(0x1ba)](_0x515c9d,{'contacts':{'displayName':''+_0x39ef17[_0x36a1b4(0x1ac)],'contacts':[{'vcard':_0x2a8511}]}});return await _0xae313b[_0x36a1b4(0x1b7)]({'lastMessage':(0x0,Mustache_1['default'])(_0x2a8511,_0xae313b),'imported':null}),_0x2be03a;}catch(_0x5f1da4){Sentry[_0x36a1b4(0x1c5)](_0x5f1da4),console[_0x36a1b4(0x1d4)](_0x5f1da4);throw new AppError_1['default'](_0x36a1b4(0x1d2));}}try{const _0x32dfe3=await _0x3dbd47['sendMessage'](_0x515c9d,{'text':(0x0,Mustache_1['default'])(_0x5f20d7,_0xae313b)},{..._0x21395a});return await _0xae313b[_0x36a1b4(0x1b7)]({'lastMessage':(0x0,Mustache_1['default'])(_0x5f20d7,_0xae313b)}),_0x32dfe3;}catch(_0x4b97be){Sentry[_0x36a1b4(0x1c5)](_0x4b97be),console[_0x36a1b4(0x1d8)](_0x4b97be);throw new AppError_1['default'](_0x36a1b4(0x1d2));}};exports[a550_0x4df682(0x1c1)]=SendWhatsAppMessage;function a550_0x4851(){const _0x2b4137=['lodash','default','defineProperty','2382YFgmnO','../../models/Message','captureException','__esModule','key','search','findOne','6984369oCjuKd','g.us','(((.+)+)+)+$','split','5598280PqtHak','s.whatsapp.net','1216104bMhSCM','toString','ERR_SENDING_WAPP_MSG','prototype','trace','create','3475611GoXmDV','call','log','replace','__createBinding','getOwnPropertyDescriptor','dataJson','isGroup','TEL;type=CELL;waid=','5KmqfaH','name','parse','3915824hKbPDH','BEGIN:VCARD\x0aVERSION:3.0\x0a','5831286aqBJOY','__importStar','apply','FN:','__importDefault','extendedTextMessage','number','update','@sentry/node','../../helpers/Mustache','sendMessage','ERR_WBOT_NOT_FOUND','1653UBRSmi','writable','get','../../helpers/GetTicketWbot'];a550_0x4851=function(){return _0x2b4137;};return a550_0x4851();}