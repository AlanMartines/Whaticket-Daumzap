const a550_0x30437d=a550_0x18ce;(function(_0x56050d,_0x1dba10){const _0x1ab733=a550_0x18ce,_0x23bbfe=_0x56050d();while(!![]){try{const _0x5a50f8=-parseInt(_0x1ab733(0x182))/0x1+-parseInt(_0x1ab733(0x191))/0x2*(parseInt(_0x1ab733(0x190))/0x3)+parseInt(_0x1ab733(0x198))/0x4+-parseInt(_0x1ab733(0x179))/0x5+-parseInt(_0x1ab733(0x17a))/0x6*(-parseInt(_0x1ab733(0x16c))/0x7)+-parseInt(_0x1ab733(0x18c))/0x8+parseInt(_0x1ab733(0x188))/0x9*(parseInt(_0x1ab733(0x19c))/0xa);if(_0x5a50f8===_0x1dba10)break;else _0x23bbfe['push'](_0x23bbfe['shift']());}catch(_0x432748){_0x23bbfe['push'](_0x23bbfe['shift']());}}}(a550_0x2669,0x6761a));const a550_0x594923=(function(){let _0x589e36=!![];return function(_0x536a56,_0x20c689){const _0x58e948=_0x589e36?function(){if(_0x20c689){const _0x507ae8=_0x20c689['apply'](_0x536a56,arguments);return _0x20c689=null,_0x507ae8;}}:function(){};return _0x589e36=![],_0x58e948;};}()),a550_0x5b4bf5=a550_0x594923(this,function(){const _0x272a70=a550_0x18ce;return a550_0x5b4bf5['toString']()[_0x272a70(0x187)](_0x272a70(0x16d))[_0x272a70(0x16f)]()[_0x272a70(0x183)](a550_0x5b4bf5)[_0x272a70(0x187)](_0x272a70(0x16d));});a550_0x5b4bf5();'use strict';function a550_0x18ce(_0x3f5e9e,_0x547fac){const _0x3bb152=a550_0x2669();return a550_0x18ce=function(_0x5b4bf5,_0x594923){_0x5b4bf5=_0x5b4bf5-0x16c;let _0x26691b=_0x3bb152[_0x5b4bf5];return _0x26691b;},a550_0x18ce(_0x3f5e9e,_0x547fac);}var __createBinding=this&&this[a550_0x30437d(0x19e)]||(Object['create']?function(_0x5b46bf,_0x128447,_0xad7b90,_0xde3ee3){const _0x468c63=a550_0x30437d;if(_0xde3ee3===undefined)_0xde3ee3=_0xad7b90;var _0x3e66fa=Object[_0x468c63(0x170)](_0x128447,_0xad7b90);(!_0x3e66fa||(_0x468c63(0x17b)in _0x3e66fa?!_0x128447[_0x468c63(0x176)]:_0x3e66fa['writable']||_0x3e66fa[_0x468c63(0x17c)]))&&(_0x3e66fa={'enumerable':!![],'get':function(){return _0x128447[_0xad7b90];}}),Object[_0x468c63(0x18d)](_0x5b46bf,_0xde3ee3,_0x3e66fa);}:function(_0x56ebdd,_0x6b8513,_0x2ce9a4,_0x368074){if(_0x368074===undefined)_0x368074=_0x2ce9a4;_0x56ebdd[_0x368074]=_0x6b8513[_0x2ce9a4];}),__setModuleDefault=this&&this[a550_0x30437d(0x18a)]||(Object[a550_0x30437d(0x195)]?function(_0x370a4e,_0x38fe5f){const _0x495b38=a550_0x30437d;Object[_0x495b38(0x18d)](_0x370a4e,_0x495b38(0x18f),{'enumerable':!![],'value':_0x38fe5f});}:function(_0xaa7a30,_0x2350fb){const _0x547f3e=a550_0x30437d;_0xaa7a30[_0x547f3e(0x18f)]=_0x2350fb;}),__importStar=this&&this[a550_0x30437d(0x18b)]||function(_0x2be811){const _0x42a901=a550_0x30437d;if(_0x2be811&&_0x2be811[_0x42a901(0x176)])return _0x2be811;var _0x47775c={};if(_0x2be811!=null){for(var _0x579f88 in _0x2be811)if(_0x579f88!==_0x42a901(0x18f)&&Object[_0x42a901(0x177)][_0x42a901(0x196)][_0x42a901(0x181)](_0x2be811,_0x579f88))__createBinding(_0x47775c,_0x2be811,_0x579f88);}return __setModuleDefault(_0x47775c,_0x2be811),_0x47775c;},__importDefault=this&&this['__importDefault']||function(_0x324dde){const _0x3deb04=a550_0x30437d;return _0x324dde&&_0x324dde[_0x3deb04(0x176)]?_0x324dde:{'default':_0x324dde};};function a550_0x2669(){const _0x1abaa4=['2Btgjoo',';;;\x0a','findOne','split','create','hasOwnProperty','isNil','1563724AKjvZh','ERR_SENDING_WAPP_MSG','key','number','10GmzIwt','ERR_WBOT_NOT_FOUND','__createBinding','67907RWVJjp','(((.+)+)+)+$','BEGIN:VCARD\x0aVERSION:3.0\x0a','toString','getOwnPropertyDescriptor','../../errors/AppError','name','g.us','replace','../../helpers/Mustache','__esModule','prototype','contact','3068725sRaZOX','282KpZlmG','get','configurable','update','TEL;type=CELL;waid=','message','FN:','call','74426GPdakr','constructor','log','extendedTextMessage','captureException','search','11666493jfnNJr','s.whatsapp.net','__setModuleDefault','__importStar','4756024lxfWdL','defineProperty','END:VCARD','default','1311093ElxVIr'];a550_0x2669=function(){return _0x1abaa4;};return a550_0x2669();}Object[a550_0x30437d(0x18d)](exports,'__esModule',{'value':!![]});const Sentry=__importStar(require('@sentry/node')),AppError_1=__importDefault(require(a550_0x30437d(0x171))),GetTicketWbot_1=__importDefault(require('../../helpers/GetTicketWbot')),Message_1=__importDefault(require('../../models/Message')),lodash_1=__importDefault(require('lodash')),Mustache_1=__importDefault(require(a550_0x30437d(0x175))),SendWhatsAppMessage=async({body:_0x3fc151,ticket:_0x18429f,quotedMsg:_0x43ec5d,vCard:_0x492184})=>{const _0x137bf4=a550_0x30437d;let _0x29e783={};const _0x1e747c=await(0x0,GetTicketWbot_1[_0x137bf4(0x18f)])(_0x18429f);if(!_0x1e747c)throw new AppError_1[(_0x137bf4(0x18f))](_0x137bf4(0x19d));const _0x2b6805=_0x18429f[_0x137bf4(0x178)][_0x137bf4(0x19b)]+'@'+(_0x18429f['isGroup']?_0x137bf4(0x173):_0x137bf4(0x189));if(_0x43ec5d){const _0x2ecf11=await Message_1[_0x137bf4(0x18f)][_0x137bf4(0x193)]({'where':{'id':_0x43ec5d['id']}});if(_0x2ecf11){const _0x45647f=JSON['parse'](_0x2ecf11['dataJson']);_0x29e783={'quoted':{'key':_0x45647f[_0x137bf4(0x19a)]||_0x2ecf11['id'],'message':{'extendedTextMessage':_0x45647f?.[_0x137bf4(0x17f)][_0x137bf4(0x185)]}}};}}if(!lodash_1[_0x137bf4(0x18f)][_0x137bf4(0x197)](_0x492184)){const _0x1e18b3=_0x492184['number'],_0x29c9c4=_0x492184[_0x137bf4(0x172)][_0x137bf4(0x194)]('\x20')[0x0],_0x121bdc=String(_0x492184['name'])[_0x137bf4(0x174)](_0x492184[_0x137bf4(0x172)][_0x137bf4(0x194)]('\x20')[0x0],''),_0x1e10f2=_0x137bf4(0x16e)+('N:'+_0x121bdc+';'+_0x29c9c4+_0x137bf4(0x192))+(_0x137bf4(0x180)+_0x492184[_0x137bf4(0x172)]+'\x0a')+(_0x137bf4(0x17e)+_0x1e18b3+':+'+_0x1e18b3+'\x0a')+_0x137bf4(0x18e);try{const _0x417efb=await _0x1e747c['sendMessage'](_0x2b6805,{'contacts':{'displayName':''+_0x492184['name'],'contacts':[{'vcard':_0x1e10f2}]}});return await _0x18429f[_0x137bf4(0x17d)]({'lastMessage':(0x0,Mustache_1[_0x137bf4(0x18f)])(_0x1e10f2,_0x18429f),'imported':null}),_0x417efb;}catch(_0x4fcf6f){Sentry[_0x137bf4(0x186)](_0x4fcf6f),console['trace'](_0x4fcf6f);throw new AppError_1[(_0x137bf4(0x18f))](_0x137bf4(0x199));}}try{const _0x22a06f=await _0x1e747c['sendMessage'](_0x2b6805,{'text':(0x0,Mustache_1[_0x137bf4(0x18f)])(_0x3fc151,_0x18429f)},{..._0x29e783});return await _0x18429f[_0x137bf4(0x17d)]({'lastMessage':(0x0,Mustache_1['default'])(_0x3fc151,_0x18429f)}),_0x22a06f;}catch(_0x805b6c){Sentry['captureException'](_0x805b6c),console[_0x137bf4(0x184)](_0x805b6c);throw new AppError_1[(_0x137bf4(0x18f))]('ERR_SENDING_WAPP_MSG');}};exports[a550_0x30437d(0x18f)]=SendWhatsAppMessage;