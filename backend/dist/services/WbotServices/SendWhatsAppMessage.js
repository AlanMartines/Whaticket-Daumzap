function a550_0x23f7(_0x43655f,_0x4898bb){const _0x300d90=a550_0x1a3b();return a550_0x23f7=function(_0x2e203c,_0x39d59e){_0x2e203c=_0x2e203c-0x12a;let _0x1a3bb4=_0x300d90[_0x2e203c];return _0x1a3bb4;},a550_0x23f7(_0x43655f,_0x4898bb);}const a550_0x4c2d04=a550_0x23f7;(function(_0x242bde,_0x5d884a){const _0x35e582=a550_0x23f7,_0x2e99b9=_0x242bde();while(!![]){try{const _0x2ab91a=-parseInt(_0x35e582(0x141))/0x1*(parseInt(_0x35e582(0x163))/0x2)+parseInt(_0x35e582(0x14f))/0x3*(parseInt(_0x35e582(0x12f))/0x4)+-parseInt(_0x35e582(0x147))/0x5*(parseInt(_0x35e582(0x139))/0x6)+-parseInt(_0x35e582(0x161))/0x7+-parseInt(_0x35e582(0x12c))/0x8*(-parseInt(_0x35e582(0x143))/0x9)+parseInt(_0x35e582(0x131))/0xa*(parseInt(_0x35e582(0x13a))/0xb)+parseInt(_0x35e582(0x142))/0xc*(-parseInt(_0x35e582(0x15d))/0xd);if(_0x2ab91a===_0x5d884a)break;else _0x2e99b9['push'](_0x2e99b9['shift']());}catch(_0x553033){_0x2e99b9['push'](_0x2e99b9['shift']());}}}(a550_0x1a3b,0x8bb42));const a550_0x39d59e=(function(){let _0x29b9e8=!![];return function(_0x3bea09,_0x2a5156){const _0x1170d4=_0x29b9e8?function(){const _0x5b441e=a550_0x23f7;if(_0x2a5156){const _0x2fed53=_0x2a5156[_0x5b441e(0x149)](_0x3bea09,arguments);return _0x2a5156=null,_0x2fed53;}}:function(){};return _0x29b9e8=![],_0x1170d4;};}()),a550_0x2e203c=a550_0x39d59e(this,function(){const _0x551834=a550_0x23f7;return a550_0x2e203c['toString']()[_0x551834(0x159)](_0x551834(0x155))[_0x551834(0x151)]()[_0x551834(0x148)](a550_0x2e203c)[_0x551834(0x159)](_0x551834(0x155));});a550_0x2e203c();'use strict';var __createBinding=this&&this[a550_0x4c2d04(0x14c)]||(Object[a550_0x4c2d04(0x164)]?function(_0x3cf782,_0x995799,_0x459491,_0x33f42a){const _0x603541=a550_0x4c2d04;if(_0x33f42a===undefined)_0x33f42a=_0x459491;var _0x173c1b=Object[_0x603541(0x144)](_0x995799,_0x459491);(!_0x173c1b||(_0x603541(0x13c)in _0x173c1b?!_0x995799[_0x603541(0x14b)]:_0x173c1b[_0x603541(0x12b)]||_0x173c1b[_0x603541(0x135)]))&&(_0x173c1b={'enumerable':!![],'get':function(){return _0x995799[_0x459491];}}),Object[_0x603541(0x152)](_0x3cf782,_0x33f42a,_0x173c1b);}:function(_0x4d3463,_0x5002a0,_0x12277a,_0x1208cb){if(_0x1208cb===undefined)_0x1208cb=_0x12277a;_0x4d3463[_0x1208cb]=_0x5002a0[_0x12277a];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x32a5a7,_0x49566d){const _0x2c77a3=a550_0x4c2d04;Object[_0x2c77a3(0x152)](_0x32a5a7,'default',{'enumerable':!![],'value':_0x49566d});}:function(_0x5bbe72,_0x5b4e1e){_0x5bbe72['default']=_0x5b4e1e;}),__importStar=this&&this[a550_0x4c2d04(0x13e)]||function(_0x1982a2){const _0x219159=a550_0x4c2d04;if(_0x1982a2&&_0x1982a2[_0x219159(0x14b)])return _0x1982a2;var _0x2fca60={};if(_0x1982a2!=null){for(var _0x440ff3 in _0x1982a2)if(_0x440ff3!==_0x219159(0x15f)&&Object[_0x219159(0x14d)]['hasOwnProperty'][_0x219159(0x132)](_0x1982a2,_0x440ff3))__createBinding(_0x2fca60,_0x1982a2,_0x440ff3);}return __setModuleDefault(_0x2fca60,_0x1982a2),_0x2fca60;},__importDefault=this&&this[a550_0x4c2d04(0x134)]||function(_0x5de0e9){const _0x506746=a550_0x4c2d04;return _0x5de0e9&&_0x5de0e9[_0x506746(0x14b)]?_0x5de0e9:{'default':_0x5de0e9};};Object[a550_0x4c2d04(0x152)](exports,a550_0x4c2d04(0x14b),{'value':!![]});function a550_0x1a3b(){const _0x28c2a3=['get','ERR_WBOT_NOT_FOUND','__importStar','END:VCARD','captureException','1PbEprL','75828KJRBra','27CbYBWX','getOwnPropertyDescriptor','g.us','s.whatsapp.net','3445zspzAz','constructor','apply','../../errors/AppError','__esModule','__createBinding','prototype',';;;\x0a','3xbbWff','trace','toString','defineProperty','../../models/Message','FN:','(((.+)+)+)+$','extendedTextMessage','log','@sentry/node','search','key','dataJson','name','1339ERiPBg','sendMessage','default','split','2277471dgcNgU','isGroup','52758lqJwVX','create','ERR_SENDING_WAPP_MSG','number','writable','822064VdDLdn','message','lodash','1028796tOZRHJ','isNil','2795510SQmITg','call','TEL;type=CELL;waid=','__importDefault','configurable','update','BEGIN:VCARD\x0aVERSION:3.0\x0a','../../helpers/Mustache','948xRakye','44VEVPur','contact'];a550_0x1a3b=function(){return _0x28c2a3;};return a550_0x1a3b();}const Sentry=__importStar(require(a550_0x4c2d04(0x158))),AppError_1=__importDefault(require(a550_0x4c2d04(0x14a))),GetTicketWbot_1=__importDefault(require('../../helpers/GetTicketWbot')),Message_1=__importDefault(require(a550_0x4c2d04(0x153))),lodash_1=__importDefault(require(a550_0x4c2d04(0x12e))),Mustache_1=__importDefault(require(a550_0x4c2d04(0x138))),SendWhatsAppMessage=async({body:_0x3f0baf,ticket:_0x12505d,quotedMsg:_0x493eb8,vCard:_0x4d6b73})=>{const _0x30f783=a550_0x4c2d04;let _0x37ddbf={};const _0x570ed9=await(0x0,GetTicketWbot_1['default'])(_0x12505d);if(!_0x570ed9)throw new AppError_1['default'](_0x30f783(0x13d));const _0x148a2f=_0x12505d[_0x30f783(0x13b)][_0x30f783(0x12a)]+'@'+(_0x12505d[_0x30f783(0x162)]?_0x30f783(0x145):_0x30f783(0x146));if(_0x493eb8){const _0x347179=await Message_1[_0x30f783(0x15f)]['findOne']({'where':{'id':_0x493eb8['id']}});if(_0x347179){const _0x43556a=JSON['parse'](_0x347179[_0x30f783(0x15b)]);_0x37ddbf={'quoted':{'key':_0x43556a[_0x30f783(0x15a)]||_0x347179['id'],'message':{'extendedTextMessage':_0x43556a?.[_0x30f783(0x12d)][_0x30f783(0x156)]}}};}}if(!lodash_1[_0x30f783(0x15f)][_0x30f783(0x130)](_0x4d6b73)){const _0x2a1f09=_0x4d6b73['number'],_0x109663=_0x4d6b73[_0x30f783(0x15c)][_0x30f783(0x160)]('\x20')[0x0],_0x88428f=String(_0x4d6b73['name'])['replace'](_0x4d6b73[_0x30f783(0x15c)][_0x30f783(0x160)]('\x20')[0x0],''),_0x54678c=_0x30f783(0x137)+('N:'+_0x88428f+';'+_0x109663+_0x30f783(0x14e))+(_0x30f783(0x154)+_0x4d6b73[_0x30f783(0x15c)]+'\x0a')+(_0x30f783(0x133)+_0x2a1f09+':+'+_0x2a1f09+'\x0a')+_0x30f783(0x13f);try{const _0x4b474d=await _0x570ed9[_0x30f783(0x15e)](_0x148a2f,{'contacts':{'displayName':''+_0x4d6b73[_0x30f783(0x15c)],'contacts':[{'vcard':_0x54678c}]}});return await _0x12505d[_0x30f783(0x136)]({'lastMessage':(0x0,Mustache_1['default'])(_0x54678c,_0x12505d),'imported':null}),_0x4b474d;}catch(_0x3ec22a){Sentry[_0x30f783(0x140)](_0x3ec22a),console[_0x30f783(0x150)](_0x3ec22a);throw new AppError_1[(_0x30f783(0x15f))]('ERR_SENDING_WAPP_MSG');}}try{const _0xd97d32=await _0x570ed9[_0x30f783(0x15e)](_0x148a2f,{'text':(0x0,Mustache_1['default'])(_0x3f0baf,_0x12505d)},{..._0x37ddbf});return await _0x12505d[_0x30f783(0x136)]({'lastMessage':(0x0,Mustache_1['default'])(_0x3f0baf,_0x12505d)}),_0xd97d32;}catch(_0x562f40){Sentry['captureException'](_0x562f40),console[_0x30f783(0x157)](_0x562f40);throw new AppError_1[(_0x30f783(0x15f))](_0x30f783(0x165));}};exports['default']=SendWhatsAppMessage;