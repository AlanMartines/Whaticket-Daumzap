const a550_0x157323=a550_0x3851;(function(_0x455bc,_0x3ebb98){const _0x6eaf6f=a550_0x3851,_0x554d0a=_0x455bc();while(!![]){try{const _0x51ef7b=-parseInt(_0x6eaf6f(0x1d2))/0x1+-parseInt(_0x6eaf6f(0x1cb))/0x2+parseInt(_0x6eaf6f(0x1c1))/0x3*(-parseInt(_0x6eaf6f(0x1de))/0x4)+parseInt(_0x6eaf6f(0x1be))/0x5+parseInt(_0x6eaf6f(0x1dc))/0x6+parseInt(_0x6eaf6f(0x1c7))/0x7+-parseInt(_0x6eaf6f(0x1dd))/0x8*(parseInt(_0x6eaf6f(0x1e7))/0x9);if(_0x51ef7b===_0x3ebb98)break;else _0x554d0a['push'](_0x554d0a['shift']());}catch(_0x59200d){_0x554d0a['push'](_0x554d0a['shift']());}}}(a550_0x6fd0,0xf049c));const a550_0x41f870=(function(){let _0x1c8cc5=!![];return function(_0x21a8d0,_0x932851){const _0x7b7f16=_0x1c8cc5?function(){if(_0x932851){const _0x44f0ce=_0x932851['apply'](_0x21a8d0,arguments);return _0x932851=null,_0x44f0ce;}}:function(){};return _0x1c8cc5=![],_0x7b7f16;};}()),a550_0x4ccf0c=a550_0x41f870(this,function(){const _0x2bec61=a550_0x3851;return a550_0x4ccf0c['toString']()['search'](_0x2bec61(0x1bc))[_0x2bec61(0x1d1)]()[_0x2bec61(0x1c2)](a550_0x4ccf0c)['search'](_0x2bec61(0x1bc));});function a550_0x6fd0(){const _0x1ef139=['writable','toString','872779WamPwo','__importStar','__createBinding','BEGIN:VCARD\x0aVERSION:3.0\x0a','dataJson','key','captureException','__setModuleDefault','get','TEL;type=CELL;waid=','9798726repOqt','24SZzmzr','1368IVlgbA','../../models/Message','g.us','../../errors/AppError','prototype','lodash','split','name','sendMessage','1754775wMfuOF','../../helpers/Mustache','__esModule','END:VCARD','create','contact','isNil','@sentry/node','default','defineProperty','(((.+)+)+)+$','hasOwnProperty','8024030DRmxMU','log','__importDefault','10959FgMUDD','constructor','parse','trace','../../helpers/GetTicketWbot','number','4867968sQqIkp','replace','ERR_WBOT_NOT_FOUND','isGroup','484202LIlHim','extendedTextMessage','update','configurable','FN:'];a550_0x6fd0=function(){return _0x1ef139;};return a550_0x6fd0();}function a550_0x3851(_0x4b87d6,_0x507052){const _0xabcfd2=a550_0x6fd0();return a550_0x3851=function(_0x4ccf0c,_0x41f870){_0x4ccf0c=_0x4ccf0c-0x1b9;let _0x6fd04=_0xabcfd2[_0x4ccf0c];return _0x6fd04;},a550_0x3851(_0x4b87d6,_0x507052);}a550_0x4ccf0c();'use strict';var __createBinding=this&&this[a550_0x157323(0x1d4)]||(Object['create']?function(_0x1c6ec2,_0x28a8cd,_0x3339ec,_0x25599f){const _0x1b1001=a550_0x157323;if(_0x25599f===undefined)_0x25599f=_0x3339ec;var _0x150673=Object['getOwnPropertyDescriptor'](_0x28a8cd,_0x3339ec);(!_0x150673||(_0x1b1001(0x1da)in _0x150673?!_0x28a8cd[_0x1b1001(0x1e9)]:_0x150673[_0x1b1001(0x1d0)]||_0x150673[_0x1b1001(0x1ce)]))&&(_0x150673={'enumerable':!![],'get':function(){return _0x28a8cd[_0x3339ec];}}),Object['defineProperty'](_0x1c6ec2,_0x25599f,_0x150673);}:function(_0x145538,_0x43b3b1,_0x5b7f04,_0x534ba9){if(_0x534ba9===undefined)_0x534ba9=_0x5b7f04;_0x145538[_0x534ba9]=_0x43b3b1[_0x5b7f04];}),__setModuleDefault=this&&this[a550_0x157323(0x1d9)]||(Object[a550_0x157323(0x1eb)]?function(_0x265378,_0x4309bf){const _0x997937=a550_0x157323;Object[_0x997937(0x1bb)](_0x265378,_0x997937(0x1ba),{'enumerable':!![],'value':_0x4309bf});}:function(_0x2503c8,_0x2febe5){_0x2503c8['default']=_0x2febe5;}),__importStar=this&&this[a550_0x157323(0x1d3)]||function(_0xe61fa0){const _0x2dfd64=a550_0x157323;if(_0xe61fa0&&_0xe61fa0[_0x2dfd64(0x1e9)])return _0xe61fa0;var _0x2c67aa={};if(_0xe61fa0!=null){for(var _0x30e6fe in _0xe61fa0)if(_0x30e6fe!==_0x2dfd64(0x1ba)&&Object[_0x2dfd64(0x1e2)][_0x2dfd64(0x1bd)]['call'](_0xe61fa0,_0x30e6fe))__createBinding(_0x2c67aa,_0xe61fa0,_0x30e6fe);}return __setModuleDefault(_0x2c67aa,_0xe61fa0),_0x2c67aa;},__importDefault=this&&this[a550_0x157323(0x1c0)]||function(_0x2a32f2){const _0x15469b=a550_0x157323;return _0x2a32f2&&_0x2a32f2[_0x15469b(0x1e9)]?_0x2a32f2:{'default':_0x2a32f2};};Object[a550_0x157323(0x1bb)](exports,a550_0x157323(0x1e9),{'value':!![]});const Sentry=__importStar(require(a550_0x157323(0x1b9))),AppError_1=__importDefault(require(a550_0x157323(0x1e1))),GetTicketWbot_1=__importDefault(require(a550_0x157323(0x1c5))),Message_1=__importDefault(require(a550_0x157323(0x1df))),lodash_1=__importDefault(require(a550_0x157323(0x1e3))),Mustache_1=__importDefault(require(a550_0x157323(0x1e8))),SendWhatsAppMessage=async({body:_0x2ed69a,ticket:_0x55dafb,quotedMsg:_0x143741,vCard:_0xab1a33})=>{const _0x4946c5=a550_0x157323;let _0xf84e3e={};const _0x3758a5=await(0x0,GetTicketWbot_1[_0x4946c5(0x1ba)])(_0x55dafb);if(!_0x3758a5)throw new AppError_1['default'](_0x4946c5(0x1c9));const _0x5d80ce=_0x55dafb[_0x4946c5(0x1ec)][_0x4946c5(0x1c6)]+'@'+(_0x55dafb[_0x4946c5(0x1ca)]?_0x4946c5(0x1e0):'s.whatsapp.net');if(_0x143741){const _0x3dff4e=await Message_1[_0x4946c5(0x1ba)]['findOne']({'where':{'id':_0x143741['id']}});if(_0x3dff4e){const _0xbdef2a=JSON[_0x4946c5(0x1c3)](_0x3dff4e[_0x4946c5(0x1d6)]);_0xf84e3e={'quoted':{'key':_0xbdef2a[_0x4946c5(0x1d7)]||_0x3dff4e['id'],'message':{'extendedTextMessage':_0xbdef2a?.['message'][_0x4946c5(0x1cc)]}}};}}if(!lodash_1['default'][_0x4946c5(0x1ed)](_0xab1a33)){const _0x2af571=_0xab1a33[_0x4946c5(0x1c6)],_0x54a480=_0xab1a33['name']['split']('\x20')[0x0],_0x1eb55a=String(_0xab1a33[_0x4946c5(0x1e5)])[_0x4946c5(0x1c8)](_0xab1a33[_0x4946c5(0x1e5)][_0x4946c5(0x1e4)]('\x20')[0x0],''),_0xf336cf=_0x4946c5(0x1d5)+('N:'+_0x1eb55a+';'+_0x54a480+';;;\x0a')+(_0x4946c5(0x1cf)+_0xab1a33[_0x4946c5(0x1e5)]+'\x0a')+(_0x4946c5(0x1db)+_0x2af571+':+'+_0x2af571+'\x0a')+_0x4946c5(0x1ea);try{const _0x39f2c7=await _0x3758a5[_0x4946c5(0x1e6)](_0x5d80ce,{'contacts':{'displayName':''+_0xab1a33[_0x4946c5(0x1e5)],'contacts':[{'vcard':_0xf336cf}]}});return await _0x55dafb[_0x4946c5(0x1cd)]({'lastMessage':(0x0,Mustache_1[_0x4946c5(0x1ba)])(_0xf336cf,_0x55dafb),'imported':null}),_0x39f2c7;}catch(_0x4d3cc7){Sentry['captureException'](_0x4d3cc7),console[_0x4946c5(0x1c4)](_0x4d3cc7);throw new AppError_1[(_0x4946c5(0x1ba))]('ERR_SENDING_WAPP_MSG');}}try{const _0x360e53=await _0x3758a5[_0x4946c5(0x1e6)](_0x5d80ce,{'text':(0x0,Mustache_1[_0x4946c5(0x1ba)])(_0x2ed69a,_0x55dafb)},{..._0xf84e3e});return await _0x55dafb[_0x4946c5(0x1cd)]({'lastMessage':(0x0,Mustache_1[_0x4946c5(0x1ba)])(_0x2ed69a,_0x55dafb)}),_0x360e53;}catch(_0x2a46a0){Sentry[_0x4946c5(0x1d8)](_0x2a46a0),console[_0x4946c5(0x1bf)](_0x2a46a0);throw new AppError_1[(_0x4946c5(0x1ba))]('ERR_SENDING_WAPP_MSG');}};exports['default']=SendWhatsAppMessage;