function a376_0x361e(_0x47e80c,_0x426392){const _0x1d97e8=a376_0x2cda();return a376_0x361e=function(_0x56c8d3,_0x2ec14d){_0x56c8d3=_0x56c8d3-0x184;let _0x2cdaf8=_0x1d97e8[_0x56c8d3];return _0x2cdaf8;},a376_0x361e(_0x47e80c,_0x426392);}const a376_0x3031d7=a376_0x361e;(function(_0x37c9a5,_0x2394fb){const _0x54129e=a376_0x361e,_0x415a42=_0x37c9a5();while(!![]){try{const _0x4b6b12=-parseInt(_0x54129e(0x198))/0x1+-parseInt(_0x54129e(0x199))/0x2*(-parseInt(_0x54129e(0x190))/0x3)+-parseInt(_0x54129e(0x18a))/0x4+-parseInt(_0x54129e(0x197))/0x5+parseInt(_0x54129e(0x189))/0x6*(parseInt(_0x54129e(0x19f))/0x7)+-parseInt(_0x54129e(0x19e))/0x8+parseInt(_0x54129e(0x187))/0x9*(parseInt(_0x54129e(0x195))/0xa);if(_0x4b6b12===_0x2394fb)break;else _0x415a42['push'](_0x415a42['shift']());}catch(_0x1317a9){_0x415a42['push'](_0x415a42['shift']());}}}(a376_0x2cda,0x5839a));const a376_0x2ec14d=(function(){let _0x1f037e=!![];return function(_0x44d8e0,_0x2f59cc){const _0x41dc08=_0x1f037e?function(){if(_0x2f59cc){const _0xa8aabb=_0x2f59cc['apply'](_0x44d8e0,arguments);return _0x2f59cc=null,_0xa8aabb;}}:function(){};return _0x1f037e=![],_0x41dc08;};}()),a376_0x56c8d3=a376_0x2ec14d(this,function(){const _0x1895e7=a376_0x361e;return a376_0x56c8d3['toString']()[_0x1895e7(0x193)](_0x1895e7(0x191))[_0x1895e7(0x18b)]()['constructor'](a376_0x56c8d3)[_0x1895e7(0x193)](_0x1895e7(0x191));});a376_0x56c8d3();'use strict';var __importDefault=this&&this[a376_0x3031d7(0x194)]||function(_0x5933d5){const _0xbe71d2=a376_0x3031d7;return _0x5933d5&&_0x5933d5[_0xbe71d2(0x186)]?_0x5933d5:{'default':_0x5933d5};};Object['defineProperty'](exports,a376_0x3031d7(0x186),{'value':!![]});const Chat_1=__importDefault(require(a376_0x3031d7(0x19c))),ChatMessage_1=__importDefault(require(a376_0x3031d7(0x18f))),ChatUser_1=__importDefault(require(a376_0x3031d7(0x18c))),User_1=__importDefault(require('../../models/User'));function a376_0x2cda(){const _0x4d6689=['chat','__esModule','729sxjdoK','name','12ixqCty','2127800CSEtoY','toString','../../models/ChatUser','unreads','findByPk','../../models/ChatMessage','246RUqDtI','(((.+)+)+)+$','default','search','__importDefault','137330sFJGHF','userId','3395560JtplCH','429723yVetcW','12444jePdDp','update','findAll','../../models/Chat','sender','1987824eOWvPZ','2198196zdISje','users','reload'];a376_0x2cda=function(){return _0x4d6689;};return a376_0x2cda();}async function CreateMessageService({senderId:_0x17dc07,chatId:_0x39e592,message:_0x3bc2d8}){const _0x3f2579=a376_0x3031d7,_0x57c867=await ChatMessage_1[_0x3f2579(0x192)]['create']({'senderId':_0x17dc07,'chatId':_0x39e592,'message':_0x3bc2d8});await _0x57c867[_0x3f2579(0x184)]({'include':[{'model':User_1[_0x3f2579(0x192)],'as':_0x3f2579(0x19d),'attributes':['id','name']},{'model':Chat_1[_0x3f2579(0x192)],'as':_0x3f2579(0x185),'include':[{'model':ChatUser_1[_0x3f2579(0x192)],'as':_0x3f2579(0x1a0)}]}]});const _0x54b250=await User_1[_0x3f2579(0x192)][_0x3f2579(0x18e)](_0x17dc07);await _0x57c867[_0x3f2579(0x185)][_0x3f2579(0x19a)]({'lastMessage':_0x54b250[_0x3f2579(0x188)]+':\x20'+_0x3bc2d8});const _0x51ae7d=await ChatUser_1[_0x3f2579(0x192)][_0x3f2579(0x19b)]({'where':{'chatId':_0x39e592}});for(let _0xa39876 of _0x51ae7d){_0xa39876[_0x3f2579(0x196)]===_0x17dc07?await _0xa39876[_0x3f2579(0x19a)]({'unreads':0x0}):await _0xa39876[_0x3f2579(0x19a)]({'unreads':_0xa39876[_0x3f2579(0x18d)]+0x1});}return _0x57c867;}exports[a376_0x3031d7(0x192)]=CreateMessageService;