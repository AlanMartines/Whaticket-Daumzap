function a376_0xe9a5(){const _0x563f4c=['toString','users','__importDefault','__esModule','findAll','1888634TpQoRw','unreads','../../models/User','8789620CvhfvC','704644RYausf','6ijLvRg','207639QGTmTC','1066395ojQsDT','update','3036096kbJSrd','apply','reload','search','456nbxMyP','create','chat','2bCiLYL','name','default','230jnNjGU','../../models/ChatMessage','(((.+)+)+)+$','defineProperty','1962228PshQNR','findByPk','35FbHAyn'];a376_0xe9a5=function(){return _0x563f4c;};return a376_0xe9a5();}const a376_0x2692bf=a376_0x2271;(function(_0x298c60,_0x4dd507){const _0x277738=a376_0x2271,_0x1e6356=_0x298c60();while(!![]){try{const _0x6c4802=parseInt(_0x277738(0x1f3))/0x1*(parseInt(_0x277738(0x202))/0x2)+-parseInt(_0x277738(0x1fa))/0x3+parseInt(_0x277738(0x206))/0x4*(parseInt(_0x277738(0x1fc))/0x5)+parseInt(_0x277738(0x207))/0x6*(parseInt(_0x277738(0x205))/0x7)+parseInt(_0x277738(0x1ec))/0x8+parseInt(_0x277738(0x1e9))/0x9*(parseInt(_0x277738(0x1f6))/0xa)+parseInt(_0x277738(0x1ea))/0xb*(-parseInt(_0x277738(0x1f0))/0xc);if(_0x6c4802===_0x4dd507)break;else _0x1e6356['push'](_0x1e6356['shift']());}catch(_0x3e030a){_0x1e6356['push'](_0x1e6356['shift']());}}}(a376_0xe9a5,0xe7d4c));const a376_0x50aeef=(function(){let _0x5ab4eb=!![];return function(_0x2a46dc,_0x1f6fb4){const _0x3de79d=_0x5ab4eb?function(){const _0x255239=a376_0x2271;if(_0x1f6fb4){const _0x2b4fbe=_0x1f6fb4[_0x255239(0x1ed)](_0x2a46dc,arguments);return _0x1f6fb4=null,_0x2b4fbe;}}:function(){};return _0x5ab4eb=![],_0x3de79d;};}()),a376_0x26d9c2=a376_0x50aeef(this,function(){const _0x5b6786=a376_0x2271;return a376_0x26d9c2[_0x5b6786(0x1fd)]()[_0x5b6786(0x1ef)](_0x5b6786(0x1f8))['toString']()['constructor'](a376_0x26d9c2)['search'](_0x5b6786(0x1f8));});a376_0x26d9c2();'use strict';var __importDefault=this&&this[a376_0x2692bf(0x1ff)]||function(_0x4da9e2){return _0x4da9e2&&_0x4da9e2['__esModule']?_0x4da9e2:{'default':_0x4da9e2};};function a376_0x2271(_0x1ffbad,_0x3e56b5){const _0x4e40de=a376_0xe9a5();return a376_0x2271=function(_0x26d9c2,_0x50aeef){_0x26d9c2=_0x26d9c2-0x1e9;let _0xe9a596=_0x4e40de[_0x26d9c2];return _0xe9a596;},a376_0x2271(_0x1ffbad,_0x3e56b5);}Object[a376_0x2692bf(0x1f9)](exports,a376_0x2692bf(0x200),{'value':!![]});const Chat_1=__importDefault(require('../../models/Chat')),ChatMessage_1=__importDefault(require(a376_0x2692bf(0x1f7))),ChatUser_1=__importDefault(require('../../models/ChatUser')),User_1=__importDefault(require(a376_0x2692bf(0x204)));async function CreateMessageService({senderId:_0x586d3b,chatId:_0x439f82,message:_0x388a8d}){const _0x5ca587=a376_0x2692bf,_0x30bf58=await ChatMessage_1[_0x5ca587(0x1f5)][_0x5ca587(0x1f1)]({'senderId':_0x586d3b,'chatId':_0x439f82,'message':_0x388a8d});await _0x30bf58[_0x5ca587(0x1ee)]({'include':[{'model':User_1[_0x5ca587(0x1f5)],'as':'sender','attributes':['id',_0x5ca587(0x1f4)]},{'model':Chat_1[_0x5ca587(0x1f5)],'as':'chat','include':[{'model':ChatUser_1[_0x5ca587(0x1f5)],'as':_0x5ca587(0x1fe)}]}]});const _0x6c925d=await User_1[_0x5ca587(0x1f5)][_0x5ca587(0x1fb)](_0x586d3b);await _0x30bf58[_0x5ca587(0x1f2)]['update']({'lastMessage':_0x6c925d['name']+':\x20'+_0x388a8d});const _0x2a37e1=await ChatUser_1[_0x5ca587(0x1f5)][_0x5ca587(0x201)]({'where':{'chatId':_0x439f82}});for(let _0x13aecb of _0x2a37e1){_0x13aecb['userId']===_0x586d3b?await _0x13aecb['update']({'unreads':0x0}):await _0x13aecb[_0x5ca587(0x1eb)]({'unreads':_0x13aecb[_0x5ca587(0x203)]+0x1});}return _0x30bf58;}exports[a376_0x2692bf(0x1f5)]=CreateMessageService;