const a431_0x187371=a431_0x1a66;(function(_0x4f8384,_0x285c2c){const _0x450a04=a431_0x1a66,_0xf87494=_0x4f8384();while(!![]){try{const _0x47df30=-parseInt(_0x450a04(0x117))/0x1*(-parseInt(_0x450a04(0x119))/0x2)+parseInt(_0x450a04(0x115))/0x3+-parseInt(_0x450a04(0x10f))/0x4+parseInt(_0x450a04(0x118))/0x5+parseInt(_0x450a04(0x108))/0x6+parseInt(_0x450a04(0x113))/0x7*(-parseInt(_0x450a04(0x11b))/0x8)+parseInt(_0x450a04(0x124))/0x9*(-parseInt(_0x450a04(0x127))/0xa);if(_0x47df30===_0x285c2c)break;else _0xf87494['push'](_0xf87494['shift']());}catch(_0x4316d7){_0xf87494['push'](_0xf87494['shift']());}}}(a431_0x4684,0xd90f4));const a431_0x5bdc41=(function(){let _0x2e1d5c=!![];return function(_0x2fc476,_0x5528d9){const _0x5bc9ef=_0x2e1d5c?function(){const _0x76253a=a431_0x1a66;if(_0x5528d9){const _0x9b8dee=_0x5528d9[_0x76253a(0x10b)](_0x2fc476,arguments);return _0x5528d9=null,_0x9b8dee;}}:function(){};return _0x2e1d5c=![],_0x5bc9ef;};}()),a431_0x3df3a7=a431_0x5bdc41(this,function(){const _0x106744=a431_0x1a66;return a431_0x3df3a7[_0x106744(0x10c)]()[_0x106744(0x126)]('(((.+)+)+)+$')[_0x106744(0x10c)]()[_0x106744(0x10d)](a431_0x3df3a7)[_0x106744(0x126)]('(((.+)+)+)+$');});a431_0x3df3a7();function a431_0x4684(){const _0x225e93=['Dados\x20do\x20usuário\x20não\x20encontrados','default','\x0a\x0aPor\x20favor,\x20copie\x20e\x20cole\x20o\x20Código\x20de\x20Verificação\x20no\x20campo\x20\x27Código\x20de\x20Verificação\x27.\x0a\x0aSe\x20você\x20não\x20solicitou\x20esta\x20redefinição\x20de\x20senha,\x20por\x20favor,\x20ignore\x20este\x20e-mail.\x0a\x0a\x0aAtenciosamente','5866716XbJVtz','E-mail\x20enviado\x20com\x20sucesso','companyId','apply','toString','constructor','all','2865344mREjJp','SELECT\x20*\x20FROM\x20\x22Users\x22\x20WHERE\x20email\x20=\x27','UPDATE','defineProperty','6117244bNfFpi','Redefinição\x20de\x20Senha','4031637VWlfwR','value','5LdpQuN','26500fFvWoI','341374XeCWQI','Configurações\x20SMTP\x20estão\x20incompletas','8mSVaHj','Email\x20não\x20encontrado','findOne','smtpport','Olá,\x0a\x0aVocê\x20solicitou\x20a\x20redefinição\x20de\x20senha\x20para\x20sua\x20conta,\x20utilize\x20o\x20seguinte\x20Código\x20de\x20Verificação\x20para\x20concluir\x20o\x20processo\x20de\x20redefinição\x20de\x20senha:\x0a\x0aCódigo\x20de\x20Verificação:\x20','sequelize','__esModule','error','__importDefault','1116cgZuMh','usersmtpauth','search','56540iEJiNR','sendMail','query'];a431_0x4684=function(){return _0x225e93;};return a431_0x4684();}'use strict';var __importDefault=this&&this[a431_0x187371(0x123)]||function(_0x3edc9c){const _0xd69f86=a431_0x187371;return _0x3edc9c&&_0x3edc9c[_0xd69f86(0x121)]?_0x3edc9c:{'default':_0x3edc9c};};Object[a431_0x187371(0x112)](exports,a431_0x187371(0x121),{'value':!![]});function a431_0x1a66(_0x5f41f8,_0x2d430d){const _0x3514cb=a431_0x4684();return a431_0x1a66=function(_0x3df3a7,_0x5bdc41){_0x3df3a7=_0x3df3a7-0x106;let _0x46847d=_0x3514cb[_0x3df3a7];return _0x46847d;},a431_0x1a66(_0x5f41f8,_0x2d430d);}const nodemailer_1=__importDefault(require('nodemailer')),sequelize_1=__importDefault(require(a431_0x187371(0x120))),database_1=__importDefault(require('../../database')),Setting_1=__importDefault(require('../../models/Setting')),SendMail=async(_0x4157ae,_0xdaef97)=>{const _0x1b80ed=a431_0x187371;try{const _0x7482dd=0x1,{hasResult:_0x6d1dc6,data:_0xbdaf70}=await filterEmail(_0x4157ae);if(!_0x6d1dc6)return{'status':0x194,'message':_0x1b80ed(0x11c)};const _0x2188df=_0xbdaf70[0x0];if(!_0x2188df||_0x2188df[_0x1b80ed(0x10a)]===undefined)return{'status':0x194,'message':_0x1b80ed(0x12a)};const [_0x21727b,_0x354f04,_0x4cd553,_0xb55ef1]=await Promise[_0x1b80ed(0x10e)]([Setting_1[_0x1b80ed(0x106)][_0x1b80ed(0x11d)]({'where':{'companyId':_0x7482dd,'key':'smtpauth'}}),Setting_1[_0x1b80ed(0x106)][_0x1b80ed(0x11d)]({'where':{'companyId':_0x7482dd,'key':_0x1b80ed(0x125)}}),Setting_1['default']['findOne']({'where':{'companyId':_0x7482dd,'key':'clientsecretsmtpauth'}}),Setting_1['default'][_0x1b80ed(0x11d)]({'where':{'companyId':_0x7482dd,'key':_0x1b80ed(0x11e)}})]),_0x26132e=_0x21727b?.[_0x1b80ed(0x116)],_0x3312c1=_0x354f04?.[_0x1b80ed(0x116)],_0x3110c6=_0x4cd553?.[_0x1b80ed(0x116)],_0x19d06f=_0x3312c1,_0x5daed1=_0xb55ef1?.['value'];if(!_0x26132e||!_0x3312c1||!_0x3110c6||!_0x5daed1)throw new Error(_0x1b80ed(0x11a));const _0x4ff47e=nodemailer_1['default']['createTransport']({'host':_0x26132e,'port':Number(_0x5daed1),'secure':![],'auth':{'user':_0x3312c1,'pass':_0x3110c6}}),{hasResults:_0x4c5c99}=await insertToken(_0x4157ae,_0xdaef97);if(!_0x4c5c99)return{'status':0x194,'message':'Não\x20foi\x20possível\x20inserir\x20o\x20token\x20de\x20redefinição'};const _0x3f1bea={'from':_0x19d06f,'to':_0x4157ae,'subject':_0x1b80ed(0x114),'text':_0x1b80ed(0x11f)+_0xdaef97+_0x1b80ed(0x107)},_0x5e8f18=await _0x4ff47e[_0x1b80ed(0x128)](_0x3f1bea);return{'status':0xc8,'message':_0x1b80ed(0x109),'info':_0x5e8f18};}catch(_0x1fe39a){return console[_0x1b80ed(0x122)]('Erro\x20ao\x20enviar\x20e-mail:',_0x1fe39a),{'status':0x1f4,'message':'Erro\x20interno\x20do\x20servidor'};}},filterEmail=async _0x20a5f3=>{const _0x1c02c7=a431_0x187371,_0x56ba6a=_0x1c02c7(0x110)+_0x20a5f3+'\x27',_0xec4231=await database_1['default'][_0x1c02c7(0x129)](_0x56ba6a,{'type':sequelize_1[_0x1c02c7(0x106)]['QueryTypes']['SELECT']});return{'hasResult':_0xec4231['length']>0x0,'data':_0xec4231};},insertToken=async(_0x165804,_0x5a6f3d)=>{const _0x34404d=a431_0x187371,_0x4ca8be='UPDATE\x20\x22Users\x22\x20SET\x20\x22resetPassword\x22=\x20\x27'+_0x5a6f3d+'\x27\x20WHERE\x20email\x20=\x27'+_0x165804+'\x27',_0x149396=await database_1[_0x34404d(0x106)][_0x34404d(0x129)](_0x4ca8be,{'type':sequelize_1[_0x34404d(0x106)]['QueryTypes'][_0x34404d(0x111)]});return{'hasResults':_0x149396[0x1]>0x0,'datas':_0x149396};};exports[a431_0x187371(0x106)]=SendMail;