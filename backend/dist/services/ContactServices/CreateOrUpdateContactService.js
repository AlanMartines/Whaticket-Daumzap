const a413_0x441ed1=a413_0x46f7;(function(_0x1a0427,_0x1d932c){const _0x9cd6fb=a413_0x46f7,_0x514656=_0x1a0427();while(!![]){try{const _0x356cc8=-parseInt(_0x9cd6fb(0x158))/0x1*(-parseInt(_0x9cd6fb(0x14c))/0x2)+parseInt(_0x9cd6fb(0x156))/0x3+parseInt(_0x9cd6fb(0x169))/0x4+-parseInt(_0x9cd6fb(0x159))/0x5+parseInt(_0x9cd6fb(0x163))/0x6*(parseInt(_0x9cd6fb(0x15a))/0x7)+parseInt(_0x9cd6fb(0x15f))/0x8+-parseInt(_0x9cd6fb(0x14a))/0x9*(parseInt(_0x9cd6fb(0x142))/0xa);if(_0x356cc8===_0x1d932c)break;else _0x514656['push'](_0x514656['shift']());}catch(_0x428395){_0x514656['push'](_0x514656['shift']());}}}(a413_0x164c,0x6f1f7));function a413_0x164c(){const _0x1a4b02=['ceil','-mainchannel','endsWith','55568RgzyaI','updatedAt','isNil','Error\x20getting\x20profile\x20picture\x202:\x20','32080aIYbiW','getTime','FRONTEND_URL','../WbotServices/GetProfilePicUrl','default','/nopicture.png','-contact','(((.+)+)+)+$','4563RPFKMc','constructor','4GzUSDO','changed','match','name','log','create','update','../../models/Contact','../../libs/socket','toString','1123062xdfrrr','getIO','382611woHVOU','2704470EwAJxA','14LaAqpw','emit','__importDefault','apply','profilePicUrl','4810552cBxpIn','Error\x20getting\x20profile\x20picture:\x20','search','nopicture.png','2603166WEJaKe','company-','lodash'];a413_0x164c=function(){return _0x1a4b02;};return a413_0x164c();}const a413_0x4c37aa=(function(){let _0x28985e=!![];return function(_0x185a57,_0x48c540){const _0xb1931=_0x28985e?function(){const _0x3b1957=a413_0x46f7;if(_0x48c540){const _0x421e09=_0x48c540[_0x3b1957(0x15d)](_0x185a57,arguments);return _0x48c540=null,_0x421e09;}}:function(){};return _0x28985e=![],_0xb1931;};}()),a413_0x3db415=a413_0x4c37aa(this,function(){const _0x592924=a413_0x46f7;return a413_0x3db415[_0x592924(0x155)]()[_0x592924(0x161)]('(((.+)+)+)+$')[_0x592924(0x155)]()[_0x592924(0x14b)](a413_0x3db415)['search'](_0x592924(0x149));});a413_0x3db415();'use strict';function a413_0x46f7(_0x50364f,_0x1a1024){const _0x495437=a413_0x164c();return a413_0x46f7=function(_0x3db415,_0x4c37aa){_0x3db415=_0x3db415-0x142;let _0x164c19=_0x495437[_0x3db415];return _0x164c19;},a413_0x46f7(_0x50364f,_0x1a1024);}var __importDefault=this&&this[a413_0x441ed1(0x15c)]||function(_0x58a8e4){return _0x58a8e4&&_0x58a8e4['__esModule']?_0x58a8e4:{'default':_0x58a8e4};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const socket_1=require(a413_0x441ed1(0x154)),Contact_1=__importDefault(require(a413_0x441ed1(0x153))),lodash_1=require(a413_0x441ed1(0x165)),GetProfilePicUrl_1=__importDefault(require(a413_0x441ed1(0x145))),CreateOrUpdateContactService=async({name:_0x553553,number:_0x40d4f0,remoteJid:_0x9f1289,isGroup:_0x33e8fa,email:email='',companyId:_0x5b5a54,extraInfo:extraInfo=[],disableBot:disableBot=![],whatsappId:_0x3ab18c},_0x440fce,_0x47bf89)=>{const _0x39cfd3=a413_0x441ed1,_0x338398=_0x33e8fa?_0x40d4f0:_0x40d4f0['replace'](/[^0-9]/g,''),_0x243b5a=(0x0,socket_1[_0x39cfd3(0x157)])();let _0x4512b3;_0x4512b3=await Contact_1['default']['findOne']({'where':{'number':_0x338398,'companyId':_0x5b5a54}});if(_0x4512b3){if(_0x553553&&(!_0x4512b3[_0x39cfd3(0x14f)]||_0x4512b3[_0x39cfd3(0x14f)]['match'](/^[0-9]*$/))&&!_0x553553[_0x39cfd3(0x14e)](/^[0-9]*$/)){_0x4512b3[_0x39cfd3(0x14d)](_0x39cfd3(0x14f),!![]),_0x4512b3[_0x39cfd3(0x14d)](_0x39cfd3(0x16a),!![]);let _0x57cc2e;try{_0x57cc2e=await(0x0,GetProfilePicUrl_1[_0x39cfd3(0x146)])(_0x40d4f0,_0x5b5a54);}catch(_0x3fb025){console[_0x39cfd3(0x150)](_0x39cfd3(0x16c)+_0x3fb025);}_0x57cc2e?.[_0x39cfd3(0x168)]('nopicture.png')&&(_0x57cc2e=_0x4512b3[_0x39cfd3(0x15e)]),_0x4512b3['update']({'name':_0x553553,'profilePicUrl':_0x57cc2e});}const _0x59cd0b=new Date(_0x4512b3[_0x39cfd3(0x16a)]),_0x37959f=new Date(),_0x13aeac=_0x37959f['getTime']()-_0x59cd0b[_0x39cfd3(0x143)](),_0x5abcb0=Math[_0x39cfd3(0x166)](_0x13aeac/(0x3e8*0xe10*0x18));if(_0x5abcb0>=0x3){let _0x412aa3;try{_0x412aa3=await(0x0,GetProfilePicUrl_1[_0x39cfd3(0x146)])(_0x40d4f0,_0x5b5a54);}catch(_0x558b66){console['log'](_0x39cfd3(0x160)+_0x558b66);}_0x4512b3[_0x39cfd3(0x14d)](_0x39cfd3(0x16a),!![]),!_0x412aa3?.[_0x39cfd3(0x168)](_0x39cfd3(0x162))?_0x4512b3[_0x39cfd3(0x152)]({'profilePicUrl':_0x412aa3,'updatedAt':new Date()}):_0x4512b3[_0x39cfd3(0x152)]({'updatedAt':new Date()});}(0x0,lodash_1[_0x39cfd3(0x16b)])(_0x4512b3['whatsappId']===null)&&_0x4512b3[_0x39cfd3(0x152)]({'whatsappId':_0x3ab18c}),_0x243b5a['to'](_0x39cfd3(0x164)+_0x5b5a54+_0x39cfd3(0x167))[_0x39cfd3(0x15b)]('company-'+_0x5b5a54+_0x39cfd3(0x148),{'action':_0x39cfd3(0x152),'contact':_0x4512b3});}else{let _0x5956fa;try{_0x5956fa=await(0x0,GetProfilePicUrl_1['default'])(_0x40d4f0,_0x5b5a54);}catch(_0x2d521d){_0x5956fa=process['env'][_0x39cfd3(0x144)]+_0x39cfd3(0x147);}_0x4512b3=await Contact_1[_0x39cfd3(0x146)]['create']({'name':_0x553553,'number':_0x338398,'profilePicUrl':_0x5956fa,'email':email,'isGroup':_0x33e8fa,'extraInfo':extraInfo,'companyId':_0x5b5a54,'disableBot':disableBot,'whatsappId':_0x3ab18c}),_0x243b5a['to'](_0x39cfd3(0x164)+_0x5b5a54+'-mainchannel')[_0x39cfd3(0x15b)]('company-'+_0x5b5a54+_0x39cfd3(0x148),{'action':_0x39cfd3(0x151),'contact':_0x4512b3});}return _0x4512b3;};exports[a413_0x441ed1(0x146)]=CreateOrUpdateContactService;