const a413_0x110a2a=a413_0x4901;(function(_0x52e382,_0x3ca3c4){const _0x1a4292=a413_0x4901,_0x444283=_0x52e382();while(!![]){try{const _0x16f17c=parseInt(_0x1a4292(0x15e))/0x1+parseInt(_0x1a4292(0x169))/0x2*(-parseInt(_0x1a4292(0x182))/0x3)+parseInt(_0x1a4292(0x168))/0x4*(-parseInt(_0x1a4292(0x176))/0x5)+parseInt(_0x1a4292(0x17b))/0x6+-parseInt(_0x1a4292(0x16a))/0x7+-parseInt(_0x1a4292(0x179))/0x8+parseInt(_0x1a4292(0x15a))/0x9*(parseInt(_0x1a4292(0x16d))/0xa);if(_0x16f17c===_0x3ca3c4)break;else _0x444283['push'](_0x444283['shift']());}catch(_0x10bd12){_0x444283['push'](_0x444283['shift']());}}}(a413_0x57ea,0xc5024));const a413_0x25cd7a=(function(){let _0x810d18=!![];return function(_0x215b17,_0x2eda8c){const _0x43bba4=_0x810d18?function(){const _0xf12d14=a413_0x4901;if(_0x2eda8c){const _0x357f6c=_0x2eda8c[_0xf12d14(0x17e)](_0x215b17,arguments);return _0x2eda8c=null,_0x357f6c;}}:function(){};return _0x810d18=![],_0x43bba4;};}()),a413_0x2bb974=a413_0x25cd7a(this,function(){const _0x4bcb38=a413_0x4901;return a413_0x2bb974[_0x4bcb38(0x15c)]()[_0x4bcb38(0x178)](_0x4bcb38(0x15b))[_0x4bcb38(0x15c)]()[_0x4bcb38(0x17d)](a413_0x2bb974)[_0x4bcb38(0x178)](_0x4bcb38(0x15b));});a413_0x2bb974();'use strict';function a413_0x4901(_0x360c18,_0x3cea6a){const _0x225af8=a413_0x57ea();return a413_0x4901=function(_0x2bb974,_0x25cd7a){_0x2bb974=_0x2bb974-0x15a;let _0x57ea6b=_0x225af8[_0x2bb974];return _0x57ea6b;},a413_0x4901(_0x360c18,_0x3cea6a);}var __importDefault=this&&this[a413_0x110a2a(0x16f)]||function(_0x5dbffc){return _0x5dbffc&&_0x5dbffc['__esModule']?_0x5dbffc:{'default':_0x5dbffc};};Object['defineProperty'](exports,'__esModule',{'value':!![]});const socket_1=require(a413_0x110a2a(0x17c)),Contact_1=__importDefault(require('../../models/Contact')),lodash_1=require('lodash'),GetProfilePicUrl_1=__importDefault(require(a413_0x110a2a(0x16e))),CreateOrUpdateContactService=async({name:_0x53c89c,number:_0xb8564,remoteJid:_0x30d120,isGroup:_0x58cbef,email:email='',companyId:_0x4024e6,extraInfo:extraInfo=[],disableBot:disableBot=![],whatsappId:_0x2aa65f},_0x395260,_0x14a31c)=>{const _0x37607a=a413_0x110a2a,_0x15ee1c=_0x58cbef?_0xb8564:_0xb8564[_0x37607a(0x171)](/[^0-9]/g,''),_0x371a5a=(0x0,socket_1[_0x37607a(0x163)])();let _0x593292;_0x593292=await Contact_1[_0x37607a(0x177)]['findOne']({'where':{'number':_0x15ee1c,'companyId':_0x4024e6}});if(_0x593292){if(_0x53c89c&&(!_0x593292[_0x37607a(0x173)]||_0x593292['name']['match'](/^[0-9]*$/))&&!_0x53c89c['match'](/^[0-9]*$/)){_0x593292['changed'](_0x37607a(0x173),!![]),_0x593292[_0x37607a(0x172)](_0x37607a(0x16b),!![]);let _0x543a9a;try{_0x543a9a=await(0x0,GetProfilePicUrl_1['default'])(_0xb8564,_0x4024e6);}catch(_0x19fb69){console[_0x37607a(0x17f)](_0x37607a(0x16c)+_0x19fb69);}_0x543a9a?.[_0x37607a(0x166)](_0x37607a(0x15f))&&(_0x543a9a=_0x593292[_0x37607a(0x167)]),_0x593292[_0x37607a(0x175)]({'name':_0x53c89c,'profilePicUrl':_0x543a9a});}const _0x3ce7bf=new Date(_0x593292['updatedAt']),_0x2a0ca9=new Date(),_0x27bc66=_0x2a0ca9[_0x37607a(0x181)]()-_0x3ce7bf[_0x37607a(0x181)](),_0x4dd633=Math['ceil'](_0x27bc66/(0x3e8*0xe10*0x18));if(_0x4dd633>=0x3){let _0x3c1f8a;try{_0x3c1f8a=await(0x0,GetProfilePicUrl_1[_0x37607a(0x177)])(_0xb8564,_0x4024e6);}catch(_0x43150c){console['log'](_0x37607a(0x164)+_0x43150c);}_0x593292[_0x37607a(0x172)](_0x37607a(0x16b),!![]),!_0x3c1f8a?.[_0x37607a(0x166)](_0x37607a(0x15f))?_0x593292[_0x37607a(0x175)]({'profilePicUrl':_0x3c1f8a,'updatedAt':new Date()}):_0x593292[_0x37607a(0x175)]({'updatedAt':new Date()});}(0x0,lodash_1[_0x37607a(0x165)])(_0x593292[_0x37607a(0x170)]===null)&&_0x593292[_0x37607a(0x175)]({'whatsappId':_0x2aa65f}),_0x371a5a['to']('company-'+_0x4024e6+_0x37607a(0x17a))[_0x37607a(0x160)](_0x37607a(0x180)+_0x4024e6+_0x37607a(0x174),{'action':_0x37607a(0x175),'contact':_0x593292});}else{let _0x32c31a;try{_0x32c31a=await(0x0,GetProfilePicUrl_1[_0x37607a(0x177)])(_0xb8564,_0x4024e6);}catch(_0x3ad6aa){_0x32c31a=process[_0x37607a(0x161)][_0x37607a(0x162)]+_0x37607a(0x15d);}_0x593292=await Contact_1[_0x37607a(0x177)]['create']({'name':_0x53c89c,'number':_0x15ee1c,'profilePicUrl':_0x32c31a,'email':email,'isGroup':_0x58cbef,'extraInfo':extraInfo,'companyId':_0x4024e6,'disableBot':disableBot,'whatsappId':_0x2aa65f}),_0x371a5a['to'](_0x37607a(0x180)+_0x4024e6+_0x37607a(0x17a))[_0x37607a(0x160)](_0x37607a(0x180)+_0x4024e6+'-contact',{'action':'create','contact':_0x593292});}return _0x593292;};function a413_0x57ea(){const _0x7bb5ec=['(((.+)+)+)+$','toString','/nopicture.png','1453143mQxbHv','nopicture.png','emit','env','FRONTEND_URL','getIO','Error\x20getting\x20profile\x20picture:\x20','isNil','endsWith','profilePicUrl','4vWHPHb','3902OhhXKA','9363669vGNGLg','updatedAt','Error\x20getting\x20profile\x20picture\x202:\x20','20eSuFNG','../WbotServices/GetProfilePicUrl','__importDefault','whatsappId','replace','changed','name','-contact','update','5698195LSetzu','default','search','3180136nAbtWL','-mainchannel','4649886XIifJS','../../libs/socket','constructor','apply','log','company-','getTime','1599pkXjzZ','11220885DhcjLv'];a413_0x57ea=function(){return _0x7bb5ec;};return a413_0x57ea();}exports['default']=CreateOrUpdateContactService;