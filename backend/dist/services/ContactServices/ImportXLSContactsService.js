const a417_0x3471a1=a417_0x29a0;(function(_0x54fcb5,_0x3c5ebf){const _0x2ef1b8=a417_0x29a0,_0xd49c4=_0x54fcb5();while(!![]){try{const _0x4accc2=parseInt(_0x2ef1b8(0x17a))/0x1*(parseInt(_0x2ef1b8(0x18f))/0x2)+-parseInt(_0x2ef1b8(0x190))/0x3+parseInt(_0x2ef1b8(0x196))/0x4+-parseInt(_0x2ef1b8(0x19d))/0x5*(-parseInt(_0x2ef1b8(0x1a2))/0x6)+parseInt(_0x2ef1b8(0x189))/0x7+parseInt(_0x2ef1b8(0x198))/0x8+-parseInt(_0x2ef1b8(0x184))/0x9;if(_0x4accc2===_0x3c5ebf)break;else _0xd49c4['push'](_0xd49c4['shift']());}catch(_0x5b0a68){_0xd49c4['push'](_0xd49c4['shift']());}}}(a417_0x31c1,0xecc51));const a417_0x33b9=(function(){let _0x51d41c=!![];return function(_0x280edc,_0x12c6f7){const _0x488d85=_0x51d41c?function(){const _0x2d02d=a417_0x29a0;if(_0x12c6f7){const _0x1472f9=_0x12c6f7[_0x2d02d(0x1a6)](_0x280edc,arguments);return _0x12c6f7=null,_0x1472f9;}}:function(){};return _0x51d41c=![],_0x488d85;};}()),a417_0x406270=a417_0x33b9(this,function(){const _0x6d983=a417_0x29a0;return a417_0x406270[_0x6d983(0x19b)]()[_0x6d983(0x18d)]('(((.+)+)+)+$')[_0x6d983(0x19b)]()[_0x6d983(0x186)](a417_0x406270)[_0x6d983(0x18d)](_0x6d983(0x181));});a417_0x406270();'use strict';var __importDefault=this&&this[a417_0x3471a1(0x183)]||function(_0x1833d2){const _0xd3a343=a417_0x3471a1;return _0x1833d2&&_0x1833d2[_0xd3a343(0x1a4)]?_0x1833d2:{'default':_0x1833d2};};Object[a417_0x3471a1(0x177)](exports,a417_0x3471a1(0x1a4),{'value':!![]}),exports[a417_0x3471a1(0x179)]=void 0x0;const lodash_1=require(a417_0x3471a1(0x1a0)),xlsx_1=__importDefault(require(a417_0x3471a1(0x17c))),lodash_2=require(a417_0x3471a1(0x1a0)),CheckNumber_1=__importDefault(require(a417_0x3471a1(0x18c))),logger_1=require(a417_0x3471a1(0x18b)),Contact_1=__importDefault(require(a417_0x3471a1(0x195))),attrNames={'NAME':[a417_0x3471a1(0x17e),a417_0x3471a1(0x1a5)],'NUMBER':['numero',a417_0x3471a1(0x191),a417_0x3471a1(0x18a),a417_0x3471a1(0x178)],'EMAIL':[a417_0x3471a1(0x199),a417_0x3471a1(0x19c),'Email',a417_0x3471a1(0x192)]};function a417_0x31c1(){const _0x4e70b3=['11334ZnCMaG','has','__esModule','Nome','apply','defineProperty','Número','ImportXLSContactsService','67dFZPZF','utils','xlsx','path','nome','values','error','(((.+)+)+)+$','Número\x20de\x20contato\x20inválido:\x20','__importDefault','13362255bmIVqF','head','constructor','push','findOrCreate','3149223DNZWup','Numero','../../utils/logger','../WbotServices/CheckNumber','search','default','19060GOKaTw','3067599QBtkse','número','E-mail','EMAIL','logger','../../models/Contact','1615380yeNBrp','jid','1265040uxNvHc','email','number','toString','e-mail','4835dVWvRZ','sheet_to_json','NAME','lodash','readFile'];a417_0x31c1=function(){return _0x4e70b3;};return a417_0x31c1();}function extractContact(_0x141ad9,_0x578066){const _0x1dd7bf=a417_0x3471a1,_0x2a6ada=getValue(_0x141ad9,attrNames[_0x1dd7bf(0x19f)]);let _0x197719=getValue(_0x141ad9,attrNames['NUMBER']);_0x197719=(''+_0x197719)['replace'](/\D/g,'');const _0x187ab5=getValue(_0x141ad9,attrNames[_0x1dd7bf(0x193)]);return{'name':_0x2a6ada,'number':_0x197719,'email':_0x187ab5,'companyId':_0x578066};}function getValue(_0x3bba76,_0x5582ec){const _0x4414dc=a417_0x3471a1;for(const _0x227108 of _0x5582ec){if((0x0,lodash_2[_0x4414dc(0x1a3)])(_0x3bba76,_0x227108))return _0x3bba76[_0x227108];}return'';}async function ImportXLSContactsService(_0x597fd7,_0x1e890d){const _0x14affb=a417_0x3471a1,_0x4bfbb4=xlsx_1[_0x14affb(0x18e)][_0x14affb(0x1a1)](_0x1e890d?.[_0x14affb(0x17d)]),_0x11c163=(0x0,lodash_1[_0x14affb(0x185)])(Object[_0x14affb(0x17f)](_0x4bfbb4['Sheets'])),_0x29fb8d=xlsx_1['default'][_0x14affb(0x17b)][_0x14affb(0x19e)](_0x11c163,{'header':0x0}),_0xb8783=_0x29fb8d['map'](_0x5a612e=>extractContact(_0x5a612e,_0x597fd7)),_0x344fb7=[];for(const _0x278db6 of _0xb8783){const [_0x33f3d1,_0x157e57]=await Contact_1[_0x14affb(0x18e)][_0x14affb(0x188)]({'where':{'number':''+_0x278db6[_0x14affb(0x19a)],'companyId':_0x278db6['companyId']},'defaults':_0x278db6});_0x157e57&&_0x344fb7[_0x14affb(0x187)](_0x33f3d1);}if(_0x344fb7)for(let _0x1529f0 of _0x344fb7){try{const _0x594b33=await(0x0,CheckNumber_1[_0x14affb(0x18e)])(_0x1529f0[_0x14affb(0x19a)],_0x597fd7),_0x27da2a=_0x594b33[_0x14affb(0x197)]['replace'](/\D/g,'');_0x1529f0[_0x14affb(0x19a)]=_0x27da2a,await _0x1529f0['save']();}catch(_0x1990a5){logger_1[_0x14affb(0x194)][_0x14affb(0x180)](_0x14affb(0x182)+_0x1529f0[_0x14affb(0x19a)]);}}return _0x344fb7;}function a417_0x29a0(_0x4badb1,_0x4499f6){const _0x4dac14=a417_0x31c1();return a417_0x29a0=function(_0x406270,_0x33b9){_0x406270=_0x406270-0x177;let _0x31c1bf=_0x4dac14[_0x406270];return _0x31c1bf;},a417_0x29a0(_0x4badb1,_0x4499f6);}exports[a417_0x3471a1(0x179)]=ImportXLSContactsService;