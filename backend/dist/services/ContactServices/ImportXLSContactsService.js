const a417_0xe36371=a417_0x2071;(function(_0x46102b,_0x20f2fe){const _0x270cb8=a417_0x2071,_0x1ff6c0=_0x46102b();while(!![]){try{const _0x1b6fe6=-parseInt(_0x270cb8(0x1a9))/0x1+-parseInt(_0x270cb8(0x1b0))/0x2+-parseInt(_0x270cb8(0x195))/0x3+-parseInt(_0x270cb8(0x1b2))/0x4*(-parseInt(_0x270cb8(0x1a5))/0x5)+-parseInt(_0x270cb8(0x186))/0x6*(parseInt(_0x270cb8(0x19e))/0x7)+-parseInt(_0x270cb8(0x187))/0x8+-parseInt(_0x270cb8(0x1af))/0x9*(-parseInt(_0x270cb8(0x18d))/0xa);if(_0x1b6fe6===_0x20f2fe)break;else _0x1ff6c0['push'](_0x1ff6c0['shift']());}catch(_0x49b32c){_0x1ff6c0['push'](_0x1ff6c0['shift']());}}}(a417_0xc9d1,0x9247d));const a417_0xf6d811=(function(){let _0x341863=!![];return function(_0xc63135,_0x2ae66b){const _0x18173c=_0x341863?function(){const _0x568d21=a417_0x2071;if(_0x2ae66b){const _0x4c9d5f=_0x2ae66b[_0x568d21(0x191)](_0xc63135,arguments);return _0x2ae66b=null,_0x4c9d5f;}}:function(){};return _0x341863=![],_0x18173c;};}()),a417_0x485fed=a417_0xf6d811(this,function(){const _0x16e410=a417_0x2071;return a417_0x485fed[_0x16e410(0x1a4)]()[_0x16e410(0x1b6)]('(((.+)+)+)+$')[_0x16e410(0x1a4)]()[_0x16e410(0x1b3)](a417_0x485fed)[_0x16e410(0x1b6)]('(((.+)+)+)+$');});a417_0x485fed();'use strict';var __importDefault=this&&this['__importDefault']||function(_0x538d7a){const _0x1cfcdf=a417_0x2071;return _0x538d7a&&_0x538d7a[_0x1cfcdf(0x1ad)]?_0x538d7a:{'default':_0x538d7a};};Object[a417_0xe36371(0x190)](exports,a417_0xe36371(0x1ad),{'value':!![]}),exports[a417_0xe36371(0x185)]=void 0x0;const lodash_1=require(a417_0xe36371(0x19d)),xlsx_1=__importDefault(require(a417_0xe36371(0x1ae))),lodash_2=require(a417_0xe36371(0x19d)),CheckNumber_1=__importDefault(require(a417_0xe36371(0x1b4))),logger_1=require(a417_0xe36371(0x1a7)),Contact_1=__importDefault(require(a417_0xe36371(0x1ac))),attrNames={'NAME':[a417_0xe36371(0x1a2),a417_0xe36371(0x197)],'NUMBER':['numero',a417_0xe36371(0x184),a417_0xe36371(0x1a8),a417_0xe36371(0x1a3)],'EMAIL':[a417_0xe36371(0x1b1),a417_0xe36371(0x1a0),a417_0xe36371(0x1a1),a417_0xe36371(0x18a)]};function a417_0x2071(_0x2b7064,_0x59dc09){const _0x993fe7=a417_0xc9d1();return a417_0x2071=function(_0x485fed,_0xf6d811){_0x485fed=_0x485fed-0x184;let _0xc9d19=_0x993fe7[_0x485fed];return _0xc9d19;},a417_0x2071(_0x2b7064,_0x59dc09);}function extractContact(_0x177c29,_0x33be6f){const _0x11708e=a417_0xe36371,_0x5d4ce6=getValue(_0x177c29,attrNames[_0x11708e(0x196)]);let _0x55a709=getValue(_0x177c29,attrNames['NUMBER']);_0x55a709=(''+_0x55a709)[_0x11708e(0x199)](/\D/g,'');const _0x3570eb=getValue(_0x177c29,attrNames[_0x11708e(0x18b)]);return{'name':_0x5d4ce6,'number':_0x55a709,'email':_0x3570eb,'companyId':_0x33be6f};}function getValue(_0x159c1e,_0x825b58){const _0x27638f=a417_0xe36371;for(const _0x3e503c of _0x825b58){if((0x0,lodash_2[_0x27638f(0x194)])(_0x159c1e,_0x3e503c))return _0x159c1e[_0x3e503c];}return'';}async function ImportXLSContactsService(_0x1fa4bb,_0xd69bf0){const _0x147404=a417_0xe36371,_0x1d94e3=xlsx_1[_0x147404(0x19b)][_0x147404(0x19c)](_0xd69bf0?.[_0x147404(0x19f)]),_0xdc3031=(0x0,lodash_1['head'])(Object[_0x147404(0x193)](_0x1d94e3[_0x147404(0x18c)])),_0x3f97e4=xlsx_1[_0x147404(0x19b)]['utils'][_0x147404(0x1b5)](_0xdc3031,{'header':0x0}),_0x360a12=_0x3f97e4[_0x147404(0x18e)](_0x2cba19=>extractContact(_0x2cba19,_0x1fa4bb)),_0xa74c35=[];for(const _0x55e776 of _0x360a12){const [_0x59ce2f,_0x261b37]=await Contact_1['default'][_0x147404(0x1aa)]({'where':{'number':''+_0x55e776[_0x147404(0x189)],'companyId':_0x55e776[_0x147404(0x198)]},'defaults':_0x55e776});_0x261b37&&_0xa74c35[_0x147404(0x19a)](_0x59ce2f);}if(_0xa74c35)for(let _0x50d0cb of _0xa74c35){try{const _0x2271a2=await(0x0,CheckNumber_1['default'])(_0x50d0cb[_0x147404(0x189)],_0x1fa4bb),_0x1dcda7=_0x2271a2[_0x147404(0x188)]['replace'](/\D/g,'');_0x50d0cb[_0x147404(0x189)]=_0x1dcda7,await _0x50d0cb[_0x147404(0x1a6)]();}catch(_0x20cf67){logger_1[_0x147404(0x192)][_0x147404(0x1ab)](_0x147404(0x18f)+_0x50d0cb[_0x147404(0x189)]);}}return _0xa74c35;}function a417_0xc9d1(){const _0x4451c4=['has','386829XwSRHq','NAME','Nome','companyId','replace','push','default','readFile','lodash','14PNZvXZ','path','e-mail','Email','nome','Número','toString','430rESVZK','save','../../utils/logger','Numero','694546jKaHoB','findOrCreate','error','../../models/Contact','__esModule','xlsx','171oWgczF','93578eXiiHi','email','14132NZuZIl','constructor','../WbotServices/CheckNumber','sheet_to_json','search','número','ImportXLSContactsService','3122838GNrYja','9216784aFPwNS','jid','number','E-mail','EMAIL','Sheets','1767710SLkfxN','map','Número\x20de\x20contato\x20inválido:\x20','defineProperty','apply','logger','values'];a417_0xc9d1=function(){return _0x4451c4;};return a417_0xc9d1();}exports[a417_0xe36371(0x185)]=ImportXLSContactsService;