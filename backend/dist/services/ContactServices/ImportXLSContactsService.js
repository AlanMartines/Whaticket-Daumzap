const a417_0x5269d9=a417_0x22a8;(function(_0x225709,_0x198db1){const _0x58399a=a417_0x22a8,_0x9b4e34=_0x225709();while(!![]){try{const _0x24c99a=parseInt(_0x58399a(0x198))/0x1+-parseInt(_0x58399a(0x1b0))/0x2+parseInt(_0x58399a(0x1ac))/0x3+parseInt(_0x58399a(0x1c2))/0x4+-parseInt(_0x58399a(0x196))/0x5+-parseInt(_0x58399a(0x1ba))/0x6*(parseInt(_0x58399a(0x1b2))/0x7)+-parseInt(_0x58399a(0x1b5))/0x8*(-parseInt(_0x58399a(0x199))/0x9);if(_0x24c99a===_0x198db1)break;else _0x9b4e34['push'](_0x9b4e34['shift']());}catch(_0x498304){_0x9b4e34['push'](_0x9b4e34['shift']());}}}(a417_0x2b8f,0x1f93f));const a417_0x2a94ac=(function(){let _0x11ef69=!![];return function(_0x38ac3f,_0x138505){const _0x19f540=_0x11ef69?function(){const _0x3933dd=a417_0x22a8;if(_0x138505){const _0x4ab4d0=_0x138505[_0x3933dd(0x1af)](_0x38ac3f,arguments);return _0x138505=null,_0x4ab4d0;}}:function(){};return _0x11ef69=![],_0x19f540;};}()),a417_0x1e789a=a417_0x2a94ac(this,function(){const _0x34a222=a417_0x22a8;return a417_0x1e789a[_0x34a222(0x1ad)]()['search'](_0x34a222(0x1ab))[_0x34a222(0x1ad)]()[_0x34a222(0x1b8)](a417_0x1e789a)['search']('(((.+)+)+)+$');});a417_0x1e789a();'use strict';var __importDefault=this&&this[a417_0x5269d9(0x1ae)]||function(_0x6eac79){const _0x4ca841=a417_0x5269d9;return _0x6eac79&&_0x6eac79[_0x4ca841(0x1b1)]?_0x6eac79:{'default':_0x6eac79};};Object[a417_0x5269d9(0x1b9)](exports,a417_0x5269d9(0x1b1),{'value':!![]}),exports[a417_0x5269d9(0x1a3)]=void 0x0;const lodash_1=require(a417_0x5269d9(0x19a)),xlsx_1=__importDefault(require(a417_0x5269d9(0x19e))),lodash_2=require(a417_0x5269d9(0x19a)),CheckNumber_1=__importDefault(require('../WbotServices/CheckNumber')),logger_1=require(a417_0x5269d9(0x19b)),Contact_1=__importDefault(require(a417_0x5269d9(0x1bb))),attrNames={'NAME':[a417_0x5269d9(0x1bc),a417_0x5269d9(0x1bd)],'NUMBER':[a417_0x5269d9(0x19d),a417_0x5269d9(0x1c0),a417_0x5269d9(0x1a8),a417_0x5269d9(0x1bf)],'EMAIL':['email',a417_0x5269d9(0x1b7),a417_0x5269d9(0x1aa),a417_0x5269d9(0x1a2)]};function extractContact(_0x543ca8,_0x3638ff){const _0x1128de=a417_0x5269d9,_0x588164=getValue(_0x543ca8,attrNames[_0x1128de(0x1be)]);let _0x2822a7=getValue(_0x543ca8,attrNames[_0x1128de(0x1b6)]);_0x2822a7=(''+_0x2822a7)['replace'](/\D/g,'');const _0x181ed7=getValue(_0x543ca8,attrNames[_0x1128de(0x1a0)]);return{'name':_0x588164,'number':_0x2822a7,'email':_0x181ed7,'companyId':_0x3638ff};}function a417_0x2b8f(){const _0x15f8e4=['__importDefault','apply','123366MlUfJQ','__esModule','5719lHfHwL','has','jid','88eXmGoK','NUMBER','e-mail','constructor','defineProperty','6PSHSyW','../../models/Contact','nome','Nome','NAME','Número','número','logger','278520aonIGJ','1082435cPZMCY','findOrCreate','73398sTEzrE','131769RKlaOp','lodash','../../utils/logger','map','numero','xlsx','default','EMAIL','readFile','E-mail','ImportXLSContactsService','replace','Sheets','values','number','Numero','utils','Email','(((.+)+)+)+$','312753CRYRig','toString'];a417_0x2b8f=function(){return _0x15f8e4;};return a417_0x2b8f();}function a417_0x22a8(_0xff058c,_0xa7aff){const _0x3233f8=a417_0x2b8f();return a417_0x22a8=function(_0x1e789a,_0x2a94ac){_0x1e789a=_0x1e789a-0x196;let _0x2b8f69=_0x3233f8[_0x1e789a];return _0x2b8f69;},a417_0x22a8(_0xff058c,_0xa7aff);}function getValue(_0x2540b9,_0x32554c){const _0x5ef8ba=a417_0x5269d9;for(const _0x5dfcce of _0x32554c){if((0x0,lodash_2[_0x5ef8ba(0x1b3)])(_0x2540b9,_0x5dfcce))return _0x2540b9[_0x5dfcce];}return'';}async function ImportXLSContactsService(_0x3150bf,_0x2a7f4c){const _0x292b08=a417_0x5269d9,_0x1c6470=xlsx_1[_0x292b08(0x19f)][_0x292b08(0x1a1)](_0x2a7f4c?.['path']),_0x1c4144=(0x0,lodash_1['head'])(Object[_0x292b08(0x1a6)](_0x1c6470[_0x292b08(0x1a5)])),_0x8cc2c0=xlsx_1[_0x292b08(0x19f)][_0x292b08(0x1a9)]['sheet_to_json'](_0x1c4144,{'header':0x0}),_0x4c3e93=_0x8cc2c0[_0x292b08(0x19c)](_0x575f63=>extractContact(_0x575f63,_0x3150bf)),_0x2aa2ea=[];for(const _0x416d3c of _0x4c3e93){const [_0x153ded,_0x415f64]=await Contact_1[_0x292b08(0x19f)][_0x292b08(0x197)]({'where':{'number':''+_0x416d3c[_0x292b08(0x1a7)],'companyId':_0x416d3c['companyId']},'defaults':_0x416d3c});_0x415f64&&_0x2aa2ea['push'](_0x153ded);}if(_0x2aa2ea)for(let _0x536944 of _0x2aa2ea){try{const _0xe199ff=await(0x0,CheckNumber_1['default'])(_0x536944['number'],_0x3150bf),_0x50bd7e=_0xe199ff[_0x292b08(0x1b4)][_0x292b08(0x1a4)](/\D/g,'');_0x536944['number']=_0x50bd7e,await _0x536944['save']();}catch(_0x57387b){logger_1[_0x292b08(0x1c1)]['error']('Número\x20de\x20contato\x20inválido:\x20'+_0x536944[_0x292b08(0x1a7)]);}}return _0x2aa2ea;}exports[a417_0x5269d9(0x1a3)]=ImportXLSContactsService;