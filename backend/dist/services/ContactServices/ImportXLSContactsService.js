const a417_0xfeba4a=a417_0x4a82;(function(_0x3e57fd,_0x240e4f){const _0x4fcafd=a417_0x4a82,_0x217018=_0x3e57fd();while(!![]){try{const _0x1d17eb=parseInt(_0x4fcafd(0x136))/0x1*(-parseInt(_0x4fcafd(0x129))/0x2)+-parseInt(_0x4fcafd(0x13b))/0x3*(-parseInt(_0x4fcafd(0x12b))/0x4)+-parseInt(_0x4fcafd(0x140))/0x5+-parseInt(_0x4fcafd(0x14b))/0x6+-parseInt(_0x4fcafd(0x12f))/0x7*(parseInt(_0x4fcafd(0x14c))/0x8)+-parseInt(_0x4fcafd(0x128))/0x9*(parseInt(_0x4fcafd(0x137))/0xa)+parseInt(_0x4fcafd(0x154))/0xb;if(_0x1d17eb===_0x240e4f)break;else _0x217018['push'](_0x217018['shift']());}catch(_0x156795){_0x217018['push'](_0x217018['shift']());}}}(a417_0xae3f,0xa5b00));function a417_0xae3f(){const _0x5d005b=['e-mail','head','push','xlsx','readFile','defineProperty','61cVSROL','20XCjibF','values','__importDefault','Sheets','4965ArHeAN','lodash','map','EMAIL','../WbotServices/CheckNumber','2714735QkoqyI','utils','search','E-mail','has','Número\x20de\x20contato\x20inválido:\x20','replace','(((.+)+)+)+$','nome','Número','default','6633978jjXkHA','8dFjBvZ','path','../../models/Contact','logger','number','email','__esModule','ImportXLSContactsService','51754318iBlaKl','NAME','Numero','apply','sheet_to_json','constructor','Email','Nome','1440378xRbHZY','28532bAFZKb','toString','116jbDqTR','error','NUMBER','findOrCreate','8647499WvQaCf'];a417_0xae3f=function(){return _0x5d005b;};return a417_0xae3f();}const a417_0x1450b7=(function(){let _0x1297b7=!![];return function(_0x55a945,_0x3af880){const _0xed02e2=_0x1297b7?function(){const _0x2d65d5=a417_0x4a82;if(_0x3af880){const _0x595d39=_0x3af880[_0x2d65d5(0x123)](_0x55a945,arguments);return _0x3af880=null,_0x595d39;}}:function(){};return _0x1297b7=![],_0xed02e2;};}()),a417_0x14fbe6=a417_0x1450b7(this,function(){const _0x7f653e=a417_0x4a82;return a417_0x14fbe6[_0x7f653e(0x12a)]()[_0x7f653e(0x142)](_0x7f653e(0x147))[_0x7f653e(0x12a)]()[_0x7f653e(0x125)](a417_0x14fbe6)['search']('(((.+)+)+)+$');});function a417_0x4a82(_0x19b555,_0x4905b1){const _0x2a8659=a417_0xae3f();return a417_0x4a82=function(_0x14fbe6,_0x1450b7){_0x14fbe6=_0x14fbe6-0x122;let _0xae3fa0=_0x2a8659[_0x14fbe6];return _0xae3fa0;},a417_0x4a82(_0x19b555,_0x4905b1);}a417_0x14fbe6();'use strict';var __importDefault=this&&this[a417_0xfeba4a(0x139)]||function(_0x88a3b){return _0x88a3b&&_0x88a3b['__esModule']?_0x88a3b:{'default':_0x88a3b};};Object[a417_0xfeba4a(0x135)](exports,a417_0xfeba4a(0x152),{'value':!![]}),exports[a417_0xfeba4a(0x153)]=void 0x0;const lodash_1=require(a417_0xfeba4a(0x13c)),xlsx_1=__importDefault(require(a417_0xfeba4a(0x133))),lodash_2=require(a417_0xfeba4a(0x13c)),CheckNumber_1=__importDefault(require(a417_0xfeba4a(0x13f))),logger_1=require('../../utils/logger'),Contact_1=__importDefault(require(a417_0xfeba4a(0x14e))),attrNames={'NAME':[a417_0xfeba4a(0x148),a417_0xfeba4a(0x127)],'NUMBER':['numero','número',a417_0xfeba4a(0x122),a417_0xfeba4a(0x149)],'EMAIL':[a417_0xfeba4a(0x151),a417_0xfeba4a(0x130),a417_0xfeba4a(0x126),a417_0xfeba4a(0x143)]};function extractContact(_0x58a3ad,_0x37e89b){const _0x2035c2=a417_0xfeba4a,_0x1709ab=getValue(_0x58a3ad,attrNames[_0x2035c2(0x155)]);let _0x4eadea=getValue(_0x58a3ad,attrNames[_0x2035c2(0x12d)]);_0x4eadea=(''+_0x4eadea)[_0x2035c2(0x146)](/\D/g,'');const _0x1b0515=getValue(_0x58a3ad,attrNames[_0x2035c2(0x13e)]);return{'name':_0x1709ab,'number':_0x4eadea,'email':_0x1b0515,'companyId':_0x37e89b};}function getValue(_0x39305c,_0x175a58){const _0x1fc586=a417_0xfeba4a;for(const _0x14972a of _0x175a58){if((0x0,lodash_2[_0x1fc586(0x144)])(_0x39305c,_0x14972a))return _0x39305c[_0x14972a];}return'';}async function ImportXLSContactsService(_0x54bac6,_0x9aeb66){const _0xeede0d=a417_0xfeba4a,_0x3fdcc8=xlsx_1[_0xeede0d(0x14a)][_0xeede0d(0x134)](_0x9aeb66?.[_0xeede0d(0x14d)]),_0x5dc3f0=(0x0,lodash_1[_0xeede0d(0x131)])(Object[_0xeede0d(0x138)](_0x3fdcc8[_0xeede0d(0x13a)])),_0x3d1603=xlsx_1[_0xeede0d(0x14a)][_0xeede0d(0x141)][_0xeede0d(0x124)](_0x5dc3f0,{'header':0x0}),_0x266631=_0x3d1603[_0xeede0d(0x13d)](_0x7b23=>extractContact(_0x7b23,_0x54bac6)),_0x29aa79=[];for(const _0x5c3515 of _0x266631){const [_0x1c8170,_0x2ed8f6]=await Contact_1[_0xeede0d(0x14a)][_0xeede0d(0x12e)]({'where':{'number':''+_0x5c3515[_0xeede0d(0x150)],'companyId':_0x5c3515['companyId']},'defaults':_0x5c3515});_0x2ed8f6&&_0x29aa79[_0xeede0d(0x132)](_0x1c8170);}if(_0x29aa79)for(let _0x4052b8 of _0x29aa79){try{const _0x262ee8=await(0x0,CheckNumber_1['default'])(_0x4052b8[_0xeede0d(0x150)],_0x54bac6),_0xdc9613=_0x262ee8['jid'][_0xeede0d(0x146)](/\D/g,'');_0x4052b8[_0xeede0d(0x150)]=_0xdc9613,await _0x4052b8['save']();}catch(_0x126b9d){logger_1[_0xeede0d(0x14f)][_0xeede0d(0x12c)](_0xeede0d(0x145)+_0x4052b8[_0xeede0d(0x150)]);}}return _0x29aa79;}exports[a417_0xfeba4a(0x153)]=ImportXLSContactsService;