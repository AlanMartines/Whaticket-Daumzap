const a423_0x4a089e=a423_0xf39e;(function(_0x3adce3,_0x31d1a1){const _0x3ed9bf=a423_0xf39e,_0x379d5d=_0x3adce3();while(!![]){try{const _0x389806=-parseInt(_0x3ed9bf(0xfd))/0x1*(-parseInt(_0x3ed9bf(0x101))/0x2)+-parseInt(_0x3ed9bf(0x106))/0x3*(-parseInt(_0x3ed9bf(0x11e))/0x4)+-parseInt(_0x3ed9bf(0x109))/0x5*(parseInt(_0x3ed9bf(0xfe))/0x6)+parseInt(_0x3ed9bf(0x125))/0x7*(parseInt(_0x3ed9bf(0x114))/0x8)+parseInt(_0x3ed9bf(0xfc))/0x9+-parseInt(_0x3ed9bf(0x129))/0xa+-parseInt(_0x3ed9bf(0x10f))/0xb;if(_0x389806===_0x31d1a1)break;else _0x379d5d['push'](_0x379d5d['shift']());}catch(_0x38e909){_0x379d5d['push'](_0x379d5d['shift']());}}}(a423_0x1bd8,0x264ea));const a423_0x553ee2=(function(){let _0x349fa5=!![];return function(_0x49b8c1,_0x159b77){const _0x253b84=_0x349fa5?function(){const _0x5ab20c=a423_0xf39e;if(_0x159b77){const _0x5dac3b=_0x159b77[_0x5ab20c(0x116)](_0x49b8c1,arguments);return _0x159b77=null,_0x5dac3b;}}:function(){};return _0x349fa5=![],_0x253b84;};}()),a423_0x1752cd=a423_0x553ee2(this,function(){const _0xc137bd=a423_0xf39e;return a423_0x1752cd[_0xc137bd(0x10a)]()[_0xc137bd(0x124)](_0xc137bd(0x100))[_0xc137bd(0x10a)]()[_0xc137bd(0x123)](a423_0x1752cd)[_0xc137bd(0x124)](_0xc137bd(0x100));});function a423_0x1bd8(){const _0xee805f=['Erro\x20ao\x20enviar\x20e-mail:','moment','add','1994067jSAKHx','5wHrrCR','24gWInYJ','configurable','(((.+)+)+)+$','110962ReuxJf','__setModuleDefault','sendMail','prototype','value','7605llUjJN','call','defineProperty','264910EFfaRc','toString','hour','findOne','createTransport','format','4511078WNvTOa','Erro\x20ao\x20agendar\x20e-mail:\x20','YYYY-MM-DDTHH:mm','Erro\x20ao\x20enviar\x20e-mail:\x20','getOwnPropertyDescriptor','32LRGWMc','default','apply','E-mail\x20agendado\x20e\x20salvo\x20com\x20sucesso','__importStar','__createBinding','schedule','__importDefault','E-mail\x20enviado\x20imediatamente','usersmtpauth','284uIaIyM','Agendamento\x20de\x20e-mail\x20realizado\x20com\x20sucesso','writable','error','SendMail','constructor','search','325472ZrJQdg','__esModule','smtpport','get','860050cRtrdM'];a423_0x1bd8=function(){return _0xee805f;};return a423_0x1bd8();}function a423_0xf39e(_0x359835,_0x247cf0){const _0x24f850=a423_0x1bd8();return a423_0xf39e=function(_0x1752cd,_0x553ee2){_0x1752cd=_0x1752cd-0xfb;let _0x1bd89c=_0x24f850[_0x1752cd];return _0x1bd89c;},a423_0xf39e(_0x359835,_0x247cf0);}a423_0x1752cd();'use strict';var __createBinding=this&&this[a423_0x4a089e(0x119)]||(Object['create']?function(_0x254594,_0xa7d9f5,_0x5c89f4,_0x36534e){const _0x5ae85c=a423_0x4a089e;if(_0x36534e===undefined)_0x36534e=_0x5c89f4;var _0x9aeae7=Object[_0x5ae85c(0x113)](_0xa7d9f5,_0x5c89f4);(!_0x9aeae7||(_0x5ae85c(0x128)in _0x9aeae7?!_0xa7d9f5[_0x5ae85c(0x126)]:_0x9aeae7[_0x5ae85c(0x120)]||_0x9aeae7[_0x5ae85c(0xff)]))&&(_0x9aeae7={'enumerable':!![],'get':function(){return _0xa7d9f5[_0x5c89f4];}}),Object[_0x5ae85c(0x108)](_0x254594,_0x36534e,_0x9aeae7);}:function(_0x317376,_0x189153,_0x4a2431,_0x4b23bd){if(_0x4b23bd===undefined)_0x4b23bd=_0x4a2431;_0x317376[_0x4b23bd]=_0x189153[_0x4a2431];}),__setModuleDefault=this&&this[a423_0x4a089e(0x102)]||(Object['create']?function(_0x317543,_0x2ee511){Object['defineProperty'](_0x317543,'default',{'enumerable':!![],'value':_0x2ee511});}:function(_0x2e3507,_0x2f71ab){const _0x293c4a=a423_0x4a089e;_0x2e3507[_0x293c4a(0x115)]=_0x2f71ab;}),__importStar=this&&this[a423_0x4a089e(0x118)]||function(_0x19e065){const _0x15c773=a423_0x4a089e;if(_0x19e065&&_0x19e065[_0x15c773(0x126)])return _0x19e065;var _0x1cb87b={};if(_0x19e065!=null){for(var _0x3ee1c5 in _0x19e065)if(_0x3ee1c5!==_0x15c773(0x115)&&Object[_0x15c773(0x104)]['hasOwnProperty'][_0x15c773(0x107)](_0x19e065,_0x3ee1c5))__createBinding(_0x1cb87b,_0x19e065,_0x3ee1c5);}return __setModuleDefault(_0x1cb87b,_0x19e065),_0x1cb87b;},__importDefault=this&&this[a423_0x4a089e(0x11b)]||function(_0x23f4fe){return _0x23f4fe&&_0x23f4fe['__esModule']?_0x23f4fe:{'default':_0x23f4fe};};Object[a423_0x4a089e(0x108)](exports,a423_0x4a089e(0x126),{'value':!![]}),exports[a423_0x4a089e(0x122)]=void 0x0;const nodemailer_1=__importDefault(require('nodemailer')),Setting_1=__importDefault(require('../../models/Setting')),Email_1=__importDefault(require('../../models/Email')),cron=__importStar(require('node-cron')),moment_1=__importDefault(require(a423_0x4a089e(0x12b))),SendMail=async(_0x3198a1,_0xa400b5,_0x8b995e,_0x556a79,_0x4f203a,_0x14cf84,_0x3b0fc4)=>{const _0x3f3017=a423_0x4a089e;try{const _0x2b1719=await Setting_1['default'][_0x3f3017(0x10c)]({'where':{'companyId':_0x3198a1,'key':'smtpauth'}}),_0x16f831=await Setting_1[_0x3f3017(0x115)][_0x3f3017(0x10c)]({'where':{'companyId':_0x3198a1,'key':_0x3f3017(0x11d)}}),_0x18be51=await Setting_1[_0x3f3017(0x115)][_0x3f3017(0x10c)]({'where':{'companyId':_0x3198a1,'key':'clientsecretsmtpauth'}}),_0x3bec84=await Setting_1[_0x3f3017(0x115)]['findOne']({'where':{'companyId':_0x3198a1,'key':_0x3f3017(0x127)}}),_0x506e48=_0x2b1719[_0x3f3017(0x105)],_0x29e143=_0x16f831[_0x3f3017(0x105)],_0x19bdc2=_0x18be51['value'],_0x2f8461=_0x3bec84[_0x3f3017(0x105)],_0x29c62c=nodemailer_1[_0x3f3017(0x115)][_0x3f3017(0x10d)]({'host':_0x506e48,'port':Number(_0x2f8461),'secure':![],'auth':{'user':_0x29e143,'pass':_0x19bdc2}});async function _0x55cb1(_0x58c380){const _0xdd5890=_0x3f3017;try{const _0x1184f6={'from':_0x29e143,'to':_0xa400b5,'subject':_0x556a79,'text':_0x4f203a};return await _0x29c62c[_0xdd5890(0x103)](_0x1184f6),await Email_1[_0xdd5890(0x115)]['create']({'sender':_0xa400b5,'subject':_0x556a79,'message':_0x4f203a,'companyId':_0x3198a1}),{'message':_0xdd5890(0x117)};}catch(_0x277b99){console[_0xdd5890(0x121)](_0xdd5890(0x12a),_0x277b99);throw new Error(_0xdd5890(0x112)+_0x277b99);}}if(_0x3b0fc4)return cron[_0x3f3017(0x11a)](_0x3b0fc4,()=>{const _0x5c1146=_0x3f3017,_0x5d2ade=(0x0,moment_1[_0x5c1146(0x115)])()['add'](0x1,'hour')[_0x5c1146(0x10e)](_0x5c1146(0x111));_0x55cb1(_0x5d2ade);}),{'message':_0x3f3017(0x11f)};else{const _0x373a6e=(0x0,moment_1[_0x3f3017(0x115)])()[_0x3f3017(0xfb)](0x1,_0x3f3017(0x10b))['format']('YYYY-MM-DDTHH:mm');return _0x55cb1(_0x373a6e),{'message':_0x3f3017(0x11c)};}}catch(_0x3a1cc1){return console['error']('Erro\x20ao\x20agendar\x20e-mail:',_0x3a1cc1),{'error':_0x3f3017(0x110)+_0x3a1cc1['message']};}};exports[a423_0x4a089e(0x122)]=SendMail,exports['default']=exports[a423_0x4a089e(0x122)];