function a561_0x4d1e(_0x380ce3,_0x25303f){const _0x33da16=a561_0x10e2();return a561_0x4d1e=function(_0x322c03,_0x4c6370){_0x322c03=_0x322c03-0x15d;let _0x10e275=_0x33da16[_0x322c03];return _0x10e275;},a561_0x4d1e(_0x380ce3,_0x25303f);}const a561_0x29e54e=a561_0x4d1e;(function(_0x45cd8a,_0x2e3328){const _0x264ba8=a561_0x4d1e,_0x2fdc6d=_0x45cd8a();while(!![]){try{const _0x94d5b8=parseInt(_0x264ba8(0x175))/0x1*(-parseInt(_0x264ba8(0x16c))/0x2)+parseInt(_0x264ba8(0x17c))/0x3+-parseInt(_0x264ba8(0x189))/0x4*(-parseInt(_0x264ba8(0x17e))/0x5)+-parseInt(_0x264ba8(0x178))/0x6+parseInt(_0x264ba8(0x184))/0x7+-parseInt(_0x264ba8(0x187))/0x8+parseInt(_0x264ba8(0x165))/0x9*(parseInt(_0x264ba8(0x16b))/0xa);if(_0x94d5b8===_0x2e3328)break;else _0x2fdc6d['push'](_0x2fdc6d['shift']());}catch(_0x59da2a){_0x2fdc6d['push'](_0x2fdc6d['shift']());}}}(a561_0x10e2,0x6bda7));const a561_0x4c6370=(function(){let _0x1770ea=!![];return function(_0x2c9243,_0x1c2675){const _0x51704a=_0x1770ea?function(){const _0x44413c=a561_0x4d1e;if(_0x1c2675){const _0x464f77=_0x1c2675[_0x44413c(0x170)](_0x2c9243,arguments);return _0x1c2675=null,_0x464f77;}}:function(){};return _0x1770ea=![],_0x51704a;};}()),a561_0x322c03=a561_0x4c6370(this,function(){const _0x5a0b0c=a561_0x4d1e;return a561_0x322c03[_0x5a0b0c(0x169)]()[_0x5a0b0c(0x160)]('(((.+)+)+)+$')[_0x5a0b0c(0x169)]()['constructor'](a561_0x322c03)[_0x5a0b0c(0x160)]('(((.+)+)+)+$');});a561_0x322c03();function a561_0x10e2(){const _0x195918=['yup','__setModuleDefault','5218493yPFyDm','min','../../models/Company','2505688YKFkse','configurable','16sBkuNF','queues','object','Esse\x20nome\x20já\x20está\x20sendo\x20utilizado\x20por\x20outra\x20conexão','../../models/Whatsapp','default','hasOwnProperty','search','../../models/Plan','prototype','OPENING','boolean','426807OMsxTJ','validate','./AssociateWhatsappQueue','create','toString','../../errors/AppError','50GqaQUO','24olUUkA','getOwnPropertyDescriptor','required','Check-name','apply','defineProperty','__esModule','plan','connections','34863pdZSDb','call','findOne','4951902HYUKsS','message','__createBinding','shape','2179335IjCLMQ','test','361990RqipmL','string','count','beta'];a561_0x10e2=function(){return _0x195918;};return a561_0x10e2();}'use strict';var __createBinding=this&&this[a561_0x29e54e(0x17a)]||(Object[a561_0x29e54e(0x168)]?function(_0x2cdbcc,_0xcc3d5,_0x49a4ed,_0x1042c9){const _0x21b194=a561_0x29e54e;if(_0x1042c9===undefined)_0x1042c9=_0x49a4ed;var _0x1c4038=Object[_0x21b194(0x16d)](_0xcc3d5,_0x49a4ed);(!_0x1c4038||('get'in _0x1c4038?!_0xcc3d5[_0x21b194(0x172)]:_0x1c4038['writable']||_0x1c4038[_0x21b194(0x188)]))&&(_0x1c4038={'enumerable':!![],'get':function(){return _0xcc3d5[_0x49a4ed];}}),Object['defineProperty'](_0x2cdbcc,_0x1042c9,_0x1c4038);}:function(_0x3fc80,_0x3f06bc,_0xcd2f91,_0x5c30b9){if(_0x5c30b9===undefined)_0x5c30b9=_0xcd2f91;_0x3fc80[_0x5c30b9]=_0x3f06bc[_0xcd2f91];}),__setModuleDefault=this&&this[a561_0x29e54e(0x183)]||(Object[a561_0x29e54e(0x168)]?function(_0x3bba4b,_0x50eef0){const _0x44b62b=a561_0x29e54e;Object[_0x44b62b(0x171)](_0x3bba4b,_0x44b62b(0x15e),{'enumerable':!![],'value':_0x50eef0});}:function(_0x44a8b6,_0x15889d){_0x44a8b6['default']=_0x15889d;}),__importStar=this&&this['__importStar']||function(_0x42fdf3){const _0xa3a663=a561_0x29e54e;if(_0x42fdf3&&_0x42fdf3[_0xa3a663(0x172)])return _0x42fdf3;var _0x2ebe40={};if(_0x42fdf3!=null){for(var _0x4bdddf in _0x42fdf3)if(_0x4bdddf!=='default'&&Object[_0xa3a663(0x162)][_0xa3a663(0x15f)][_0xa3a663(0x176)](_0x42fdf3,_0x4bdddf))__createBinding(_0x2ebe40,_0x42fdf3,_0x4bdddf);}return __setModuleDefault(_0x2ebe40,_0x42fdf3),_0x2ebe40;},__importDefault=this&&this['__importDefault']||function(_0x2af852){const _0x1f808a=a561_0x29e54e;return _0x2af852&&_0x2af852[_0x1f808a(0x172)]?_0x2af852:{'default':_0x2af852};};Object[a561_0x29e54e(0x171)](exports,a561_0x29e54e(0x172),{'value':!![]});const Yup=__importStar(require(a561_0x29e54e(0x182))),AppError_1=__importDefault(require(a561_0x29e54e(0x16a))),Whatsapp_1=__importDefault(require(a561_0x29e54e(0x15d))),Company_1=__importDefault(require(a561_0x29e54e(0x186))),Plan_1=__importDefault(require(a561_0x29e54e(0x161))),AssociateWhatsappQueue_1=__importDefault(require(a561_0x29e54e(0x167))),CreateWhatsAppService=async({name:_0x32272e,status:status=a561_0x29e54e(0x163),queueIds:queueIds=[],greetingMessage:_0x55f2b1,complationMessage:_0x34e367,outOfHoursMessage:_0x15e2e8,ratingMessage:_0x531c8a,isDefault:isDefault=![],companyId:_0x370e85,token:token='',provider:provider=a561_0x29e54e(0x181),timeSendQueue:_0x474998,sendIdQueue:_0x464a48,promptId:_0xc9ed21,integrationId:_0x159077,maxUseBotQueues:maxUseBotQueues=0x3,timeUseBotQueues:timeUseBotQueues=0x0,expiresTicket:expiresTicket=0x0,expiresInactiveMessage:expiresInactiveMessage='',allowGroup:_0x59e286,importOldMessages:_0x442dbe,importRecentMessages:_0x22e9cf,closedTicketsPostImported:_0x1edfde,importOldMessagesGroups:_0x136e13})=>{const _0x27f732=a561_0x29e54e,_0x5e640d=await Company_1[_0x27f732(0x15e)][_0x27f732(0x177)]({'where':{'id':_0x370e85},'include':[{'model':Plan_1[_0x27f732(0x15e)],'as':_0x27f732(0x173)}]});if(_0x5e640d!==null){const _0xbbfd65=await Whatsapp_1[_0x27f732(0x15e)][_0x27f732(0x180)]({'where':{'companyId':_0x370e85}});if(_0xbbfd65>=_0x5e640d[_0x27f732(0x173)][_0x27f732(0x174)])throw new AppError_1[(_0x27f732(0x15e))]('Número\x20máximo\x20de\x20conexões\x20já\x20alcançado:\x20'+_0xbbfd65);}const _0x347968=Yup[_0x27f732(0x18b)]()[_0x27f732(0x17b)]({'name':Yup[_0x27f732(0x17f)]()[_0x27f732(0x16e)]()[_0x27f732(0x185)](0x2)[_0x27f732(0x17d)](_0x27f732(0x16f),_0x27f732(0x18c),async _0x2d5fae=>{const _0x363a77=_0x27f732;if(!_0x2d5fae)return![];const _0x4f8a7a=await Whatsapp_1[_0x363a77(0x15e)]['findOne']({'where':{'name':_0x2d5fae}});return!_0x4f8a7a;}),'isDefault':Yup[_0x27f732(0x164)]()[_0x27f732(0x16e)]()});try{await _0x347968[_0x27f732(0x166)]({'name':_0x32272e,'status':status,'isDefault':isDefault});}catch(_0xc428db){throw new AppError_1[(_0x27f732(0x15e))](_0xc428db[_0x27f732(0x179)]);}const _0x21b11e=await Whatsapp_1[_0x27f732(0x15e)][_0x27f732(0x177)]({'where':{'companyId':_0x370e85}});isDefault=!_0x21b11e;let _0xa4a0a3=null;isDefault&&(_0xa4a0a3=await Whatsapp_1[_0x27f732(0x15e)][_0x27f732(0x177)]({'where':{'isDefault':!![],'companyId':_0x370e85}}),_0xa4a0a3&&await _0xa4a0a3['update']({'isDefault':![],'companyId':_0x370e85}));if(queueIds['length']>0x1&&!_0x55f2b1)throw new AppError_1[(_0x27f732(0x15e))]('ERR_WAPP_GREETING_REQUIRED');if(token!==null&&token!==''){const _0x4dfdb1=Yup[_0x27f732(0x18b)]()['shape']({'token':Yup[_0x27f732(0x17f)]()[_0x27f732(0x16e)]()[_0x27f732(0x185)](0x2)[_0x27f732(0x17d)]('Check-token','This\x20whatsapp\x20token\x20is\x20already\x20used.',async _0x335319=>{const _0x3f5ef0=_0x27f732;if(!_0x335319)return![];const _0x35a0e6=await Whatsapp_1[_0x3f5ef0(0x15e)][_0x3f5ef0(0x177)]({'where':{'token':_0x335319}});return!_0x35a0e6;})});try{await _0x4dfdb1['validate']({'token':token});}catch(_0x35ffe5){throw new AppError_1[(_0x27f732(0x15e))](_0x35ffe5[_0x27f732(0x179)]);}}const _0x487986=await Whatsapp_1[_0x27f732(0x15e)][_0x27f732(0x168)]({'name':_0x32272e,'status':status,'greetingMessage':_0x55f2b1,'complationMessage':_0x34e367,'outOfHoursMessage':_0x15e2e8,'ratingMessage':_0x531c8a,'isDefault':isDefault,'companyId':_0x370e85,'token':token,'provider':provider,'timeSendQueue':_0x474998,'sendIdQueue':_0x464a48,'promptId':_0xc9ed21&&_0xc9ed21>0x0?_0xc9ed21:null,'integrationId':_0x159077&&_0x159077>0x0?_0x159077:null,'maxUseBotQueues':maxUseBotQueues,'timeUseBotQueues':timeUseBotQueues,'expiresTicket':expiresTicket,'expiresInactiveMessage':expiresInactiveMessage,'allowGroup':_0x59e286,'importOldMessages':_0x442dbe,'importRecentMessages':_0x22e9cf,'closedTicketsPostImported':_0x1edfde,'importOldMessagesGroups':_0x136e13},{'include':[_0x27f732(0x18a)]});return await(0x0,AssociateWhatsappQueue_1['default'])(_0x487986,queueIds),{'whatsapp':_0x487986,'oldDefaultWhatsapp':_0xa4a0a3};};exports[a561_0x29e54e(0x15e)]=CreateWhatsAppService;