function a520_0x1068(_0x327493,_0x42ef48){const _0x45021f=a520_0x50b3();return a520_0x1068=function(_0x2f2db7,_0x5b2dfd){_0x2f2db7=_0x2f2db7-0xb8;let _0x50b3d0=_0x45021f[_0x2f2db7];return _0x50b3d0;},a520_0x1068(_0x327493,_0x42ef48);}function a520_0x50b3(){const _0x2d04f3=['4284610LDEqYr','7443ljkaCT','toString','__esModule','../WhatsappService/ShowWhatsAppService','contact','6hoULGf','ERR_CREATING_TICKET','default','constructor','922536KDnvFF','apply','3711463eXYRuv','2odcZhB','../../helpers/GetDefaultWhatsApp','124xevUTs','641280JhrmJt','40hrUtTd','52077LeWCKM','__importDefault','update','5830308HSIAUT','../../libs/socket','queue','../../helpers/GetDefaultWhatsAppByUser','search','ticket','../../helpers/CheckContactOpenTickets','getIO','(((.+)+)+)+$','../../errors/AppError'];a520_0x50b3=function(){return _0x2d04f3;};return a520_0x50b3();}const a520_0x5413c8=a520_0x1068;(function(_0x524312,_0x2162de){const _0x4ccc3e=a520_0x1068,_0x9b228c=_0x524312();while(!![]){try{const _0x5638e4=-parseInt(_0x4ccc3e(0xd3))/0x1*(parseInt(_0x4ccc3e(0xd6))/0x2)+parseInt(_0x4ccc3e(0xbc))/0x3*(parseInt(_0x4ccc3e(0xb9))/0x4)+parseInt(_0x4ccc3e(0xc9))/0x5+parseInt(_0x4ccc3e(0xcf))/0x6*(-parseInt(_0x4ccc3e(0xd5))/0x7)+-parseInt(_0x4ccc3e(0xbb))/0x8*(parseInt(_0x4ccc3e(0xca))/0x9)+parseInt(_0x4ccc3e(0xba))/0xa+parseInt(_0x4ccc3e(0xbf))/0xb;if(_0x5638e4===_0x2162de)break;else _0x9b228c['push'](_0x9b228c['shift']());}catch(_0x358103){_0x9b228c['push'](_0x9b228c['shift']());}}}(a520_0x50b3,0x81f67));const a520_0x5b2dfd=(function(){let _0x3ce575=!![];return function(_0x572155,_0x3bcd59){const _0x262306=_0x3ce575?function(){const _0x2311af=a520_0x1068;if(_0x3bcd59){const _0x2b21bd=_0x3bcd59[_0x2311af(0xd4)](_0x572155,arguments);return _0x3bcd59=null,_0x2b21bd;}}:function(){};return _0x3ce575=![],_0x262306;};}()),a520_0x2f2db7=a520_0x5b2dfd(this,function(){const _0x4210fd=a520_0x1068;return a520_0x2f2db7[_0x4210fd(0xcb)]()[_0x4210fd(0xc3)](_0x4210fd(0xc7))[_0x4210fd(0xcb)]()[_0x4210fd(0xd2)](a520_0x2f2db7)[_0x4210fd(0xc3)]('(((.+)+)+)+$');});a520_0x2f2db7();'use strict';var __importDefault=this&&this[a520_0x5413c8(0xbd)]||function(_0x132e2b){const _0xb09694=a520_0x5413c8;return _0x132e2b&&_0x132e2b[_0xb09694(0xcc)]?_0x132e2b:{'default':_0x132e2b};};Object['defineProperty'](exports,a520_0x5413c8(0xcc),{'value':!![]});const AppError_1=__importDefault(require(a520_0x5413c8(0xc8))),CheckContactOpenTickets_1=__importDefault(require(a520_0x5413c8(0xc5))),GetDefaultWhatsApp_1=__importDefault(require(a520_0x5413c8(0xb8))),Ticket_1=__importDefault(require('../../models/Ticket')),ShowContactService_1=__importDefault(require('../ContactServices/ShowContactService')),socket_1=require(a520_0x5413c8(0xc0)),GetDefaultWhatsAppByUser_1=__importDefault(require(a520_0x5413c8(0xc2))),ShowWhatsAppService_1=__importDefault(require(a520_0x5413c8(0xcd))),CreateTicketService=async({contactId:_0x5a9fdf,status:_0x5f12a4,userId:_0x511ffb,queueId:_0x27fcab,companyId:_0x5a2fa5,whatsappId:_0x2850e8})=>{const _0x1059c6=a520_0x5413c8;let _0xf4e11d;_0x2850e8!==undefined&&_0x2850e8!==null&&_0x2850e8!==''&&(_0xf4e11d=await(0x0,ShowWhatsAppService_1[_0x1059c6(0xd1)])(_0x2850e8,_0x5a2fa5));let _0x264702=await(0x0,GetDefaultWhatsAppByUser_1['default'])(_0x511ffb);_0xf4e11d&&(_0x264702=_0xf4e11d);if(!_0x264702)_0x264702=await(0x0,GetDefaultWhatsApp_1['default'])(_0x5a2fa5);await(0x0,CheckContactOpenTickets_1['default'])(_0x5a9fdf,_0x2850e8);const {isGroup:_0x37ab9a}=await(0x0,ShowContactService_1[_0x1059c6(0xd1)])(_0x5a9fdf,_0x5a2fa5),[{id:_0x249f07}]=await Ticket_1[_0x1059c6(0xd1)]['findOrCreate']({'where':{'contactId':_0x5a9fdf,'companyId':_0x5a2fa5,'whatsappId':_0x2850e8},'defaults':{'contactId':_0x5a9fdf,'companyId':_0x5a2fa5,'whatsappId':_0x264702['id'],'status':_0x5f12a4,'isGroup':_0x37ab9a,'userId':_0x511ffb}});await Ticket_1[_0x1059c6(0xd1)][_0x1059c6(0xbe)]({'companyId':_0x5a2fa5,'queueId':_0x27fcab,'userId':_0x511ffb,'whatsappId':_0x264702['id'],'status':'open'},{'where':{'id':_0x249f07}});const _0x1a0c30=await Ticket_1[_0x1059c6(0xd1)]['findByPk'](_0x249f07,{'include':[_0x1059c6(0xce),_0x1059c6(0xc1)]});if(!_0x1a0c30)throw new AppError_1['default'](_0x1059c6(0xd0));const _0x491b7e=(0x0,socket_1[_0x1059c6(0xc6)])();return _0x491b7e['to'](_0x1a0c30['id']['toString']())['emit'](_0x1059c6(0xc4),{'action':_0x1059c6(0xbe),'ticket':_0x1a0c30}),_0x1a0c30;};exports['default']=CreateTicketService;