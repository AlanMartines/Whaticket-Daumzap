const a520_0x4fabc1=a520_0x3241;(function(_0x2ee631,_0x48c0b0){const _0x5a04f5=a520_0x3241,_0x3e6f61=_0x2ee631();while(!![]){try{const _0x1597bf=parseInt(_0x5a04f5(0x1ae))/0x1*(parseInt(_0x5a04f5(0x1a4))/0x2)+parseInt(_0x5a04f5(0x1b5))/0x3*(-parseInt(_0x5a04f5(0x1ad))/0x4)+parseInt(_0x5a04f5(0x1a5))/0x5*(parseInt(_0x5a04f5(0x1b7))/0x6)+-parseInt(_0x5a04f5(0x1a0))/0x7*(-parseInt(_0x5a04f5(0x19e))/0x8)+-parseInt(_0x5a04f5(0x19d))/0x9*(-parseInt(_0x5a04f5(0x1b3))/0xa)+parseInt(_0x5a04f5(0x198))/0xb+-parseInt(_0x5a04f5(0x1b1))/0xc;if(_0x1597bf===_0x48c0b0)break;else _0x3e6f61['push'](_0x3e6f61['shift']());}catch(_0x3cb26c){_0x3e6f61['push'](_0x3e6f61['shift']());}}}(a520_0xb409,0x4785e));const a520_0x4c22d2=(function(){let _0x546ad3=!![];return function(_0x930e27,_0x1b67fd){const _0x1927b7=_0x546ad3?function(){const _0x4e4bb9=a520_0x3241;if(_0x1b67fd){const _0x48c26c=_0x1b67fd[_0x4e4bb9(0x19b)](_0x930e27,arguments);return _0x1b67fd=null,_0x48c26c;}}:function(){};return _0x546ad3=![],_0x1927b7;};}()),a520_0xdb290a=a520_0x4c22d2(this,function(){const _0x5956a4=a520_0x3241;return a520_0xdb290a['toString']()[_0x5956a4(0x1a6)](_0x5956a4(0x1af))[_0x5956a4(0x19a)]()[_0x5956a4(0x1b6)](a520_0xdb290a)[_0x5956a4(0x1a6)](_0x5956a4(0x1af));});a520_0xdb290a();function a520_0x3241(_0x4f6444,_0x5e03db){const _0x49f42d=a520_0xb409();return a520_0x3241=function(_0xdb290a,_0x4c22d2){_0xdb290a=_0xdb290a-0x196;let _0xb409e=_0x49f42d[_0xdb290a];return _0xb409e;},a520_0x3241(_0x4f6444,_0x5e03db);}'use strict';var __importDefault=this&&this[a520_0x4fabc1(0x1aa)]||function(_0x5933d1){return _0x5933d1&&_0x5933d1['__esModule']?_0x5933d1:{'default':_0x5933d1};};function a520_0xb409(){const _0x287ff6=['open','1032126cOcAUX','constructor','1193964GLkHxN','emit','queue','../../helpers/GetDefaultWhatsAppByUser','4948361rKXXLh','__esModule','toString','apply','contact','72GmyKzL','8rzFbWk','update','4045783elqigk','../../helpers/GetDefaultWhatsApp','defineProperty','../../helpers/CheckContactOpenTickets','16ujGNzP','5IasVRM','search','default','ticket','ERR_CREATING_TICKET','__importDefault','../ContactServices/ShowContactService','findOrCreate','4TjxXxe','7655tzcicH','(((.+)+)+)+$','../WhatsappService/ShowWhatsAppService','10323432JHIxxk','getIO','261540pVgTcS'];a520_0xb409=function(){return _0x287ff6;};return a520_0xb409();}Object[a520_0x4fabc1(0x1a2)](exports,a520_0x4fabc1(0x199),{'value':!![]});const AppError_1=__importDefault(require('../../errors/AppError')),CheckContactOpenTickets_1=__importDefault(require(a520_0x4fabc1(0x1a3))),GetDefaultWhatsApp_1=__importDefault(require(a520_0x4fabc1(0x1a1))),Ticket_1=__importDefault(require('../../models/Ticket')),ShowContactService_1=__importDefault(require(a520_0x4fabc1(0x1ab))),socket_1=require('../../libs/socket'),GetDefaultWhatsAppByUser_1=__importDefault(require(a520_0x4fabc1(0x197))),ShowWhatsAppService_1=__importDefault(require(a520_0x4fabc1(0x1b0))),CreateTicketService=async({contactId:_0x4a6aba,status:_0x18fcc8,userId:_0x539290,queueId:_0x3a49f2,companyId:_0x93b72e,whatsappId:_0x587297})=>{const _0x4962cc=a520_0x4fabc1;let _0x1ad1f5;_0x587297!==undefined&&_0x587297!==null&&_0x587297!==''&&(_0x1ad1f5=await(0x0,ShowWhatsAppService_1[_0x4962cc(0x1a7)])(_0x587297,_0x93b72e));let _0x48cfee=await(0x0,GetDefaultWhatsAppByUser_1[_0x4962cc(0x1a7)])(_0x539290);_0x1ad1f5&&(_0x48cfee=_0x1ad1f5);if(!_0x48cfee)_0x48cfee=await(0x0,GetDefaultWhatsApp_1['default'])(_0x93b72e);await(0x0,CheckContactOpenTickets_1[_0x4962cc(0x1a7)])(_0x4a6aba,_0x587297);const {isGroup:_0x29454c}=await(0x0,ShowContactService_1['default'])(_0x4a6aba,_0x93b72e),[{id:_0x90ba97}]=await Ticket_1[_0x4962cc(0x1a7)][_0x4962cc(0x1ac)]({'where':{'contactId':_0x4a6aba,'companyId':_0x93b72e,'whatsappId':_0x587297},'defaults':{'contactId':_0x4a6aba,'companyId':_0x93b72e,'whatsappId':_0x48cfee['id'],'status':_0x18fcc8,'isGroup':_0x29454c,'userId':_0x539290}});await Ticket_1[_0x4962cc(0x1a7)][_0x4962cc(0x19f)]({'companyId':_0x93b72e,'queueId':_0x3a49f2,'userId':_0x539290,'whatsappId':_0x48cfee['id'],'status':_0x4962cc(0x1b4)},{'where':{'id':_0x90ba97}});const _0x16390d=await Ticket_1[_0x4962cc(0x1a7)]['findByPk'](_0x90ba97,{'include':[_0x4962cc(0x19c),_0x4962cc(0x196)]});if(!_0x16390d)throw new AppError_1[(_0x4962cc(0x1a7))](_0x4962cc(0x1a9));const _0x2374f6=(0x0,socket_1[_0x4962cc(0x1b2)])();return _0x2374f6['to'](_0x16390d['id'][_0x4962cc(0x19a)]())[_0x4962cc(0x1b8)](_0x4962cc(0x1a8),{'action':'update','ticket':_0x16390d}),_0x16390d;};exports[a520_0x4fabc1(0x1a7)]=CreateTicketService;