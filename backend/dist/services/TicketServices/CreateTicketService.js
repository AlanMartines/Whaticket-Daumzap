const a520_0x5731d7=a520_0x520c;(function(_0xd911e5,_0x5d8a23){const _0x5002f3=a520_0x520c,_0x114ba9=_0xd911e5();while(!![]){try{const _0x322ea7=-parseInt(_0x5002f3(0x1a6))/0x1+parseInt(_0x5002f3(0x1ac))/0x2+-parseInt(_0x5002f3(0x19e))/0x3+-parseInt(_0x5002f3(0x1a9))/0x4*(parseInt(_0x5002f3(0x1a5))/0x5)+-parseInt(_0x5002f3(0x1aa))/0x6*(parseInt(_0x5002f3(0x1af))/0x7)+-parseInt(_0x5002f3(0x1b0))/0x8*(parseInt(_0x5002f3(0x1a2))/0x9)+parseInt(_0x5002f3(0x1ab))/0xa*(parseInt(_0x5002f3(0x19c))/0xb);if(_0x322ea7===_0x5d8a23)break;else _0x114ba9['push'](_0x114ba9['shift']());}catch(_0x5ee87c){_0x114ba9['push'](_0x114ba9['shift']());}}}(a520_0x1788,0x8101b));function a520_0x520c(_0xdf110,_0xe8916c){const _0x3cb958=a520_0x1788();return a520_0x520c=function(_0x5f1e1d,_0x5cedc7){_0x5f1e1d=_0x5f1e1d-0x192;let _0x1788e9=_0x3cb958[_0x5f1e1d];return _0x1788e9;},a520_0x520c(_0xdf110,_0xe8916c);}const a520_0x5cedc7=(function(){let _0x24c39b=!![];return function(_0x167418,_0x54504e){const _0x17ec01=_0x24c39b?function(){const _0x339e0a=a520_0x520c;if(_0x54504e){const _0x32ed62=_0x54504e[_0x339e0a(0x199)](_0x167418,arguments);return _0x54504e=null,_0x32ed62;}}:function(){};return _0x24c39b=![],_0x17ec01;};}()),a520_0x5f1e1d=a520_0x5cedc7(this,function(){const _0x727656=a520_0x520c;return a520_0x5f1e1d[_0x727656(0x197)]()[_0x727656(0x194)](_0x727656(0x1b3))[_0x727656(0x197)]()[_0x727656(0x1a3)](a520_0x5f1e1d)[_0x727656(0x194)](_0x727656(0x1b3));});a520_0x5f1e1d();'use strict';function a520_0x1788(){const _0x3f3497=['emit','(((.+)+)+)+$','__importDefault','defineProperty','search','queue','findOrCreate','toString','../../helpers/GetDefaultWhatsAppByUser','apply','findByPk','ticket','35669953dNNYOJ','../../errors/AppError','1931058XAsBqp','../WhatsappService/ShowWhatsAppService','contact','ERR_CREATING_TICKET','4584429pPFGha','constructor','getIO','26845tdzaVa','476608SpuGhF','open','../ContactServices/ShowContactService','680RmHKDQ','399576bfxiCI','10qwAbBB','1121298MTABte','../../helpers/CheckContactOpenTickets','../../helpers/GetDefaultWhatsApp','77gFJxNJ','8BmaEbd','default'];a520_0x1788=function(){return _0x3f3497;};return a520_0x1788();}var __importDefault=this&&this[a520_0x5731d7(0x192)]||function(_0x50c8b3){return _0x50c8b3&&_0x50c8b3['__esModule']?_0x50c8b3:{'default':_0x50c8b3};};Object[a520_0x5731d7(0x193)](exports,'__esModule',{'value':!![]});const AppError_1=__importDefault(require(a520_0x5731d7(0x19d))),CheckContactOpenTickets_1=__importDefault(require(a520_0x5731d7(0x1ad))),GetDefaultWhatsApp_1=__importDefault(require(a520_0x5731d7(0x1ae))),Ticket_1=__importDefault(require('../../models/Ticket')),ShowContactService_1=__importDefault(require(a520_0x5731d7(0x1a8))),socket_1=require('../../libs/socket'),GetDefaultWhatsAppByUser_1=__importDefault(require(a520_0x5731d7(0x198))),ShowWhatsAppService_1=__importDefault(require(a520_0x5731d7(0x19f))),CreateTicketService=async({contactId:_0x103ccd,status:_0xdb7bee,userId:_0x5a156e,queueId:_0x3f710b,companyId:_0x41cfb1,whatsappId:_0x3cc4f0})=>{const _0x1e982b=a520_0x5731d7;let _0x3afe43;_0x3cc4f0!==undefined&&_0x3cc4f0!==null&&_0x3cc4f0!==''&&(_0x3afe43=await(0x0,ShowWhatsAppService_1['default'])(_0x3cc4f0,_0x41cfb1));let _0x172986=await(0x0,GetDefaultWhatsAppByUser_1['default'])(_0x5a156e);_0x3afe43&&(_0x172986=_0x3afe43);if(!_0x172986)_0x172986=await(0x0,GetDefaultWhatsApp_1[_0x1e982b(0x1b1)])(_0x41cfb1);await(0x0,CheckContactOpenTickets_1[_0x1e982b(0x1b1)])(_0x103ccd,_0x3cc4f0);const {isGroup:_0x2a49b7}=await(0x0,ShowContactService_1[_0x1e982b(0x1b1)])(_0x103ccd,_0x41cfb1),[{id:_0x482d36}]=await Ticket_1[_0x1e982b(0x1b1)][_0x1e982b(0x196)]({'where':{'contactId':_0x103ccd,'companyId':_0x41cfb1,'whatsappId':_0x3cc4f0},'defaults':{'contactId':_0x103ccd,'companyId':_0x41cfb1,'whatsappId':_0x172986['id'],'status':_0xdb7bee,'isGroup':_0x2a49b7,'userId':_0x5a156e}});await Ticket_1[_0x1e982b(0x1b1)]['update']({'companyId':_0x41cfb1,'queueId':_0x3f710b,'userId':_0x5a156e,'whatsappId':_0x172986['id'],'status':_0x1e982b(0x1a7)},{'where':{'id':_0x482d36}});const _0x4f445f=await Ticket_1[_0x1e982b(0x1b1)][_0x1e982b(0x19a)](_0x482d36,{'include':[_0x1e982b(0x1a0),_0x1e982b(0x195)]});if(!_0x4f445f)throw new AppError_1[(_0x1e982b(0x1b1))](_0x1e982b(0x1a1));const _0xab4a4d=(0x0,socket_1[_0x1e982b(0x1a4)])();return _0xab4a4d['to'](_0x4f445f['id'][_0x1e982b(0x197)]())[_0x1e982b(0x1b2)](_0x1e982b(0x19b),{'action':'update','ticket':_0x4f445f}),_0x4f445f;};exports[a520_0x5731d7(0x1b1)]=CreateTicketService;