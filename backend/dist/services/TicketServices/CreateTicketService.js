const a520_0x5b2352=a520_0x2677;(function(_0x4a832a,_0xe0021c){const _0x3e0886=a520_0x2677,_0x2a5c06=_0x4a832a();while(!![]){try{const _0x520291=-parseInt(_0x3e0886(0x1c2))/0x1*(-parseInt(_0x3e0886(0x1cc))/0x2)+parseInt(_0x3e0886(0x1cb))/0x3+parseInt(_0x3e0886(0x1da))/0x4+parseInt(_0x3e0886(0x1ce))/0x5*(-parseInt(_0x3e0886(0x1ca))/0x6)+-parseInt(_0x3e0886(0x1d6))/0x7+parseInt(_0x3e0886(0x1cf))/0x8+-parseInt(_0x3e0886(0x1d1))/0x9*(-parseInt(_0x3e0886(0x1d7))/0xa);if(_0x520291===_0xe0021c)break;else _0x2a5c06['push'](_0x2a5c06['shift']());}catch(_0x29a35c){_0x2a5c06['push'](_0x2a5c06['shift']());}}}(a520_0x17ce,0x882d2));function a520_0x2677(_0x47489f,_0x129252){const _0x2193b1=a520_0x17ce();return a520_0x2677=function(_0x4775d1,_0x462ea2){_0x4775d1=_0x4775d1-0x1bf;let _0x17ce7a=_0x2193b1[_0x4775d1];return _0x17ce7a;},a520_0x2677(_0x47489f,_0x129252);}const a520_0x462ea2=(function(){let _0x372cce=!![];return function(_0x401456,_0x2c71dc){const _0x3f2db6=_0x372cce?function(){if(_0x2c71dc){const _0x4045cb=_0x2c71dc['apply'](_0x401456,arguments);return _0x2c71dc=null,_0x4045cb;}}:function(){};return _0x372cce=![],_0x3f2db6;};}()),a520_0x4775d1=a520_0x462ea2(this,function(){const _0x4ebddf=a520_0x2677;return a520_0x4775d1[_0x4ebddf(0x1c5)]()['search'](_0x4ebddf(0x1d3))[_0x4ebddf(0x1c5)]()[_0x4ebddf(0x1d9)](a520_0x4775d1)[_0x4ebddf(0x1d5)](_0x4ebddf(0x1d3));});a520_0x4775d1();function a520_0x17ce(){const _0x162bbe=['54oBooeP','ticket','618930yMkGhR','4636240gLwBmk','open','45QbsyMH','../../helpers/GetDefaultWhatsApp','(((.+)+)+)+$','emit','search','6271433ikgWdq','73930ENlsce','../WhatsappService/ShowWhatsAppService','constructor','267304FOoSdy','update','__esModule','defineProperty','findByPk','21674GqrLqC','findOrCreate','contact','toString','getIO','queue','../../helpers/CheckContactOpenTickets','default','18LcAOxk','1669608YEgTir'];a520_0x17ce=function(){return _0x162bbe;};return a520_0x17ce();}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x15b2dd){const _0x206575=a520_0x2677;return _0x15b2dd&&_0x15b2dd[_0x206575(0x1bf)]?_0x15b2dd:{'default':_0x15b2dd};};Object[a520_0x5b2352(0x1c0)](exports,a520_0x5b2352(0x1bf),{'value':!![]});const AppError_1=__importDefault(require('../../errors/AppError')),CheckContactOpenTickets_1=__importDefault(require(a520_0x5b2352(0x1c8))),GetDefaultWhatsApp_1=__importDefault(require(a520_0x5b2352(0x1d2))),Ticket_1=__importDefault(require('../../models/Ticket')),ShowContactService_1=__importDefault(require('../ContactServices/ShowContactService')),socket_1=require('../../libs/socket'),GetDefaultWhatsAppByUser_1=__importDefault(require('../../helpers/GetDefaultWhatsAppByUser')),ShowWhatsAppService_1=__importDefault(require(a520_0x5b2352(0x1d8))),CreateTicketService=async({contactId:_0x515f45,status:_0x5081f5,userId:_0x403b72,queueId:_0x4868e0,companyId:_0x248185,whatsappId:_0x5395a7})=>{const _0x38e27f=a520_0x5b2352;let _0x258902;_0x5395a7!==undefined&&_0x5395a7!==null&&_0x5395a7!==''&&(_0x258902=await(0x0,ShowWhatsAppService_1[_0x38e27f(0x1c9)])(_0x5395a7,_0x248185));let _0x5d9c4c=await(0x0,GetDefaultWhatsAppByUser_1[_0x38e27f(0x1c9)])(_0x403b72);_0x258902&&(_0x5d9c4c=_0x258902);if(!_0x5d9c4c)_0x5d9c4c=await(0x0,GetDefaultWhatsApp_1[_0x38e27f(0x1c9)])(_0x248185);await(0x0,CheckContactOpenTickets_1[_0x38e27f(0x1c9)])(_0x515f45,_0x5395a7);const {isGroup:_0x1990cf}=await(0x0,ShowContactService_1[_0x38e27f(0x1c9)])(_0x515f45,_0x248185),[{id:_0x1a4753}]=await Ticket_1[_0x38e27f(0x1c9)][_0x38e27f(0x1c3)]({'where':{'contactId':_0x515f45,'companyId':_0x248185,'whatsappId':_0x5395a7},'defaults':{'contactId':_0x515f45,'companyId':_0x248185,'whatsappId':_0x5d9c4c['id'],'status':_0x5081f5,'isGroup':_0x1990cf,'userId':_0x403b72}});await Ticket_1[_0x38e27f(0x1c9)][_0x38e27f(0x1db)]({'companyId':_0x248185,'queueId':_0x4868e0,'userId':_0x403b72,'whatsappId':_0x5d9c4c['id'],'status':_0x38e27f(0x1d0)},{'where':{'id':_0x1a4753}});const _0x184584=await Ticket_1['default'][_0x38e27f(0x1c1)](_0x1a4753,{'include':[_0x38e27f(0x1c4),_0x38e27f(0x1c7)]});if(!_0x184584)throw new AppError_1['default']('ERR_CREATING_TICKET');const _0x55ee10=(0x0,socket_1[_0x38e27f(0x1c6)])();return _0x55ee10['to'](_0x184584['id'][_0x38e27f(0x1c5)]())[_0x38e27f(0x1d4)](_0x38e27f(0x1cd),{'action':_0x38e27f(0x1db),'ticket':_0x184584}),_0x184584;};exports[a520_0x5b2352(0x1c9)]=CreateTicketService;