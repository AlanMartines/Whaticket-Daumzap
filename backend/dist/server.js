'use strict';const a348_0x58d8ad=a348_0x4101;(function(_0x446dde,_0x5d9a12){const _0x58e21e=a348_0x4101,_0x484981=_0x446dde();while(!![]){try{const _0x5bf361=-parseInt(_0x58e21e(0x14e))/0x1+-parseInt(_0x58e21e(0x15c))/0x2+-parseInt(_0x58e21e(0x154))/0x3+parseInt(_0x58e21e(0x160))/0x4+-parseInt(_0x58e21e(0x152))/0x5*(-parseInt(_0x58e21e(0x159))/0x6)+parseInt(_0x58e21e(0x157))/0x7*(-parseInt(_0x58e21e(0x16e))/0x8)+-parseInt(_0x58e21e(0x15d))/0x9*(-parseInt(_0x58e21e(0x15a))/0xa);if(_0x5bf361===_0x5d9a12)break;else _0x484981['push'](_0x484981['shift']());}catch(_0x3ab44d){_0x484981['push'](_0x484981['shift']());}}}(a348_0x4d5a,0x85020));function a348_0x4d5a(){const _0x416496=['env','error','then','flushdb','./utils/logger','toString','payGatewayInitialize','__importDefault','Error\x20initializing\x20payment\x20gateway:\x20','checkOpenInvoices','./services/WbotServices/StartAllWhatsAppsSessions','591360YxpdIo','toUTCString','catch','./models/Company','map','initIO','defineProperty','http-graceful-shutdown','startLicenseChecker','unhandledRejection','startQueueProcess','./queues','128958UdejZe','message','search','PORT','33905Blbmji','default','3198129ncnWlA','logger','(((.+)+)+)+$','70SrZuMR','constructor','864HbqDcz','1160ycuLNa','stack','1027822zOMkRT','106479ZLQClp','findAll','__esModule','2576208DWToad','./app','FLUSH_REDIS_ON_START'];a348_0x4d5a=function(){return _0x416496;};return a348_0x4d5a();}function a348_0x4101(_0x61359b,_0x472d4e){const _0xd3b2b8=a348_0x4d5a();return a348_0x4101=function(_0x35ca3f,_0x19a749){_0x35ca3f=_0x35ca3f-0x149;let _0x4d5a44=_0xd3b2b8[_0x35ca3f];return _0x4d5a44;},a348_0x4101(_0x61359b,_0x472d4e);}var __importDefault=this&&this[a348_0x58d8ad(0x16a)]||function(_0x339328){const _0xaa14ad=a348_0x58d8ad;return _0x339328&&_0x339328[_0xaa14ad(0x15f)]?_0x339328:{'default':_0x339328};};Object[a348_0x58d8ad(0x174)](exports,a348_0x58d8ad(0x15f),{'value':!![]});const http_graceful_shutdown_1=__importDefault(require(a348_0x58d8ad(0x149))),app_1=__importDefault(require(a348_0x58d8ad(0x161))),socket_1=require('./libs/socket'),logger_1=require(a348_0x58d8ad(0x167)),StartAllWhatsAppsSessions_1=require(a348_0x58d8ad(0x16d)),Company_1=__importDefault(require(a348_0x58d8ad(0x171))),queues_1=require(a348_0x58d8ad(0x14d)),PaymentGatewayServices_1=require('./services/PaymentGatewayServices/PaymentGatewayServices'),useRedisAuthState_1=require('./helpers/useRedisAuthState'),licenseChecker_1=require('./workers/licenseChecker');async function startServer(){const _0x368708=a348_0x58d8ad,_0x38d64b=(function(){let _0x359ad4=!![];return function(_0x53427c,_0x305f53){const _0x145251=_0x359ad4?function(){if(_0x305f53){const _0x2280ba=_0x305f53['apply'](_0x53427c,arguments);return _0x305f53=null,_0x2280ba;}}:function(){};return _0x359ad4=![],_0x145251;};}()),_0x3bb3e8=_0x38d64b(this,function(){const _0x44a6ee=a348_0x4101;return _0x3bb3e8[_0x44a6ee(0x168)]()[_0x44a6ee(0x150)](_0x44a6ee(0x156))[_0x44a6ee(0x168)]()[_0x44a6ee(0x158)](_0x3bb3e8)[_0x44a6ee(0x150)](_0x44a6ee(0x156));});_0x3bb3e8();try{await(0x0,licenseChecker_1[_0x368708(0x14a)])();const _0x2c47e8=app_1[_0x368708(0x153)]['listen'](process['env']['PORT'],async()=>{const _0xe324b7=_0x368708;if(process[_0xe324b7(0x163)][_0xe324b7(0x162)]=='true')await useRedisAuthState_1['redis'][_0xe324b7(0x166)]();const _0x33062b=await Company_1['default'][_0xe324b7(0x15e)]({'where':{'status':!![]}}),_0x3840f5=[];_0x33062b['map'](async _0x501164=>{const _0x2e6702=(0x0,StartAllWhatsAppsSessions_1['StartAllWhatsAppsSessions'])(_0x501164['id']);_0x3840f5['push'](_0x2e6702);}),Promise['all'](_0x3840f5)[_0xe324b7(0x165)](async()=>{const _0x4a3540=_0xe324b7;await(0x0,queues_1[_0x4a3540(0x14c)])();}),logger_1['logger']['info']('Server\x20started\x20on\x20port:\x20'+process[_0xe324b7(0x163)][_0xe324b7(0x151)]),(0x0,PaymentGatewayServices_1[_0xe324b7(0x169)])()[_0xe324b7(0x170)](_0x106d6e=>{const _0x25d3e0=_0xe324b7;logger_1[_0x25d3e0(0x155)]['error'](_0x25d3e0(0x16b)+_0x106d6e[_0x25d3e0(0x14f)]);}),_0x33062b[_0xe324b7(0x172)](async _0x46ee98=>{const _0x3d0bad=_0xe324b7,_0x1eac16=(0x0,PaymentGatewayServices_1[_0x3d0bad(0x16c)])(_0x46ee98['id']);_0x3840f5['push'](_0x1eac16);});});(0x0,socket_1[_0x368708(0x173)])(_0x2c47e8),(0x0,http_graceful_shutdown_1[_0x368708(0x153)])(_0x2c47e8),process['on']('uncaughtException',_0x3462d5=>{const _0x53f37c=_0x368708;console[_0x53f37c(0x164)](new Date()[_0x53f37c(0x16f)]()+'\x20uncaughtException:',_0x3462d5[_0x53f37c(0x14f)]),console[_0x53f37c(0x164)](_0x3462d5[_0x53f37c(0x15b)]);}),process['on'](_0x368708(0x14b),(_0x4e4c64,_0x2e8815)=>{console['error'](new Date()['toUTCString']()+'\x20unhandledRejection:',_0x4e4c64,_0x2e8815);});}catch(_0xca2228){logger_1[_0x368708(0x155)][_0x368708(0x164)]('Failed\x20to\x20start\x20the\x20server:',_0xca2228),process['exit'](0x1);}}startServer();